<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.8">
<title>Welcome to Entando</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="./stylesheets/menuoverride.css">
<link rel="stylesheet" href="./stylesheets/fontawesome5-3-1.css">

<script src="./js/jquery.js"></script>
<script src="./js/fontawesome.min.js"></script>
<script src="./js/menu.js"></script>
<script src="./js/headScript.js"></script>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Welcome to Entando</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#e6-new">1. Entando 6.1.0</a>
<ul class="sectlevel2">
<li><a href="#_getting_started">1.1. Getting Started</a>
<ul class="sectlevel3">
<li><a href="#_pre_requisites">1.1.1. Pre-Requisites</a></li>
<li><a href="#_steps">1.1.2. Steps</a>
<ul class="sectlevel4">
<li><a href="#_kubernetes_setup_instructions">Kubernetes Setup Instructions</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_app_builder">1.2. App Builder</a>
<ul class="sectlevel3">
<li><a href="#_hello_world_for_a_widget_using_the_app_builder">1.2.1. Hello World for a Widget Using the App builder</a>
<ul class="sectlevel4">
<li><a href="#_basic_widget_tutorial">Basic Widget Tutorial</a></li>
<li><a href="#_simple_fragment_tutorial">Simple Fragment tutorial</a></li>
<li><a href="#_freemarker_basics_in_entando">Freemarker Basics in Entando</a></li>
<li><a href="#_useful_links">Useful Links</a></li>
</ul>
</li>
<li><a href="#_tutorial_extending_the_app_builder">1.2.2. Tutorial: Extending the App Builder</a>
<ul class="sectlevel4">
<li><a href="#_creating_a_basic_application">Creating a Basic Application</a></li>
<li><a href="#_understanding_the_stand_alone_environment">Understanding the Stand Alone Environment</a></li>
</ul>
</li>
<li><a href="#_exports">1.2.3. Exports</a></li>
<li><a href="#_id_is_the_app_id">1.2.4. id:  is the app id.</a></li>
<li><a href="#_menu_is_a_react_component_containing_all_the_menu_elements">1.2.5. menu:  is a React component containing all the menu elements.</a>
<ul class="sectlevel4">
<li><a href="#_customizing_the_menu">Customizing the Menu</a></li>
</ul>
</li>
<li><a href="#_locales">1.2.6. locales</a>
<ul class="sectlevel4">
<li><a href="#_customizing_the_menu_labels">Customizing the menu labels</a></li>
</ul>
</li>
<li><a href="#_routes_and_routesdir">1.2.7. Routes and RoutesDir</a>
<ul class="sectlevel4">
<li><a href="#_customizing_the_routes">Customizing the Routes</a></li>
<li><a href="#_state">state</a></li>
<li><a href="#_customizing_the_reducers">Customizing the Reducers</a></li>
</ul>
</li>
<li><a href="#_creating_the_ui_components">1.2.8. Creating the UI Components</a>
<ul class="sectlevel4">
<li><a href="#_userlist">userList</a></li>
<li><a href="#_page_models">Page Models</a></li>
</ul>
</li>
<li><a href="#_connecting_the_app_to_an_entando_core_instance">1.2.9. Connecting the app to an Entando core instance</a>
<ul class="sectlevel4">
<li><a href="#_adding_the_api_calls">Adding the API Calls</a></li>
<li><a href="#_creating_the_thunk">Creating the Thunk</a></li>
<li><a href="#_changing_the_mapdispatchtoprops_in_the_containers">changing the mapDispatchToProps in the containers</a></li>
<li><a href="#_updating_the_list_components">Updating the List components</a></li>
<li><a href="#_clear_the_default_value_of_the_reducer">clear the default value of the reducer</a></li>
</ul>
</li>
<li><a href="#_adding_additional_dependencies">1.2.10. adding additional dependencies</a></li>
<li><a href="#_running_the_app_in_integrated_mode_within_app_builder">1.2.11. running the app in integrated mode within App Builder</a></li>
</ul>
</li>
<li><a href="#_micro_frontends">1.3. Micro Frontends</a>
<ul class="sectlevel3">
<li><a href="#_tutorial_create_a_react_micro_frontend_widget">1.3.1. Tutorial: create a react micro frontend widget</a>
<ul class="sectlevel4">
<li><a href="#_prerequisites">Prerequisites</a></li>
<li><a href="#_bootstrap_a_react_app">Bootstrap a react app</a></li>
<li><a href="#_wrap_the_react_app_in_a_custom_element">Wrap the react app in a custom element</a></li>
<li><a href="#_build_the_widget">Build the widget</a></li>
<li><a href="#_create_the_entando_6_widget_in_app_builder">Create the Entando 6 widget in App Builder</a></li>
</ul>
</li>
<li><a href="#_tutorial_using_a_custom_event_for_widget_communication">1.3.2. Tutorial: Using a custom event for widget communication</a>
<ul class="sectlevel4">
<li><a href="#_fire_an_event_from_a_widget">Fire an event from a widget</a></li>
<li><a href="#_consume_an_event_in_another_widget">Consume an event in another widget</a></li>
<li><a href="#_make_both_widgets_work_in_entando">Make both widgets work in Entando</a></li>
</ul>
</li>
<li><a href="#_tutorial_add_app_builder_configuration_screen_for_an_entando_6_widget">1.3.3. Tutorial: Add App Builder configuration screen for an Entando 6 widget</a>
<ul class="sectlevel4">
<li><a href="#_generate_a_react_app">Generate a React app</a></li>
<li><a href="#_edit_the_root_app_component">Edit the root app component</a></li>
<li><a href="#_wrap_the_react_app_in_a_web_component">Wrap the react app in a web component</a></li>
<li><a href="#_add_widget_config_screen_in_app_builder">Add widget config screen in App Builder</a></li>
</ul>
</li>
<li><a href="#_tutorial_display_widget_configuration_data">1.3.4. Tutorial: Display widget configuration data</a>
<ul class="sectlevel4">
<li><a href="#_add_an_attribute_to_the_custom_element">Add an attribute to the custom element</a></li>
<li><a href="#_make_react_component_handle_the_input">Make react component handle the input</a></li>
<li><a href="#_rebuild_the_widget">Rebuild the widget</a></li>
<li><a href="#_update_the_entando_6_widget_in_app_builder">Update the Entando 6 widget in App Builder</a></li>
</ul>
</li>
<li><a href="#_tutorial_blueprint_generated_widgets_overview">1.3.5. Tutorial: Blueprint generated widgets' overview</a>
<ul class="sectlevel4">
<li><a href="#_common_parts">Common parts</a></li>
<li><a href="#_form_widget">Form widget</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_entando_component_repository">1.4. Entando Component Repository</a>
<ul class="sectlevel3">
<li><a href="#_entando_component_repository_overview">1.4.1. Entando Component Repository Overview</a>
<ul class="sectlevel4">
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#_entando_component_repository_glossary">Entando Component Repository Glossary</a></li>
<li><a href="#_architecture_overview">Architecture overview</a></li>
<li><a href="#_example_of_an_ecr_flow">Example of an ECR flow:</a></li>
<li><a href="#_ecre_bundle_and_component_details">ECRe bundle and component details</a></li>
</ul>
</li>
<li><a href="#_create_a_local_npm_registry_for_testing">1.4.2. Create a local NPM registry for testing</a>
<ul class="sectlevel4">
<li><a href="#_start_local_nexus_as_a_docker_container">Start local nexus as a docker container</a></li>
<li><a href="#_setup_a_private_npm_registry">Setup a private npm registry</a></li>
<li><a href="#_setup_npm_realm_and_user_for_publishing">Setup npm-realm and user for publishing</a></li>
<li><a href="#_create_the_role">Create the role</a></li>
<li><a href="#_create_the_user">Create the user</a></li>
<li><a href="#_enable_npm_realm_to_support_npm_adduser_or_npm_login">Enable npm realm to support <code>npm adduser</code> or <code>npm login</code></a></li>
<li><a href="#_configure_npm">Configure NPM</a></li>
<li><a href="#_config_npm_to_use_the_local_repository">Config npm to use the local repository</a></li>
<li><a href="#_login_to_the_registry">Login to the registry</a></li>
<li><a href="#_good_to_go">Good to go</a></li>
<li><a href="#_set_the_publish_repository_at_package_json_level">Set the publish repository at package.json level</a></li>
</ul>
</li>
<li><a href="#_tutorial_how_to_create_a_digital_exchange_bundle">1.4.3. Tutorial: How to create a digital-exchange bundle</a>
<ul class="sectlevel4">
<li><a href="#_purpose">Purpose</a></li>
<li><a href="#_requirements">Requirements</a></li>
<li><a href="#_steps_2">Steps</a></li>
<li><a href="#_conclusion">Conclusion</a></li>
<li><a href="#resources">Resources</a></li>
</ul>
</li>
<li><a href="#_from_blueprint_to_the_entando_component_repository_ecr_bundle">1.4.4. From Blueprint to the Entando Component Repository (ECR) bundle</a></li>
<li><a href="#_purpose_2">1.4.5. Purpose</a></li>
<li><a href="#_requirements_2">1.4.6. Requirements</a></li>
<li><a href="#_steps_3">1.4.7. Steps</a>
<ul class="sectlevel4">
<li><a href="#_1_generate_an_entity">1. Generate an entity</a></li>
<li><a href="#_2_populate_the_bundle_with_the_micro_frontends">2. Populate the bundle with the micro frontends</a></li>
<li><a href="#_3_generate_a_docker_image_for_your_microservice">3. Generate a docker image for your microservice</a></li>
<li><a href="#_4_publish_the_docker_image_to_docker_registry_dockerhub_or_equivalent">4. Publish the Docker image to Docker registry (DockerHub or equivalent)</a></li>
<li><a href="#_5_publish_the_bundle_to_an_npm_registry">5. Publish the bundle to an Npm registry</a></li>
<li><a href="#_6_generate_the_entandodebundle_kubernetes_custom_resource">6. Generate the EntandoDeBundle Kubernetes custom resource</a></li>
<li><a href="#_7_deploy_the_entandodebundle_custom_resource_on_the_cluster">7. Deploy the EntandoDeBundle custom resource on the cluster</a></li>
</ul>
</li>
<li><a href="#_conclusion_2">1.4.8. Conclusion</a></li>
<li><a href="#_resources">1.4.9. Resources</a></li>
</ul>
</li>
<li><a href="#_blueprint">1.5. Blueprint</a>
<ul class="sectlevel3">
<li><a href="#_objective">1.5.1. Objective</a>
<ul class="sectlevel4">
<li><a href="#_prerequisites_2">Prerequisites</a></li>
<li><a href="#_setup_for_blueprint_dev_mode">Setup for Blueprint Dev mode</a></li>
<li><a href="#_open_the_project_in_an_ide">Open the project in an IDE</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_core_app">1.6. Core App</a>
<ul class="sectlevel3">
<li><a href="#_the_entando_core_apis">1.6.1. The Entando Core APIs</a>
<ul class="sectlevel4">
<li><a href="#_prerequisites_3">Prerequisites</a></li>
<li><a href="#_setup">Setup</a></li>
<li><a href="#_overview">Overview</a></li>
<li><a href="#_tutorial">Tutorial:</a></li>
</ul>
</li>
<li><a href="#_adding_a_new_api_to_the_core_app">1.6.2. Adding a new API to the core app</a>
<ul class="sectlevel4">
<li><a href="#_prerequisites_4">Prerequisites</a></li>
<li><a href="#_overview_2">Overview</a></li>
<li><a href="#_tutorial_2">Tutorial</a></li>
</ul>
</li>
<li><a href="#_building_a_docker_image_for_the_entando_core">1.6.3. Building a Docker Image for the Entando Core</a>
<ul class="sectlevel4">
<li><a href="#_prerequisites_5">Prerequisites</a></li>
<li><a href="#_introduction_2">Introduction</a></li>
<li><a href="#_setup_2">Setup</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_freemarker_tags">1.7. Freemarker Tags</a>
<ul class="sectlevel3">
<li><a href="#_aps_core_tag_library">1.7.1. Aps Core Tag Library</a>
<ul class="sectlevel4">
<li><a href="#_tag_action">Tag <code>action</code></a></li>
<li><a href="#_tag_categories">Tag <code>categories</code></a></li>
<li><a href="#_tag_checkheadinfoouputter">Tag <code>checkHeadInfoOuputter</code></a></li>
<li><a href="#_tag_cssurl">Tag <code>cssURL</code></a></li>
<li><a href="#_tag_currentpage">Tag <code>currentPage</code></a></li>
<li><a href="#_tag_currentwidget">Tag <code>currentWidget</code></a></li>
<li><a href="#_tag_fragment">Tag <code>fragment</code></a></li>
<li><a href="#_tag_freemarkertemplateparameter">Tag <code>freemarkerTemplateParameter</code></a></li>
<li><a href="#_tag_headinfo">Tag <code>headInfo</code></a></li>
<li><a href="#_tag_i18n">Tag <code>i18n</code></a></li>
<li><a href="#_tag_ifauthorized">Tag <code>ifauthorized</code></a></li>
<li><a href="#_tag_imgurl">Tag <code>imgURL</code></a></li>
<li><a href="#_tag_info">Tag <code>info</code></a></li>
<li><a href="#_tag_internalservlet">Tag <code>internalServlet</code></a></li>
<li><a href="#_tag_nav">Tag <code>nav</code></a></li>
<li><a href="#_tag_outputheadinfo">Tag <code>outputHeadInfo</code></a></li>
<li><a href="#_tag_pageinfo">Tag <code>pageInfo</code></a></li>
<li><a href="#_tag_pager">Tag <code>pager</code></a></li>
<li><a href="#_tag_parameter">Tag <code>parameter</code></a></li>
<li><a href="#_tag_pager_2">Tag <code>pager</code></a></li>
<li><a href="#_tag_printheadinfo">Tag <code>printHeadInfo</code></a></li>
<li><a href="#_tag_resourceurl">Tag <code>resourceURL</code></a></li>
<li><a href="#_tag_show">Tag <code>show</code></a></li>
<li><a href="#_tag_url">Tag <code>url</code></a></li>
<li><a href="#_tag_pagewithwidget">Tag <code>pageWithWidget</code></a></li>
<li><a href="#_tag_currentuserprofileattribute">Tag <code>currentUserProfileAttribute</code></a></li>
<li><a href="#_tag_userprofileattribute">Tag <code>userProfileAttribute</code></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_kubernetes_and_operator">1.8. Kubernetes and Operator</a>
<ul class="sectlevel3">
<li><a href="#_entando_6_cluster_citizens">1.8.1. Entando 6 cluster citizens</a>
<ul class="sectlevel4">
<li><a href="#_purpose_3">Purpose</a></li>
<li><a href="#_prerequisites_6">Prerequisites</a></li>
<li><a href="#_architecture_diagram">Architecture diagram</a></li>
<li><a href="#_members_of_the_cluster">Members of the cluster</a></li>
<li><a href="#_references">References</a></li>
</ul>
</li>
<li><a href="#_tutorial_how_to_connect_entando_6_to_an_external_keycloak_instance">1.8.2. Tutorial: How to connect Entando 6 to an external Keycloak instance</a>
<ul class="sectlevel4">
<li><a href="#_purpose_4">Purpose</a></li>
<li><a href="#_requirements_3">Requirements</a></li>
<li><a href="#_steps_4">Steps</a></li>
<li><a href="#_conclusion_3">Conclusion</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_process_driven_apps">1.9. Process Driven Apps</a>
<ul class="sectlevel3">
<li><a href="#_business_objective">1.9.1. Business Objective</a></li>
<li><a href="#_terminology">1.9.2. Terminology</a>
<ul class="sectlevel4">
<li><a href="#_micro_frontend">Micro Frontend</a></li>
<li><a href="#_process_automation_manager_pam">Process Automation Manager (PAM)</a></li>
<li><a href="#_business_process_modeling_notation_bpmn">Business Process Modeling Notation (bpmn)</a></li>
<li><a href="#_decision_model_and_notation_dmn">Decision Model and Notation (dmn)</a></li>
<li><a href="#_back_end_for_front_end_bff">Back End for Front End (BFF)</a></li>
</ul>
</li>
<li><a href="#_pda_micro_frontends">1.9.3. PDA Micro Frontends</a>
<ul class="sectlevel4">
<li><a href="#_task_list">Task List</a></li>
<li><a href="#_task_details">Task Details</a></li>
<li><a href="#_task_comments">Task Comments</a></li>
<li><a href="#_task_forms">Task Forms</a></li>
<li><a href="#_attachments">Attachments</a></li>
<li><a href="#_new_process_form">New Process Form</a></li>
<li><a href="#_summary_card">Summary Card</a></li>
<li><a href="#_totals_over_time">Totals Over Time</a></li>
</ul>
</li>
<li><a href="#_customizing_the_process_driven_application">1.9.4. Customizing the Process Driven Application</a>
<ul class="sectlevel4">
<li><a href="#_styling">Styling</a></li>
<li><a href="#_implementing_a_new_engine_or_integrating_a_new_task_source">Implementing a New Engine or Integrating a New Task Source</a></li>
<li><a href="#_page_templates_and_layout">Page Templates and Layout</a></li>
<li><a href="#_creating_a_new_pda_mfe">Creating a new PDA MFE</a></li>
<li><a href="#_communication_between_mfes">Communication between MFEs</a></li>
</ul>
</li>
<li><a href="#_technical_documentation">1.9.5. Technical Documentation</a>
<ul class="sectlevel4">
<li><a href="#_micro_frontend_overview">Micro Frontend Overview</a></li>
<li><a href="#_widgets">Widgets</a></li>
<li><a href="#_building_from_source">Building From source</a></li>
<li><a href="#_code_style">Code Style</a></li>
<li><a href="#_sonar">Sonar</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_cms">1.10. CMS</a>
<ul class="sectlevel3">
<li><a href="#_publish_a_content_in_your_application_page_tutorial">1.10.1. Publish a Content in your Application Page_Tutorial</a>
<ul class="sectlevel4">
<li><a href="#_objective_2">Objective</a></li>
<li><a href="#_content_templates">Content Templates</a></li>
<li><a href="#_content_types">Content Types</a></li>
<li><a href="#_contents">Contents</a></li>
<li><a href="#_publish_a_content">Publish A Content</a></li>
<li><a href="#_digital_assets">Digital Assets</a></li>
<li><a href="#_list_of_attribute_types">List of Attribute Types</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_release_notes">1.11. Release Notes</a>
<ul class="sectlevel3">
<li><a href="#_release_notes_entando_6_1_0">1.11.1. Release Notes Entando 6.1.0</a>
<ul class="sectlevel4">
<li><a href="#_highlights">Highlights</a></li>
<li><a href="#_tech_preview">Tech Preview</a></li>
<li><a href="#_released_image_versions">Released Image Versions</a></li>
<li><a href="#_known_issues">Known Issues</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_entando_6_0_0">2. ENTANDO 6.0.0</a>
<ul class="sectlevel2">
<li><a href="#_see_6_1_0">2.1. See 6.1.0</a></li>
</ul>
</li>
<li><a href="#_entando_5_2_0">3. ENTANDO 5.2.0</a>
<ul class="sectlevel2">
<li><a href="#current-release-notes">3.1. ENTANDO 6.0.0 RELEASE NOTES</a>
<ul class="sectlevel3">
<li><a href="#_new_capabilities_and_features">3.1.1. NEW CAPABILITIES AND FEATURES</a>
<ul class="sectlevel4">
<li><a href="#_goal_of_e6">GOAL OF E6</a></li>
<li><a href="#_about_e6">ABOUT E6</a></li>
<li><a href="#_whats_new_in_e6">WHAT&#8217;S NEW IN E6</a></li>
<li><a href="#_improved_developer_experience">Improved Developer Experience</a></li>
<li><a href="#_software_requirements">SOFTWARE REQUIREMENTS</a></li>
<li><a href="#_legal_notice">LEGAL NOTICE</a></li>
<li><a href="#_links_and_resources">LINKS AND RESOURCES</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#installation">3.2. INSTALLING ENTANDO ENTANDO 6</a>
<ul class="sectlevel3">
<li><a href="#_prerequisites_7">3.2.1. PREREQUISITES</a>
<ul class="sectlevel4">
<li><a href="#_space_and_hardware_requirements">SPACE AND HARDWARE REQUIREMENTS</a></li>
<li><a href="#_installed_prerequisites">INSTALLED PREREQUISITES:</a></li>
</ul>
</li>
<li><a href="#_preparation">3.2.2. PREPARATION</a></li>
<li><a href="#_introduction_3">3.2.3. INTRODUCTION</a></li>
<li><a href="#_steps_with_a_cluster_admin_role">3.2.4. STEPS WITH A CLUSTER ADMIN ROLE</a></li>
<li><a href="#_steps_without_a_cluster_admin_role">3.2.5. STEPS WITHOUT A CLUSTER ADMIN ROLE</a></li>
<li><a href="#_after_installation">3.2.6. AFTER INSTALLATION</a></li>
</ul>
</li>
<li><a href="#_app_building_with_entando">3.3. APP BUILDING WITH ENTANDO</a>
<ul class="sectlevel3">
<li><a href="#_introducing_the_entando_app_builder">3.3.1. INTRODUCING THE ENTANDO APP BUILDER</a>
<ul class="sectlevel4">
<li><a href="#_entando_admin_console_version_5_0">ENTANDO ADMIN CONSOLE VERSION 5.0</a></li>
</ul>
</li>
<li><a href="#_app_builder_overview">3.3.2. APP BUILDER OVERVIEW</a></li>
<li><a href="#_dashboard">3.3.3. DASHBOARD</a></li>
<li><a href="#_creating_and_managing_pages_with_page_designer">3.3.4. CREATING AND MANAGING PAGES WITH PAGE DESIGNER</a>
<ul class="sectlevel4">
<li><a href="#_using_the_page_tree">USING THE PAGE TREE</a></li>
<li><a href="#configuring-page">CONFIGURING A PAGE</a></li>
</ul>
</li>
<li><a href="#_ux_patterns_managing_widgets_page_models_and_fragments">3.3.5. UX PATTERNS: MANAGING WIDGETS, PAGE MODELS, AND FRAGMENTS</a>
<ul class="sectlevel4">
<li><a href="#_using_widgets">USING WIDGETS</a></li>
<li><a href="#_using_fragments">USING FRAGMENTS</a></li>
<li><a href="#page-models">USING PAGE MODELS</a></li>
</ul>
</li>
<li><a href="#_integrating_with_red_hat_process_automation_manager_pam">3.3.6. INTEGRATING WITH RED HAT PROCESS AUTOMATION MANAGER (PAM)</a></li>
<li><a href="#_managing_users">3.3.7. MANAGING USERS</a>
<ul class="sectlevel4">
<li><a href="#_working_with_users">WORKING WITH USERS</a></li>
<li><a href="#_restricting_access">RESTRICTING ACCESS</a></li>
</ul>
</li>
<li><a href="#_presenting_data">3.3.8. PRESENTING DATA</a>
<ul class="sectlevel4">
<li><a href="#_structuring_with_data_types">STRUCTURING WITH DATA TYPES</a></li>
</ul>
</li>
<li><a href="#_configuring_entando">3.3.9. CONFIGURING ENTANDO</a>
<ul class="sectlevel4">
<li><a href="#_categories">CATEGORIES</a></li>
<li><a href="#_labels_and_languages">LABELS AND LANGUAGES</a></li>
<li><a href="#_database">DATABASE</a></li>
<li><a href="#_file_browser">FILE BROWSER</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#getting-started-app-builder">3.4. GETTING STARTED WITH ENTANDO</a>
<ul class="sectlevel3">
<li><a href="#_sample_mortgage_application">3.4.1. SAMPLE MORTGAGE APPLICATION</a>
<ul class="sectlevel4">
<li><a href="#_preface">PREFACE</a></li>
<li><a href="#_configuring_the_applicant_page">CONFIGURING THE APPLICANT PAGE</a></li>
</ul>
</li>
<li><a href="#rh-getting-started">3.4.2. GETTING STARTED WITH ENTANDO AND PAM</a>
<ul class="sectlevel4">
<li><a href="#_overview_9">Overview</a></li>
<li><a href="#_update_the_home_screen_of_your_application">Update the Home Screen of your Application</a></li>
<li><a href="#_view_your_application">View your Application</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_content_management_system">3.5. CONTENT MANAGEMENT SYSTEM</a>
<ul class="sectlevel3">
<li><a href="#_introduction_4">3.5.1. INTRODUCTION</a>
<ul class="sectlevel4">
<li><a href="#_defining_content_management_sections">DEFINING CONTENT MANAGEMENT SECTIONS</a></li>
</ul>
</li>
<li><a href="#_contents_section">3.5.2. CONTENTS SECTION</a>
<ul class="sectlevel4">
<li><a href="#_adding_images_and_tags">ADDING IMAGES AND TAGS</a></li>
</ul>
</li>
<li><a href="#_digital_assets_2">3.5.3. DIGITAL ASSETS</a>
<ul class="sectlevel4">
<li><a href="#_editing_assets">EDITING ASSETS</a></li>
<li><a href="#_working_with_an_assets_metadata">WORKING WITH AN ASSET&#8217;S METADATA</a></li>
<li><a href="#_cropping_images">CROPPING IMAGES</a></li>
</ul>
</li>
<li><a href="#_content_types_2">3.5.4. CONTENT TYPES</a></li>
<li><a href="#_content_models">3.5.5. CONTENT MODELS</a></li>
<li><a href="#_content_settings">3.5.6. CONTENT SETTINGS</a>
<ul class="sectlevel4">
<li><a href="#_autopopulating_image_tags">AUTOPOPULATING IMAGE TAGS</a></li>
<li><a href="#_excluding_metadata">EXCLUDING METADATA</a></li>
<li><a href="#_adding_and_removing_metadata_fields">ADDING AND REMOVING METADATA FIELDS</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_entando_pwa">3.6. ENTANDO PWA</a>
<ul class="sectlevel3">
<li><a href="#_defining_the_structure">3.6.1. DEFINING THE STRUCTURE</a></li>
<li><a href="#_installation">3.6.2. INSTALLATION</a>
<ul class="sectlevel4">
<li><a href="#_prerequisites_8">PREREQUISITES</a></li>
<li><a href="#_git_clone">GIT CLONE</a></li>
<li><a href="#_provider_instance_setup">PROVIDER INSTANCE SETUP</a></li>
<li><a href="#_pwa_instance_setup">PWA INSTANCE SETUP</a></li>
</ul>
</li>
<li><a href="#_keycloak_authentication_feature">3.6.3. KEYCLOAK AUTHENTICATION FEATURE</a>
<ul class="sectlevel4">
<li><a href="#_prerequisites_9">PREREQUISITES</a></li>
<li><a href="#_keycloak_setup_in_pwa_provider">KEYCLOAK SETUP IN PWA PROVIDER</a></li>
<li><a href="#_configure_pwa_provider_instance_with_keycloak">CONFIGURE PWA PROVIDER INSTANCE WITH KEYCLOAK</a></li>
<li><a href="#_configure_pwa_app_pwa_shell_with_keycloak">CONFIGURE PWA APP (PWA-SHELL) WITH KEYCLOAK</a></li>
</ul>
</li>
<li><a href="#_styling_rebranding">3.6.4. STYLING / REBRANDING</a>
<ul class="sectlevel4">
<li><a href="#_app_naming">APP NAMING</a></li>
<li><a href="#_icons_splash_screens">ICONS &amp; SPLASH SCREENS</a></li>
<li><a href="#_logos_icons_other_image_assets">LOGOS, ICONS &amp; OTHER IMAGE ASSETS</a></li>
<li><a href="#_color_themes">COLOR THEMES</a></li>
</ul>
</li>
<li><a href="#_the_pwa_shell_code_structure">3.6.5. THE PWA SHELL CODE STRUCTURE</a>
<ul class="sectlevel4">
<li><a href="#_layout_components">LAYOUT COMPONENTS</a></li>
<li><a href="#_api_methods">API METHODS</a></li>
<li><a href="#_i18n">I18N</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_entandos_custom_jsp_tags">3.7. ENTANDO&#8217;S CUSTOM JSP TAGS</a></li>
<li><a href="#_entando_faqs">3.8. ENTANDO FAQs</a>
<ul class="sectlevel3">
<li><a href="#_error_messages">3.8.1. ERROR MESSAGES</a></li>
<li><a href="#_how_tos">3.8.2. HOW TOs</a></li>
<li><a href="#_widgets_2">3.8.3. WIDGETS</a></li>
</ul>
</li>
<li><a href="#_prior_entando_release_notes">3.9. PRIOR ENTANDO RELEASE NOTES</a>
<ul class="sectlevel3">
<li><a href="#prior-release-notes">3.9.1. ENTANDO 5.2.0 RELEASE NOTES</a>
<ul class="sectlevel4">
<li><a href="#_new_capabilities_and_features_2">NEW CAPABILITIES AND FEATURES</a></li>
<li><a href="#_documentation_and_deployment">DOCUMENTATION AND DEPLOYMENT</a></li>
<li><a href="#_content_management">CONTENT MANAGEMENT</a></li>
<li><a href="#_apis_and_endpoints">APIs AND ENDPOINTS</a></li>
<li><a href="#_fixes_and_updates">FIXES AND UPDATES</a></li>
<li><a href="#_new_capabilities_in_integration_with_red_hat_pam">NEW CAPABILITIES IN INTEGRATION WITH RED HAT PAM</a></li>
<li><a href="#_changes_and_updates_in_5_1_0_in_integration_with_red_hat_pam">CHANGES AND UPDATES IN 5.1.0 IN INTEGRATION WITH RED HAT PAM</a></li>
<li><a href="#_known_issues_3">KNOWN ISSUES</a></li>
<li><a href="#_software_requirements_2">SOFTWARE REQUIREMENTS</a></li>
<li><a href="#_legal_notice_2">LEGAL NOTICE</a></li>
<li><a href="#_links_and_resources_2">LINKS AND RESOURCES</a></li>
</ul>
</li>
<li><a href="#_entando_5_0_2_release_notes">3.9.2. ENTANDO 5.0.2 RELEASE NOTES</a></li>
<li><a href="#_abstract">3.9.3. ABSTRACT</a></li>
<li><a href="#_changes_in_5_0_2">3.9.4. CHANGES IN 5.0.2</a>
<ul class="sectlevel4">
<li><a href="#_known_issues_4">KNOWN ISSUES</a></li>
<li><a href="#_versioning_information">VERSIONING INFORMATION</a></li>
<li><a href="#_software_requirements_3">SOFTWARE REQUIREMENTS</a></li>
<li><a href="#_legal_notice_3">LEGAL NOTICE</a></li>
<li><a href="#_links_and_resources_3">LINKS AND RESOURCES</a></li>
</ul>
</li>
<li><a href="#_entando_5_0_1_release_notes">3.9.5. ENTANDO 5.0.1 RELEASE NOTES</a>
<ul class="sectlevel4">
<li><a href="#_abstract_2">ABSTRACT</a></li>
<li><a href="#_changes_in_5_0_1">CHANGES IN 5.0.1</a></li>
<li><a href="#_defect_resolution_and_general_updates">Defect Resolution and General Updates</a></li>
<li><a href="#_known_issues_5">Known Issues</a></li>
<li><a href="#_software_requirements_4">Software Requirements</a></li>
<li><a href="#_legal_notice_4">Legal Notice</a></li>
<li><a href="#_links_and_resources_4">Links and Resources</a></li>
</ul>
</li>
<li><a href="#_entando_5_0_0_release_notes">3.9.6. ENTANDO 5.0.0 RELEASE NOTES</a>
<ul class="sectlevel4">
<li><a href="#_abstract_3">ABSTRACT</a></li>
<li><a href="#_preface_2">PREFACE</a></li>
<li><a href="#_goal_of_entando_5">GOAL OF ENTANDO 5</a></li>
<li><a href="#_about_entando_5">ABOUT ENTANDO 5</a></li>
<li><a href="#_whats_new_with_entando_5">WHAT&#8217;S NEW WITH ENTANDO 5</a></li>
<li><a href="#_versioning_information_2">VERSIONING INFORMATION</a></li>
<li><a href="#_software_requirements_5">SOFTWARE REQUIREMENTS</a></li>
<li><a href="#_legal_notice_5">LEGAL NOTICE</a></li>
<li><a href="#_links_and_resources_5">LINKS AND RESOURCES</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_entando_5_1_0">4. ENTANDO 5.1.0</a>
<ul class="sectlevel2">
<li><a href="#_see_5_2_0">4.1. See 5.2.0</a></li>
</ul>
</li>
<li><a href="#_entando_5_0_0">5. ENTANDO 5.0.0</a>
<ul class="sectlevel2">
<li><a href="#installation-e5">5.1. INSTALLING ENTANDO APP BUILDER 5.0</a>
<ul class="sectlevel3">
<li><a href="#_prerequisites_10">5.1.1. PREREQUISITES</a>
<ul class="sectlevel4">
<li><a href="#_space_and_hardware_requirements_2">SPACE AND HARDWARE REQUIREMENTS</a></li>
<li><a href="#_installed_prerequisites_2">INSTALLED PREREQUISITES:</a></li>
</ul>
</li>
<li><a href="#_running_the_mapp_engine_instance">5.1.2. RUNNING THE MAPP ENGINE INSTANCE</a>
<ul class="sectlevel4">
<li><a href="#_creating_a_new_entando_project">CREATING A NEW ENTANDO PROJECT</a></li>
<li><a href="#_launching_the_mapp_engine">LAUNCHING THE MAPP ENGINE</a></li>
</ul>
</li>
<li><a href="#_launching_the_app_builder">5.1.3. LAUNCHING THE APP BUILDER</a>
<ul class="sectlevel4">
<li><a href="#_clone_and_setup">CLONE AND SETUP</a></li>
<li><a href="#_configuration">CONFIGURATION</a></li>
<li><a href="#_additional_commands">ADDITIONAL COMMANDS</a></li>
</ul>
</li>
<li><a href="#_setting_up_a_database_optional">5.1.4. SETTING UP A DATABASE (OPTIONAL)</a></li>
<li><a href="#_configuring_swagger_optional">5.1.5. CONFIGURING SWAGGER (OPTIONAL)</a>
<ul class="sectlevel4">
<li><a href="#_enabling_swagger_in_a_development_environment">ENABLING SWAGGER IN A DEVELOPMENT ENVIRONMENT</a></li>
<li><a href="#_authentication_details">AUTHENTICATION DETAILS</a></li>
<li><a href="#_how_does_the_integration_work">HOW DOES THE INTEGRATION WORK?</a></li>
</ul>
</li>
<li><a href="#_building_the_mapp_engine_from_source_code_optional">5.1.6. BUILDING THE MAPP ENGINE FROM SOURCE CODE (OPTIONAL)</a></li>
</ul>
</li>
<li><a href="#_deployment_on_docker_and_openshift">5.2. DEPLOYMENT ON DOCKER AND OPENSHIFT</a>
<ul class="sectlevel3">
<li><a href="#containers">5.2.1. Overview</a>
<ul class="sectlevel4">
<li><a href="#_a_word_on_docker_tooling">A word on Docker tooling.</a></li>
</ul>
</li>
<li><a href="#getting-started">5.2.2. Getting Started</a></li>
<li><a href="#getting-started-with-docker-compose">5.2.3. Docker Compose in a 'vanilla' Docker environment</a></li>
<li><a href="#maven-docker-quickstart">5.2.4. Getting started on Maven and Docker</a></li>
<li><a href="#openshift-quickstart">5.2.5. Openshift Quick Start</a></li>
<li><a href="#common-variables">5.2.6. Common Variables on Docker</a>
<ul class="sectlevel4">
<li><a href="#_environment_variables_for_images_hosting_the_entando_database">Environment Variables for images hosting the Entando database</a></li>
<li><a href="#_environment_variables_for_images_hosting_the_entando_engine">Environment Variables for images hosting the Entando Engine</a></li>
<li><a href="#_environment_variables_for_images_hosting_the_appbuilder_and_other_javascript_apps">Environment Variables for images hosting the AppBuilder (and other JavaScript apps)</a></li>
</ul>
</li>
<li><a href="#_common_ports">5.2.7. Common Ports</a></li>
<li><a href="#common-volumes">5.2.8. Common Volumes</a></li>
<li><a href="#demos-on-docker">5.2.9. Demos on Docker</a>
<ul class="sectlevel4">
<li><a href="#entando-ful-stack-demo">Default Entando Full Stack demo</a></li>
<li><a href="#_entando_full_stack_on_postgresql">Entando Full Stack on Postgresql</a></li>
<li><a href="#_fsi_credit_card_dispute_demo">FSI Credit Card Dispute Demo</a></li>
</ul>
</li>
<li><a href="#_designing_your_pipeline_for_entando">5.2.10. Designing your pipeline for Entando.</a>
<ul class="sectlevel4">
<li><a href="#_entando_app_granularity">Entando App Granularity</a></li>
</ul>
</li>
<li><a href="#_your_existing_build_infrastructure">5.2.11. Your existing build infrastructure.</a>
<ul class="sectlevel4">
<li><a href="#pure-openshift-environment">Pure Openshift Environment</a></li>
<li><a href="#hybrid-docker-environment">Hybrid Docker Environment</a></li>
</ul>
</li>
<li><a href="#maven-and-docker">5.2.12. Maven and Docker</a>
<ul class="sectlevel4">
<li><a href="#_the_pom_xml">The pom.xml</a></li>
</ul>
</li>
<li><a href="#_using_mvn_jettyrun_locally_with_appbuilder_and_postgresql_images">5.2.13. Using mvn jetty:run locally with AppBuilder and PostgreSQL images</a></li>
<li><a href="#_volumes">5.2.14. Volumes</a></li>
<li><a href="#_docker_host_ip_complexities">5.2.15. Docker Host IP Complexities</a></li>
<li><a href="#_verifying_and_pushing_your_images">5.2.16. Verifying and Pushing your images</a></li>
<li><a href="#entando-on-openshift">5.2.17. Entando on Openshift</a>
<ul class="sectlevel4">
<li><a href="#_from_docker_compose_to_openshift">From Docker Compose to Openshift</a></li>
<li><a href="#_entando_standard_openshift_template_parameters">Entando Standard Openshift Template Parameters</a></li>
<li><a href="#_deploying_the_entando_pre_built_images">Deploying the Entando pre-built images</a></li>
<li><a href="#_building_your_own_entando_images">Building your own Entando images</a></li>
<li><a href="#_entando_imagick_s2i_image">Entando Imagick S2I Image</a></li>
</ul>
</li>
<li><a href="#_jenkins_pipelines">5.2.18. Jenkins Pipelines</a>
<ul class="sectlevel4">
<li><a href="#_entando_reference_pipeline">Entando Reference Pipeline</a></li>
<li><a href="#_installing_the_pipeline">Installing the pipeline</a></li>
<li><a href="#_example_openshift_only_pipeline">Example Openshift Only Pipeline</a></li>
<li><a href="#_example_hybrid_pipeline">Example Hybrid Pipeline</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_cloud_deployments_on_aws_azure_and_gce">5.3. Cloud deployments on AWS, Azure and GCE</a>
<ul class="sectlevel3">
<li><a href="#cloud-deployments">5.3.1. Overview</a></li>
<li><a href="#_assumptions">5.3.2. Assumptions</a></li>
<li><a href="#getting-started-k8s">5.3.3. Getting started</a>
<ul class="sectlevel4">
<li><a href="#simplest-example">The Simplest example</a></li>
<li><a href="#n-tier-example">An n-tier example</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_developers_guide">5.4. DEVELOPERS' GUIDE</a>
<ul class="sectlevel3">
<li><a href="#firstdevelopers">5.4.1. INITIAL SETUP</a></li>
<li><a href="#_configuring_ant">5.4.2. CONFIGURING ANT</a>
<ul class="sectlevel4">
<li><a href="#_additional_settings_for_windows">ADDITIONAL SETTINGS FOR WINDOWS</a></li>
<li><a href="#_windows_10">WINDOWS 10</a></li>
<li><a href="#_other_windows_versions">OTHER WINDOWS VERSIONS</a></li>
<li><a href="#_ant_tasks">ANT TASKS</a></li>
</ul>
</li>
<li><a href="#_troubleshooting">5.4.3. TROUBLESHOOTING</a></li>
<li><a href="#_filter_management">5.4.4. FILTER MANAGEMENT</a>
<ul class="sectlevel4">
<li><a href="#_development_filters">DEVELOPMENT FILTERS</a></li>
<li><a href="#_production_filters">PRODUCTION FILTERS</a></li>
<li><a href="#_filter_setup">FILTER SETUP</a></li>
<li><a href="#_network_setup">NETWORK SETUP</a></li>
<li><a href="#_servlet_container_setup_tomcat">SERVLET CONTAINER SETUP - TOMCAT</a></li>
<li><a href="#_application_server_setup_jbosswildfly">APPLICATION SERVER SETUP - JBOSS/WILDFLY</a></li>
<li><a href="#_database_setup">DATABASE SETUP</a></li>
</ul>
</li>
<li><a href="#_configuring_swagger_optional_2">5.4.5. CONFIGURING SWAGGER (OPTIONAL)</a>
<ul class="sectlevel4">
<li><a href="#_enabling_swagger_in_a_development_environment_2">ENABLING SWAGGER IN A DEVELOPMENT ENVIRONMENT</a></li>
<li><a href="#_authentication_details_2">AUTHENTICATION DETAILS</a></li>
<li><a href="#_how_does_the_integration_work_2">HOW DOES THE INTEGRATION WORK?</a></li>
</ul>
</li>
<li><a href="#_building_a_rest_api">5.4.6. BUILDING A REST API</a></li>
<li><a href="#_oauth_2_0_on_entando">5.4.7. OAUTH 2.0 ON ENTANDO</a></li>
<li><a href="#_creating_an_api_consumer">5.4.8. CREATING AN API CONSUMER</a></li>
<li><a href="#_imagemagick_setup">5.4.9. IMAGEMAGICK SETUP</a>
<ul class="sectlevel4">
<li><a href="#_linuxmac_setup">LINUX/MAC SETUP</a></li>
<li><a href="#_windows_setup">WINDOWS SETUP</a></li>
</ul>
</li>
<li><a href="#_creating_a_plugin_back_end">5.4.10. CREATING A PLUGIN - BACK END</a>
<ul class="sectlevel4">
<li><a href="#_introduction_5">INTRODUCTION</a></li>
<li><a href="#plugincyclesample_back-end">INITIALIZE THE ENVIRONMENT</a></li>
<li><a href="#_create_an_entando_project">CREATE AN ENTANDO PROJECT</a></li>
<li><a href="#_create_a_custom_component_project">CREATE A CUSTOM COMPONENT PROJECT</a></li>
<li><a href="#_create_a_prototype_plugin_called_phonebook">CREATE A PROTOTYPE PLUGIN CALLED "PHONEBOOK"</a></li>
<li><a href="#_create_plugin_with_edo_component_generator">CREATE PLUGIN WITH EDO (COMPONENT GENERATOR)</a></li>
<li><a href="#_install_the_new_plugin_component">INSTALL THE NEW PLUGIN COMPONENT</a></li>
<li><a href="#_add_the_plugin_to_an_entando_project">ADD THE PLUGIN TO AN ENTANDO PROJECT</a></li>
<li><a href="#_app_builder_component">APP BUILDER COMPONENT</a></li>
</ul>
</li>
<li><a href="#plugincyclesample_front-end">5.4.11. CREATING A PLUGIN - FRONT END</a>
<ul class="sectlevel4">
<li><a href="#_prerequisites_11">PREREQUISITES</a></li>
<li><a href="#_installing_the_app_builder">INSTALLING THE APP BUILDER</a></li>
<li><a href="#_adding_the_plugin_to_the_basic_app_builder_integration">ADDING THE PLUGIN TO THE BASIC APP BUILDER INTEGRATION</a></li>
<li><a href="#_add_the_plugin_to_the_app_builder">ADD THE PLUGIN TO THE APP BUILDER</a></li>
<li><a href="#_customize_the_plugin">CUSTOMIZE THE PLUGIN</a></li>
<li><a href="#_apply_widget_configuration_forms">APPLY WIDGET CONFIGURATION FORMS</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_working_with_entando_widgets">5.5. WORKING WITH ENTANDO WIDGETS</a>
<ul class="sectlevel3">
<li><a href="#_widget_catalog">5.5.1. WIDGET CATALOG</a></li>
<li><a href="#_widget_catalog_examples">5.5.2. WIDGET CATALOG EXAMPLES</a></li>
<li><a href="#_basic_widgets">5.5.3. BASIC WIDGETS</a>
<ul class="sectlevel4">
<li><a href="#_example_19">EXAMPLE</a></li>
</ul>
</li>
<li><a href="#_configuring_widgets">5.5.4. CONFIGURING WIDGETS</a></li>
<li><a href="#_struts2_based_widgets">5.5.5. STRUTS2-BASED WIDGETS</a>
<ul class="sectlevel4">
<li><a href="#_example_of_database_definition">EXAMPLE OF DATABASE DEFINITION</a></li>
<li><a href="#_widget_configuration">WIDGET CONFIGURATION</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_list_of_entando_widgets">5.6. LIST OF ENTANDO WIDGETS</a>
<ul class="sectlevel3">
<li><a href="#widgetlist">5.6.1. CREATING A LOGIN PAGE</a>
<ul class="sectlevel4">
<li><a href="#_example_login_form">Example login form</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_digital_exchange">5.7. DIGITAL EXCHANGE</a>
<ul class="sectlevel3">
<li><a href="#_using_a_digital_exchange">5.7.1. USING A DIGITAL EXCHANGE</a>
<ul class="sectlevel4">
<li><a href="#_loggingauditing_information">LOGGING/AUDITING INFORMATION</a></li>
</ul>
</li>
<li><a href="#_setup_your_digital_exchange">5.7.2. SETUP YOUR DIGITAL EXCHANGE</a>
<ul class="sectlevel4">
<li><a href="#_create_credentials_for_digital_exchange_clients">CREATE CREDENTIALS FOR DIGITAL EXCHANGE CLIENTS</a></li>
<li><a href="#_create_a_component">CREATE A COMPONENT</a></li>
<li><a href="#_configure_the_de_to_provide_a_component">CONFIGURE THE DE TO PROVIDE A COMPONENT</a></li>
<li><a href="#_customize_component_rating">CUSTOMIZE COMPONENT RATING</a></li>
</ul>
</li>
<li><a href="#_troubleshooting_2">5.7.3. TROUBLESHOOTING</a>
<ul class="sectlevel4">
<li><a href="#_client_issues">Client issues</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_jboss_eap_deployment">5.8. JBOSS EAP DEPLOYMENT</a>
<ul class="sectlevel3">
<li><a href="#jboss_eap_deployment">5.8.1. PREREQUISITES</a></li>
<li><a href="#_introduction_6">5.8.2. INTRODUCTION</a></li>
<li><a href="#_procedure">5.8.3. PROCEDURE</a>
<ul class="sectlevel4">
<li><a href="#_prepare_the_database">PREPARE THE DATABASE</a></li>
<li><a href="#_jboss_configuration">JBOSS CONFIGURATION</a></li>
<li><a href="#_entando_application_configuration">ENTANDO APPLICATION CONFIGURATION</a></li>
<li><a href="#_filter_configuration">FILTER CONFIGURATION</a></li>
<li><a href="#_building_the_war_file">BUILDING THE WAR FILE</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_migrating_entando_applictions">5.9. MIGRATING ENTANDO APPLICTIONS</a>
<ul class="sectlevel3">
<li><a href="#_porting_from_entando_5_0_0_to_5_0_1">5.9.1. PORTING FROM ENTANDO 5.0.0 TO 5.0.1</a>
<ul class="sectlevel4">
<li><a href="#_upgrade_your_database">UPGRADE YOUR DATABASE</a></li>
<li><a href="#_upgrade_project_configuration">UPGRADE PROJECT CONFIGURATION</a></li>
</ul>
</li>
<li><a href="#_porting_from_entando_5_0_0_to_5_1_0">5.9.2. PORTING FROM ENTANDO 5.0.0 TO 5.1.0</a>
<ul class="sectlevel4">
<li><a href="#_upgrade_your_database_2">UPGRADE YOUR DATABASE</a></li>
<li><a href="#_upgrade_your_project_configuration">UPGRADE YOUR PROJECT CONFIGURATION</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="e6-new">1. Entando 6.1.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_getting_started">1.1. Getting Started</h3>
<div class="sect3">
<h4 id="_pre_requisites">1.1.1. Pre-Requisites</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Java 1.8</p>
</li>
<li>
<p>node LTS</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Use nvm to setup your node and npm install (or manually install node LTS)</p>
</li>
</ol>
</div>
</li>
<li>
<p>Maven 3.0.5+</p>
</li>
<li>
<p>Git</p>
</li>
<li>
<p>Docker</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Install: <a href="https://docs.docker.com/install/" class="bare">https://docs.docker.com/install/</a></p>
</li>
</ol>
</div>
</li>
<li>
<p>Access to a Docker images repository</p>
</li>
<li>
<p>Docker hub works great and is free</p>
</li>
<li>
<p>Helm 2.x (2.x only- 3.x is not currently compatible or supported)</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Install: <a href="https://github.com/helm/helm/releases/tag/v2.16.3" class="bare">https://github.com/helm/helm/releases/tag/v2.16.3</a></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_steps">1.1.2. Steps</h4>
<div class="sect4">
<h5 id="_kubernetes_setup_instructions">Kubernetes Setup Instructions</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Enable ingress in your kubernetes installation</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>For minikube this is done with the command : minikube addons enable ingress</p>
</li>
</ol>
</div>
</li>
<li>
<p>Make sure you have at least 4 CPUs and 8GB of ram allocated to your kubernetes client</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>minikube start --cpus 4 --memory 8192</code></p>
</li>
<li>
<p>Or set globally</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><code>minikube config set cpus 4</code></p>
</li>
<li>
<p><code>minikube config set memory 8192</code></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Install a helm2 client for your environment.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>You only need the client - no need to install Tiller, the server side component. We use the client to process templates. Doesnâ€™t require cluster changes</p>
</li>
<li>
<p>Note that it is important that it is helm2. The current default is 3.</p>
</li>
<li>
<p><a href="https://helm.sh/docs/intro/install/" class="bare">https://helm.sh/docs/intro/install/</a></p>
</li>
</ol>
</div>
</li>
<li>
<p>Clone this project locally to a development environment of your choice</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>git clone <a href="https://github.com/entando-k8s/entando-helm-quickstart" class="bare">https://github.com/entando-k8s/entando-helm-quickstart</a></p>
</li>
</ol>
</div>
</li>
<li>
<p>In the values.yaml file you need to update the configuration for your environment and deployment.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If you are deploying in Openshift, set the operator.supportOpenshift = true , otherwise set it to false</p>
</li>
<li>
<p>Set ENTANDO_DEFAULT_ROUTING_SUFFIX to the value that matches the env you&#8217;re going to deploy to. For local clusters (MicroK8S, Minikube) that would be your local cluster IP address (e.g. minikube ip) with the suffix nip.io, e.g. 192.168.1.9.nip.io. On a shared cluster you may need to consult your cluster admin.</p>
</li>
<li>
<p>If you want to deploy the Process Driven Applications Plugin (PDA), set deployPDA = true, otherwise leave it as false</p>
</li>
</ol>
</div>
</li>
<li>
<p>Ensure you have a namespace in the cluster you can use, and the current user has admin permissions on the namespace.</p>
</li>
<li>
<p>Ensure the Entando CRDs are installed on your cluster. Follow this guide to learn how to do so: <a href="https://github.com/entando-k8s/entando-k8s-custom-model/tree/v6.1.0/src/main/resources/crd" class="bare">https://github.com/entando-k8s/entando-k8s-custom-model/tree/v6.1.0/src/main/resources/crd</a></p>
</li>
<li>
<p>On a command line go into the directory of the entando-helm-quickstart you cloned in step 2</p>
</li>
<li>
<p>Process the template and deploy the output using your favorite Kubernetes client, e.g</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><code>helm template --name=my-app  --namespace=my-namespace ./ | kubectl create -f</code></p>
</li>
<li>
<p>Or use helm to create and save the deployment descriptor to a file of your choice <code>helm template --name=&lt;name-of-resources&gt; --namespace=&lt;namespace-where-to-deploy&gt;  ./ &gt; some-template.yaml</code></p>
</li>
<li>
<p>And deploy it with kubectl create -f some-template.yaml</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_app_builder">1.2. App Builder</h3>
<div class="paragraph">
<p>The Entando App Builder is the design time environment where you can interact with and configure
your page templates, layouts, widgets, and micro frontends.</p>
</div>
<div class="sect3">
<h4 id="_hello_world_for_a_widget_using_the_app_builder">1.2.1. Hello World for a Widget Using the App builder</h4>
<div class="paragraph">
<p>This tutorial will take you through the basics of creating an Entando widget and placing it on a page.
This document will also review the basics of fragments which are re-usable pieces of a user interface.</p>
</div>
<div class="sect4">
<h5 id="_basic_widget_tutorial">Basic Widget Tutorial</h5>
<div class="paragraph">
<p>For this example you will use the Entando App Builder
to build and assign your widget on a page. In a production system
or a larger development environment you would  build and deploy widgets
differently, however this example provides a quick idea of the building blocks.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the App Builder menu, at the top, Go To: UX Patterns -&#8594; Widgets</p>
</li>
<li>
<p>Select NEW</p>
</li>
<li>
<p>The Custom UI Field is a freemarker template where you can put raw html and include freemarker logic,</p>
<div class="ulist">
<ul>
<li>
<p>It allows you to import javascript, css, or any normal HTML</p>
</li>
<li>
<p>Example, put &lt;h2&gt;Hello World&lt;/h2&gt; into your widget, give it a name and save it</p>
</li>
</ul>
</div>
</li>
<li>
<p>Go To: Page Designer -&#8594; Page Settings</p>
</li>
<li>
<p>In the Home Page dropdown select Home / Service and select SAVE</p>
</li>
<li>
<p>Now place the widget on the page</p>
</li>
<li>
<p>Go To: Page Designer -&#8594; Page Tree</p>
</li>
<li>
<p>On the row that says "Service", on the far right side, select the Kebab button and select CONFIGURE</p>
</li>
<li>
<p>Find the widget created in step 5 on the right hand side</p>
</li>
<li>
<p>Drag and drop the widget onto the open frame of the page</p>
</li>
<li>
<p>Select PUBLISH at the bottom of the screen</p>
</li>
<li>
<p>Then select GO TO HOME PAGE in the upper right</p>
</li>
<li>
<p>You should see "Hello World" on the page</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_simple_fragment_tutorial">Simple Fragment tutorial</h5>
<div class="paragraph">
<p>A fragment is a way to take a common piece of front end code and reuse it across multiple
pages or widgets. Common elements such as basic html, javascript, or freemarker logic
can be stored as fragments and referenced via the <code>&lt;@wp.fragment &#8230;&#8203;</code> tag.</p>
</div>
<div class="paragraph">
<p>Starting from the simple widget tutorial above:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the app builder Go To: UX Patterns -&#8594; Fragments</p>
</li>
<li>
<p>Enter the code for the fragment as <code>test</code></p>
</li>
<li>
<p>In the <code>Gui Code</code> enter <code>&lt;h2&gt;This is a fragment&lt;/h2&gt;</code></p>
</li>
<li>
<p>Next place the fragment on a page</p>
</li>
<li>
<p>Go To: Ux Patterns -&#8594; Page Models</p>
</li>
<li>
<p>On the row for <code>service</code>, select EDIT</p>
</li>
<li>
<p>Use the fragment tag to place the fragment on the page <code>&lt;@wp.fragment code="test"/&gt;</code></p>
</li>
<li>
<p>SAVE the page model</p>
</li>
<li>
<p>Go To: homepage (assuming you&#8217;ve set the service page to the homepage)</p>
</li>
<li>
<p>Note that the fragment is printed including the HTML tags. By default html embedded via a fragment tag is escaped so you get it rendered exactly as you enter it. You&#8217;ll need to un-escape it to get it to render correctly.</p>
</li>
<li>
<p>Go back to your page model (UX Patterns -&#8594; Page Models) select SERVICE and EDIT</p>
</li>
<li>
<p>Change the tag to: <code>&lt;@wp.fragment code="test" escapeXml=false/&gt;</code></p>
</li>
<li>
<p>Go back to the homepage</p>
</li>
<li>
<p>See correctly rendered fragment</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_freemarker_basics_in_entando">Freemarker Basics in Entando</h5>
<div class="paragraph">
<p>The freemarker templating language gives you a lot of flexibility and power in how pages are rendered.
You can include conditional logic, inject information from the backend, check for query parameters and route to different pages.</p>
</div>
<div class="paragraph">
<p>For example, to check for a query parameter you can use:
<code>&lt;#if RequestParameters.myParam?exists &gt; &#8230;&#8203;</code></p>
</div>
<div class="paragraph">
<p>To check the current username, use:
<code>&lt;#if (Session.currentUser.username != "guest") &gt;</code></p>
</div>
<div class="paragraph">
<p>When you need dynamic behavior in your widgets consider using the power of freemarker.</p>
</div>
</div>
<div class="sect4">
<h5 id="_useful_links">Useful Links</h5>
<div class="paragraph">
<p><a href="https://freemarker.apache.org/" class="bare">https://freemarker.apache.org/</a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_tutorial_extending_the_app_builder">1.2.2. Tutorial: Extending the App Builder</h4>
<div class="paragraph">
<p>Apps for the Entando App Builder are developed as standalone applications which can be run using <code>npm start</code> in standalone mode.</p>
</div>
<div class="paragraph">
<p>Each application should be deployed in npm using the <code>@entando</code> namespace and will export into their dist folder several items used by the App Builder when integrating it into the full application.</p>
</div>
<div class="sect4">
<h5 id="_creating_a_basic_application">Creating a Basic Application</h5>
<div class="paragraph">
<p>To create a basic application, use the [entando fpg](<a href="https://github.com/entando/fpg" class="bare">https://github.com/entando/fpg</a>) running the <code>npx @entando/fpg ab-app &lt;appName&gt;</code> command.</p>
</div>
<div class="paragraph">
<p><strong>the <code>appName</code> should only contain alphanumeric characters and underscores, and should begin with a letter.</strong></p>
</div>
<div class="paragraph">
<p>This will create inside the working directory, a boilerplate app-builder app in a directory named <code>&lt;appName&gt;</code> argument.</p>
</div>
<div class="paragraph">
<p>i.e.</p>
</div>
<div class="paragraph">
<p>using the command <code>npm @entando/fpg ab-app testing</code> inside your home directory, a directory named <code>testing</code> will be created   containing the app.</p>
</div>
<div class="paragraph">
<p>All dependencies will already be installed allowing you to <code>cd</code> inside the project directory and run <code>npm start</code> to start the app running.</p>
</div>
</div>
<div class="sect4">
<h5 id="_understanding_the_stand_alone_environment">Understanding the Stand Alone Environment</h5>
<div class="paragraph">
<p>Each app for the App Builder, can run in both a stand alone mode and an integrated mode.
Using <code>npm start</code>  will use standalone mode.</p>
</div>
<div class="paragraph">
<p>In this environment you&#8217;ll be looking at the user interface of the app inside a default page.  This page, which includes a default menu, will not be exported and therefore can be customized.</p>
</div>
<div class="paragraph">
<p>To better understand which elements and components are being exported to App Builder, it is best to understand the anatomy of the app.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_exports">1.2.3. Exports</h4>
<div class="paragraph">
<p>Each app will have a <code>babel.js</code> export file similar to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import menu from 'ui/common/LinkMenu';
import { cms as state } from 'state/rootReducer';
import { routes, routesDir } from 'ui/App';
import en from 'locales/en';
import it from 'locales/it';

const testing = {
  id: 'testing',
  menu,
  state,
  routes,
  routesDir,
  locales: {
    en,
    it,
  },
};

export default testing;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_id_is_the_app_id">1.2.4. id:  is the app id.</h4>
<div class="paragraph">
<p>This parameter is used by App Builder to differentiate all integrated apps.</p>
</div>
</div>
<div class="sect3">
<h4 id="_menu_is_a_react_component_containing_all_the_menu_elements">1.2.5. menu:  is a React component containing all the menu elements.</h4>
<div class="paragraph">
<p>These elements are used inside the standalone environment and inside the integrated environment as a second level menu.  The boilerplate app contains a basic menu.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import React from 'react';
import { LinkMenuItem } from '@entando/menu';
import { FormattedMessage } from 'react-intl';

const LinkMenu = () =&gt; (
  &lt;&gt;
    &lt;LinkMenuItem
      id="menu-SECTION_ID"
      label={&lt;FormattedMessage id="testing.menu.SECTION_NAME" defaultMessage="SECTION_NAME" /&gt;}
      to='/use/const/here/imported/from/routes'
    /&gt;
  &lt;/&gt;
);

export default LinkMenu;</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_customizing_the_menu">Customizing the Menu</h5>
<div class="paragraph">
<p>For this exercise, we will create two links inside the menu. The first will link to a page listing all the users inside the entando instance. The second will list all the existing page models inside the Entando instance.</p>
</div>
<div class="paragraph">
<p>For this example we&#8217;re using existing APIs from the Entando core just for simplicity, you can instead call any API or data source.</p>
</div>
<div class="paragraph">
<p>In your app project, open <code>src/ui/common/LinkMenu.js</code> and update the const to the code below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">const LinkMenu = () =&gt; (
  &lt;&gt;
    &lt;LinkMenuItem
      id="menu-userList"
      label={&lt;FormattedMessage id="testing.menu.userList" defaultMessage="User List" /&gt;}
      to='/use/const/here/imported/from/routes'
    /&gt;
    &lt;LinkMenuItem
      id="menu-pageModelList"
      label={&lt;FormattedMessage id="testing.menu.pageModelList" defaultMessage="Page Model List" /&gt;}
      to='/use/const/here/imported/from/routes'
    /&gt;
  &lt;/&gt;
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>it is important that both the <code>&lt;LinkMenuItem&gt;</code> id property and the `&lt;FormattedMessage&gt;`properties inside label have the correct values assigned, i.e.:</p>
</div>
<div class="paragraph">
<p>the LinkMenuItem id will be <strong>menu-userList</strong> while the FormattedMessage id will be <strong>testing.menu.userList</strong> and the defaultMessage will be <strong>User List</strong>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_locales">1.2.6. locales</h4>
<div class="paragraph">
<p>The locales files are objects that contain all of the i18n locales of the app.</p>
</div>
<div class="paragraph">
<p>By default the boilerplate contains both the english and italian i18n files.</p>
</div>
<div class="paragraph">
<p>In your app project in <code>src/locales/en.js</code> and <code>src/locales/it.js</code> you can see your labels.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">export default {
  locale: 'en',
  messages: {
    'testing.title': '',
    'testing.label.errors': '',
    'testing.label.cancel': '',
    'testing.chooseAnOption': '',
    'testing.tip': '',
    'testing.new': '',
    'testing.save': '',
    'testing.saveAndApprove': '',
    'testing.unpublish': '',
    'testing.setContentAs': '',
    'testing.cancel': '',
    'testing.saveAndContinue': '',
    'testing.stickySave.status': '',
    'testing.stickySave.lastAutoSave': '',
  },
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>While running in standalone mode the boilerplate does not offer a way for the user pick a locale, but both will be loaded inside app-builder and will be consumed as intended by it, using the correct one based on the user-picked language.</p>
</div>
<div class="paragraph">
<p>It is of course possible to change the standalone app to give the user the option to choose the locale in here as well, but this is not something will be covering in this tutorial.</p>
</div>
<div class="sect4">
<h5 id="_customizing_the_menu_labels">Customizing the menu labels</h5>
<div class="paragraph">
<p>To customize the existing menu labels, we&#8217;ll add the new label ids inside both the english and Italian locale files:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you named your app something besides <code>testing</code> you&#8217;ll need to fix these tags to match the name of your app.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">...
messages: {
    ...
    'testing.menu.userList': 'List of Users',
    'testing.menu.pageModelList': 'Page Models',
    ...
},
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The key in the messages object matches the id of the `&lt;FormattedMessage&gt;`component we placed inside the menu, while its value is the actual string that will be displayed depending on the currently active language.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_routes_and_routesdir">1.2.7. Routes and RoutesDir</h4>
<div class="paragraph">
<p>Both of these elements are imported from <code>src/ui/App.js</code>.  The first one is a collection of actual <code>&lt;Route&gt;</code> components, and the second one is an object containing each route data, i.e.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">export const routesDir = [
  {
    path: ROUTE_TESTING,
    component: &lt;&gt;app component&lt;/&gt;,
  },
];</code></pre>
</div>
</div>
<div class="paragraph">
<p>The constant <code>ROUTE_TESTING</code> is imported from <code>src/app-init/routes.js</code></p>
</div>
<div class="sect4">
<h5 id="_customizing_the_routes">Customizing the Routes</h5>
<div class="paragraph">
<p>Next we will create the two routes for the two links we have created by creating first the two constants needed.</p>
</div>
<div class="paragraph">
<p>In your IDE open <code>src/app-init/routes.js</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">export const ROUTE_TESTING = '/testing';
export const ROUTE_USER_LIST = '/testing/user-list';
export const ROUTE_PAGE_MODELS = '/testing/page-models';</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Change the value of <code>testing</code> to what you selected for the name of your App extension.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of each constant will be the path of the route. It is important that each route is a subroute of the id of the app itself, otherwise this may cause name collision when running inside the integrated environment of app-builder.</p>
</div>
<div class="paragraph">
<p>Both routes are next imported inside <code>App.js</code>:</p>
</div>
<div class="paragraph">
<p>Update the imports with your new ROUTE tags.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import {
  ROUTE_TESTING,
  ROUTE_USER_LIST,
  ROUTE_PAGE_MODELS,
} from 'app-init/routes';</code></pre>
</div>
</div>
<div class="paragraph">
<p>and then add to the <code>routesDir</code> constant:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">export const routesDir = [
  {
    path: ROUTE_TESTING,
    component: &lt;&gt;app component&lt;/&gt;,
  },
  {
    path: ROUTE_USER_LIST,
    render: () =&gt; &lt;&gt;user list&lt;/&gt;,
  },
  {
    path: ROUTE_PAGE_MODELS,
    render: () =&gt; &lt;&gt;page models&lt;/&gt;,
  },
];</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, import the routes constants inside <code>LinkMenu.js</code> and change accordingly the <strong>to</strong> property of the <code>&lt;LinkMenuItem&gt;</code> component:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">...
import {
  ROUTE_USER_LIST,
  ROUTE_PAGE_MODELS,
} from 'app-init/routes';

const LinkMenu = () =&gt; (
  &lt;&gt;
    &lt;LinkMenuItem
      id="menu-userList"
      label={&lt;FormattedMessage id="tatata.menu.userList" defaultMessage="User List" /&gt;}
      to={ROUTE_USER_LIST}
    /&gt;
    &lt;LinkMenuItem
      id="menu-pageModelList"
      label={&lt;FormattedMessage id="tatata.menu.pageModelList" defaultMessage="Page Model List" /&gt;}
      to={ROUTE_PAGE_MODELS}
    /&gt;
  &lt;/&gt;
);
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next clicks on the links in the menu will change the routes and display the content defined in the <code>App.js</code> file.</p>
</div>
</div>
<div class="sect4">
<h5 id="_state">state</h5>
<div class="paragraph">
<p>The state in src/babel.js is the combined reducer of the app, the rootReducer.js contains the combined reducer of the app and exports it, but also contains the entire reducer of the app when running in standalone mode.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">export const testing = combineReducers({
  // implement here your app specific reducers
});

export default combineReducers({
  apps: combineReducers({ testing }),
  api,
  currentUser,
  form,
  loading,
  locale,
  messages,
  modal,
  pagination,
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>The app specific reducers are stored inside the <code>apps</code> object, this is done to avoid possible name collisions with any reducer stored inside app-builder when running the app in integrated mode.</p>
</div>
</div>
<div class="sect4">
<h5 id="_customizing_the_reducers">Customizing the Reducers</h5>
<div class="paragraph">
<p>Next we will be creating the two reducers for the user list and page models.  They will be created inside two new directories <code>src/state/apps/testing/userList/</code> and <code>src/state/apps/testing/pageModels</code>. The <code>types.js</code> files will contain the two action types that we&#8217;ll need.</p>
</div>
<div class="paragraph">
<p><code>userList/types.js</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">// eslint-disable-next-line import/prefer-default-export
export const ADD_USERS = 'apps/testing/add-users';</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>pageModels/types.js</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">// eslint-disable-next-line import/prefer-default-export
export const ADD_PAGE_MODELS = 'apps/testing/page-models/add-page-models';</code></pre>
</div>
</div>
<div class="paragraph">
<p>The value of both constants contain the whole namespace <code>apps/testing/REDUCER</code> this is done to avoid any possible name collision when running the app in integrated mode.</p>
</div>
<div class="paragraph">
<p>Next create both actions files:</p>
</div>
<div class="paragraph">
<p><code>userList/actions.js</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import {
  ADD_USERS,
} from 'state/apps/testing/userList/types';

// eslint-disable-next-line import/prefer-default-export
export const addUsers = users =&gt; ({
  type: ADD_USERS,
  payload: users,
});</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>pageModels/actions.js</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import {
  ADD_PAGE_MODELS,
} from 'state/apps/testing/pageModels/types';

// eslint-disable-next-line import/prefer-default-export
export const addPageModels = pageModels =&gt; ({
  type: ADD_PAGE_MODELS,
  payload: pageModels,
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>then the selectors:</p>
</div>
<div class="paragraph">
<p><code>userList/selectors.js</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import { createSelector } from 'reselect';

export const getUserList = state =&gt; state.apps.testing.userList;
export const getList = createSelector(getUserList, userList =&gt; userList.list);</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>pageModels/selectors.js</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import { createSelector } from 'reselect';

export const getPageModels = state =&gt; state.apps.testing.pageModels;
export const getList = createSelector(getPageModels, pageModels =&gt; pageModels.list);</code></pre>
</div>
</div>
<div class="paragraph">
<p>And finally the reducers. The default state is going to contain some sample data for us to display.</p>
</div>
<div class="paragraph">
<p><code>userList/reducer.js</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import { ADD_USERS } from 'state/apps/testing/userList/types';

const defaultState = {
  list: [
    {
      username: 'admin',
      registration: '2018-01-08 00:00:00',
      lastLogin: '2018-01-08 00:00:00',
      lastPasswordChange: '2018-01-08 00:00:00',
      status: 'active',
      passwordChangeRequired: true,
      profileAttributes: {
        fullName: 'admin',
        email: 'admin@entando.com',
      },
    },
    {
      username: 'user1',
      registration: '2018-01-08 00:00:00',
      lastLogin: '2018-01-08 00:00:00',
      lastPasswordChange: '2018-01-08 00:00:00',
      status: 'disabled',
      passwordChangeRequired: true,
      profileAttributes: {
        fullName: 'User Name',
        email: 'user1@entando.com',
      },
    },
  ],
};

const reducer = (state = defaultState, action = {}) =&gt; {
  switch (action.type) {
    case ADD_USERS: {
      return { ...state, list: action.payload };
    }

    default: return state;
  }
};

export default reducer;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>pageModels/reducer.js</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import { ADD_PAGE_MODELS } from 'state/apps/testing/pageModels/types';

const defaultState = {
  list: [
    {
      code: 'home',
      descr: 'Home Page',
      configuration: {
        frames: [
          {
            pos: 0,
            descr: 'Navbar',
            sketch: {
              x1: 0,
              y1: 0,
              x2: 2,
              y2: 0,
            },
          },
          {
            pos: 1,
            descr: 'Navbar 2',
            sketch: {
              x1: 3,
              y1: 0,
              x2: 5,
              y2: 0,
            },
          },
        ],
      },
      template: '&lt;html&gt;&lt;/html&gt;',
    },
    {
      code: 'service',
      descr: 'Service Page',
      configuration: {
        frames: [
          {
            pos: 0,
            descr: 'Navbar',
            sketch: {
              x1: 0,
              y1: 0,
              x2: 2,
              y2: 0,
            },
          },
          {
            pos: 1,
            descr: 'Navbar 2',
            sketch: {
              x1: 3,
              y1: 0,
              x2: 5,
              y2: 0,
            },
          },
        ],
      },
      template: '&lt;html&gt;&lt;/html&gt;',
    },
  ],
};

const reducer = (state = defaultState, action = {}) =&gt; {
  switch (action.type) {
    case ADD_PAGE_MODELS: {
      return { ...state, list: action.payload };
    }

    default: return state;
  }
};

export default reducer;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Last, we can add the two reducers just created to the <code>src/state/rootReducer.js</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">...
import userList from 'state/apps/testing/userList/reducer';
import pageModels from 'state/apps/testing/pageModels/reducer';

export const testing = combineReducers({
  pageModels,
  userList,
});
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>we will now be able to see with the <code>reduxDevTools</code> in our browser. To view this state in your reduxDevTools go to:</p>
</div>
<div class="paragraph">
<p><code>State -&#8594; apps -&#8594; testing -&#8594; pageModels</code> and <code>State -&#8594; apps -&#8594; testing -&#8594; userList</code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_creating_the_ui_components">1.2.8. Creating the UI Components</h4>
<div class="paragraph">
<p>At this point, both routes created should be rendering a simple string.  We will next create the actual component that will be rendered inside the page.</p>
</div>
<div class="sect4">
<h5 id="_userlist">userList</h5>
<div class="paragraph">
<p>Inside <code>src/ui/userList/</code> create the <code>List</code> component. Create the <code>userList</code> directory and <code>List.js</code> file in that directory.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import React from 'react';

import {
  Grid,
  TablePfProvider,
} from 'patternfly-react';

const List = () =&gt; {
  const data = [
    {
      username: 'admin',
      registration: '2018-01-08 00:00:00',
    },
    {
      username: 'user1',
      registration: '2018-01-08 00:00:00',
    },
  ];

  const tr = data.map(row =&gt; (
    &lt;tr&gt;
      &lt;td&gt;{row.username}&lt;/td&gt;
      &lt;td&gt;{row.registration}&lt;/td&gt;
    &lt;/tr&gt;
  ));

  return (
    &lt;Grid fluid&gt;
      &lt;TablePfProvider
        striped
        bordered
        hover
      &gt;
        &lt;thead&gt;
          &lt;tr&gt;
            &lt;td&gt;username&lt;/td&gt;
            &lt;td&gt;registration&lt;/td&gt;
          &lt;/tr&gt;
        &lt;/thead&gt;
        &lt;tbody&gt;
          {tr}
        &lt;/tbody&gt;
      &lt;/TablePfProvider&gt;
    &lt;/Grid&gt;
  );
};

export default List;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, change the route inside <code>src/ui/App.js</code>. Add the import below and update the component to reference the List component created in the prior step.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">...
import List from 'ui/userList/List';
...
  {
    path: ROUTE_USER_LIST,
    component: List,
  },
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The table will now display correctly when clicking on the menu item.</p>
</div>
<div class="sect5">
<h6 id="_connecting_to_the_store">connecting to the store</h6>
<div class="paragraph">
<p>Next let&#8217;s connect the component to the store to get the data from the reducer.</p>
</div>
<div class="paragraph">
<p>The first step is creating the <code>ListContainer.js</code> next to the <code>List</code> component file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import { connect } from 'react-redux';
import { getList } from 'state/apps/testing/userList/selectors';

import List from 'ui/userList/List';

export const mapStateToProps = state =&gt; ({
  data: getList(state),
});

export default connect(
  mapStateToProps,
  null,
)(List);</code></pre>
</div>
</div>
<div class="paragraph">
<p>And then update the List component to receive the property. The List file should now look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import React from 'react';
import PropTypes from 'prop-types';

import {
  Grid,
  TablePfProvider,
} from 'patternfly-react';

const List = ({ data }) =&gt; {
  const tr = data.map(row =&gt; (
    &lt;tr&gt;
      &lt;td&gt;{row.username}&lt;/td&gt;
      &lt;td&gt;{row.registration}&lt;/td&gt;
    &lt;/tr&gt;
  ));

  return (
    &lt;Grid fluid&gt;
      &lt;TablePfProvider
        striped
        bordered
        hover
      &gt;
        &lt;thead&gt;
        &lt;tr&gt;
          &lt;td&gt;username&lt;/td&gt;
          &lt;td&gt;registration&lt;/td&gt;
        &lt;/tr&gt;
        &lt;/thead&gt;
        &lt;tbody&gt;
        {tr}
        &lt;/tbody&gt;
      &lt;/TablePfProvider&gt;
    &lt;/Grid&gt;
  );
};

export default List;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Make sure that you remove the predefined <code>data</code> const since the data will now be coming from the reducer, on top of defining PropTypes rules for validating and giving a default for the injected property <code>data</code>.</p>
</div>
<div class="paragraph">
<p>Once complete, update the component used in the route inside <code>App.js</code>. Update the import to the container and update the component in <code>ROUTE_USER_LIST</code> to the new ListContainer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">...
import ListContainer from 'ui/userList/ListContainer';
...
  {
    path: ROUTE_USER_LIST,
    component: ListContainer,
  },
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Go back to your app. We will now see the data inside the table reflecting the content of the storage.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_page_models">Page Models</h5>
<div class="paragraph">
<p>inside <code>src/ui/pageModels/</code> we are going to create the <code>List</code> component</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import React from 'react';
import PropTypes from 'prop-types';

import {
  Grid,
  TablePfProvider,
} from 'patternfly-react';

const List = ({ data }) =&gt; {
  const tr = data.map(row =&gt; (
    &lt;tr&gt;
      &lt;td&gt;{row.username}&lt;/td&gt;
      &lt;td&gt;{row.registration}&lt;/td&gt;
    &lt;/tr&gt;
  ));

  return (
    &lt;Grid fluid&gt;
      &lt;TablePfProvider
        striped
        bordered
        hover
      &gt;
        &lt;thead&gt;
        &lt;tr&gt;
          &lt;td&gt;username&lt;/td&gt;
          &lt;td&gt;registration&lt;/td&gt;
        &lt;/tr&gt;
        &lt;/thead&gt;
        &lt;tbody&gt;
        {tr}
        &lt;/tbody&gt;
      &lt;/TablePfProvider&gt;
    &lt;/Grid&gt;
  );
};

List.propTypes = {
  data: PropTypes.arrayOf(PropTypes.shape({})),
};

List.defaultProps = {
  data: [],
};

export default List;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next change the route inside <code>src/ui/App.js</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">...
import ListPageModels from 'ui/pageModels/List';
...
  {
    path: ROUTE_PAGE_MODELS,
    component: ListPageModels,
  },
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The table will now be displayed correctly when clicking on the menu item.</p>
</div>
<div class="sect5">
<h6 id="_connecting_to_the_store_2">Connecting to the Store</h6>
<div class="paragraph">
<p>Next, connect the component to the store to get the data from the reducer.</p>
</div>
<div class="paragraph">
<p>The very first thing we&#8217;ll do is create the <code>ListContainer.js</code> next to the <code>List</code> component file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import { connect } from 'react-redux';
import { getList } from 'state/apps/testing/pageModels/selectors';

import List from 'ui/pageModels/List';

export const mapStateToProps = state =&gt; ({
  data: getList(state),
});

export default connect(
  mapStateToProps,
  null,
)(List);</code></pre>
</div>
</div>
<div class="paragraph">
<p>And then update the List component to receive the property. The whole List component will have this content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import React from 'react';
import PropTypes from 'prop-types';

import {
  Grid,
  TablePfProvider,
} from 'patternfly-react';

const List = ({ data }) =&gt; {
  const tr = data.map(row =&gt; (
    &lt;tr&gt;
      &lt;td&gt;{row.code}&lt;/td&gt;
      &lt;td&gt;{row.descr}&lt;/td&gt;
    &lt;/tr&gt;
  ));


  return (
    &lt;Grid fluid&gt;
      &lt;TablePfProvider
        striped
        bordered
        hover
      &gt;
        &lt;thead&gt;
        &lt;tr&gt;
          &lt;td&gt;code&lt;/td&gt;
          &lt;td&gt;descr&lt;/td&gt;
        &lt;/tr&gt;
        &lt;/thead&gt;
        &lt;tbody&gt;
        {tr}
        &lt;/tbody&gt;
      &lt;/TablePfProvider&gt;
    &lt;/Grid&gt;
  );
};

List.propTypes = {
  data: PropTypes.arrayOf(PropTypes.shape({})),
};

List.defaultProps = {
  data: [],
};
export default List;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next make sure that you remove the predefined <code>data</code> const since the data will be coming from the reducer, on top of defining PropTypes rules for validating and giving a default for the injected property <code>data</code>.</p>
</div>
<div class="paragraph">
<p>Once complete, update the component used in the route inside <code>App.js</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">...
import PageModelsListContainer from 'ui/pageModels/ListContainer';
...
  {
    path: ROUTE_PAGE_MODELS,
    component: PageModelsListContainer,
  },
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will now see the data inside the table reflecting the content of the storage.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_connecting_the_app_to_an_entando_core_instance">1.2.9. Connecting the app to an Entando core instance</h4>
<div class="paragraph">
<p>By default the app is using mocks and not connecting to any Entando core instance.</p>
</div>
<div class="paragraph">
<p>Because the app is making use of <code>@entando/apimanager</code> we can easily change this by setting up two <code>.env</code> variables inside the <code>.env</code> file in the project root:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>REACT_APP_DOMAIN=http://localhost:8080/entando-app
REACT_APP_USE_MOCKS=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>REACT_APP_DOMAIN</code> must pointing towards the domain and container where the Entando instance is running and <strong>must not</strong> contain trailing slashes.</p>
</div>
<div class="paragraph">
<p>Once this is done to make the change happen we will have to stop the app using <code>ctrl + c</code> and re run it with <code>npm start</code>.</p>
</div>
<div class="paragraph">
<p>Now the toast stating <em>This application is using mocks</em> won&#8217;t be popping up anymore.</p>
</div>
<div class="paragraph">
<p>You can make sure that the configuration is correct by looking at the network section in the browser dev tools.  By default the app automatically makes an admin login against a plain Entando instance to authenticate the user and to be able to  consume any protected api.</p>
</div>
<div class="paragraph">
<p>This is not an ideal scenario and it is meant to be used only for debugging purposes for many reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the username and password should never be hardcoded in your app</p>
</li>
<li>
<p>if authentication is required the user should be the one performing the login action</p>
</li>
<li>
<p>the plain default passwords in use won&#8217;t be useful against a proper production instance of Entando</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_adding_the_api_calls">Adding the API Calls</h5>
<div class="paragraph">
<p>We are now going to add api calls for both users and page models to retrieve the data live instead of relying on our store&#8217;s default state.</p>
</div>
<div class="paragraph">
<p>Inside <code>src/api</code> create the <code>users.js</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import { makeRequest, METHODS } from '@entando/apimanager';

// eslint-disable-next-line import/prefer-default-export
export const getUsers = (page = { page: 1, pageSize: 10 }, params = '') =&gt; (
  makeRequest(
    {
      uri: `/api/users${params}`,
      method: METHODS.GET,
      mockResponse: {},
      useAuthentication: true,
    },
    page,
  )
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>and then create the <code>pageModels.js</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import { makeRequest, METHODS } from '@entando/apimanager';

// eslint-disable-next-line import/prefer-default-export
export const getPageModels = (page = { page: 1, pageSize: 10 }, params = '') =&gt; makeRequest({
  uri: `/api/pageModels${params}`,
  method: METHODS.GET,
  mockResponse: {},
  useAuthentication: true,
}, page);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_creating_the_thunk">Creating the Thunk</h5>
<div class="paragraph">
<p>In order to use the api call we next create a thunk action, which is a redux action with side effects, like an API call.</p>
</div>
<div class="paragraph">
<p>inside the <code>src/state/apps/testing/userList/actions.js</code> file we are going to add the new action:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">...
import { addErrors } from '@entando/messages';
import {
  getUsers,
} from 'api/users';
...

// thunks

export const fetchUsers = (page = { page: 1, pageSize: 10 }, params = '') =&gt; dispatch =&gt; (
  new Promise((resolve) =&gt; {
    getUsers(page, params).then((response) =&gt; {
      response.json().then((json) =&gt; {
        if (response.ok) {
          dispatch(addUsers(json.payload));
        } else {
          dispatch(addErrors(json.errors.map(err =&gt; err.message)));
        }
        resolve();
      });
    }).catch(() =&gt; {});
  })
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next do the same inside  <code>src/state/apps/testing/pageModels/actions.js</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">...
import { addErrors } from '@entando/messages';
import {
  getPageModels,
} from 'api/pageModels';
...

// thunks

export const fetchPageModels = (page = { page: 1, pageSize: 10 }, params = '') =&gt; dispatch =&gt; (
  new Promise((resolve) =&gt; {
    getPageModels(page, params).then((response) =&gt; {
      response.json().then((data) =&gt; {
        if (response.ok) {
          dispatch(addPageModels(data.payload));
          resolve();
        } else {
          dispatch(addErrors(data.errors.map(err =&gt; err.message)));
          resolve();
        }
      });
    }).catch(() =&gt; {});
  })
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now with two exports, it is safe to remove the <code>eslint-disable-next-line</code> comment on line 5 of both files.</p>
</div>
</div>
<div class="sect4">
<h5 id="_changing_the_mapdispatchtoprops_in_the_containers">changing the mapDispatchToProps in the containers</h5>
<div class="paragraph">
<p>Next, in order to pass the newly created thunk to both List components, we&#8217;ll update the containers accordingly, as:</p>
</div>
<div class="paragraph">
<p><code>src/ui/userList/ListContainer.js</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">...
import { fetchUsers } from 'state/apps/testing/userList/actions';
...
export const mapDispatchToProps = dispatch =&gt; ({
  fetch: () =&gt; dispatch(fetchUsers()),
});

export default connect(
  mapStateToProps,
  mapDispatchToProps,
)(List);</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>src/ui/pageModels/ListContainer.js</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">...
import { fetchPageModels } from 'state/apps/testing/pageModels/actions';
...
export const mapDispatchToProps = dispatch =&gt; ({
  fetch: () =&gt; dispatch(fetchPageModels()),
});

export default connect(
  mapStateToProps,
  mapDispatchToProps,
)(List);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_updating_the_list_components">Updating the List components</h5>
<div class="paragraph">
<p>Both List components were simple components with only a <code>render</code> method, therefore could be declared as simple constants.</p>
</div>
<div class="paragraph">
<p>Next we will fetch data during the <code>componentDidMount</code> life cycle event which will require we turn the constant into a class on top of changing the PropTypes to add the new fetch method passed down to the component.</p>
</div>
<div class="paragraph">
<p><code>src/ui/userList/List.js</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import React, { Component } from 'react';
...
class List extends Component {
  componentDidMount() {
    const { fetch } = this.props;
    fetch();
  }

  render() {
    const { data } = this.props;
    const tr = data.map(row =&gt; (
      &lt;tr&gt;
        &lt;td&gt;{row.username}&lt;/td&gt;
        &lt;td&gt;{row.registration}&lt;/td&gt;
      &lt;/tr&gt;
    ));

    return (
      &lt;Grid fluid&gt;
        &lt;TablePfProvider
          striped
          bordered
          hover
        &gt;
          &lt;thead&gt;
            &lt;tr&gt;
              &lt;td&gt;username&lt;/td&gt;
              &lt;td&gt;registration&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/thead&gt;
          &lt;tbody&gt;
            {tr}
          &lt;/tbody&gt;
        &lt;/TablePfProvider&gt;
      &lt;/Grid&gt;
    );
  }
}

List.propTypes = {
  data: PropTypes.arrayOf(PropTypes.shape({})),
  fetch: PropTypes.func,
};

List.defaultProps = {
  data: [],
  fetch: () =&gt; {},
};</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>src/ui/pageModels/List.js</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import React, { Component } from 'react';
...
class List extends Component {
  componentDidMount() {
    const { fetch } = this.props;
    fetch();
  }

  render() {
    const { data } = this.props;
    const tr = data.map(row =&gt; (
      &lt;tr&gt;
        &lt;td&gt;{row.code}&lt;/td&gt;
        &lt;td&gt;{row.descr}&lt;/td&gt;
      &lt;/tr&gt;
    ));

    return (
      &lt;Grid fluid&gt;
        &lt;TablePfProvider
          striped
          bordered
          hover
        &gt;
          &lt;thead&gt;
            &lt;tr&gt;
              &lt;td&gt;code&lt;/td&gt;
              &lt;td&gt;descr&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/thead&gt;
          &lt;tbody&gt;
            {tr}
          &lt;/tbody&gt;
        &lt;/TablePfProvider&gt;
      &lt;/Grid&gt;
    );
  }
}

List.propTypes = {
  data: PropTypes.arrayOf(PropTypes.shape({})),
  fetch: PropTypes.func,
};

List.defaultProps = {
  data: [],
  fetch: () =&gt; {},
};</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_clear_the_default_value_of_the_reducer">clear the default value of the reducer</h5>
<div class="paragraph">
<p>Now we should be fetching data from the server, therefore we can safely make the list key in the <code>defaultState</code> object an empty array:</p>
</div>
<div class="paragraph">
<p><code>src/state/apps/testing/userList/reducer.js</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">...
const defaultState = {
  list: [],
};
...</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>src/state/apps/testing/pageModels/reducer.js</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">...
const defaultState = {
  list: [],
};
...</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_adding_additional_dependencies">1.2.10. adding additional dependencies</h4>
<div class="paragraph">
<p>It may be necessary to set additional dependencies for your project.  If the need arises, it is important to remember a few rules:</p>
</div>
<div class="paragraph">
<p>Only actual dependencies that are not already included in <code>app-builder</code> can be added as pure dependencies.
Every other dependency must either be a <code>devDependency</code> or <code>peerDependency</code>.</p>
</div>
<div class="paragraph">
<p>If you are not careful you may end up with duplicated dependencies that <strong>will</strong> result in errors manifesting themselves when running the app inside App Builder.</p>
</div>
</div>
<div class="sect3">
<h4 id="_running_the_app_in_integrated_mode_within_app_builder">1.2.11. running the app in integrated mode within App Builder</h4>
<div class="paragraph">
<p>After running <code>npm install</code> in the App Builder, the user can run the <code>npm run app-install &lt;appId&gt;</code> command to install the app.</p>
</div>
<div class="paragraph">
<p>This command will trigger a download of the app from npm and the installation of its component within App Builder.
After the installation process is complete, it will be possible to either <code>npm start</code> or <code>npm build</code> App Builder.</p>
</div>
<div class="paragraph">
<p>To install a dev app, like the one developed in this tutorial which have not been previously published on npm, you will need to use additional flags and will have to run a few additional commands.</p>
</div>
<div class="paragraph">
<p><strong>Before running the Install command</strong> make sure that you have uninstalled all existing peer and dev dependencies to avoid collision with app builder. To do so, from the app builder app directory (<code>testing</code>, in this tutorial) just run in the correct order the following commands:</p>
</div>
<div class="paragraph">
<p><code>npm run babel</code></p>
</div>
<div class="paragraph">
<p><code>npm i --only=production</code></p>
</div>
<div class="paragraph">
<p>The first will create the dist directory that will be needed by App Builder while the second one will uninstall anything but production dependencies.</p>
</div>
<div class="paragraph">
<p>Next, from the App Builder directory, run the install command with these additional flags:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-d</code> specify the relative path where the app is installed. When using this flag the appId should be the normalized app name, without the <code>@entando/</code> prefix.</p>
</li>
<li>
<p><code>-p</code> specify the package name if it is different from the appId</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>to use flags you will have to use the double dash in the command:</p>
</div>
<div class="paragraph">
<p><code>npm run app-install&#8201;&#8212;&#8201; cms -d ../testing -p @entando/testing</code></p>
</div>
<div class="paragraph">
<p><strong>the value in the <code>-p</code> flag should always match the actual name of the app that is going to be installed inside App Builder</strong>. You can check your app name inside the <code>package.json</code> file of your app.</p>
</div>
<div class="paragraph">
<p>If you experience problems after running the build command delete the <code>node_modules</code> directory before running the second command.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_micro_frontends">1.3. Micro Frontends</h3>
<div class="sect3">
<h4 id="_tutorial_create_a_react_micro_frontend_widget">1.3.1. Tutorial: create a react micro frontend widget</h4>
<div class="sect4">
<h5 id="_prerequisites">Prerequisites</h5>
<div class="paragraph">
<p>Use last stable node version (at the time of writing <strong>v13.8.0</strong>). We suggest using <a href="https://github.com/nvm-sh/nvm">nvm</a> to handle node installations.</p>
</div>
</div>
<div class="sect4">
<h5 id="_bootstrap_a_react_app">Bootstrap a react app</h5>
<div class="paragraph">
<p>In this tutorial we use <a href="https://create-react-app.dev/">Create React App</a>, but feel free to adopt whatever boilerplate you like.</p>
</div>
<div class="paragraph">
<p><code>npx create-react-app my-widget --use-npm</code></p>
</div>
<div class="paragraph">
<p>This is the expected output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>my-widget
â”œâ”€â”€ README.md
â”œâ”€â”€ node_modules
â”œâ”€â”€ package.json
â”œâ”€â”€ .gitignore
â”œâ”€â”€ public
â”‚   â”œâ”€â”€ favicon.ico
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ logo192.png
â”‚   â”œâ”€â”€ logo512.png
â”‚   â”œâ”€â”€ manifest.json
â”‚   â””â”€â”€ robots.txt
â””â”€â”€ src
    â”œâ”€â”€ App.css
    â”œâ”€â”€ App.js
    â”œâ”€â”€ App.test.js
    â”œâ”€â”€ index.css
    â”œâ”€â”€ index.js
    â”œâ”€â”€ logo.svg
    â”œâ”€â”€ serviceWorker.js
    â””â”€â”€ setupTests.js</pre>
</div>
</div>
<div class="paragraph">
<p>Now, type <code>cd my-widget</code> and <code>npm start</code> to start the app.</p>
</div>
</div>
<div class="sect4">
<h5 id="_wrap_the_react_app_in_a_custom_element">Wrap the react app in a custom element</h5>
<div class="paragraph">
<p>Let&#8217;s add a new file <code>WidgetElement.js</code>, containing the custom element that will wrap the entire React app under the <code>src</code> folder.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import React from 'react';
import ReactDOM from 'react-dom';
import App from './App';

class WidgetElement extends HTMLElement {
  connectedCallback() {
    this.mountPoint = document.createElement('div');
    this.appendChild(this.mountPoint);
    ReactDOM.render(&lt;App /&gt;, this.mountPoint);
  }
}

customElements.define('my-widget', WidgetElement);

export default WidgetElement;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>connectedCallback</code> is a lifecycle hook method of custom elements, part of the web components spec.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then, the <code>index.js</code> file should be updated. Starting from this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import React from 'react';
import ReactDOM from 'react-dom';
import './index.css';
import App from './App';
import * as serviceWorker from './serviceWorker';

ReactDOM.render(&lt;App /&gt;, document.getElementById('root'));

// If you want your app to work offline and load faster, you can change
// unregister() to register() below. Note this comes with some pitfalls.
// Learn more about service workers: https://bit.ly/CRA-PWA
serviceWorker.unregister();</code></pre>
</div>
</div>
<div class="paragraph">
<p>replace the whole file with these two lines</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import './index.css';
import './WidgetElement';</code></pre>
</div>
</div>
<div class="paragraph">
<p>You only have to import <code>WidgetElement</code> plus the css, if needed.</p>
</div>
<div class="paragraph">
<p>We assume we don&#8217;t need a service worker for the widget, so we can delete serviceWorker.js.</p>
</div>
<div class="paragraph">
<p>Now, to ensure our custom element is working we have to edit <code>public/index.html</code>. Remove <code>&lt;div id="root"&gt;&lt;/div&gt;</code> from the <code>body</code> (we programmatically generated the react root in the <code>connectedCallback</code> method of <code>WidgetElement</code>) and add our custom element <code>&lt;my-widget /&gt;</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
  &lt;head&gt;
    &lt;meta charset="utf-8" /&gt;
    &lt;link rel="shortcut icon" href="%PUBLIC_URL%/favicon.ico" /&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;
    &lt;title&gt;React App&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;my-widget /&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>the custom element name (<code>my-widget</code> in this tutorial) <em>must</em> match the first parameter of <code>customElements.define</code> method</p>
</li>
<li>
<p>custom element names <a href="https://stackoverflow.com/questions/22545621/do-custom-elements-require-a-dash-in-their-name">require a dash to be used in them</a> (kebab-case) - they can&#8217;t be single words.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Page should auto reload and&#8230;&#8203; congrats! You&#8217;re running a barebones Entando 6 widget in isolation.</p>
</div>
</div>
<div class="sect4">
<h5 id="_build_the_widget">Build the widget</h5>
<div class="paragraph">
<p>In order to avoid path issues, we should set up a one line <code>.env</code> file in the CRA project root:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-.env" data-lang=".env">PUBLIC_URL=http://localhost:8080/entando/resources/static/my-widget</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where <code><a href="http://localhost:8080/entando/" class="bare">http://localhost:8080/entando/</a></code> is the path of the Entando 6 instance containing the widget.</p>
</div>
<div class="paragraph">
<p>Ready to build now! From the react project root, type</p>
</div>
<div class="paragraph">
<p><code>npm run build</code></p>
</div>
<div class="paragraph">
<p>and a <code>build</code> dir will be generated. Now rename</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a file like <code>static/js/runtime~main.c7dcdf0b.js</code> to <code>static/js/runtime.js</code> (bootstrapping logic)</p>
</li>
<li>
<p>a file like <code>static/js/2.230b21ef.chunk.js</code> to <code>static/js/vendor.js</code> (third-party libraries)</p>
</li>
<li>
<p>a file like <code>static/js/main.1fd3965a.chunk.js</code> to <code>static/js/main.js</code> (app)</p>
</li>
<li>
<p>a file like <code>static/css/main.d1b05096.chunk.js</code> to <code>static/css/main.css</code> (stylesheet)</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
you could keep the original names in order to avoid potential caching issues, but then you will have to update the <em>Custom UI</em> field in the App Builder widget screen every time a new version of the widget is deployed. DE bundles can help with this and are covered in another lab.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_create_the_entando_6_widget_in_app_builder">Create the Entando 6 widget in App Builder</h5>
<div class="paragraph">
<p>For the purposes of this tutorial we are going to load the widget to the App builder manually. In a live system you would include this in an Entando app, load via API, or via a Component Repository bundle.</p>
</div>
<div class="paragraph">
<p>Open the Entando App Builder</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to Configuration &#8594; File Browser</p>
</li>
<li>
<p>Click public</p>
</li>
<li>
<p>Click Create Folder</p>
</li>
<li>
<p>Enter <code>my-widget</code></p>
</li>
<li>
<p>Click save</p>
</li>
<li>
<p>Click <code>my-widget</code> folder</p>
</li>
<li>
<p>Recreate the same folder structure (my-widget/static/js, my-widget/static/css)</p>
</li>
<li>
<p>Upload files from js and css folders in the corresponding folders in file browser</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can also embed the widget directly in a local copy of an Entando app. Copy it into the Entando 6 instance under <code>src\main\webapp\resources\my-widget</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now create the widget in the App Builder</p>
</div>
<div class="paragraph">
<p>go to UX Patterns &#8594; Widgets and click on the <em>New</em> button.</p>
</div>
<div class="paragraph">
<p>You&#8217;ll see a screen like this one</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/new-widget-screen.png" alt="New widget screen"></span></p>
</div>
<div class="paragraph">
<p>Fill the form, e.g.:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>my_widget</em> as widget code (dashes are not allowed in a widget code)</p>
</li>
<li>
<p><em>My Widget</em> as title for all the languages</p>
</li>
<li>
<p><em>Free access</em> as group</p>
</li>
<li>
<p>the following code as <em>Custom UI</em></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;#assign wp=JspTaglibs[ "/aps-core"]&gt;
&lt;link rel="stylesheet" type="text/css" href="&lt;@wp.resourceURL /&gt;my-widget/static/css/main.css"&gt;
&lt;script async src="&lt;@wp.resourceURL /&gt;my-widget/static/js/runtime.js"&gt;&lt;/script&gt;
&lt;script async src="&lt;@wp.resourceURL /&gt;my-widget/static/js/vendor.js"&gt;&lt;/script&gt;
&lt;script async src="&lt;@wp.resourceURL /&gt;my-widget/static/js/main.js"&gt;&lt;/script&gt;
&lt;my-widget /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Update the paths to match what you loaded to the app builder in the steps above. And save the widget.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>&lt;#assign wp=JspTaglibs[ "/aps-core"]&gt;</code> is needed for your widget code to have access to <code>@wp</code> object which provides access to environment variables.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then, configure a page (let&#8217;s assume it&#8217;s called <em>mypage</em>) and drag the widget <em>mywidget</em> in the page model. Publish, load the page (its url should be <code><a href="http://localhost:8080/entando/en/mypage.page" class="bare">http://localhost:8080/entando/en/mypage.page</a></code>) and <em>voilÃ </em>, here&#8217;s our react app embedded as a widget. Done!</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_tutorial_using_a_custom_event_for_widget_communication">1.3.2. Tutorial: Using a custom event for widget communication</h4>
<div class="paragraph">
<p>Entando 6 widgets can communicate through <a href="https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent">Custom Events</a>, an established web standard.</p>
</div>
<div class="paragraph">
<p>In this tutorial we&#8217;re going to build two widgets: the first one will fire an event, the second one will intercept it.</p>
</div>
<div class="sect4">
<h5 id="_fire_an_event_from_a_widget">Fire an event from a widget</h5>
<div class="paragraph">
<p><code>npx create-react-app publisher-widget --use-npm</code></p>
</div>
<div class="paragraph">
<p>then follow the same steps from our <a href="create-react-microfrontend-widget.adoc">previous tutorial</a>.</p>
</div>
<div class="paragraph">
<p>Be careful to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>rename <code>WidgetElement.js</code> to <code>PublisherWidgetElement.js</code></p>
</li>
<li>
<p>edit <code>index.js</code>: now you should import <code>PublisherWidgetElement</code></p>
</li>
<li>
<p>edit <code>index.html</code> updating the reference to the custom element: now it&#8217;s <code>&lt;publisher-widget&gt;</code></p>
</li>
<li>
<p>edit <code>PublisherWidgetElement.js</code> and <code>App.js</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We need to add some event firing logic</p>
</div>
<div class="sect5">
<h6 id="_publisherwidgetelement_js">PublisherWidgetElement.js</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import React from 'react';
import ReactDOM from 'react-dom';
import App from './App';

const EVENTS = {
  greeting: 'greeting',
};

class PublisherWidgetElement extends HTMLElement {

  constructor() {
    super();
    this.onGreet = name =&gt; this.publishWidgetEvent(EVENTS.greeting, { name });
  }

  connectedCallback() {
    this.mountPoint = document.createElement('div');
    this.appendChild(this.mountPoint);
    this.render();
  }

  publishWidgetEvent(eventId, detail) {
    const widgetEvent = new CustomEvent(eventId, { detail });
    window.dispatchEvent(widgetEvent);
  }

  render() {
    ReactDOM.render(&lt;App onGreet={this.onGreet} /&gt;, this.mountPoint);
  }
}

customElements.define('publisher-widget', PublisherWidgetElement);

export default PublisherWidgetElement;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>in the <code>CustomEvent</code> constructor, <code>detail</code> is the specific name to use in the event payload, as for the <a href="https://dom.spec.whatwg.org/#interface-customevent">specs</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="_app_js">App.js</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import React from 'react';
import './App.css';

class App extends React.Component {
  constructor(props) {
    super(props);
    this.state = { name: ''};
  }

  handleNameChange(value) {
    this.setState(prevState =&gt; ({
      ...prevState,
      name: value,
    }));
  }

  render() {
    const { name } = this.state;
    const { onGreet } = this.props;
    return (
      &lt;div&gt;
        &lt;h1&gt;Send a greeting&lt;/h1&gt;
        &lt;label htmlFor="name"&gt;Name&lt;/label&gt;
        &lt;input id="name" onChange={e =&gt; this.handleNameChange(e.target.value)} value={name} /&gt;
        &lt;button onClick={() =&gt; onGreet(name)}&gt;Say hello!&lt;/button&gt;
      &lt;/div&gt;
    );
  }
}

export default App;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To quickly test the event publishing we can execute from the JS console this line of code</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">window.addEventListener('greeting', (evt) =&gt; console.log('Hello', evt.detail.name))</code></pre>
</div>
</div>
<div class="paragraph">
<p>then write something in the text field, click the "Say hello!" button and have a look at the JS console, it will show the expected hello message.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_consume_an_event_in_another_widget">Consume an event in another widget</h5>
<div class="paragraph">
<p>Now, let&#8217;s create the subscriber widget.</p>
</div>
<div class="paragraph">
<p><code>npx create-react-app subscriber-widget --use-npm</code></p>
</div>
<div class="paragraph">
<p>then follow the same steps from our <a href="create-react-microfrontend-widget.adoc">previous tutorial</a>.</p>
</div>
<div class="paragraph">
<p>Be careful to</p>
</div>
<div class="ulist">
<ul>
<li>
<p>rename <code>WidgetElement.js</code> to <code>SubscriberWidgetElement.js</code></p>
</li>
<li>
<p>edit <code>index.js</code>: now you should import <code>SubscriberWidgetElement</code></p>
</li>
<li>
<p>edit <code>index.html</code> updating the reference to the custom element: now it&#8217;s <code>&lt;subscriber-widget&gt;</code></p>
</li>
<li>
<p>edit <code>SubscriberWidgetElement.js</code> and <code>App.js</code></p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_subscriberwidgetelement_js">SubscriberWidgetElement.js</h6>
<div class="paragraph">
<p>(Rename <code>WidgetElement</code> to <code>SubscriberWidgetElement</code> and update the import in <code>index.js</code> accordingly)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import React from 'react';
import ReactDOM from 'react-dom';
import App from './App';

const EVENTS = {
  greeting: 'greeting',
};

class SubscriberWidgetElement extends HTMLElement {

  constructor() {
    super();
    this.name = null;
    this.subscribeToWidgetEvent(EVENTS.greeting, (evt) =&gt; this.onGreeting(evt.detail.name));
  }

  connectedCallback() {
    this.mountPoint = document.createElement('div');
    this.appendChild(this.mountPoint);
    this.render();
  }

  subscribeToWidgetEvent(eventType, eventHandler) {
    window.addEventListener(eventType, eventHandler);
  }

  onGreeting(name) {
    this.name = name;
    this.render();
  }

  render() {
    ReactDOM.render(&lt;App name={this.name} /&gt;, this.mountPoint);
  }
}

customElements.define('subscriber-widget', SubscriberWidgetElement);

export default SubscriberWidgetElement;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_app_js_2">App.js</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import React from 'react';
import './App.css';

function App({ name }) {
  return name ? (&lt;h2&gt;Just got a greeting from {name}&lt;/h2&gt;)
    : (&lt;h2&gt;Waiting for a greeting...&lt;/h2&gt;);
}

export default App;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To quickly test the event publishing we can execute from the JS console these lines of code</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">const widgetEvent = new CustomEvent('greeting', {
  detail: {
    name: 'Pippo'
  },
});
window.dispatchEvent(widgetEvent);</code></pre>
</div>
</div>
<div class="paragraph">
<p>and then the widget will update the text.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_make_both_widgets_work_in_entando">Make both widgets work in Entando</h5>
<div class="paragraph">
<p>To properly test widgets in an Entando instance, follow these steps (you can use the <a href="create-react-microfrontend-widget.adoc">basic microfrontend tutorial</a> as reference)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>build both widgets</p>
</li>
<li>
<p>copy widget files</p>
</li>
<li>
<p>create widgets from App Builder</p>
</li>
<li>
<p>create a page model from App Builder</p>
</li>
<li>
<p>create a page and assign the just created page model</p>
</li>
<li>
<p>configure the page dragging both widgets to the page</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For a sample page model, use this one</p>
</div>
<div class="paragraph">
<p><strong>JSON Configuration</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "frames": [
    {
      "pos": 0,
      "descr": "Sample Frame",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": null
    },
    {
      "pos": 1,
      "descr": "Sample Frame Two",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": null
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Template</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;#assign wp=JspTaglibs["/aps-core"]&gt;
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;html&gt;
&lt;head&gt;
	&lt;title&gt;&lt;@wp.currentPage param="title" /&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;&lt;@wp.currentPage param="title" /&gt;&lt;/h1&gt;
&lt;div&gt;&lt;@wp.show frame=0 /&gt;&lt;/div&gt;
&lt;div&gt;&lt;@wp.show frame=1 /&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, go to the page you just created and you will find both widgets. Write something in the publisher widget input, press the button and the subscriber widget will update. Done!</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_tutorial_add_app_builder_configuration_screen_for_an_entando_6_widget">1.3.3. Tutorial: Add App Builder configuration screen for an Entando 6 widget</h4>
<div class="paragraph">
<p>Entando 6 widgets can be customized through an App Builder configuration screen so the citizen developers can avoid writing ad-hoc additional code.</p>
</div>
<div class="paragraph">
<p>In Entando 6, the configuration screen is also a micro frontend, which can also be defined as a web component. That means you can develop and test it in isolation, without a running Entando instance.</p>
</div>
<div class="sect4">
<h5 id="_generate_a_react_app">Generate a React app</h5>
<div class="paragraph">
<p>Let&#8217;s start with the boilerplate provided by <a href="https://create-react-app.dev/">Create React App</a>, probably the most popular one.</p>
</div>
<div class="paragraph">
<p><code>npx create-react-app my-widget-config --use-npm</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>my-widget-config
â”œâ”€â”€ README.md
â”œâ”€â”€ node_modules
â”œâ”€â”€ package.json
â”œâ”€â”€ .gitignore
â”œâ”€â”€ public
â”‚   â”œâ”€â”€ favicon.ico
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ logo192.png
â”‚   â”œâ”€â”€ logo512.png
â”‚   â”œâ”€â”€ manifest.json
â”‚   â””â”€â”€ robots.txt
â””â”€â”€ src
    â”œâ”€â”€ App.css
    â”œâ”€â”€ App.js
    â”œâ”€â”€ App.test.js
    â”œâ”€â”€ index.css
    â”œâ”€â”€ index.js
    â”œâ”€â”€ logo.svg
    â”œâ”€â”€ serviceWorker.js
    â””â”€â”€ setupTests.js</pre>
</div>
</div>
<div class="paragraph">
<p>Then, type <code>cd my-widget-config</code> and <code>npm start</code> to start the app.</p>
</div>
</div>
<div class="sect4">
<h5 id="_edit_the_root_app_component">Edit the root app component</h5>
<div class="paragraph">
<p>Let&#8217;s start with a simple form: only an input with a label. So, let&#8217;s edit <code>App.js</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import React from 'react';

class App extends React.Component {
  constructor(props) {
    super(props);
    this.state = { name: ''};
  }

  handleNameChange(value) {
    this.setState(prevState =&gt; ({
      ...prevState,
      name: value,
    }));
  }

  render() {
    const { name } = this.state;
    return (
      &lt;div&gt;
        &lt;h1&gt;Sample Entando 6 Widget Configuration&lt;/h1&gt;
        &lt;label htmlFor="name"&gt;Name&lt;/label&gt;
        &lt;input id="name" onChange={e =&gt; this.handleNameChange(e.target.value)} value={name} /&gt;
      &lt;/div&gt;
    );
  }
}

export default App;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You are free to use your favorite form handling library e.g., <a href="https://jaredpalmer.com/formik">Formik</a>, <a href="https://redux-form.com/">redux-form</a> (that requirese redux) or others.</p>
</div>
<div class="paragraph">
<p>In regards to styling, since this is going to be an App Builder screen, we strongly suggest using <a href="https://www.patternfly.org/v3/">PatternFly v3</a> (<code>patternfly</code> and <code>patternfly-react</code> packages) to keep UX coherence.</p>
</div>
</div>
<div class="sect4">
<h5 id="_wrap_the_react_app_in_a_web_component">Wrap the react app in a web component</h5>
<div class="paragraph">
<p>Now, let&#8217;s add the web component that will wrap the entire React app. Let&#8217;s name it <code>WidgetElement</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import React from 'react';
import ReactDOM from 'react-dom';
import App from './App';

class WidgetElement extends HTMLElement {
  constructor() {
    super();
    this.reactRootRef = React.createRef();
    this.mountPoint = null;
  }

  get config() {
    return this.reactRootRef.current ? this.reactRootRef.current.state : {};
  }

  set config(value) {
    return this.reactRootRef.current.setState(value);
  }

  connectedCallback() {
    this.mountPoint = document.createElement('div');
    this.appendChild(this.mountPoint);
    ReactDOM.render(&lt;App ref={this.reactRootRef} /&gt;, this.mountPoint);
  }
}

customElements.define('my-widget-config', WidgetElement);

export default WidgetElement;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Its responsibility is rendering the react app and syncing the react app state in a <code>config</code> property, that <em>must</em> be named that way. The key to App builder communication is that it works in three steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>App Builder reads <code>config</code> property when the widget config screen is rendered</p>
</li>
<li>
<p><code>config</code> property is mutated when a user configures the widget</p>
</li>
<li>
<p>When a user saves the config, App Builder retrieves it (again, from the <code>config</code> property) and persists it through Entando APIs</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This means the widget developer can focus on the configuration screens without having to call Entando APIs to read or write configuration.</p>
</div>
<div class="paragraph">
<p>One more JS file to update: <code>index.js</code>. Starting from this</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import React from 'react';
import ReactDOM from 'react-dom';
import './index.css';
import App from './App';
import * as serviceWorker from './serviceWorker';

ReactDOM.render(&lt;App /&gt;, document.getElementById('root'));

// If you want your app to work offline and load faster, you can change
// unregister() to register() below. Note this comes with some pitfalls.
// Learn more about service workers: https://bit.ly/CRA-PWA
serviceWorker.unregister();</code></pre>
</div>
</div>
<div class="paragraph">
<p>You only have to import <code>WidgetElement</code> plus the css, if needed. Something like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import './index.css';
import './WidgetElement';</code></pre>
</div>
</div>
<div class="paragraph">
<p>We assume we don&#8217;t need a service worker for the widget, so we can delete serviceWorker.js.</p>
</div>
<div class="paragraph">
<p>To ensure our web component is working we have to edit <code>public/index.html</code>. Remove <code>&lt;div id="root"&gt;&lt;/div&gt;</code> from the <code>body</code> (we programmatically generated the react root in the <code>connectedCallback</code> method of <code>WidgetElement</code>) and add our new web component tag <code>&lt;my-widget /&gt;</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
  &lt;head&gt;
    &lt;meta charset="utf-8" /&gt;
    &lt;link rel="shortcut icon" href="%PUBLIC_URL%/favicon.ico" /&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;
    &lt;title&gt;React App&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;my-widget-config /&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the web component tag name (<code>my-widget-config</code> in this tutorial) <em>must</em> match the first parameter of the <code>customElements.define</code> method.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The page should auto reload and&#8230;&#8203;congrats, you&#8217;re running an Entando 6 widget in isolation.</p>
</div>
</div>
<div class="sect4">
<h5 id="_add_widget_config_screen_in_app_builder">Add widget config screen in App Builder</h5>
<div class="paragraph">
<p>Before integrating the widget config screen, we need some widget info. Open App Builder, go to UX Patterns &#8594; Widgets and click on the installed widget that we&#8217;re creating the configuration screen for.</p>
</div>
<div class="paragraph">
<p>You&#8217;ll see a screen like:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/edit-widget-screen.png" alt="Edit widget screen"></span></p>
</div>
<div class="paragraph">
<p>Next, we&#8217;ll build our widget before embedding it into the Entando 6 instance. From the react project root, type</p>
</div>
<div class="paragraph">
<p><code>npm run build</code></p>
</div>
<div class="paragraph">
<p>and a <code>build/static</code> directory will be generated. Copy it into the Entando 6 instance under <code>src\main\webapp\cmsresources\my-widget-config</code>, then rename</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a file like <code>js/runtime~main.c7dcdf0b.js</code> to <code>js/runtime.js</code> (bootstrapping logic)</p>
</li>
<li>
<p>a file like <code>js/2.230b21ef.chunk.js</code> to <code>js/vendor.js</code> (third-party libraries)</p>
</li>
<li>
<p>a file like <code>js/main.1fd3965a.chunk.js</code> to <code>js/main.js</code> (app)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now, edit again the widget and update the <code>configUI</code> field.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "customElement": "my-widget-config",
  "resources": [
    "my-widget-config/static/js/runtime.js",
    "my-widget-config/static/js/vendor.js",
    "my-widget-config/static/js/main.js"
  ]
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>It is possible to keep the original names in order to avoid potential caching issues, but then you will have to update the <em>Config UI</em> field in the App Builder widget screen each time a new version of the widget is deployed.</p>
</li>
<li>
<p><code>configUI</code> is a JSON object, so pay attention to save a well-formed one (the integrated JSON editor will help you)</p>
</li>
<li>
<p>value for <code>customElement</code> must match the name of custom tag in <code>index.html</code> and the one passed as parameter to <code>customElements.define</code> in <code>WidgetElement</code></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Last step: configure a page in App Builder, drag our widget into the page model slot and you&#8217;ll see the configuration screen we just built.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_tutorial_display_widget_configuration_data">1.3.4. Tutorial: Display widget configuration data</h4>
<div class="paragraph">
<p>So, we already created a react micro frontend widget and configuration screen to customize a <em>name</em> field.</p>
</div>
<div class="paragraph">
<p>In this tutorial we will display that field in our micro frontend widget.</p>
</div>
<div class="sect4">
<h5 id="_add_an_attribute_to_the_custom_element">Add an attribute to the custom element</h5>
<div class="paragraph">
<p>Edit <code>WidgetElement</code> to add attribute handling to the custom element, and make re-render our app when an attribute changes. Now, the <em>name</em> attribute is being read from the custom element and passed as a prop to the react root component (<em>App</em>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import React from 'react';
import ReactDOM from 'react-dom';
import App from './App';

const ATTRIBUTES = {
  name: 'name',
};

class WidgetElement extends HTMLElement {

  static get observedAttributes() {
    return Object.values(ATTRIBUTES);
  }

  attributeChangedCallback(name, oldValue, newValue) {
    if (!Object.values(ATTRIBUTES).includes(name)) {
      throw new Error(`Untracked changed attribute: ${name}`);
    }
    if (this.mountPoint &amp;&amp; newValue !== oldValue) {
      this.render();
    }
  }

  connectedCallback() {
    this.mountPoint = document.createElement('div');
    this.appendChild(this.mountPoint);
    this.render();
  }

  render() {
    const name = this.getAttribute(ATTRIBUTES.name);
    ReactDOM.render(&lt;App name={name} /&gt;, this.mountPoint);
  }
}

customElements.define('my-widget', WidgetElement);

export default WidgetElement;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>attributeChangedCallback</code> is also a custom elements lifecycle hook method.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_make_react_component_handle_the_input">Make react component handle the input</h5>
<div class="paragraph">
<p>Edit the <code>App</code> component now, to make it display the <code>name</code> prop.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import React from 'react';
import './App.css';

function App({name}) {
  return (
    &lt;div className="App"&gt;
      &lt;header className="App-header"&gt;
        &lt;p&gt;
          Hello, {name}!
        &lt;/p&gt;
      &lt;/header&gt;
    &lt;/div&gt;
  );
}

export default App;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, to ensure our custom element is working we can edit <code>public/index.html</code> and set a value for the <em>name</em> attribute of the custom element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
  &lt;head&gt;
    &lt;meta charset="utf-8" /&gt;
    &lt;link rel="shortcut icon" href="%PUBLIC_URL%/favicon.ico" /&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;
    &lt;title&gt;React App&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;my-widget name="Marco"/&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>After page reload, you should be able to display a simple "Hello, Marco!" message.</p>
</div>
</div>
<div class="sect4">
<h5 id="_rebuild_the_widget">Rebuild the widget</h5>
<div class="paragraph">
<p>From the react project root, type:</p>
</div>
<div class="paragraph">
<p><code>npm run build</code></p>
</div>
<div class="paragraph">
<p>and the <code>build/static</code> directory will be (re)generated. Copy it again into the Entando 6 instance under <code>src\main\webapp\resources\static\my-widget</code>, then rename</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a file like <code>js/runtime~main.c7dcdf0b.js</code> to <code>js/runtime.js</code> (bootstrapping logic)</p>
</li>
<li>
<p>a file like <code>js/2.230b21ef.chunk.js</code> to <code>js/vendor.js</code> (third-party libraries)</p>
</li>
<li>
<p>a file like <code>js/main.1fd3965a.chunk.js</code> to <code>js/main.js</code> (app)</p>
</li>
<li>
<p>a file like <code>css/main.d1b05096.chunk.js</code> to <code>css/main.css</code> (stylesheet)</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
you could keep the original names in order to avoid potential caching issues, but then you will have to update the <em>Custom UI</em> field in the App Builder widget screen every time a new version of the widget is deployed.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the application server you&#8217;re running does not have hot deploy enabled, restart it.</p>
</div>
</div>
<div class="sect4">
<h5 id="_update_the_entando_6_widget_in_app_builder">Update the Entando 6 widget in App Builder</h5>
<div class="paragraph">
<p>Open the Entando App Builder, go to UX Patterns &#8594; Widgets, find the widget <em>My Widget</em> and click to edit it.</p>
</div>
<div class="paragraph">
<p>You&#8217;ll see a screen like this one</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/edit-widget-screen-2.png" alt="Edit widget screen"></span></p>
</div>
<div class="paragraph">
<p>Update the <em>Custom UI</em> field from:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;#assign wp=JspTaglibs[ "/aps-core"]&gt;
&lt;link rel="stylesheet" type="text/css" href="&lt;@wp.resourceURL /&gt;static/my-widget/static/css/main.css"&gt;
&lt;script async src="&lt;@wp.resourceURL /&gt;static/my-widget/static/js/runtime.js"&gt;&lt;/script&gt;
&lt;script async src="&lt;@wp.resourceURL /&gt;static/my-widget/static/js/vendor.js"&gt;&lt;/script&gt;
&lt;script async src="&lt;@wp.resourceURL /&gt;static/my-widget/static/js/main.js"&gt;&lt;/script&gt;
&lt;my-widget /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;#assign wp=JspTaglibs[ "/aps-core"]&gt;
&lt;link rel="stylesheet" type="text/css" href="&lt;@wp.resourceURL /&gt;static/my-widget/static/css/main.css"&gt;
&lt;script async src="&lt;@wp.resourceURL /&gt;static/my-widget/static/js/runtime.js"&gt;&lt;/script&gt;
&lt;script async src="&lt;@wp.resourceURL /&gt;static/my-widget/static/js/vendor.js"&gt;&lt;/script&gt;
&lt;script async src="&lt;@wp.resourceURL /&gt;static/my-widget/static/js/main.js"&gt;&lt;/script&gt;
&lt;@wp.currentWidget param="config" configParam="name" var="configName" /&gt;
&lt;my-widget name="${configName}" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>We basically added a JSTL tag to extract a field (under <code>configParam</code>) from the config field of the current widget and put it in a <code>configName</code> variable, that we pass to the custom element.</p>
</div>
<div class="paragraph">
<p>Save the widget and reload the page that contains the widget: you&#8217;ll see "Hello, Marco!" as expected.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_tutorial_blueprint_generated_widgets_overview">1.3.5. Tutorial: Blueprint generated widgets' overview</h4>
<div class="paragraph">
<p>When you create an entity using Entando blueprint, it generates a few premade widgets. In this section we will review them.</p>
</div>
<div class="paragraph">
<p>We will be using <code>Conference</code> as an entity name for the examples below.</p>
</div>
<div class="sect4">
<h5 id="_common_parts">Common parts</h5>
<div class="paragraph">
<p>Each widget contains a README file that should help you with the setup.</p>
</div>
<div class="paragraph">
<p>All generated widgets are web components created using Custom Elements API.</p>
</div>
<div class="paragraph">
<p>Each widget is displayed using the custom element tag - e.g., inside the Details widget folder <code>conference/detailsWidget/public/index.html</code> you can find <code>conference-details id="1" override-edit-handler hide-edit-button /&gt;</code>. This element <code>&lt;conference-details /&gt;</code> is defined in the component entry point at <code>conference/detailsWidget/src/custom-elements/ConferenceDetailsElement.js</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
custom element names (<code>conference-details</code>) require a dash in them to be used, e.g., (kebab-case) - they can not be single words.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more information about web components, custom elements and micro frontends, please refer to "Create a react micro frontend widget" section.</p>
</div>
<div class="sect5">
<h6 id="_authentication">Authentication</h6>
<div class="paragraph">
<p>If widget requires authentication, component is wrapped in <code>KeycloakContext.Provider</code> and Keycloak object is fetched from <code>window.entando.keycloak</code> variable. Entando is using Keycloak as our authentication provider, but you can add any providers you like.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">ReactDOM.render(
  &lt;KeycloakContext.Provider value={this.keycloak}&gt;
    &lt;StylesProvider jss={this.jss}&gt;
      &lt;ThemeProvider theme={this.muiTheme}&gt;{FormContainer}&lt;/ThemeProvider&gt;
    &lt;/StylesProvider&gt;
  &lt;/KeycloakContext.Provider&gt;,
  this.mountPoint
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about authentication implementation, please refer to the "Authentication" section.</p>
</div>
</div>
<div class="sect5">
<h6 id="_custom_events">Custom events</h6>
<div class="paragraph">
<p>All widgets rely on custom events for communication which is why custom event creation and removal is in each widget, as well as event listener creation. Note that when an event listener is created, it should be when the element is no longer needed.  It should be created in the custom element&#8217;s <code>disconnectedCallback()</code> function.</p>
</div>
<div class="paragraph">
<p>To add more events to listen to the widgets, add the event types to <code>INPUT_EVENT_TYPES</code> object at <code>detailsWidget/src/custom-elements/widgetEventTypes.js</code> which will add it to the listener list (or remove the event by removing the element).</p>
</div>
<div class="paragraph">
<p>For more information about custom events and widget communication, please refer to the section on "Widget communication".</p>
</div>
</div>
<div class="sect5">
<h6 id="_tests_and_mocks">Tests and mocks</h6>
<div class="paragraph">
<p>Each widget has tests written for it. Entando uses <code>react-testing-library</code>, but developers are free to upgrade and use any tool. Tests are kept at <code>detailsWidget/src/components/<em>tests</em></code> and mocks for them are at <code>detailsWidget/src/components/<em>mocks</em></code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_proptypes">PropTypes</h6>
<div class="paragraph">
<p>PropTypes for data used across several components are shared - you can see and modify them at <code>detailsWidget/src/components/<em>types</em></code>. This way you can avoid repeating same propTypes in each component and just import shared ones</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">import React from 'react';
import conferenceType from 'components/__types__/conference';

const ConferenceDetails = props =&gt; {
  // ...
};

ConferenceDetails.propTypes = {
  conference: conferenceType,
  t: PropTypes.func.isRequired,
};

export default ConferenceDetails;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_fetching_data">Fetching data</h6>
<div class="paragraph">
<p>For data fetching from widgets use Fetch API. You can find functions for fetching data at <code>detailsWidget/src/api</code> in different files for different contexts.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_form_widget">Form widget</h5>
<div class="paragraph">
<p>For displaying forms within a widget use <a href="https://jaredpalmer.com/formik">Formik</a> which helps with form state management. For data validation use <a href="https://github.com/jquense/yup">Yup</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_entando_component_repository">1.4. Entando Component Repository</h3>
<div class="sect3">
<h4 id="_entando_component_repository_overview">1.4.1. Entando Component Repository Overview</h4>
<div class="sect4">
<h5 id="_introduction">Introduction</h5>
<div class="paragraph">
<p>The Entando Component Repository (ECR) is meant to be a repository to share reusable components
among different Entando instances.</p>
</div>
<div class="paragraph">
<p>The following glossary relates to the ECR and related concepts:</p>
</div>
</div>
<div class="sect4">
<h5 id="_entando_component_repository_glossary">Entando Component Repository Glossary</h5>
<div class="sect5">
<h6 id="_component">Component</h6>
<div class="paragraph">
<p>An Entando component - simply referred to as component - is a piece of reusable code/resource to be used in an Entando widget, page or application. Examples of components are widgets, microfrontends, content-types, labels, plugins, and static resources</p>
</div>
</div>
<div class="sect5">
<h6 id="_ecr_bundle">ECR Bundle</h6>
<div class="paragraph">
<p>An ECR bundle - is a package containing one or more components and a 'descriptor.yaml' file providing information about the bundle.
The bundle is published on an NPM registry and is shared with an Entando application using the EntandoDeBundle custom resource.</p>
</div>
</div>
<div class="sect5">
<h6 id="_entandodebundle_custom_resource">EntandoDeBundle custom resource</h6>
<div class="paragraph">
<p>The EntandoDeBundle custom resource is a Kubernetes custom resource readable by the Entando6 operator. It&#8217;s used to provide information about an ECR bundle and make the bundle available in kubernetes for the entando-component-manager.</p>
</div>
</div>
<div class="sect5">
<h6 id="_entando_component_manager">Entando-component-manager</h6>
<div class="paragraph">
<p>The entando-component-manager - a.k.a component-manager is part of the Entando6 app and dialogs both with the Kubernetes cluster via the entando-k8s-service and with the entando-core.
The entando-component-manager reads the bundles from the cluster and exposes them via an API accessible from AppBuilder. The component-manager is also responsible of the installation/removal of components from entando-core</p>
</div>
</div>
<div class="sect5">
<h6 id="_entando_k8s_service">Entando-K8S-service</h6>
<div class="paragraph">
<p>The Entando-K8S-Service is part of the Entando infrastructure and is responsible for the low-level communication with the K8S cluster API.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_architecture_overview">Architecture overview</h5>
<div class="imageblock">
<div class="content">
<img src="images/digital-exchange-architecture.png" alt="Digital-Exchange Architecture">
</div>
</div>
<div class="paragraph">
<p>From an architectural point of view, the ECR is composed of
1. The EntandoDeBundles which contain the metadata associated with a bundle
2. The Entando-k8s-service which reads the bundles from the cluster/namspace(s) and serves them via a consumable API
3. The Component-manager which creates the connection between the EntandoApp and the K8S-service.</p>
</div>
</div>
<div class="sect4">
<h5 id="_example_of_an_ecr_flow">Example of an ECR flow:</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The user lands on the ECR page in app-builder and wants to see the list of bundles shared with that EntandoApp</p>
</li>
<li>
<p>AppBuilder asks the component-manager for the list of available bundles</p>
</li>
<li>
<p>Component-manager queries the k8s-service to get the available bundles</p>
</li>
<li>
<p>The k8s-service queries the cluster/namespace(s) it is able to read from for available bundles and returns the list to the component-manager</p>
</li>
<li>
<p>Component-manager returns a list to App-Builder</p>
</li>
<li>
<p>The user is able to see the available bundles and is able to install one or more of them</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_ecre_bundle_and_component_details">ECRe bundle and component details</h5>
<div class="paragraph">
<p>In order for the entando-component-manager to read the content of a bundle and install components, a <code>descriptor.yaml</code> file is required at the root of the bundle package.</p>
</div>
<div class="paragraph">
<p>Here is a generic bundle structure</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>.
â”œ descriptor.yaml
â”œ resources/
â”‚ â”” ...
â”” ... (folders reported in descriptor.yaml file)</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="_bundle_convensions">Bundle convensions</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The bundle descriptor file needs to be named <code>descriptor.yaml</code> otherwise the bundle will not be recognized.</p>
</li>
<li>
<p>Static resources are not defined in the <code>descriptor.yaml</code> file as they are by default read from a <code>resources</code> folder. If you need to install static resources, please follow the following convention.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_descriptor_file">Descriptor File</h6>
<div class="paragraph">
<p>The descriptor file will aggregate all components inside and has the following structure.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Remember the file needs to be named <code>descriptor.yaml</code>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Descriptor.yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">code: survey_bundle # The bundle ID
description: This is the survey bundle # The description of the bundle

components: # All components will be here

  # Optional. Use if the component requires a deployment
  plugins:
    - folder/you/want/my_plugin_descriptor.yaml
    - folder/you/want/another_plugin_descriptor.yaml

  # To create widgets you will need to add references to the descriptor file's
  widgets:
    - widgets/my_widget_descriptor.yaml
    - widgets/another_widget_descriptor.yaml

  # To create fragments, you will need to add references to the descriptor file's
  fragments:
    - fragments/my_fragment.yaml

  # To create Page Models you will need to add references to the descriptor file's
  pageModels:
    - pagemodels/my_page_model_descriptor.yaml
    - pagemodels/another_page_model_descriptor.yaml

  # To create Content Types you will need to add references to the descriptor file's
  contentTypes:
    - contenttypes/my_content_type_descriptor.yaml

  # To create Content Models you will need to add references to the descriptor file's
  contentModels:
    - contentmodels/my_content_model_descriptor.yaml
    - contentmodels/another_content_model_descriptor.yaml

  # Labels on the system
  labels:
    - key: HELLO # This is the label identifier
      titles: # The titles on the label
        it: Mio Titolo # The title in Italian
        en: My Title # The title in English</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_plugin_descriptor">Plugin Descriptor</h6>
<div class="paragraph">
<p>A plugin should be described using the [EntandoPlugin CustomResource format](<a href="https://github.com/entando-k8s/entando-k8s-custom-model/blob/master/src/main/resources/crd/EntandoPluginCRD.yaml" class="bare">https://github.com/entando-k8s/entando-k8s-custom-model/blob/master/src/main/resources/crd/EntandoPluginCRD.yaml</a>).</p>
</div>
<div class="paragraph">
<p>Here is an example, but check the CRD for details on the available fields.</p>
</div>
<div class="listingblock">
<div class="title">Plugin descriptor.yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">kind: "EntandoPlugin"
apiVersion: "entando.org/v1alpha1"
metadata:
  name: "my-plugin"
spec:
  image: "my-image"
  replicas: 1
  dbms: "postgresql"
  roles:
    - name: "task-list"
      code: "task-list"
    - name: "task-get"
      code: "task-get"
    - name: "connection-list"
      code: "connection-list"
    - name: "connection-get"
      code: "connection-get"
    - name: "connection-create"
      code: "connection-create"
    - name: "connection-delete"
      code: "connection-delete"
    - name: "connection-edit"
      code: "connection-edit"
  permissions: []
  parameters: {}
  ingressPath: "/myPath"
  healthCheckPath: "/actuator/health"
  securityLevel: "strict"
  connectionConfigNames: []</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_widget_descriptor">Widget Descriptor</h6>
<div class="paragraph">
<p>Here is an example of a widget descriptor</p>
</div>
<div class="listingblock">
<div class="title">Widget descriptor.yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">code: another_todomvc_widget # The Widget identification

titles: # Widget's Titles
  en: TODO MVC Widget # Title in English
  it: TODO MVC Widget # Title in Italian

group: free # The owner group of the widget

# Optional. The UI Path, the widget.ftl file will have the customUi content
customUiPath: widget.ftl

# Optional. The Custom UI
customUi: &gt;-
    &lt;h1&gt;My custom widget UI&lt;/h1&gt;

# Optional. ConfigUI
configUi:
  customElement: todomvc-config # The name of the custom-element used to render the configUI
  resources:
    - &lt;bundleid&gt;/static/js/main.js # The resources necessary to the custom element to render the configUI, like the code</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_fragment_descriptor">Fragment Descriptor</h6>
<div class="listingblock">
<div class="title">Fragment descriptor.yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">code: my-fragment # The fragment identification

# Optional. The fragment content
guiCode &gt;-
  "&lt;div&gt;Here the content&lt;/div&gt;"

# Optional. The GuiCode Path, the fragment.ftl file will have the guiCde conent in it
guiCodePath: fragment.ftl</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_page_model_descriptor">Page Model Descriptor</h6>
<div class="listingblock">
<div class="title">Page model descriptor.yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">code: todomvc_page_model # The Page Model identification
description: TODO MVC basic page model # The Page Model description

titles: # Page Model's Titles
  en: TODO MVC PageModel # Title in English
  it: TODO MVC PageModel # Title in Italian

# The Page Model configuration
configuration:
  frames: # All frames
    - pos: 0 # Frame position
      description: Header # Frame description
      sketch: # Frame sketch configuration
        x1: 0
        y1: 0
        x2: 11
        y2: 0

    # A simplified way to define a Frame
    - pos: 1
      description: Breadcrumb
      sketch: { x1: 0, y1: 1, x2: 11, y2: 1 }

# Optional. Define the Page Model Template in a separate file or inside the descriptor file with `template`
templatePath: page.ftl

# Optional. Define the Page Model Template this way or in a separate file with `templatePath`
template: &gt;-
  &lt;#assign wp=JspTaglibs[\"/aps-core\"]&gt;
  &lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\"&gt;
  &lt;html&gt;
      &lt;head&gt;
          &lt;title&gt;&lt;@wp.currentPage param=\"title\" /&gt;&lt;/title&gt;
      &lt;/head&gt;
      &lt;body&gt;
          &lt;h1&gt;&lt;@wp.currentPage param=\"title\" /&gt;&lt;/h1&gt;
          &lt;a href=\"&lt;@wp.url page=\"homepage\"/&gt;\"&gt;Home&lt;/a&gt;&lt;br&gt;
          &lt;div&gt;
              &lt;h1&gt;Bundle 1 Page Model&lt;/h1&gt;
              &lt;@wp.show frame=0 /&gt;
          &lt;/div&gt;
      &lt;/body&gt;
  &lt;/html&gt;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_content_type_descriptor">Content Type Descriptor</h6>
<div class="paragraph">
<p>For more details on the properties, refer to the Content Type documentation.</p>
</div>
<div class="listingblock">
<div class="title">Content-type descriptor.yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">code: CNG
name: Demo
status: 0

attributes:
  - code: title
    type: Text
    name: Title
    roles:
      - code: jacms:title
        descr: The main title of a Content
    disablingCodes: []
    mandatory: true
    listFilter: false
    indexable: false

    enumeratorStaticItems: string
    enumeratorStaticItemsSeparator: string
    enumeratorExtractorBean: string

    validationRules:
      minLength: 0
      maxLength: 100
      regex: string
      rangeStartString: string
      rangeEndString: string
      rangeStartStringAttribute: string
      rangeEndStringAttribute: string
      equalString: string
      equalStringAttribute: string
      rangeStartDate: string
      rangeEndDate: string
      rangeStartDateAttribute: string
      rangeEndDateAttribute: string
      equalDate: string
      equalDateAttribute: string
      rangeStartNumber: 0
      rangeStartNumberAttribute: string
      rangeEndNumber: 0
      rangeEndNumberAttribute: string
      equalNumber: 0
      equalNumberAttribute:
      ognlValidation:
        applyOnlyToFilledAttr: false
        errorMessage: Something
        keyForErrorMessage: some
        keyForHelpMessage: thing
        ognlExpression: string</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_content_model_descriptor">Content Model Descriptor</h6>
<div class="listingblock">
<div class="title">Content-model descriptor.yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">id: 8880003
contentType: CNG
description: Demo Content Model

# Optional. Define the Content Model Shape in a separate file or inside descriptor file with `contentShape`
contentShapePath:

# Optional. Define the Content Model Shape this way or in a separate file with `contentShapePath`
contentShape: &gt;-
  &lt;article&gt;
  	&lt;h1&gt;$content.Title.text&lt;/h1&gt;
  	&lt;h2&gt;Demo content model&lt;/h2&gt;
  	#if ( $content.MainBody.text != "" )
  	$content.MainBody.text
  	#end
  &lt;/article&gt;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_static_files">Static Files</h6>
<div class="paragraph">
<p>In order to upload static files, you will need to create a folder called <code>resources/</code>, all files inside this folder will be uploaded in the same folder structure that is inside.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>resources/
â”œ css/
â”‚ â”” styles.css
â”œ js/
â”‚ â”” script.css
â”œ images/
â”‚ â”œ favicon.ico
â”‚ â”” logo.png
â”” page.html</pre>
</div>
</div>
<div class="paragraph">
<p>On the structure mentioned above, the resulting files in the Entando architecture will be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>yourbundleid/
â”œ css/
â”‚ â”” styles.css
â”œ js/
â”‚ â”” script.js
â”œ images/
â”‚ â”œ favicon.ico
â”‚ â”” logo.png
â”” page.html</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<code>yourbundleid</code> is the <code>code</code> property inside <code>descriptor.yaml</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>So if you need to use the file in a widget or page model, use this FTL tag <code>&lt;@wp.resourceURL /&gt;</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;img src="&lt;@wp.resourceURL /&gt;yourbundleid/images/logo.png"&gt;
&lt;link rel="stylesheet" href="&lt;@wp.resourceURL /&gt;yourbundleid/css/styles.css"&gt;
&lt;link rel="shortcut icon" href="&lt;@wp.resourceURL /&gt;yourbundleid/images/favicon.ico" type="image/x-icon"/&gt;
&lt;script type="application/javascript" src="&lt;@wp.resourceURL /&gt;yourbundleid/js/script.js"&gt;&lt;/script&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_create_a_local_npm_registry_for_testing">1.4.2. Create a local NPM registry for testing</h4>
<div class="paragraph">
<p>As a registry you can use whatever technology you prefer. Some examples are the [NPM official registry](<a href="https://npmjs.org" class="bare">https://npmjs.org</a>), [Verdaccio](<a href="https://github.com/verdaccio/verdaccio" class="bare">https://github.com/verdaccio/verdaccio</a>) or [Nexus](<a href="https://github.com/sonatype/nexus-public" class="bare">https://github.com/sonatype/nexus-public</a>)</p>
</div>
<div class="paragraph">
<p>For development purposes, let&#8217;s start a local Nexus repository and set it up as NPM registry</p>
</div>
<div class="sect4">
<h5 id="_start_local_nexus_as_a_docker_container">Start local nexus as a docker container</h5>
<div class="paragraph">
<p>Start by creating a volume to host all the data you will build in nexus. This is useful
to save the content even if you will remove the docker container. You can follow two different
approaches here:
1. You create a docker volume and mount it (that&#8217;s the sonatype recommanded approach)
2. You create a folder, change the modification to 777 and use that as a volume</p>
</div>
<div class="paragraph">
<p>By following the first approach, here are the commands you will need to issue in order to run Nexus as a docker container using the docker command</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>docker volume create --name nexus-data
docker run -d -p 8081:8081 --name nexus -v nexus-data:/nexus-data sonatype/nexus3</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the second approach, create a directory (e.g. <code>nexus-data</code>) and set the own to UID 200</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>mkdir nexus-data &amp;&amp; chown -R 200:200 nexus-data
docker run -d -p 8081:8081 --name nexus -v "$(pwd)/nexus-data":/nexus-data sonatype/nexus3</code></pre>
</div>
</div>
<div class="paragraph">
<p>Nexus should be available at your localhost at  port 8081</p>
</div>
<div class="paragraph">
<p>Now you need to sign-in as an admin to configure Nexus and make it usable as a private npm repository. To do so, you need to get the admin credential from inside the container.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>docker exec -it nexus cat /nexus-data/admin.password</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you can use the password to access your private nexus instance as an admin and change the admin password to something easier for you to work with.</p>
</div>
</div>
<div class="sect4">
<h5 id="_setup_a_private_npm_registry">Setup a private npm registry</h5>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>NOTE</strong>: Nexus allows you to setup both a private registry and a proxy to an external registry.
For development purposes, having only a private registry could make sense in order to retrieve only local modules and not modules available on remote registries, though feel free to setup also a proxy if you want to get access to npm modules outside of the private registry.
Check out the [documentation](<a href="https://help.sonatype.com/repomanager3/formats/npm-registry==NpmRegistry-ProxyingnpmRegistries" class="bare">https://help.sonatype.com/repomanager3/formats/npm-registry==NpmRegistry-ProxyingnpmRegistries</a>) on nexus website for further details.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>To setup a  local repository:
1. Go to the <code>Server administration and configuration</code> page
2. Go to repositories
3. Create a new repository
4. Choose the <strong>npm (hosted)</strong>
5. Provide a name and save</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>NOTE</strong>: If you want you can also create a group repository to support search from multiple sources (local/proxies) at the same time.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect4">
<h5 id="_setup_npm_realm_and_user_for_publishing">Setup npm-realm and user for publishing</h5>
<div class="paragraph">
<p>In order to be able to login and publish into a repository you need to
1. Create a role to enable user publishing
2. Create a user and assign roles to them
3. Enable the NPM realm to support <code>npm adduser</code> or <code>npm login</code> commands</p>
</div>
</div>
<div class="sect4">
<h5 id="_create_the_role">Create the role</h5>
<div class="ulist">
<ul>
<li>
<p>Go to <code>Security &gt; Roles &gt; Create role &gt; Nexus Role</code></p>
</li>
<li>
<p>Choose a role ID and name</p>
</li>
<li>
<p>In the privileges, add the one required for publishing, e.g. <code>nx-repository-view-npm-&lt;your-repo&gt;-*</code></p>
</li>
<li>
<p>Save</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_create_the_user">Create the user</h5>
<div class="ulist">
<ul>
<li>
<p>Go to <code>Security &gt; Users &gt; Create local user</code></p>
</li>
<li>
<p>Add the relevant informations for your user, set the user <code>Active</code> and add the role you created in the previous step</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_enable_npm_realm_to_support_npm_adduser_or_npm_login">Enable npm realm to support <code>npm adduser</code> or <code>npm login</code></h5>
<div class="ulist">
<ul>
<li>
<p>Go to <code>Security &gt; Realms</code></p>
</li>
<li>
<p>Add <code>the npm Bearer Token Realm</code> to the active column</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_configure_npm">Configure NPM</h5>

</div>
<div class="sect4">
<h5 id="_config_npm_to_use_the_local_repository">Config npm to use the local repository</h5>
<div class="paragraph">
<p>In order to use the private repository as default repository you need to configure npm accordingly (or use the <code>--registry=</code> option with all your commands)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>npm config set registry http://localhost:8081/repository/&lt;repo-name&gt;/</code></pre>
</div>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Note A</strong>: The trailing slash at the end of the repository is required for the repository to work</p>
</div>
</blockquote>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Note B</strong>: This repository will be used for all the npm methods, so bare in mind that changing the global repository will potentially break other projects. If you want to avoid this, continue to use the <code>--registry</code> option.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect4">
<h5 id="_login_to_the_registry">Login to the registry</h5>
<div class="paragraph">
<p>You should be able to login to the registry using the login command</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>npm login --registry=http://localhost:8081/repository/&lt;repo-name&gt;/</code></pre>
</div>
</div>
<hr>
</div>
<div class="sect4">
<h5 id="_good_to_go">Good to go</h5>
<div class="paragraph">
<p>You can now publish your own npm modules to the private registry
using the `npm publish --registry=http://localhost:8081/repository/&lt;repo-name&gt;/`command.</p>
</div>
</div>
<div class="sect4">
<h5 id="_set_the_publish_repository_at_package_json_level">Set the publish repository at package.json level</h5>
<div class="paragraph">
<p>In your npm module you can also add to the <code>package.json</code> an entry to
make the private repository the default for publishing. Add this to your package.json file</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>  "publishConfig": {
    "registry": "http://localhost:8081/repository/&lt;repo-name&gt;/"
  }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_tutorial_how_to_create_a_digital_exchange_bundle">1.4.3. Tutorial: How to create a digital-exchange bundle</h4>
<div class="sect4">
<h5 id="_purpose">Purpose</h5>
<div class="paragraph">
<p>Generate a simple Entando Component Repository (ECR) bundle shareable in an Entando 6 environment</p>
</div>
</div>
<div class="sect4">
<h5 id="_requirements">Requirements</h5>
<div class="paragraph">
<p>You can create the bundle using you favorite text/code editor.
To share the bundle you will need:
1. Node/NPM
2. An NPM registry where to upload the bundle
3. A K8S cluster where to upload the bundle (e.g. minikube, microk8s,minishift) configured correctly for Entando 6
4. A namespace in the cluster reachable from the operator and entando-k8s-service
5. The <code>entando-bundle-cli</code> command-line tool to generate the necessary metadata to share the bundle in a Kubernetes cluster</p>
</div>
</div>
<div class="sect4">
<h5 id="_steps_2">Steps</h5>
<div class="sect5">
<h6 id="_1_create_a_bundle_folder">1. Create a bundle folder</h6>
<div class="paragraph">
<p>To start, let&#8217;s create a new folder to host your bundle.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mkdir example-bundle &amp;&amp; cd example-bundle</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_2_add_a_descriptor_yaml_file">2. Add a descriptor.yaml file</h6>
<div class="paragraph">
<p>For a bundle to be readable by the ECR it will need at least a <code>descriptor.yaml</code> file in the folder. Let&#8217;s create it with some minimal information.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>vim descriptor.yaml</pre>
</div>
</div>
<div class="paragraph">
<p>Here is some content for your base descriptor.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>code: example-bundle
description: This is an example of an Entando 6 bundle

components:</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_3_add_a_simple_component_to_the_bundle">3. Add a simple component to the bundle</h6>
<div class="paragraph">
<p>This bundle will contains only a simple widget.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s first create the widget metadata in a dedicated folder.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mkdir widgets

vim widgets/example-widget.yaml</pre>
</div>
</div>
<div class="paragraph">
<p>Now let&#8217;s populate the <code>example-widget.yaml</code> metadata with some content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>code: example-widget
titles:
  en: Example Widget
  it: Widget d'esempio
group: free
customUi: &lt;h2&gt;Hi from Example Widget&lt;/h2&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Finally, add a reference to this widget in the bundle <code>descriptor.yaml</code> file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>code: example-bundle
description: This is an example of a Entando 6 bundle

components:
    widgets:
        - widgets/example-widget.yaml</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_4_make_the_bundle_an_npm_module_to_be_hostable_on_an_npm_registry">4. Make the bundle an NPM module to be hostable on an NPM registry.</h6>
<div class="paragraph">
<p>From the bundle root, initialize a <code>package.json</code> file</p>
</div>
<div class="listingblock">
<div class="content">
<pre>npm init</pre>
</div>
</div>
<div class="paragraph">
<p>Follow the instructions on screen.  Here is an example of a possible <code>package.json</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "name": "example-bundle",
  "version": "1.0.0",
  "description": "An example of an Entando6 bundle",
  "license": "LGPL-2.1",
  "main": "descriptor.yaml",
  "keywords": [
    "entando6",
    "digital-exchange",
    "entando-de-bundle"
  ]
}</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Try to keep the name of the published bundle the same as the bundle code in the descriptor.yaml file to avoid confusion.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="_5_publish_the_bundle_on_an_npm_registry">5. Publish the bundle on an NPM registry</h6>
<div class="paragraph">
<p>Now your bundle is ready to be published on an NPM registry.</p>
</div>
<div class="paragraph">
<p>From the root of the bundle (where the package.json and descriptor.yaml files are) you can issue an <code>npm publish</code> command.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
It would be ideal to have a private npm registry to upload this into. Check the <a href="#resources">resources section</a> for more details;
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>npm publish --registry=&lt;your-registry&gt;</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_6_create_the_entandodebundle_custom_resource_for_kubernetes">6. Create the EntandoDeBundle custom resource for Kubernetes.</h6>
<div class="paragraph">
<p>Assuming the "entando-bundle-cli" commandline utility is already installed and available globally on your system, you can now convert the module into an EntandoDeBundle K8S custom resource.
We assume you have a namespace in a Kubernetes cluster which is readable from the Entando Operator and you have the permissions to create resources there. Let&#8217;s call this namespace <code>accessible-ns</code></p>
</div>
<div class="paragraph">
<p>You can also provide a thumbnail for your bundle. Let&#8217;s use an image available in the <a href="https://github.com/entando-k8s/entando-sample-bundle">entando-sample-bundle</a> repository.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>entando-bundle generate @entando/example-bundle --name=example-bundle --namespace=accessible-ns --thumbnail-url=https://raw.githubusercontent.com/entando-k8s/entando-sample-bundle/master/example/survey-bundle/example-bundle.jpg --dry-run &gt; example-bundle.yaml</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_7_upload_the_bundle_to_kubernetes">7. Upload the bundle to Kubernetes.</h6>
<div class="paragraph">
<p>Now you simply need to upload the bundle into Kubernetes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>kubectl create -f example-bundle.yaml</pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_conclusion">Conclusion</h5>
<div class="paragraph">
<p>You should now have the bundle available in your cluster and accessible from the App Builder.</p>
</div>
</div>
<div class="sect4">
<h5 id="resources">Resources</h5>
<div class="ulist">
<ul>
<li>
<p><a href="../../how-to-create-local-npm-registry.adoc">Setup a local npm registry for testing purposes</a></p>
</li>
<li>
<p><a href="https://github.com/entando-k8s/entando-bundle-cli">Entando Bundle CLI project</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_from_blueprint_to_the_entando_component_repository_ecr_bundle">1.4.4. From Blueprint to the Entando Component Repository (ECR) bundle</h4>

</div>
<div class="sect3">
<h4 id="_purpose_2">1.4.5. Purpose</h4>
<div class="paragraph">
<p>In this tutorial you will learn how to generate an ECR bundle from a microservice generated using the JHipster&#8217;s Entando Blueprint.</p>
</div>
</div>
<div class="sect3">
<h4 id="_requirements_2">1.4.6. Requirements</h4>
<div class="ulist">
<ul>
<li>
<p>A microservice built with the Entando Blueprint</p>
</li>
<li>
<p>Node and NPM are installed on your machine</p>
</li>
<li>
<p>An NPM registry where to upload the bundle (must be logged in)</p>
</li>
<li>
<p>Docker installed on your machine and you are able to upload images to docker-hub</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_3">1.4.7. Steps</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In this tutorial we will assume you have generated at least an entity for your microservice.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_1_generate_an_entity">1. Generate an entity</h5>
<div class="paragraph">
<p>In order to include auto-generated micro frontends to your bundle you will need to use the <code>jhispter entity</code> generator. Let&#8217;s assume we want to generate a simple <em>Conference</em> entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>jhipster entity conference</pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s use these options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One field of type <code>String</code> called <code>name</code> with no validation</p>
</li>
<li>
<p>No relationships with other entities</p>
</li>
<li>
<p>REST controller should use the repository directly</p>
</li>
<li>
<p>No pagination for the entity</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_2_populate_the_bundle_with_the_micro_frontends">2. Populate the bundle with the micro frontends</h5>
<div class="paragraph">
<p>To populate the bundle with the generated micro frontends, run the <code>./buildBundle.sh</code> script or use the npm.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>npm run populate-bundle</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
The bundle population with the micro frontends requires some time to be processed.  You should be able to follow the progress
of the operation on screen.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_3_generate_a_docker_image_for_your_microservice">3. Generate a docker image for your microservice</h5>
<div class="paragraph">
<p>JHipster uses the JIB Maven plugin to generate a docker image for your microservice.</p>
</div>
<div class="paragraph">
<p>By default the output image will use the name of your application and the <code>0.0.1-SNAPSHOT</code> tag, eg. <code>entando/jhipster@0.0.1-SNAPSHOT</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>./mvnw -Pprod clean package jib:dockerBuild [-Djib.to.image=&lt;your-image-name]</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
By default, the organization used for the image is <code>entando</code> but you can simply change it in the <code>pom.xml</code> file or by providing the <code>-Djib.to.image=&lt;org&gt;/&lt;name&gt;:&lt;version&gt;</code> to the jib:dockerBuild command.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Output image name is controlled in the <code>pom.xml</code> file but could also be customized in the <code>./mvnw</code> command using the <code>-Djib.to.image</code> parameter.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
If you change the target image of the docker build, remember to update the plugin metadata in the bundle accordingly.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_4_publish_the_docker_image_to_docker_registry_dockerhub_or_equivalent">4. Publish the Docker image to Docker registry (DockerHub or equivalent)</h5>
<div class="paragraph">
<p>Let&#8217;s now publish the docker image for the microservice to make it available later during bundle installation in the cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>docker push &lt;name-of-the-image:tag&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_5_publish_the_bundle_to_an_npm_registry">5. Publish the bundle to an Npm registry</h5>
<div class="paragraph">
<p>Now let&#8217;s publish the bundle to your private NPM registry.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>cd bundle/

npm publish . --registry=&lt;your-private-registry-url&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_6_generate_the_entandodebundle_kubernetes_custom_resource">6. Generate the EntandoDeBundle Kubernetes custom resource</h5>
<div class="paragraph">
<p>You should now be able to generate an EntandoDeBundle custom resource using the <code>entando-bundle</code> command-line tool.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Make sure both the NPM registry where you published the bundle and the Docker registry where you published the docker image are accessbile in read mode without restrictions.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>entando-bundle generate &lt;your-bundle-name&gt; --dry-run --registry=&lt;your-private-registry&gt; [--name=&lt;custom-name&gt;] [--namespace=&lt;namespace-to-deploy&gt;] &gt; jhipster-bundle.yaml</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_7_deploy_the_entandodebundle_custom_resource_on_the_cluster">7. Deploy the EntandoDeBundle custom resource on the cluster</h5>
<div class="paragraph">
<p>Finally, let&#8217;s deploy the previously generated custom resource on the kubernetes/openshift cluster</p>
</div>
<div class="listingblock">
<div class="content">
<pre>kubectl create -f jhipster-bundle.yaml</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conclusion_2">1.4.8. Conclusion</h4>
<div class="paragraph">
<p>You should now have the bundle available in your cluster and accessible from App Builder.</p>
</div>
</div>
<div class="sect3">
<h4 id="_resources">1.4.9. Resources</h4>
<div class="ulist">
<ul>
<li>
<p><a href="../../how-to-create-local-npm-registry.adoc">Setup a local npm registry for testing purposes</a></p>
</li>
<li>
<p><a href="https://github.com/entando-k8s/entando-bundle-cli">Entando Bundle CLI project</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-blueprint">Entando blueprint</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_blueprint">1.5. Blueprint</h3>
<div class="sect3">
<h4 id="_objective">1.5.1. Objective</h4>
<div class="paragraph">
<p>The objective of this lab is to briefly introduce the Entand JHipster Blueprint and to provide an introduction to using the blueprint to generate a microservice and micro-frontends for deployment into an Entando application.</p>
</div>
<div class="sect4">
<h5 id="_prerequisites_2">Prerequisites</h5>
<div class="ulist">
<ul>
<li>
<p>Java 1.8</p>
</li>
<li>
<p>Maven 3.0.5+</p>
</li>
<li>
<p>npm 6+</p>
</li>
<li>
<p>git</p>
</li>
<li>
<p>Docker</p>
</li>
<li>
<p>node 10+ (or LTS)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_setup_for_blueprint_dev_mode">Setup for Blueprint Dev mode</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install JHipster
<code>npm install -g generator-jhipster</code></p>
</li>
<li>
<p>Clone the entando blueprint  project to a location of your choice
<code>git clone <a href="https://github.com/entando/entando-blueprint" class="bare">https://github.com/entando/entando-blueprint</a></code></p>
</li>
<li>
<p>On a command line enter the entando-blueprint directory just cloned and run this command
<code>npm link</code></p>
</li>
<li>
<p>Create a new empty directory in a location of your choice outside of existing projects.
Don&#8217;t create this inside the entando-blueprint project</p>
<div class="ulist">
<ul>
<li>
<p>This will be the directory where you create your plugin.</p>
</li>
<li>
<p>It is important that the commands below are run in the directory you are creating</p>
</li>
</ul>
</div>
</li>
<li>
<p>On a command line change into the directory that you just created and run
<code>npm link generator-jhipster-entando</code></p>
</li>
<li>
<p>Create a plugin using the blueprint. Run the following command
<code>jhipster --blueprints entando</code></p>
</li>
<li>
<p>Select the following options (if nothing is specified in this list you can choose any available option</p>
<div class="ulist">
<ul>
<li>
<p>Microservice application</p>
</li>
<li>
<p>Name of application: training (Or whatever you want)</p>
</li>
<li>
<p>Port: 8081</p>
</li>
<li>
<p>Default package: com.entando (or whatever you want)</p>
</li>
<li>
<p>SQL</p>
</li>
<li>
<p>MySQL or Postgres</p>
</li>
<li>
<p>H2 with disk based persistence</p>
</li>
<li>
<p>Yes, with the Caffeine implementation</p>
</li>
<li>
<p>2nd level cache: Yes</p>
</li>
<li>
<p>Maven</p>
</li>
<li>
<p>Do not select any other technologies</p>
</li>
<li>
<p>Accept the provided suggetion for the bundle name</p>
</li>
<li>
<p>i18n: Yes</p>
</li>
<li>
<p>Pick a default language</p>
</li>
<li>
<p>Pick other languages you want</p>
</li>
<li>
<p>Donâ€™t add any other testing frameworks</p>
</li>
<li>
<p>No other generators from the marketplace</p>
</li>
</ul>
</div>
</li>
<li>
<p>Adding an Entity and Creating the Micro-Frontends. In your new project run the following command
<code>jhipster entity Conference</code></p>
<div class="ulist">
<ul>
<li>
<p>Select Yes for â€œDo you want to add a field to your entityâ€</p>
</li>
<li>
<p>For the name of the field use: conferenceName</p>
</li>
<li>
<p>Select String for type</p>
</li>
<li>
<p>Select No for validation rules</p>
</li>
<li>
<p>Select Yes for â€œDo you want to add a field to your entityâ€</p>
</li>
<li>
<p>For the name of the field use: location</p>
</li>
<li>
<p>Select String for type</p>
</li>
<li>
<p>Select No for validation rules</p>
</li>
<li>
<p>Select No for adding relationships</p>
</li>
<li>
<p>Select No for Do you want to use separate service class for your business logic?</p>
</li>
<li>
<p>You can choose any option you want here</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Repeat the steps above for other entities that you want to add. Also, review the content and documentation around the JHipster Design Language (JDL)
<a href="https://start.jhipster.tech/jdl-studio/" class="bare">https://start.jhipster.tech/jdl-studio/</a></p>
</div>
</div>
<div class="sect4">
<h5 id="_open_the_project_in_an_ide">Open the project in an IDE</h5>
<div class="paragraph">
<p>This section just walks through the anatomy of the project and the Micro-frontends. You can skip this or review later as desired.
The top level project is a normal SpringBoot application. You can look through the code and configuration in src/main/java to get a view of the server side
The micro frontends are in the ui folder. Each entity gets an MFE for details, table, and form</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_core_app">1.6. Core App</h3>
<div class="sect3">
<h4 id="_the_entando_core_apis">1.6.1. The Entando Core APIs</h4>
<div class="sect4">
<h5 id="_prerequisites_3">Prerequisites</h5>
<div class="ulist">
<ul>
<li>
<p>Java 8</p>
</li>
<li>
<p>maven</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_setup">Setup</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clone the Entando sample app if you don&#8217;t already have it.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>git clone https://github.com/entando-k8s/entando-sample-app</code></pre>
</div>
</div>
</li>
<li>
<p>Start the app for local execution and enable the swagger profile by passing <code>-Dspring.profiles.active=swagger</code> to the jetty command. Set the
value of <code>-Djetty.port</code> to something available on your machine e.g. 8081.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code> mvn clean package jetty:run -Pjetty-local -Pderby -Dspring.profiles.active=swagger -Djetty.reload=manual -Djetty.port=[available_port]</code></pre>
</div>
</div>
</li>
<li>
<p>Wait for the app to start.</p>
</li>
<li>
<p>Once started, navigate to the swagger ui in a browser.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>http://localhost:[your port]/entando-sample-app/api/swagger-ui.html</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_overview">Overview</h5>
<div class="paragraph">
<p>The Entando core exposes REST APIs for every action that can be taken in the App
Builder and Admin Console environments. For example, you can use these apis to
create pages, create page models or to add widgets to  pages. The APIs can be
used to support automation, testing, or integrations with external systems.</p>
</div>
<div class="sect5">
<h6 id="_api_structure">API structure</h6>
<div class="paragraph">
<p>All of the APIs share a common top level structure. Each response will contain a top level entry for <code>errors</code>, <code>metadata</code>, and <code>payload</code>.</p>
</div>
<div class="paragraph">
<p>The <code>errors</code> will always contain code and a message string indicating an error condition in the request. The <code>metadata</code> section is
used for paging, sorting, filtering and data that is distinct from the body. The body of each response is included in the <code>payload</code> section of the response
and varies according to each API.</p>
</div>
</div>
<div class="sect5">
<h6 id="_models">Models</h6>
<div class="paragraph">
<p>All of the model classes returned by the Entando core are annotated so that the model definition is included in the swagger documentation. At the bottom of the swagger page
all of the model classes returned by the API endpoints can be found.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tutorial">Tutorial:</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Stop the Entando instance if it is running.</p>
</li>
<li>
<p>In the project open <code>src/main/conf/systemParams.properties</code>.</p>
</li>
<li>
<p>Change the value of this property to reflect the port you are using to run the app.</p>
<div class="ulist">
<ul>
<li>
<p>applicationBaseURL</p>
</li>
<li>
<p>For example if running on 8085 you would have <code>applicationBaseURL=http://localhost:8085/${entando.engine.web.context}/</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Login to the admin console at <a href="http://localhost:8085/entando-sample-app/do/login" class="bare">http://localhost:8085/entando-sample-app/do/login</a>.</p>
</li>
<li>
<p>Once logged in go to Integration -&#8594; API Management -&#8594; Consumers.</p>
</li>
<li>
<p>Select the kebab button on the row labeled swagger.</p>
</li>
<li>
<p>On that screen enable the button for <code>client_credentials</code>.</p>
</li>
<li>
<p>On that screen enter <code>swagger</code> as the value for the secret.</p>
</li>
<li>
<p>Hit save</p>
</li>
<li>
<p>Return to swagger <a href="http://localhost:">your port</a>/entando-sample-app/api/swagger-ui.html</p>
</li>
<li>
<p>Hit authorize</p>
</li>
<li>
<p>Enter</p>
<div class="ulist">
<ul>
<li>
<p>User: admin</p>
</li>
<li>
<p>PW: adminadmin</p>
</li>
<li>
<p>client: swagger</p>
</li>
<li>
<p>client_secret: swagger</p>
</li>
</ul>
</div>
</li>
<li>
<p>Use the <strong>Try it out</strong> button on the APIs</p>
<div class="ulist">
<ul>
<li>
<p>Scroll to <code>widget-controller</code></p>
</li>
<li>
<p>Select the blue GET row</p>
</li>
<li>
<p>Select <strong>Try it out</strong></p>
</li>
<li>
<p>Look at the results in the window</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_adding_a_new_api_to_the_core_app">1.6.2. Adding a new API to the core app</h4>
<div class="sect4">
<h5 id="_prerequisites_4">Prerequisites</h5>
<div class="ulist">
<ul>
<li>
<p>Java 8</p>
</li>
<li>
<p>maven</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_overview_2">Overview</h5>
<div class="paragraph">
<p>This guide will take you through adding a new REST API to the Entando core app.
In some cases it is better to add new APIs to the core rather than creating a new microservice. Some example cases where adding new APIs to the core is recommended are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When extending or adding functionality to the WCMS</p>
</li>
<li>
<p>When you have a simple use case requiring persistence that is specific to only the application you&#8217;re working within</p>
</li>
<li>
<p>When exposing configurations that are needed by the portal-ui during page rendering</p>
</li>
<li>
<p>For small changes that don&#8217;t warrant a full stand-alone microservice</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can  build widgets and micro frontends that take advantage of these APIs in the same way that
your micro-frontends can invoke APIs exposed by other services.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tutorial_2">Tutorial</h5>
<div class="paragraph">
<p>Creating a controller and services</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a new java package in the project using your favorite IDE at the path <code>org.entando.training</code>.</p>
</li>
<li>
<p>Under that package add packages for <code>controllers</code> and <code>services</code>.</p>
</li>
<li>
<p>Create a class called <a href="./demoResources/DemoController.java">DemoController.java</a> from the training package into the controllers package.</p>
<div class="ulist">
<ul>
<li>
<p>This is a normal Spring rest controller and it will be discovered by annotations.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Copy <a href="./demoResources/DemoService.java">DemoService.java</a> from the training package into the services package.</p>
<div class="ulist">
<ul>
<li>
<p>This is a normal Spring service that will be autowired into the controller.
The data in this service is hardcoded but this is where you can wire in external services or other parts of the Entando architecture to fetch the data.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Copy <a href="./demoResources/commonConfig.xml">commonConfig.xml</a> to <code>src/main/resources/spring/aps/managers</code>.</p>
<div class="ulist">
<ul>
<li>
<p>The goal is to enable package scanning for annotation driven spring services. This includes the package scan for your package defined above. If you want to scan another package, then you need to add another path to this file. This is the only spring XML you will need to change if you want to build annotation driven beans in Entando.</p>
</li>
<li>
<p>See also web.xml for deeper details.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Review the code and annotations in the controller to understand how the APIs are protected and integrated.</p>
</li>
<li>
<p><code>@RestAccessControl</code> is a custom Entando annotation that can be used to restrict APIs by role.</p>
<div class="ulist">
<ul>
<li>
<p>The rest of the annotations are normal Spring annotations.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Restart your app using jetty.</p>
<div class="ulist">
<ul>
<li>
<p>if you get an error add the entries below to <code>src/main/conf/systemParams.properties</code> This is temporary</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code># Parameters for Argon2 algorithm encryption
algo.argon2.type=ARGON2i
algo.argon2.hash.length=32
algo.argon2.salt.length=16
algo.argon2.iterations=4
algo.argon2.memory=65536
algo.argon2.parallelism=4
algo.default.key=changeit</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Go to Swagger</p>
</li>
<li>
<p>Find the demo-controller and try your new endpoints out using swagger</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_building_a_docker_image_for_the_entando_core">1.6.3. Building a Docker Image for the Entando Core</h4>
<div class="sect4">
<h5 id="_prerequisites_5">Prerequisites</h5>
<div class="ulist">
<ul>
<li>
<p>Java 8</p>
</li>
<li>
<p>Docker installed locally (<a href="https://docs.docker.com/docker-for-windows/install/" class="bare">https://docs.docker.com/docker-for-windows/install/</a>)</p>
</li>
<li>
<p>maven</p>
</li>
<li>
<p>Access to a docker repository (docker.io or other)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_introduction_2">Introduction</h5>
<div class="paragraph">
<p>This tutorial will take you through the basic steps to create a docker image from an Entando core application.
A more detailed guide with additional commands and configuration can be found here:</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/entando-k8s/entando-sample-app" class="bare">https://github.com/entando-k8s/entando-sample-app</a></p>
</div>
</div>
<div class="sect4">
<h5 id="_setup_2">Setup</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clone the application at: <a href="https://github.com/entando-k8s/entando-sample-app" class="bare">https://github.com/entando-k8s/entando-sample-app</a> using</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>git clone https://github.com/entando-k8s/entando-sample-app</code></pre>
</div>
</div>
</li>
<li>
<p>On a command line, cd into the entando-sample-app you just cloned:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>cd entando-sample-app</code></pre>
</div>
</div>
</li>
<li>
<p>Build a docker image from the core app</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>mvn clean package -Pwildfly -Pderby docker:build</code></pre>
</div>
</div>
</li>
<li>
<p>View the images installed on your local docker instance</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>docker images</code></pre>
</div>
</div>
<div class="paragraph">
<p>Look for</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>entando/entando-sample-app:latest</code></pre>
</div>
</div>
</li>
<li>
<p>Create a repository on your docker repository to house your new application</p>
</li>
<li>
<p>Re-tag the image you just built with your repo</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code> docker tag entando/entando-sample-app:latest [your-user]/[your-repo-name]:latest</code></pre>
</div>
</div>
</li>
<li>
<p>Push the Image to your Repository</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>docker push [your-user]/[your-repo-name]:latest</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_freemarker_tags">1.7. Freemarker Tags</h3>
<div class="paragraph">
<p>This section provides an overview of the tags available for use in the Entando core and in the Entando CMS.</p>
</div>
<div class="sect3">
<h4 id="_aps_core_tag_library">1.7.1. Aps Core Tag Library</h4>
<div class="ulist">
<ul>
<li>
<p>Version: 2.3</p>
</li>
<li>
<p>Short Name: wp</p>
</li>
<li>
<p>URI: /aps-core</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_tag_action">Tag <code>action</code></h5>
<div class="sect5">
<h6 id="_description">Description</h6>
<div class="paragraph">
<p>Build the URL to call a jsp or a functionality of a servlet defined within the system. This tag can use the ParameterTag sub-tag to add url parameters.</p>
</div>
</div>
<div class="sect5">
<h6 id="_example">Example</h6>
<div class="paragraph">
<p><code>(&lt;@wp.action path="/do/my.action" var="myaction" /&gt;)</code> or <code>(&lt;@wp.action path="/JSP/my.jsp" var="my.jsp"/&gt;)</code></p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The relative path of jsp or servlet to invoke, relative to the context of web-application</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page-scoped variable where to place the URL.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.ActionURLTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_categories">Tag <code>categories</code></h5>
<div class="sect5">
<h6 id="_description_2">Description</h6>
<div class="paragraph">
<p>Return the list of the system categories on SelectItem objects.</p>
</div>
</div>
<div class="sect5">
<h6 id="_example_2">Example</h6>
<div class="paragraph">
<p><code>&lt;@wp.categories var="systemCategories" titleStyle="prettyFull" root="$\{userFilterOptionVar.userFilterCategoryCode}" /&gt;</code></p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_2">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">titleStyle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The style of the single select item. Currently it can be 'default' (single title node), 'full' (title with all parents) or 'prettyFull' (title with all parents in form of '..'). The default when none is given is 'default'.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fullTitleSeparator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The separator beetwen the titles when 'titleStyle' is 'full' or 'prettyFull'.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page-scoped variable where to place the list of categories.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">root</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The root of the categories to show. The default is the system root categories</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_2">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.CategoriesTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_checkheadinfoouputter">Tag <code>checkHeadInfoOuputter</code></h5>
<div class="sect5">
<h6 id="_description_3">Description</h6>
<div class="paragraph">
<p>This sub-tag verifies the availability of the information to display. This sub-tag can be used only in a page model, in conjunction with 'outputHeadInfo'.</p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_3">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the type of information to analyse.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_3">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.CheckHeadInfoOutputterTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_cssurl">Tag <code>cssURL</code></h5>
<div class="sect5">
<h6 id="_description_4">Description</h6>
<div class="paragraph">
<p>Extension of the ResourceURL tag. It returns the URL of the css files.</p>
</div>
</div>
<div class="sect5">
<h6 id="_example_3">Example</h6>
<div class="paragraph">
<p><code>&lt;@wp.cssURL /&gt;href="&lt;@wp.cssURL /&gt;myportal.css" /&gt;</code></p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_4">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_4">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.CssURLTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_currentpage">Tag <code>currentPage</code></h5>
<div class="sect5">
<h6 id="_description_5">Description</h6>
<div class="paragraph">
<p>Returns the requested information held by the current page bean.</p>
</div>
</div>
<div class="sect5">
<h6 id="_example_4">Example</h6>
<div class="paragraph">
<p><code>&lt;@wp.currentPage param="code" var="currentViewCode" /&gt;</code></p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_5">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The wanted parameter: actually can be either "title", "owner" (group), "code", "hasChild" or "childOf" (with attribute "targetPage"). The default when none is given is "title".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">langCode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code of the language to use for the page information being returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page context variable where the information are placed. Please note that the in this case the special characters will not be escaped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">targetPage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Target page when "param" is "childOf".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decides whether to escape the special characters in the information retrieved or not. Value admitted (true, false), the default is true.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_5">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.CurrentPageTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_currentwidget">Tag <code>currentWidget</code></h5>
<div class="sect5">
<h6 id="_description_6">Description</h6>
<div class="paragraph">
<p>Returns information about the widget where the tag resides. To obtain information about a widget placed in a frame other than the current, use the "frame" attribute.</p>
</div>
</div>
<div class="sect5">
<h6 id="_example_5">Example</h6>
<div class="paragraph">
<p><code>&lt;@wp.currentWidget param="config" configParam="name" var="configName" /&gt;</code></p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_6">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The requested parameter. It can assume one of the following values: - "code" returns the code of the associated widget type (empty if none associated) - "title" returns the name of the associated widget type (empty if none associated) - "config" returns the value of the configuration parameter declared in the "configParam" attribute. The default is "title".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">configParam</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the configuration parameter request. This attribute is mandatory when the attribute "param" is set to "config".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page context variable where the requested information is pushed. In this case the special characters will not be escaped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">frame</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Id of the frame hosting the widget with the desired information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Toggles the escape of the special characters. Admitted value are (true, false), the default is "true".</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_6">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.CurrentWidgetTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_fragment">Tag <code>fragment</code></h5>
<div class="sect5">
<h6 id="_description_7">Description</h6>
<div class="paragraph">
<p>Print a gui fragment by the given code.</p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_7">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">code</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The code of the fragment to return.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page context variable where the requested information is pushed. In this case the special characters will not be escaped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Toggles the escape of the special characters. Admitted value are (true, false), the default is "true".</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_7">Tag class</h6>
<div class="paragraph">
<p><code>org.entando.entando.aps.tags.GuiFragmentTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_freemarkertemplateparameter">Tag <code>freemarkerTemplateParameter</code></h5>
<div class="sect5">
<h6 id="_description_8">Description</h6>
<div class="paragraph">
<p>Add a parameter into the Freemarker&#8217;s TemplateModel Map.</p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_8">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the variable where the requested information is pushed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">valueName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the variable of the page context where extract the information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">removeOnEndTag</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to remove the parameter on end of Tag. Possible entries (true, false). Default value: false.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_8">Tag class</h6>
<div class="paragraph">
<p><code>org.entando.entando.aps.tags.FreemarkerTemplateParameterTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_headinfo">Tag <code>headInfo</code></h5>
<div class="sect5">
<h6 id="_description_9">Description</h6>
<div class="paragraph">
<p>Declares the information to insert in the header of the HTML page. The information can be passed as an attribute or, in an indirect manner, through a variable of the page context. It is mandatory to specify the type of the information.</p>
</div>
</div>
<div class="sect5">
<h6 id="_example_6">Example</h6>
<div class="paragraph">
<p><code>&lt;@wp.headInfo type="JS" info="entando-misc-bootstrap/bootstrap.min.js" /&gt;</code></p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_9">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaration of the information type. Currently only "CSS" is currently supported.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Information to declare. This is an alternative of the "var" attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the variable holding the information to declare. This attribute is the alternative of the "info" one. This variable can be used for those types of information that cannot be held by an attribute.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_9">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.HeadInfoTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_i18n">Tag <code>i18n</code></h5>
<div class="sect5">
<h6 id="_description_10">Description</h6>
<div class="paragraph">
<p>Return the string associated to the given key in the specified language. This string is either returned (and rendered) or can be optionally placed in a page context variable. This tag can use the ParameterTag sub-tag to add label parameters.</p>
</div>
</div>
<div class="sect5">
<h6 id="_example_7">Example</h6>
<div class="paragraph">
<p><code>&lt;@wp.i18n key="COPYRIGHT" escapeXml="false" /&gt;</code></p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_10">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key of the label to return.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lang</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code of the language requested for the lable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the variable (page scope) where to store the wanted information. In this case the special characters will not be escaped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Toggles the escape of the special characters of the returned label. Admitted values (true, false), the default is true.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_10">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.I18nTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_ifauthorized">Tag <code>ifauthorized</code></h5>
<div class="sect5">
<h6 id="_description_11">Description</h6>
<div class="paragraph">
<p>Toggles the visibility of the elements contained in its body, depending on user permissions.</p>
</div>
</div>
<div class="sect5">
<h6 id="_example_8">Example</h6>
<div class="paragraph">
<p><code>&lt;@wp.ifauthorized permission="enterBackend"&gt;</code></p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_11">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">permission</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The code of the permission required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">groupName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the group membership required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the (boolean) page context parameter where the result of the authorization check is placed.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_11">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.CheckPermissionTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_imgurl">Tag <code>imgURL</code></h5>
<div class="sect5">
<h6 id="_description_12">Description</h6>
<div class="paragraph">
<p>Extension of the ResourceURL tag. It returns the URL of the images to display as static content outside the cms.</p>
</div>
</div>
<div class="sect5">
<h6 id="_example_9">Example</h6>
<div class="paragraph">
<p><code>&lt;@wp.imgURL /&gt;entando-logo.png" alt="Entando - Access. Build. Connect." /&gt;</code></p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_12">Attributes</h6>

</div>
<div class="sect5">
<h6 id="_tag_class_12">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.ImgURLTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_info">Tag <code>info</code></h5>
<div class="sect5">
<h6 id="_description_13">Description</h6>
<div class="paragraph">
<p>Returns the information of the desired system parameter.</p>
</div>
</div>
<div class="sect5">
<h6 id="_example_10">Example</h6>
<div class="paragraph">
<p><code>&lt;@wp.info key="systemParam" paramName="applicationBaseURL" /&gt;</code></p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_13">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key of the desired system parameter, admitted values are: "startLang" returns the code of start language of web browsing "defaultLang" returns the code of default language "currentLang" returns the code of current language "langs" returns the list of the languages defined in the system "systemParam" returns the value of the system param specified in the "paramName" attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the variable where to store the retrieved information (page scope). In this case the special characters will not be escaped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">paramName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the wanted system parameter; it is mandatory if the "key" attribute is "systemParam", otherwise it is ignored.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Toggles the escape of the special characters in the information returned. Admitted values are (true,false), the former being the default value.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_13">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.InfoTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_internalservlet">Tag <code>internalServlet</code></h5>
<div class="sect5">
<h6 id="_description_14">Description</h6>
<div class="paragraph">
<p>Tag for the "Internal Servlet" functionality. Publishes a function served by an internal Servlet; the servlet is invoked from a path specified in the attribute "actionPath" or by the widget parameter sharing the same name. This tag can be used only in a widgets.</p>
</div>
</div>
<div class="sect5">
<h6 id="_example_11">Example</h6>
<div class="paragraph">
<p><code>&lt;@wp.internalServlet actionPath="/ExtStr2/do/jpuserreg/UserReg/initRegistration" /&gt;</code></p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_14">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">actionPath</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The init action path.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">staticAction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to execute only the given action path. Possible entries (true, false). Default value: false.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_14">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.InternalServletTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_nav">Tag <code>nav</code></h5>
<div class="sect5">
<h6 id="_description_15">Description</h6>
<div class="paragraph">
<p>Generates through successive iterations the so called "navigation" list. For every target/page being iterated (inserted in the page context) are made available the page code, the title (in the current language) and the link. Is it also possible to check whether the target page is empty -that is, with no configured positions- or not.</p>
</div>
</div>
<div class="sect5">
<h6 id="_example_12">Example</h6>
<div class="paragraph">
<p><code>&lt;@wp.nav var="page"&gt;</code></p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_15">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spec</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the set of the pages to generate.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page context variable where the data of target being iterated are made available.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_15">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.NavigatorTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_outputheadinfo">Tag <code>outputHeadInfo</code></h5>
<div class="sect5">
<h6 id="_description_16">Description</h6>
<div class="paragraph">
<p>Iterates over various information in HTML header displaying them; this tag works in conjunction with other specific sub-tags. Please note that the body can contain only a sub-tag, or information, at once. This tag must be used only in a page model. E.g (&lt;@wp.outputHeadInfo type="CSS"&gt;)</p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_16">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the type of information to return, in accordance with the sub-tag to use.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_16">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.HeadInfoOutputterTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_pageinfo">Tag <code>pageInfo</code></h5>
<div class="sect5">
<h6 id="_description_17">Description</h6>
<div class="paragraph">
<p>Returns the information of the specified page. This tag can use the sub-tag "ParameterTag" to add url parameters if the info attribute is set to 'url'.</p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_17">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pageCode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The code of the page.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code of required page parameter. Possible entries: "code" (default value) , "title", "owner" (group), "url", "hasChild" or "childOf" (with attribute "targetPage").</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">langCode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code of the language to use for the returned information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name used to reference the value pushed into the pageContext. In this case, the system will not escape the special characters in the value entered in pageContext.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">targetPage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Target page when "param" is "childOf".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to escape HTML. Possible entries (true, false). Default value: true.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_17">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.PageInfoTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_pager">Tag <code>pager</code></h5>
<div class="sect5">
<h6 id="_description_18">Description</h6>
<div class="paragraph">
<p>List pager.</p>
</div>
</div>
<div class="sect5">
<h6 id="_example_13">Example</h6>
<div class="paragraph">
<p><code>&lt;@wp.pager listName="result" objectName="groupContent" max="10" pagerIdFromFrame="true" advanced="true" offset="5"&gt;</code></p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_18">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum value for each object group.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">listName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the list as found in the request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">objectName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the object currently iterated. The following methods are exposed:&nbsp; getMax, getPrevItem, getNextItem, getCurrItem, getSize, getBegin, getEnd, getMaxItem, getPagerId.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pagerId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the ID of the pager itself, it has to be used when two or more pagers exist in the same page. This attributes overrides "pagerIdFromFrame".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pagerIdFromFrame</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the ID of the pager (mandatory when two or more pagers share the same page) based upon the frame where the tag is placed. Admitted values are (true, false), the latter being the default. Please note that the "pagerId" attribute takes precedence over this one.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">advanced</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Toggles the pager in advanced mode. Admitted values are (true, false). the advanced mode of the tag is used when the list to iterate over is huge.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">offset</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This attribute is considered only when the pager is in advanced mode. This is the numeric value of the single step increment (or decrement) when iterating over the list</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_18">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.PagerTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_parameter">Tag <code>parameter</code></h5>

</div>
<div class="sect4">
<h5 id="_tag_pager_2">Tag <code>pager</code></h5>
<div class="sect5">
<h6 id="_description_19">Description</h6>
<div class="paragraph">
<p>This tag can be used to parameterise other tags. The parameter value can be added through the 'value' attribute or the body tag. When you declare the param tag, the value can be defined in either a value attribute or as text between the start and the ending of the tag.</p>
</div>
</div>
<div class="sect5">
<h6 id="_example_14">Example</h6>
<div class="paragraph">
<p><code>&lt;@wp.parameter name="resourceName"&gt;</code></p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_19">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the parameter.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value of the parameter.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_19">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.ParameterTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_printheadinfo">Tag <code>printHeadInfo</code></h5>
<div class="sect5">
<h6 id="_description_20">Description</h6>
<div class="paragraph">
<p>Returns the information to display. This sub-tag must be used only in a page model, in conjunction with 'outputHeadInfo'.</p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_20">Attributes</h6>

</div>
<div class="sect5">
<h6 id="_tag_class_20">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.HeadInfoPrinterTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_resourceurl">Tag <code>resourceURL</code></h5>
<div class="sect5">
<h6 id="_description_21">Description</h6>
<div class="paragraph">
<p>Returns URL of the resources.</p>
</div>
</div>
<div class="sect5">
<h6 id="_example_15">Example</h6>
<div class="paragraph">
<p><code>&lt;@wp.resourceURL /&gt;static/js/entando-misc-html5-essentials/html5shiv.js"&gt;</code></p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_21">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">root</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the resource root. If not otherwise specified, the value of SystemConstants.PAR_RESOURCES_ROOT_URL is used.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">folder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares a specific directory for the desired resources. Unless specified, the value "" (empty string) is used in the generation of the URL.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_21">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.ResourceURLTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_show">Tag <code>show</code></h5>
<div class="sect5">
<h6 id="_description_22">Description</h6>
<div class="paragraph">
<p>Defines the position of inclusion of a widget. This tag can be used only in a page model.</p>
</div>
</div>
<div class="sect5">
<h6 id="_example_16">Example</h6>
<div class="paragraph">
<p><code>&lt;@wp.show frame="0" /&gt;</code></p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_22">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">frame</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The positional number of the frame, starting from 0.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_22">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.WidgetTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_url">Tag <code>url</code></h5>
<div class="sect5">
<h6 id="_description_23">Description</h6>
<div class="paragraph">
<p>Generates the complete URL of a portal page. The URL returned is either returned (and rendered) or placed in the given variable. To insert parameters in the query string the sub-tag "ParameterTag" is provided.</p>
</div>
</div>
<div class="sect5">
<h6 id="_example_17">Example</h6>
<div class="paragraph">
<p><code>&lt;@wp.url paramRepeat="true" &gt;</code></p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_23">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">page</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code of the destination page. The default is the current page.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lang</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code of the language to use in the destination page.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page-scoped variable where to place the URL.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">paramRepeat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Repeats in the URL all the parameters of the actual request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">excludeParameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the list of parameter names (comma separated) to exclude from repeating. By default, this attribute excludes only the password parameter of the login form. Used only when paramRepeat="true".</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_23">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.URLTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_pagewithwidget">Tag <code>pageWithWidget</code></h5>
<div class="sect5">
<h6 id="_description_24">Description</h6>
<div class="paragraph">
<p>Search and return the page (or the list of pages) with the given widget type. When "filterParamName" and "filterParamValue" attributes are present, the returned list will be filtered by a specific widget configuration.</p>
</div>
</div>
<div class="sect5">
<h6 id="_example_18">Example</h6>
<div class="paragraph">
<p><code>&lt;@wp.pageWithWidget widgetTypeCode="userprofile_editCurrentUser" var="userprofileEditingPageVar" listResult="false" /&gt;</code></p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_24">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attribute_description:</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">widgetTypeCode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The code of the widget to search</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">filterParamName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional widget config param name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">filterParamValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional widget config param value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">listResult</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional, dafault false. When true the result is a list of pages, when false the returned page is the first occurence</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_24">Tag class</h6>
<div class="paragraph">
<p><code>com.agiletec.aps.tags.PageWithWidgetTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_currentuserprofileattribute">Tag <code>currentUserProfileAttribute</code></h5>
<div class="sect5">
<h6 id="_description_25">Description</h6>
<div class="paragraph">
<p>Current User Profile tag. Return a attribute value of the current user profile.</p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_25">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributeName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the name of the attribute from which extract the value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributeRoleName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the name of the attribute role from which extract the value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name used to reference the value pushed into the pageContext.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decides whether to escape the special characters in the information retrieved or not. Value admitted (true, false), the default is true.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_25">Tag class</h6>
<div class="paragraph">
<p><code>org.entando.entando.aps.tags.CurrentUserProfileAttributeTag</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tag_userprofileattribute">Tag <code>userProfileAttribute</code></h5>
<div class="sect5">
<h6 id="_description_26">Description</h6>
<div class="paragraph">
<p>User Profile tag. Return a attribute value from the profile givea an username.</p>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_26">Attributes</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">username</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the username</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributeName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the name of the attribute from which extract the value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributeRoleName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the name of the attribute role from which extract the value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name used to reference the value pushed into the pageContext.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decides whether to escape the special characters in the information retrieved or not. Value admitted (true, false), the default is true.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_tag_class_26">Tag class</h6>
<div class="paragraph">
<p><code>org.entando.entando.aps.tags.UserProfileAttributeTag</code></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_kubernetes_and_operator">1.8. Kubernetes and Operator</h3>
<div class="sect3">
<h4 id="_entando_6_cluster_citizens">1.8.1. Entando 6 cluster citizens</h4>
<div class="sect4">
<h5 id="_purpose_3">Purpose</h5>
<div class="paragraph">
<p>Purpose of this guide is to give an overview of the members of an Entando 6 cluster and their role</p>
</div>
</div>
<div class="sect4">
<h5 id="_prerequisites_6">Prerequisites</h5>
<div class="ulist">
<ul>
<li>
<p>None</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_architecture_diagram">Architecture diagram</h5>
<div class="paragraph">
<p>Let&#8217;s start with a picture of an Entando6 cluster and how the various members interact with each other.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Entando-cluster-overview.png" alt="Entando6 cluster architecture diagram">
</div>
<div class="title">Figure 1. Entando6 cluster architecture diagram</div>
</div>
</div>
<div class="sect4">
<h5 id="_members_of_the_cluster">Members of the cluster</h5>
<div class="paragraph">
<p>An Entando 6 cluster is composed of various citizens which interact with each other. Most of these citizens have a Custom Resource Definition file associated with them and are deployable on Kubernetes using the Entando operator and controllers.</p>
</div>
<div class="sect5">
<h6 id="_entando_app">Entando app</h6>
<div class="paragraph">
<p>An Entando app is composed of three parts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>App Builder</strong>: the replacement for the Admin Console and entry point to customize and build an entando application, as well as providing a method to interact with the Entando Component Repository.</p>
</li>
<li>
<p><strong>Entando core</strong>: the backend APIs providing access to Entando services.</p>
</li>
<li>
<p><strong>Entando component manager</strong>: the service providing the Entando Component Repository functionality, e.g. listing the available bundles, install/uninstall a bundle, etc. Check the <a href="#ecm-section">dedicated section</a> for more details</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The interaction between these three components (and the rest of the Entando cluster) use the authorization/authentication features provided by Keycloak.</p>
</div>
</div>
<div class="sect5">
<h6 id="ecm-section">Entando component manager</h6>
<div class="paragraph">
<p>As briefly introuced before, the Entando component manager is able to list the EntandoDeBundles accessible from the EntandoApp and provide the install/uninstall services to install a bundle on an Entando App. All of these services are made possible by the communication with the Entando Kubernetes service, the only service of the entando ecosystem (other than the operator itself) able to interact with the cluster and some of the Entando custom resources.</p>
</div>
</div>
<div class="sect5">
<h6 id="_entando_kubernetes_service">Entando Kubernetes Service</h6>
<div class="paragraph">
<p>The Entando Kubernetes Service is part of the Entando cluster infrastructure custom resource, and provides an access point to some of the custom resources defined by Entando, in particular:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entando applications</p>
</li>
<li>
<p>Entando plugins</p>
</li>
<li>
<p>Entando links</p>
</li>
<li>
<p>Entando Component Repository bundles</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Some of the main services provided by the Entando Kubernetes Service are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Provide a list of the available EntandoDeBundles to the component-manager</p>
</li>
<li>
<p>Deploy a plugin during the installation of a bundle or discovery of an already available plugin and expose that to an app</p>
</li>
<li>
<p>Create a link between an EntandoApp and an EntandoPlugin to expose the plugin&#8217;s APIs to the EntandoApp and the micro frontends (MFEs)</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_entando_component_repository_bundles">Entando Component Repository bundles</h6>
<div class="paragraph">
<p>An EntandoDeBundle - or Component Repository bundle - is a package with a set of Entando components and resources. The Entando component manager is able to read these kind of packages and install the components to extend the functionalities of an EntandoApp.
For more details on the EntandoDeBundle and the Entando Component Repository, check the <a href="../digital-exchange/digital-exchange-overview.adoc">digital-exchange overview</a> documentation</p>
</div>
</div>
<div class="sect5">
<h6 id="_entando_plugin">Entando plugin</h6>
<div class="paragraph">
<p>An Entando plugin is a microservice that exposes APIs reusable by one or more Entando apps. Usually the plugin services are exposed to the Entando developer and the end users via micro frontends. Check the <a href="../microfrontends">micro-frontends</a> guides for more details.
You can quickly generate an Entando plugin using the (to-complete link:../blueprint) Entando JHipster Blueprint. The generated project will be ready to work in an Entando environment providing the integration with Keycloak, generating a set of default micro frontends and exposing the plugin&#8217;s logic via an EntandoDeBundle (check the references for details)</p>
</div>
</div>
<div class="sect5">
<h6 id="_keycloak">Keycloak</h6>
<div class="paragraph">
<p>Keycloak in Entando 6 is responsible for authorization and authentication
All the members of an Entando 6 cluster interact with keycloak to verify user/service authorization to perform any specific task. Check out the refereces below for more details on keycloak.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_references">References</h5>
<div class="ulist">
<ul>
<li>
<p><a href="../digital-exchange/digital-exchange-overview.adoc">Digital-exchange overview</a></p>
</li>
<li>
<p><a href="../digital-exchange/tutorials/from-blueprint-to-digital-exchange-bundle/README.adoc">Tutorial: From blueprint to the digital-exchange bundle</a></p>
</li>
<li>
<p><a href="../microfrontes/create-react-microfrontend-widget.adoc">Create a micro-frontend with React</a></p>
</li>
<li>
<p>To complete - reference to the blueprint</p>
</li>
<li>
<p>To complete - reference to keycloak overview</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_tutorial_how_to_connect_entando_6_to_an_external_keycloak_instance">1.8.2. Tutorial: How to connect Entando 6 to an external Keycloak instance</h4>
<div class="sect4">
<h5 id="_purpose_4">Purpose</h5>
<div class="paragraph">
<p>This tutorial enables the Entando administrator to leverage an existing Keycloak instance.</p>
</div>
</div>
<div class="sect4">
<h5 id="_requirements_3">Requirements</h5>
<div class="ulist">
<ul>
<li>
<p>A Keycloak instance</p>
</li>
<li>
<p>A realm named "entando" on that instance</p>
</li>
<li>
<p>An admin user for the "entando" realm</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_steps_4">Steps</h5>
<div class="sect5">
<h6 id="_1_get_keycloak_information">1. Get keycloak information</h6>
<div class="paragraph">
<p>Retrieve the relevant information from the Keycloak instance you want to use.</p>
</div>
<div class="paragraph">
<p>Specifically you will need:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The username of the Keycloak admin that has admin rights to the "entando" realm, e.g entando-keycloak-admin</p>
</li>
<li>
<p>The Keycloak admin password, e.g. password123</p>
</li>
<li>
<p>The base url for the Keycloak server, including the auth value, e.g. <a href="https://my-keycloak-instance.com/auth" class="bare">https://my-keycloak-instance.com/auth</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_2_generate_the_secret">2. Generate the secret</h6>
<div class="paragraph">
<p>You now need to generate a secret with name <em>keycloak-admin-secret</em> using the information retrieved from step 1. The Entando administrator will automatically detect this secret by name, and use it to log onto the provided Keycloak server.</p>
</div>
<div class="paragraph">
<p>Here is an example of the secret you will need to construct:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>---
apiVersion: v1
stringData:
    username: &lt;the username of the Keycloak admin user for the "entando" realm&gt;
    password: &lt;the password of this Keycloak admin user&gt;
    url: &lt;the base url of the Keycloak service, typically ending with the path /auth&gt;
kind: Secret
metadata
    name: keycloak-admin-secret
    namespace: &lt;your-app-namespace&gt;
type: Opaque</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
To encode your values, in bash, you can do <code>echo &lt;your-value&gt; | base64</code>
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="_3_upload_the_secret">3. Upload the secret</h6>
<div class="paragraph">
<p>Next upload the secret to the namespace where you want to deploy your Entando 6 instance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>oc create -f my-secret.yaml -n &lt;my-app-namespace&gt;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_4_deploy_the_entando6_application">4. Deploy the Entando6 application</h6>
<div class="paragraph">
<p>Now you are ready to deploy your Entando 6 application and the administrator will reuse the <em>keycloak-admin-secret</em> secret to populate the environment correctly.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_conclusion_3">Conclusion</h5>
<div class="paragraph">
<p>You should now have a working Entando 6 instance using an external Keycloak server.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_process_driven_apps">1.9. Process Driven Apps</h3>
<div class="sect3">
<h4 id="_business_objective">1.9.1. Business Objective</h4>
<div class="paragraph">
<p>The Entando Process Driven Applications plugin is built to provide a rich and full featured user experience to allow for the management and completion of business processes and automation. The UX is delivered a general purpose UX layer built using micro frontends that can be utilized for any business process or task engine. Customers drive the UX layer by utilizing a pre-developed Entando integration or by implementing a set of interfaces on the server side. The backend is a Spring Boot microservice that provides a pluggable interface allowing for the injection of any underlying process or automation toolkit. The interfaces and steps for creating a new PDA backend implementation are provided below.
This document provides an overview of the Entando Process Driven Apps (PDA) plugin. The initial section covers the business functionality and user facing micro frontends. The second section covers the architecture and the points of extension for the PDA plugin. The third provides a detailed technical overview for developers to add new functionality to a PDA implementation.</p>
</div>
</div>
<div class="sect3">
<h4 id="_terminology">1.9.2. Terminology</h4>
<div class="sect4">
<h5 id="_micro_frontend">Micro Frontend</h5>
<div class="paragraph">
<p>A Micro frontend architecture is an approach to developing web application as a composition of small frontend apps. Instead of writing a large monolith frontend application, the application is broken down into domain specific micro frontends, which are self-contained and can be developed and deployed independently.
Process Driven Application</p>
</div>
</div>
<div class="sect4">
<h5 id="_process_automation_manager_pam">Process Automation Manager (PAM)</h5>
<div class="paragraph">
<p>A business process automation engine built and maintained by Red Hat</p>
</div>
</div>
<div class="sect4">
<h5 id="_business_process_modeling_notation_bpmn">Business Process Modeling Notation (bpmn)</h5>
<div class="paragraph">
<p>Business Process Model and Notation (BPMN) is a graphical representation for specifying business processes in a business process model.</p>
</div>
</div>
<div class="sect4">
<h5 id="_decision_model_and_notation_dmn">Decision Model and Notation (dmn)</h5>
<div class="paragraph">
<p>Decision Model and Notation is a standard published by the Object Management Group. It is a standard approach for describing and modeling repeatable decisions within organizations to ensure that decision models are interchangeable across organizations.</p>
</div>
</div>
<div class="sect4">
<h5 id="_back_end_for_front_end_bff">Back End for Front End (BFF)</h5>
<div class="paragraph">
<p>A microservice architecture allows teams to iterate quickly and to develop technology to scale rapidly. The Backend for Frontend (BFF) architecture is a type of pattern built with microservices. The key component of this pattern is an application that connects the front-end of your application with the backend. This BFF Code Pattern will help you build that component according to IBMâ€™s best practices.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_pda_micro_frontends">1.9.3. PDA Micro Frontends</h4>
<div class="paragraph">
<p>This section provides an overview of each of the micro frontends (MFE) that are available as part of the Entando PDA plugin.
In cases below where there are details specific to the PAM implementation they are provided for that MFE. When extending the integration layer to other engines or custom implementations it will be up to the integrating team to define behavior and datasource for each MFE.</p>
</div>
<div class="sect4">
<h5 id="_task_list">Task List</h5>
<div class="paragraph">
<p>The task list MFE provides a user with a list of visible tasks that are either assigned to that user or that are potentially ownable by that user.  In the default implementation the visible tasks are limited to a single process instance.
At configuration time the application designer is given the option to select a set of columns that will be visible in the task list for that page.</p>
</div>
<div class="sect5">
<h6 id="_pam_implementation">PAM Implementation</h6>
<div class="paragraph">
<p>The default PAM implementation makes the top level  task fields available in the task list for selection. It is possible to fetch task and process variables for rendering in the task list but these values are excluded by default due to the additional API call overhead required.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_task_details">Task Details</h5>
<div class="paragraph">
<p>The task details MFE renders detailed information about a given task. The task details widget is intended to give the final user processing a task the information necessary to complete the task at hand. The task details are rendered in a read only grid. See the styling section below for changing and customizing the layout.</p>
</div>
<div class="sect5">
<h6 id="_pam_implementation_2">PAM Implementation</h6>
<div class="paragraph">
<p>The PAM integration renders task variables in the task details widget.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_task_comments">Task Comments</h5>
<div class="paragraph">
<p>The task comments MFE gives the user the ability to view notes attached to a given task and to add new notes to a task.</p>
</div>
<div class="sect5">
<h6 id="_pam_implementation_3">PAM Implementation</h6>
<div class="paragraph">
<p>The PAM implementation reads and publishes notes to the comments endpoint</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_task_forms">Task Forms</h5>
<div class="paragraph">
<p>The task form implementation renders a form specific to a task and gives the user the ability to complete that form. The form implementation is a wrapper around a JSON schema that describes the layout, style and content of the form. It is up to the backend implementation to transform to the schema and default ux layout needed to render the form. See the technical documentation below for more on the JSON schema based implementation.</p>
</div>
<div class="sect5">
<h6 id="_pam_implementation_4">PAM Implementation</h6>
<div class="paragraph">
<p>The PAM implementation of forms depends on the presence of a form definition being present on the PAM task. The Entando PAM engine implementation transforms from the PAM format to the JSON schema to render the form. And it transforms the API format back to the PAM format based on the form definition in PAM. There are some limitations on form customization due to the format required to return data to PAM. See the forms section in the technical documentation for more information.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_attachments">Attachments</h5>
<div class="paragraph">
<p>The attachments MFE gives the user to view documents attached to a task/case/process and to add new documents to a task/case/process.</p>
</div>
<div class="sect5">
<h6 id="_pam_implementation_5">PAM Implementation</h6>
<div class="paragraph">
<p>The PAM implementation posts the documents to the PAM endpoints for storage. Future features will include using Entando document storage for storing documents and a pluggable document management interface.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_new_process_form">New Process Form</h5>
<div class="paragraph">
<p>The new process form renders a  form that allows the final user to provide the information necessary to instantiate a new business process instance. The technology for generating the process form is the same as the JSON schema definition used for task forms.
=== PAM Implementation
The PAM implementation depends on a form definition being attached to the process definition. Entando transforms the PAM representation into a JSON schema form that can be rendered to the final user.</p>
</div>
</div>
<div class="sect4">
<h5 id="_summary_card">Summary Card</h5>
<div class="paragraph">
<p>The summary card MFE provides a view into aggregate data for the process implementation. The rendered information includes a  total value, a trend value, and a selector for timeframe. The summary card allows the application developer to select a request for rendering the requested information which maps to a call in the underlying engine to provide the summarized data.</p>
</div>
<div class="sect5">
<h6 id="_pam_implementation_6">PAM Implementation</h6>
<div class="paragraph">
<p>The PAM implementation of the summary card widget relies on the PAM custom query functionality. The PAM PDA engine exposes configuration that allows users/developers to define a custom query in a config file that will be executed to render the summary card. This implementation allows the data rendered on the summary cards to be changed via configuration.
In the application there is a properties file that allows the implementer to provide a custom query for each of the cards.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_totals_over_time">Totals Over Time</h5>
<div class="paragraph">
<p>The totals over time MFE provides a dual axis line/bar graph providing trend information about the process environment. The MFE also provides three summary values for comparison over the same time period.</p>
</div>
<div class="sect5">
<h6 id="_pam_implementation_7">PAM Implementation</h6>
<div class="paragraph">
<p>The PAM implementation of the totals over time MFE utilizes custom queries to fetch the summary data rendered in the chart. The queries used in the implementation are defined in configuration files in the MFE and can be updated to render data specific to a given implementation.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_customizing_the_process_driven_application">1.9.4. Customizing the Process Driven Application</h4>
<div class="sect4">
<h5 id="_styling">Styling</h5>
<div class="paragraph">
<p>The Entando PDA MFEs are styled via a material UI theme. That theme can be downloaded and updated here:
<a href="https://github.com/entando/frontend-libraries/tree/master/packages/entando-ui" class="bare">https://github.com/entando/frontend-libraries/tree/master/packages/entando-ui</a></p>
</div>
</div>
<div class="sect4">
<h5 id="_implementing_a_new_engine_or_integrating_a_new_task_source">Implementing a New Engine or Integrating a New Task Source</h5>
<div class="paragraph">
<p>Implementing a new Engine for Process Driven Applications means to create a new Java Project and implement the interfaces defined in the pda-core-engine project. So, the new project should include the pda-core-engine as a dependency. To see an implementation in action, take a look at the pda-redhatpam-engine project, which implements the Red Hat PAM engine integration.
After the engine is implemented, the JAR file resulting from the implementation should be available in the classpath for entando-process-driven-plugin, which is the project that is ultimately executed and exposes the Rest APIs for the frontend application. One way to do that is by publishing the engine implementation to a Maven repository and adding it as a dependency to the entando-process-driven-plugin project.
Below are the descriptions of the key classes and interfaces in the pda-core-engine project that need to be inherited or implemented when creating a new engine implementation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Engine: This class represents a BPM engine and exposes the services that are available for that specific implementation. It is intended to be inherited and the subclass should provide the real implementation for each service by calling the superclass constructor with the service implementations as arguments. If any service is not supported, a null value should be passed to the corresponding constructor argument. The engine can provide implementations for the the following service interfaces:</p>
<div class="ulist">
<ul>
<li>
<p>TaskService: defines service methods for task retrieval from the BPM engine.</p>
</li>
<li>
<p>TaskDefinitionService: defines service methods related to task definition. A task definition specifies which fields or columns are available for all task instances.</p>
</li>
<li>
<p>TaskCommentService: defines service methods related to task comment manipulation. It should be implemented if the task comment is supported by the engine.</p>
</li>
<li>
<p>TaskAttachmentService: defines service methods to operate on task attachments. It should be implemented if the engine supports file attachment on the task.</p>
</li>
<li>
<p>TaskFormService: defines service methods for task form operations, like retrieving the form definition and submitting a form. The Form object can be used to render a form dynamically.</p>
</li>
<li>
<p>TaskLifecycleService: defines service methods related to the task lifecycle. The lifecycle operations move the task from one state to another.</p>
</li>
<li>
<p>TaskLifecycleBulkService: defines methods for bulk lifecycle operations. Like the TaskLifecycleService, methods here move the task from one state to another, but this interface works with multiple tasks at a time.</p>
</li>
<li>
<p>ProcessService: defines service methods for process definitions operations.</p>
</li>
<li>
<p>ProcessFormService: defines service methods for process form operations, like retrieving the form definition and submitting a form. The Form object can be used to render a form dynamically.</p>
</li>
<li>
<p>GroupService: define service methods related to groups from the BPM engine.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_page_templates_and_layout">Page Templates and Layout</h5>
<div class="paragraph">
<p>Page templates are page templates that facilitate rapid development of pages and allow adding pre-made components - widgets - just by drag &amp; dropping.
Templating language used in page models is parsed by Apache FreeMarker template engine.
To create a new page model, go to the Admin panel and select UX Pattern &gt; Page Models. Press â€œAddâ€ and you will be redirected to the page model creation screen. Add the page model code and page model name. Depending on the version you are using you will need to provide a XML or JSON schema. This schema is used to generate the page layout in page configuration screen - itâ€™s used to drag &amp; drop widgets on the page and helps users visualize where each widget will be placed on the page. Basic schema could look like this</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
  "frames": [
    {
      "pos": 0,
      "descr": "Widget description",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x2": 1,
        "y2": 0,
        "x1": 0,
        "y1": 0
      }
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each item in the frames array represents a widget frame (slot).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>pos - a position index (starts from zero); this value is used in APIs to address specific widget on the page</p>
</li>
<li>
<p>descr - widget frame description that is displayed in page configuration screen</p>
</li>
<li>
<p>mainFrame - The primary frame on the page model</p>
</li>
<li>
<p>defaultWidget - widget code for a default widget to use in this frame; page model developer can help out users and suggest the default widgets to use (e.g., header and footer widgets)</p>
</li>
<li>
<p>sketch - an object with 4 coordinates on x and y axises; this allows the developer to place the widgets on the visual representation of the page modelâ€™s frames.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Sketchâ€™s x and y values go from 0 to 11 (similar to columns in Bootstrap), so if you want to place a 2x2 frame at the top left corner of the page, the values would be x1: 0, x2: 1 y1: 0 y2: 1.</p>
</div>
<div class="paragraph">
<p>After you create the JSON/XML schema for the widgets, you can start working on the page template itself.
Itâ€™s a HTML template that contains references to the frames you have added in schema. To add a frame in a specific place of the page, just add <code>&lt;@wp.show frame=0 /&gt;</code>, where frame is the pos variable from the schema. Do not forget to add <code>&lt;#assign wp=JspTaglibs["/aps-core"]&gt;</code> at the top of your template, it will provide access to wp variable.</p>
</div>
<div class="paragraph">
<p>After you are done with your page model, go to Page designer &gt; Page tree and create a new page by pressing â€œAddâ€. Fill the needed information and under Settings &gt; Page Model select your newly created page model. Press â€œSave and Configureâ€ and you will be redirected to the page configuration screen where you will be able to drag &amp; drop the available widgets onto the free frames. Set up your widgets (not all frames need to be filled) and publish the page. To see your page you can press â€œPreviewâ€ or go to <code>`&lt;YOUR_ENVIRONMENT_URL&gt;/&lt;LOCALE&gt;/&lt;PAGE_CODE&gt;.page</code>.
If your pages share common parts such as GTM scripts, consider using fragments. Fragments are like shared code snippets - just add &lt;@wp.fragment code="&lt;FRAGMENT_CODE&gt;" escapeXml=false /&gt; to your page template and the code inside the fragment will be added to your page.</p>
</div>
</div>
<div class="sect4">
<h5 id="_creating_a_new_pda_mfe">Creating a new PDA MFE</h5>
<div class="paragraph">
<p>There are no limitations on the stack that could be used to create PDA MFEs. Custom Elements are a great way to hide implementation details while providing a neutral interface to others.
To create a simple PDA MFE, implement your solution using technologies you are familiar with and wrap it in a custom element. Build your solution with a custom element and upload the built files (Settings &gt; File Browser) in /public/ folder.
Go to <code>UX Pattern &gt; Widget</code> section of the admin panel and press â€œAddâ€ to add a new widget. Enter widget code, titles, select group (for free access to everybody, select â€œFree Accessâ€), and fill the Custom UI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;#assign wp=JspTaglibs["/aps-core"]&gt;
&lt;script src="&lt;@wp.resourceURL /&gt;path/from/static/bundle.js"&gt;&lt;/script&gt;
&lt;your-custom-element parameter=â€valueâ€ /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>&lt;#assign wp=JspTaglibs["/aps-core"]&gt;</code> - provides access to wp variable that is used to get resource URL.
After you add the widget, go to the page tree, select a page where you would like to use the widget and configure it. Drag and drop the widget into a frame and publish the page.</p>
</div>
</div>
<div class="sect4">
<h5 id="_communication_between_mfes">Communication between MFEs</h5>
<div class="paragraph">
<p>Communication between MFEs can be achieved using Custom Events.
Each widget can define events that it will emit and register to events that are important to it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>const createWidgetEvent = eventType =&gt; {
  return payload =&gt; {
	const widgetEvent = new CustomEvent(eventType, { payload });
	window.dispatchEvent(widgetEvent);
  };
};


const subscribeToWidgetEvent = (eventType, eventHandler) =&gt; {
  window.addEventListener(eventType, eventHandler);
  return () =&gt; {
	window.removeEventListener(eventType, eventHandler);
  };
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>Custom element then creates the events it emits and registers to the events that it wants to react to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>constructor(props) {
  super(props);

  // other code

  this.onClickSubmit = createWidgetEvent(â€˜myWidget.onSubmitâ€™);
}

connectedCallback() {

  // other code

  this.unsubscribeFromWidgetEvents = subscribeToWidgetEvent(
    â€˜otherWidget.onClickClearâ€™,
    () =&gt; {
      // callback function when otherWidget fires the onClickClear custom event
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_technical_documentation">1.9.5. Technical Documentation</h4>
<div class="sect4">
<h5 id="_micro_frontend_overview">Micro Frontend Overview</h5>
<div class="sect5">
<h6 id="_task_forms_2">Task forms</h6>
<div class="paragraph">
<p>Widgets containing form (e.g., task completion form widget) use JSON schema to dynamically create forms.
Widget implementation uses react-jsonshema-form library that converts formsâ€™ JSON schemas into React components. Our initial implementation uses Material UI components via Material UI theme library rjsf-material-ui as baseline and has Entando specific templates, widgets and fields (which are react-jsonshema-form terms for parts of forms).
In this section you will learn about basic setup of the form, but if you would like to learn more, please refer to react-jsonshema-form documentation.
Themed JSON form is created using the withTheme() method from the react-jsonschema-form package</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>import { withTheme } from 'react-jsonschema-form';
import { Theme as MuiRJSForm } from 'rjsf-material-ui';

const JSONForm = props =&gt; {

  const ThemedForm = withTheme(MuiRJSForm);

  // ...

  return (
	&lt;ThemedForm
  	schema={formSchema}
  	uiSchema={uiSchema}
  	{...customTemplates}
  	widgets={customWidgets}
  	formData={formData}
  	onSubmit={e =&gt; onSubmitForm(e)}
	&gt;
  );
};

export default JSONForm;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For JSON Form to work, the form schema is mandatory. Itâ€™s a JSON definition of the formâ€™s structure. Users can also provide form data via formData variable, which should follow the structure of JSON schema; and UI schema using uiSchema variable, which allows users to customise the formâ€™s UI (components, rules, types, etc.)
To test JSON schema, UI schema and form data, you can use react-jsonschema-form sandbox environment.
Custom Entando templates, widgets, and fields provide a possibility to customise the layout of the form using Grid components. To specify what area a field or subform should fill, users can provide size parameter in UI schemaâ€™s ui:options object. Size refers to Material UIâ€™s grid column widths (Material UI documentation) where the area the from can take up is divided into 12 columns and value 12 (a default value if size is not provided) means the field or subform should take up all 12 columns. That means that size should be a value from 1 to 12. If two fields that are next to each other have size values 8 and 4 respectively - they will fit into one row, first field being 2 times wider than the second field. User can also provide innerSize parameter to size the input inside the field. This helps with formatting - if user wants a two column layout and have smaller input fields inside these columns.
Multicolumn layout can also be achieved using generateColumnedOFT(columnSize) functionality, basically providing the default columnSize to the created form. generateColumnedOFT returns an ObjectFieldTemplate that is used as a template for all object fields (fields that contain properties inside of them).
To help us understand the mapping between JSON schema and UI schema lets define an example schema:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://entando.org/schemas/pda-form.json",
  "title": "Mortgage Application Form",
  "type": "object",
  "properties": {
    "Application": {
      "title": "Application",
  	"type": "object",
  	"required": [],
  	"properties": {
        "mortgageamount": {
          "type": "integer",
          "title": "Mortgage amount",
          "description": "Mortgage amount"
        },
        "downpayment": {
          "type": "integer",
          "title": "Down Payment",
          "description": "Down Payment"
        },
        "applicant": {
          "title": "Applicant",
          "type": "object",
          "required": [],
          "properties": {
            "name": {
              "type": "string",
              "title": "Name",
              "description": "Name",
              "maxLength": 100
            },
            "annualincome": {
              "type": "integer",
              "title": "Annual Income",
              "description": "Annual Income"
            }
          }
        },
        "property": {
          "title": "Property",
          "type": "object",
          "required": [],
          "properties": {
            "age": {
              "type": "integer",
              "title": "Age of property",
              "description": "Age of property"
            },
            "address": {
              "type": "string",
              "title": "Address of property",
              "description": "Address of property",
              "maxLength": 100
        	   }
          }
        }
      }
    },
    "inlimit": {
      "type": "boolean",
  	"title": "Is mortgage application in limit?"
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>From this JSON (you can copy &amp; paste it into the react-jsonschema-form sandbox) we can see that there is a main form with a title â€œMortgage Application Formâ€.
Root â€œMortgage Application Formâ€ form has two properties - one is a subform <code>Application</code> and the second one is just a checkbox field (field ID is inlimit).
Application subform contains 2 fields: Mortgage amount (field ID is mortgageamount) and Down Payment (field ID is downpayment); and two subforms - Applicant (field ID is applicant) and Property (field ID is property).
Applicant subform contains 2 fields - Name (field ID is name) and Annual Income (field ID is annualincome).
Property subform contains 2 fields - Age of property (field ID is age) and Address of property (field ID is address)
By default (without providing UI schema) they are all listed one field per row. To use Entandoâ€™s implementation of Grid layout, users have to provide UI schema with details about each field. For example, if we would like to have a layout that looks like this (fields are marked <code>[ field name ]</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>+----------------------------------------------------------------------------+
| Mortgage Application Form                                              	  |
+----------------------------------------------------------------------------+
| Application                                                            	  |
+----------------------------------+-----------------------------------------+
| [Mortgage amount]                | [Down Payment]                          |
+----------------------------------+-----------------+-----------------------+
| Applicant                                          | Property              |
+----------------------------------+-----------------+-----------------------+
| [Name]                           | [Annual Income] | [Age of property]     |
+----------------------------------+-----------------+-----------------------+
|                                                    | [Address of property] |
+----------------------------------------------------+-----------------------+</code></pre>
</div>
</div>
<div class="paragraph">
<p>To set up the UI schema you have to define each field you want to customise by addressing using the field IDs - to add options to Applicantâ€™s Name field, you will have to create an object tree going from root object through Application â€”&gt; Applicant â€”&gt; Name (using IDs itâ€™s Application.applicant.name). UI schema for the table layout defined above would look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
  Application: {
    'ui:options': {
      size: 12, // &lt;-- this value is not mandatory as size is 12 columns-wide by default
    },
    mortgageamount: {
      'ui:disabled': true, // &lt;-- user can define fields disabled at UI schema level
      'ui:options': {
        size: 6, // &lt;-- Mortgage amount field should take up half of the row
      },
    },
    downpayment: {
      'ui:options': {
        size: 4, // &lt;-- Down payment field should take up the other half of the row
      },
    },
    applicant: {
      'ui:options': {
        size: 8, // &lt;-- Applicant subform should take up 8 out of 12 columns
      },
      name: {
        'ui:options': {
          size: 8, // &lt;-- Applicant name field should take up 8 columns in the 8 columns that Applicant subform occupies
        },
      },
      annualincome: {
        'ui:options': {
          size: 4, // &lt;-- Annual Income field taking up the remaining 4 columns
        },
      },
    },
    property: {
      'ui:options': {
        size: 4, // &lt;-- Property subform should take up the remaining 4 out of 12 columns
      },
      // note that property's fields are not mentioned - defaulting them to 12 columns in are that is available to them
    },
  },
};

As Material UI components are used for field templates, there might be a need to pass some Material UI options into the field. You can do that by adding muiProps object to the ui:options.
For example, if you would like to make the Down payment field resizable, you can add multiline: true to muiProps option. If you want to make the field take up multiple rows by default, add rows and rowsMax fields. The latter limits how many rows should be added until the scroll bar is shown.
downpayment: {
  'ui:options': {
    size: 4,
    muiProps: {
      multiline: true,
      rows: 2,
      rowsMax: 4
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_widgets">Widgets</h5>
<div class="paragraph">
<p>Different types of widgets can be applied by passing the type via "ui:widget". Property tells the form which UI widget should be used to render a field. You can read about react-jsonschema-form supported widgets here.</p>
</div>
</div>
<div class="sect4">
<h5 id="_building_from_source">Building From source</h5>
<div class="paragraph">
<p>Reference the component projects for instructions to build from source.
<a href="https://github.com/entando/entando-process-driven-plugin" class="bare">https://github.com/entando/entando-process-driven-plugin</a>
<a href="https://github.com/entando/entando-process-driven-plugin/tree/master/widgets" class="bare">https://github.com/entando/entando-process-driven-plugin/tree/master/widgets</a>
<a href="https://github.com/entando/pda-redhatpam-engine" class="bare">https://github.com/entando/pda-redhatpam-engine</a>
<a href="https://github.com/entando/pda-core-engine" class="bare">https://github.com/entando/pda-core-engine</a></p>
</div>
</div>
<div class="sect4">
<h5 id="_code_style">Code Style</h5>
<div class="paragraph">
<p>See: <a href="https://github.com/entando/entando-code-style" class="bare">https://github.com/entando/entando-code-style</a></p>
</div>
</div>
<div class="sect4">
<h5 id="_sonar">Sonar</h5>
<div class="paragraph">
<p><a href="https://sonarcloud.io/organizations/entando/projects" class="bare">https://sonarcloud.io/organizations/entando/projects</a></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cms">1.10. CMS</h3>
<div class="sect3">
<h4 id="_publish_a_content_in_your_application_page_tutorial">1.10.1. Publish a Content in your Application Page_Tutorial</h4>
<div class="sect4">
<h5 id="_objective_2">Objective</h5>
<div class="paragraph">
<p>The activity goal is to create a new Content Type, the related Content Model and Content and publish it in a page of your application. The expected outcome is the new Content is published in the â€œ<em>Conference Home</em>â€ Page of your application.</p>
</div>
<div class="paragraph">
<p><strong>WorkFlow</strong></p>
</div>
<div class="paragraph">
<p><strong>STEP 1</strong></p>
</div>
<div class="paragraph">
<p>We are going to create a new Content Type in theApp Builder installation, by using the WEB CMS capabilities.</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p><strong>Create the new â€œConference â€œ Content Type</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Go inside App Builder &#8594; CMS &#8594; Content Types and click on the ADD button.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Fill out the fields with these values:</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_info">Info</h6>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>In the field <strong>Code</strong> insert the desired unique ID for the new Content Type: e.g. â€œCNFâ€</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>In the field <strong>Name</strong> insert the desired name for the new Content Type: e.g. â€œ<em>Conference</em> â€</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_metadata">Metadata</h6>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>In the dropdown menu <strong>Page for on-the-fly-publishing</strong> select the Page you want to use to publish automatically Contents, that are not associated to a specific Page. If there are no Pages available go to the next phase</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_attributes_27">Attributes</h6>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>In the dropdown <strong>Type</strong> select the following Attributes and then click on the ADD button.</p>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p></p>
<div class="paragraph">
<p>Text (Title)</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Text (Subtitle)</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Hypertext (Abstract)</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Date (Date)</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Image (Picture)</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>You will access the page for the configuration of the new Content Attribute</p>
</div>
</div>
<div class="sect5">
<h6 id="_add_text_attribute_title">Add Text Attribute (Title)</h6>

</div>
<div class="sect5">
<h6 id="_info_2">Info</h6>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>In the field <strong>Code</strong> insert the desired unique identifier for the new Content Attribute: e.g. <em>â€œTitle</em>â€</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>In the field <strong>Name</strong> insert the desired name for the new Content Attribute: e.g. <em>â€œTitleâ€</em></p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Toggle the checkboxes for whatever feature you want to activate among <strong>Mandatory</strong>, <strong>Searchable</strong> and <strong>Can be used as a filter in lists</strong></p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>In the Roles section, select the following role â€œj<em>acms:title â€“ The main title of a Content</em>â€ from the dropdown</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>on the <strong>CONTINUE</strong> button and you will be brought back to previous page, for the configuration of the Content Type</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_add_text_attribute_subtitle">Add Text Attribute (Subtitle)</h6>

</div>
<div class="sect5">
<h6 id="_info_3">Info</h6>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>In the field <strong>Code</strong> insert the desired unique ID for the new Content Attribute: e.g. â€œ<em>Subtitle</em>â€</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>In the field <strong>Name</strong> insert the desired name for the new Content Attribute: e.g. â€œ<em>Subtitle</em>â€</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Toggle the checkboxes for whatever feature you want to activate among <strong>Mandatory</strong>, <strong>Searchable</strong> and <strong>Can be used as a filter in lists</strong></p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Click on the <strong>CONTINUE</strong> button and you will be brought back to previous page, for the configuration of a new Content Type</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_add_hypertext_attribute_abstract">Add Hypertext Attribute (Abstract)</h6>

</div>
<div class="sect5">
<h6 id="_info_4">Info</h6>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>In the field <strong>Code</strong> insert the desired unique ID for the new Content Attribute: e.g. â€œ<em>Abstract</em>â€</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>In the field <strong>Name</strong> insert the desired name for the new Content Attribute: e.g. A<em>bstract</em>â€</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Toggle the checkboxes for whatever feature you want to activate among <strong>Mandatory</strong>, <strong>Searchable</strong> and <strong>Can be used as a filter in lists</strong></p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Click on the <strong>CONTINUE</strong> button and you will be brought back to previous page, for the configuration of a new Content Type</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_add_date_attribute_date">Add Date Attribute (Date)</h6>

</div>
<div class="sect5">
<h6 id="_info_5">Info</h6>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>In the field <strong>Code</strong> insert the desired unique ID for the new Content Date: e.g. â€œ<em>Date</em>â€</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>In the field <strong>Name</strong> insert the desired name for the new Content Date: e.g. â€œ<em>Date</em>â€</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Toggle the checkboxes for whatever feature you want to activate among <strong>Mandatory</strong>, <strong>Searchable</strong> and <strong>Can be used as a filter in lists</strong></p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Click on the <strong>CONTINUE</strong> button and you will be brought back to previous page, for the configuration of a new Content Type</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_add_image_attribute_picture">Add Image Attribute (Picture)</h6>

</div>
<div class="sect5">
<h6 id="_info_6">Info</h6>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>In the field <strong>Code</strong> insert the desired unique ID for the new Content Image: e.g. â€œ<em>Picture</em>â€</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>In the field <strong>Name</strong> insert the desired name for the new Content Date: e.g. â€œ<em>Picture</em>â€</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Toggle the checkboxes for whatever feature you want to activate among <strong>Mandatory</strong>, <strong>Searchable</strong>.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Click on the <strong>CONTINUE</strong> button and you will be brought back to previous page, for the configuration of a new Content Type</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Save</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Click on the <strong>SAVE</strong> button to end the process and save the Content Type on the database. You will be brought back to Content Type list page and you can see the â€œ<em>Conference</em> â€ in the list</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>STEP 2</strong></p>
</div>
<div class="paragraph">
<p>We are going to create a new Content Model for the Content Type just created in your App Builder application.</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p><strong>Create the new â€œ<em>Conference</em>â€œ Content Model for the Content Type just created in step 1</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Go inside App Builder &#8594; CMS &#8594; Content Models and click on the ADD button</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Fill the fields with these values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>In the dropdown Type select the â€œ<em>Conference</em> â€ Content Type, just created in step 1. Then click on the SET button. Keep in mind that in order for the content assist to work properly user must always select the Content Type</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>In the field <strong>Code</strong> insert the desired unique ID for the new Content Model: e.g. â€œ<em>11112</em>â€</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>In the field <strong>Name</strong> insert the desired name for the new Content Model: e.g. â€œ<em>Conferenceâ€.</em></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the text-area <strong>Model</strong> add the markup for the new Content Model to get the model shown in the next picture as a final result. If you have previously set the Content Type, press <strong>ALT+TAB button</strong> to activate the content assist that will help you while writing the code. You can enter the specific CSS code directly here, under the Velocity code.</p>
</div>
<div class="paragraph">
<p>As example, you could copy and paste the content model of the Appendix A of the present document. If you have not already entered the specific CSS code in the field <strong>Model</strong>, you can create a CSS file for the new Content Model in Configuration&#8594; File browser&#8594;static&#8594;css. Inside the css folder, create your folder â€œcontentmoldesâ€ where you create your custom .css file.</p>
</div>
<div class="paragraph">
<p>Finally add the path and the name of the custom CSS file in the field <strong>Style Sheet</strong> (e.g. <em>contentmodels/CNF_Conference.css</em>). Please pay attention to the folder location of the custom CSS. See Appendix B.</p>
</div>
<div class="paragraph">
<p>Be sure that in your page model temaple, before to close the header, the following inclusion:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;@c.import url="/WEB-INF/aps/jsp/models/inc/models-common-utils.jsp" /&gt;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_save">Save</h6>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Click on the <strong>SAVE</strong> button to end the process and save the new Content Model on the database. You will be brought back to the Content Model list page and you can see the â€œConferenceâ€ in the list.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>STEP 3</strong></p>
</div>
<div class="paragraph">
<p>We are going to create a new Content in your App Builder application.</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p><strong>Create a new Content based on â€œ<em>Conference</em>â€ Content Type just created in step 1</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Go inside App Builder &#8594; CMS &#8594; Contents. You will access the page with the list of available Contents. Click on the ADD button and you will see a list of available Content Types.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Select the â€œ<em>Conference</em>â€ Content Type just created in step 1. You will access the page for the creation of the new Content</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Fill the fields with these values:</p>
</div>
<div class="paragraph">
<p><strong>Groups</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>In the field <strong>Owner Group:</strong> simply set â€œ<em>Free Access</em>â€ to let your content be available for every user created on Entando platform</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>In the field <strong>Join Group:</strong> select â€œ<em>Free Access</em>â€</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Content attributes</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Below you will find the list of Attributes defined in the â€œ<em>Conference</em>â€ Content Type (Title, Subtitle, Abstract)</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>1. In the field <strong>Title</strong> insert simple text: e.g. â€œ<em>Conference News</em>â€</p>
</div>
<div class="paragraph">
<p>2. In the field <strong>Subtitle</strong> insert simple text: e.g. â€œ<em>Entando Training and Development</em>â€</p>
</div>
<div class="paragraph">
<p>3. In the field <strong>Abstract</strong> insert simple text: â€œ<em>Entando Training and Development will start soon</em>â€</p>
</div>
<div class="paragraph">
<p><strong>Save</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Click on the SAVE AND APPROVE button to end the process and save the new Content on the database. You will be brought back to Content list page and you can see the â€œ<em>Conference News</em>â€ Content in the list</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>STEP 4</strong></p>
</div>
<div class="paragraph">
<p>We are going to publish the Content just created in the App Builder application.</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p><strong>Publish the â€œ<em>Conference Newsâ€</em> Content just created in step 3 in the â€œ<em>Conference</em> <em>Home</em>â€ Page of the App Builder application.</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Go inside Page Designer &#8594; Page Tree. Now select the â€œ<em>Conference</em> <em>Home</em>â€ Page and click on the <strong>Configure</strong> button in the <strong>Actions</strong> kebab menu. You will access the Page configuration section</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>From the right-side bar select the â€œ<em>Contents - Publish a content</em>â€ CMS Widget and drag &amp; drop it on the Page in the position that contains the â€œ<em>Frame E</em>â€ frame. After dropping it you will access to the Widget configuration page</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>In the Search field, you can type the name of the content â€œ<em>Conference News</em>â€ â€then hit the plus <strong>(+)</strong> button. Remember that, in order to publish the content on your page, it must be saved and approved.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Choose the â€œConferenceâ€ from the Content Model drop-down list</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Press the blue <strong>Save</strong> button.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Click on the PUBLISH and then the PREVIEW button to see the modified â€œ<em>Conference Home</em>â€Page. You will see:</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/Image1.png" alt="image" width="642" height="577"></span></p>
</div>
<div class="paragraph">
<p><strong>Appendix A</strong></p>
</div>
<div class="paragraph">
<p><strong>Sample of a Content Model</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;div class="date-training"&gt;&lt;time class="label"
datetime="$content.Date.shortDate"&gt;$content.Date.getFormattedDate("EEEE dd MMMM
yyyy")&lt;/time&gt;&lt;/div&gt;
&lt;div class="lightbar"&gt;&lt;/div&gt;
&lt;div class="col-md-6"&gt;
&lt;p class="title-training"&gt;$content.Title.text&lt;/p&gt;
&lt;p class="subtitle-training"&gt;$content.Subtitle.text&lt;/p&gt;
&lt;p class="abstract-training"&gt;$content.Abstract.text&lt;/p&gt;
&lt;/div&gt;
&lt;div figure class="image-training"&gt;
&lt;img src="$content.Picture.getImagePath("0")"/&gt;
&lt;/div&gt;
&lt;div class="lightbar"&gt;&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Appendix B</strong></p>
</div>
<div class="paragraph">
<p><strong>Sample of a file .css</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Path: contentmodels/Conference.css</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>.date-training{
font-family: Arial, Helvetica, sans-serif;
font-size:12px;
line-height:22px;
text-align: left;
}

.title-training{
font-family: Arial, Helvetica, sans-serif;
font-size:28px;
width:300px;
line-height:30px;
text-align: left;
}

.subtitle-training{
font-family: "Times New Roman", Times, serif;
font-size:16px;
}

.abstract-training{
font-family: "Times New Roman", Times, serif;
font-size:16px;
line-height:22px;
}

.lightbar{
border: 1px solid #337ab7;
width: 620px;
margin:18px 0 0 0;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Appendix C</strong></p>
</div>
<div class="paragraph">
<p><strong>Sample of a Page Model</strong></p>
</div>
<div class="paragraph">
<p><strong>Json Config</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
"frames": [
{
"pos": 0,
"descr": "Frame A",
"mainFrame": false,
"defaultWidget": null,
"sketch": {
"y2": 0,
"y1": 0,
"x1": 0,
"x2": 11
}
},
{
"pos": 1,
"descr": "Frame B",
"mainFrame": false,
"defaultWidget": null,
"sketch":{
"y2": 1,
"y1": 1,
"x1": 0,
"x2": 11
}
},

{
"pos": 2,
"descr": "Frame C",
"mainFrame": false,
"defaultWidget": null,
"sketch": {
"y2": 2,
"y1": 2,
"x1": 0,
"x2": 11
}
},

{
"pos": 3,
"descr": "Frame D",
"mainFrame": false,
"defaultWidget": null,
"sketch": {
"y2": 6,
"y1": 3,
"x1": 0,
"x2": 5
}

},

{
"pos": 4,
"descr": "Frame E",
"mainFrame": false,
"defaultWidget": null,
"sketch": {
"y2": 6,
"y1": 3,
"x1": 6,
"x2": 11
}
},

{

"pos": 5,
"descr": "Frame F",
"mainFrame": false,
"defaultWidget": null,
"sketch": {
"y2": 10,
"y1": 7,
"x1": 0,
"x2": 11
}
},

{
"pos": 6,
"descr": "Frame G",
"mainFrame": false,
"defaultWidget": null,
"sketch": {
"y2": 14,
"y1": 11,
"x1": 0,
"x2": 5
}
},

{
"pos": 7,
"descr": "Frame H",
"mainFrame": false,
"defaultWidget": null,
"sketch": {
"y2": 14,
"y1": 11,
"x1": 6,
"x2": 11
}

}
]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Template</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;#assign wp=JspTaglibs["/aps-core"]&gt;
&lt;#assign c=JspTaglibs["http://java.sun.com/jsp/jstl/core"]&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
&lt;meta charset="utf-8" /&gt;
&lt;title&gt;
&lt;@wp.currentPage param="title" /&gt; - &lt;@wp.i18n key="PORTAL_TITLE" /&gt;
&lt;/title&gt;
&lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;
&lt;meta name="description" content="" /&gt;
&lt;meta name="author" content="" /&gt;
&lt;@c.import url="/WEB-INF/aps/jsp/models/inc/models-common-utils.jsp" /&gt;
&lt;/head&gt;

&lt;body class="training-inspinia"&gt;
&lt;div class="pace pace-inactive"&gt;
&lt;div class="pace-progress" data-progress-text="100%" data-progress="99" style="transform: translate3d(100%, 0px, 0px);"&gt;
&lt;div class="pace-progress-inner"&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;div class="pace-activity"&gt;&lt;/div&gt;
&lt;/div&gt;

&lt;div class="container-training" style="margin:10px;"&gt;

&lt;div class="row "&gt;
&lt;div class="col-md-12"&gt;
&lt;@wp.show frame=0 /&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="row white-bg"&gt;
&lt;div class="col-md-12"&gt;
&lt;@wp.show frame=1 /&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="row white-bg"&gt;
&lt;div class="col-md-12"&gt;
&lt;@wp.show frame=2 /&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="row white-bg"&gt;
&lt;div class="col-md-6"&gt;
&lt;@wp.show frame=3 /&gt;
&lt;/div&gt;

&lt;div class="row white-bg"&gt;
&lt;div class="col-md-6"&gt;
&lt;@wp.show frame=4 /&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="row white-bg"&gt;
&lt;div class="col-md-12"&gt;
&lt;@wp.show frame=5 /&gt;
&lt;/div&gt;

&lt;div class="row white-bg"&gt;
&lt;div class="col-md-6"&gt;
&lt;@wp.show frame=6 /&gt;
&lt;/div&gt;

&lt;div class="col-md-6"&gt;
&lt;@wp.show frame=7 /&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_content_templates">Content Templates</h5>
<div class="sect5">
<h6 id="_objective_3">Objective</h6>
<div class="paragraph">
<p>This document provides a description of Content Templates and how they are defined and used.</p>
</div>
</div>
<div class="sect5">
<h6 id="_overview_3">Overview</h6>
<div class="paragraph">
<p>The purpose of Content Templates is to define how the information, enclosed in the Content, displayed to the end user, after the content is published within the pages. Simplifying the concept, Content Templates provide styling and layout for the Contents Types; consequently they allow to show the same content in different ways.</p>
</div>
<div class="paragraph">
<p>The Content Templates can be managed using the App Builderâ€™s user interface, in which the Web CMS has been integrated. The interface:</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>displays the list of the content models already existing, for each Content Types to which they refer.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>provides the tools to create a new content model; the model is written using the Velocity language.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_how_to_define_a_content_templates">How to define a Content Templates</h6>
<div class="paragraph">
<p>Creating a Content Template is fairly simple. From the App Builder application</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Select the CMS section and click on Content Templates subsection</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/ContentModel1.png" alt="image" width="642" height="214"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Click on the Add <strong>Content Model button</strong> to create a new Content Template and to add it to the list.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/ContentModel2.png" alt="image" width="642" height="214"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Access the Add Content Template page, where you can</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Choose the Content Type in the dropdown list.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Edit the Code. It is the unique identifier of the content model. You can insert up to 10 numbers. Itâ€™s mandatory.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Edit the Name. It is the name or description of the content model.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Edit the HTML model based on Velocity language</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Define the CSS style sheet file (this is an optional parameter)</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Press the Save button</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/ContentModel3.png" alt="image" width="642" height="285"></span></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_content_types">Content Types</h5>
<div class="sect5">
<h6 id="_objective_4">Objective</h6>
<div class="paragraph">
<p>This document provides an overview of the Content Types, as well as how they are created and represented.</p>
</div>
</div>
<div class="sect5">
<h6 id="_overview_4">Overview</h6>
<div class="paragraph">
<p>The Content Type is a construct used to represent or to model a Content. It is characterized by a set of Attribute Types<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup> , each of which defines the value of their properties, called attributes. A Content is an instance or specialization of the Content Type.</p>
</div>
</div>
<div class="sect5">
<h6 id="_how_to_create_a_content_type">How to create a Content Type</h6>
<div class="paragraph">
<p>Creating Contents Types is fairly simple. The Content Types are managed through the Web CMS, its user interface is made available in the App Builder application.</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>From App Builder, select the CMS section and click on Content Types subsection.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/ContentTypes1.png" alt="image" width="642" height="172"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Click on the Add <strong>Content Type button</strong> to create a new Content Type and to add it to the list.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/ContentTypes2.png" alt="image" width="642" height="172"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>You be asked to provide</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p><strong>Code</strong>. The code is the unique identifier of the content type, that must be 3 uppercase letters, (e.g. CNN). Itâ€™s mandatory.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Name.</strong> The name must be max 50 characters uppercase and lowercase letters, including numbers and special characters, (e.g. Conference_News). Itâ€™s mandatory.</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/ContentTypes3.png" alt="image" width="642" height="172"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Select the <strong>Save</strong> button, then youâ€™ll see</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p><strong>Content Type Information</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p><strong>Code</strong>. The value is pre-filled.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Name</strong>. The name is pre-filled.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Metadata</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p><strong>Page for on-the-fly publishing</strong></p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Default content model</strong></p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Default content model for lists</strong></p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>â€œDefault content modelâ€ and â€œDefault content model for listsâ€ are used respectively to show the detailed view of the Content and its representation as an element in a list, will be created later, during the creation and the content.</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p><strong>Attributes</strong></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the Attributes section, select the <strong>Type</strong> from the drop-down list. The list contains all the available attributes types that define which properties/attributes will characterize the Content.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/ContentTypes4.png" alt="image" width="626" height="247"></span></p>
</div>
<div class="paragraph">
<p>The Add button will start the configuration of the single attribute type. Even every attribute type has its own configuration.</p>
</div>
<div class="paragraph">
<p>For example, to configure the <strong>Text</strong> Attribute Type, choose Text from the Types drop-down menu and then press the blue Add button.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/ContentTypes5.png" alt="image" width="642" height="172"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>You should specify the following fields</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Type:</strong> the value is the pre-filled. It represents the selected attribute type</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Code</strong>: Title. You should insert the name of the attribute. (You can insert max 10 characters uppercase and lowercase letters, numbers, and special characters _ ). (e.g. title)</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Name</strong>: Title. You should insert the description of the attribute. (You can insert max 50 characters uppercase and lowercase letters, including numbers and special characters). (e.g. Title).</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>You should declare if the attribute is <strong>mandatory</strong>, <strong>searchable</strong>, and <strong>to be used as a filter in the list.</strong></p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>The <strong>Roles</strong> section it is possible to assign the <em>jacms:title Attribute Role</em> to this attribute; in this way other plugins or services will know that within the CNG entity this attribute is a title, whatever the key is; however, for sake of clarity, the Code of the attribute is Title.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>The remaining fields related to <strong>Sections</strong> and <strong>Validation - OGNL</strong> sections are not mandatories, you can leave empty.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Press the <strong>Continue</strong> button. The Text attribute type requires no additional configuration step.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can add other Attributes Types.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/ContentTypes6.png" alt="image" width="642" height="172"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Press the Save button. The Content type will be saved and displayed in the table list</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/ContentTypes7.png" alt="image" width="642" height="172"></span></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_contents">Contents</h5>
<div class="sect5">
<h6 id="_objective_5">Objective</h6>
<div class="paragraph">
<p>This document provides an overview of Contents and how to create them in order to be displayed in your applicationâ€™s pages.</p>
</div>
</div>
<div class="sect5">
<h6 id="_overview_5">Overview</h6>
<div class="paragraph">
<p>The App Builder application provides the interface to manage Contents to the final user, using the WEB CMS integrated with the App Builder.</p>
</div>
</div>
<div class="sect5">
<h6 id="_how_to_create_a_content">How to create a Content</h6>
<div class="paragraph">
<p>To manage Contents through the Web CMS</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Select the CMS section and click on the Content subsection; all contents already existing are displayed in a table list.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/Content1.png" alt="image" width="628" height="241"></span></p>
</div>
<div class="paragraph">
<p>To create an additional Content and add it to the list</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Select the <strong>Add Content</strong> button. A drop-down list will let you choose which Content Type the content will be based on.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/Content2.png" alt="image" width="634" height="240"></span></p>
</div>
<div class="paragraph">
<p>You will be asked to provide the information in distinct sections</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p><strong>Info</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p><strong>Content Type</strong>. The information is pre-filled, it is the content type on which the content is based.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Description</strong>. Itâ€™s the content â€˜s name or description. It is mandatory.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Groups</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p><strong>Owner Group.</strong> A drop-down list will let you choose the available users group that can administrate /manage the content. It is mandatory.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Join Group.</strong> A drop-down list will let you choose the available users group to share the content with. They canâ€™t administrate it. It is not mandatory.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Categories.</strong> You can select the categories to join the contents to provide a classification schema of them. It is not mandatory.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Content Attributes.</strong> You must fill out the attributes fields defined by the content types on which the content is based. It is mandatory.</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/Content3.png" alt="image" width="642" height="578"></span></p>
</div>
<div class="paragraph">
<p>At least the additional content is added and displayed in the list by selecting</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p><strong>Save</strong> button. The content will be saved in a draft version.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Save and Approve</strong> button. The content will be saved, approved and published.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id=""><span class="image"><img src="images/extracted-media/media/Content4.png" alt="image" width="642" height="240"></span></h6>
<div class="paragraph">
<p>You can list the contents by filtering with</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p><strong>All</strong>. All created contents are displayed (Draft, To Approve and Approved/Published)</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Draft.</strong> All created contents and saved by only clicking on the <strong>Save</strong> or <strong>Save and Continue</strong> button. The content is not approved and consequently it is not ready to be published.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>To Approve.</strong> All created contents, moved in <strong>Ready</strong> status, then saved by clicking on the Save or <strong>Save and Continue</strong> button. The content is ready for review but has not yet been approved and consequently it has not been published.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Approved</strong>. All created contents that have been saved and approved by clicking on the <strong>Save and Approve</strong> button. It has been published.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/Content5.png" alt="image" width="615" height="237"></span></p>
</div>
<div class="paragraph">
<p>In the table list, contents are listed with several parameters: Name, Created by, Last Edited, Type, Created Date, Owner Group, Join Group, Status, Restrictions, Code, Actions. They can be shown, by setting them in the Columns filter.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/Content6.png" alt="image" width="642" height="304"></span></p>
</div>
<div class="paragraph">
<p>For every content in the list, you have access to a set of actions through the <strong>Actions</strong> kebab button, from which you can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Edit, update the information data related to the content</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Delete, remove the content</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Publish, making the content visible</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Clone, replicate the content</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Unpublish, making the content invisible</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/Content7.png" alt="image" width="642" height="282"></span></p>
</div>
<div class="paragraph">
<p>The contents list can be saved in your file system by clicking the Download button and selecting CSV or XLS format.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/Content8.png" alt="image" width="642" height="249"></span></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_publish_a_content">Publish A Content</h5>
<div class="sect5">
<h6 id="_objective_6">Objective</h6>
<div class="paragraph">
<p>This document provides an overview of how to publish a Content in your application page.</p>
</div>
</div>
<div class="sect5">
<h6 id="_overview_6">Overview</h6>
<div class="paragraph">
<p>The App Builder application provides the capabilities to publish contents in your application page to the final user.</p>
</div>
</div>
<div class="sect5">
<h6 id="_how_to_publish_a_content">How to publish a Content</h6>
<div class="paragraph">
<p>To publish a Content, through the App Builder application, in your page</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Create a new page<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup> clicking <strong>Add</strong> button in Page Tree subsection inside the Page Designer section. Before pressing the Add button, select the hierarchical placement of the page, selecting an already present page, or you will be asked for that afterwards.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/Publish1.png" alt="image" width="642" height="200"></span></p>
</div>
<div class="paragraph">
<p>A page must have a title, a code, a placement in the page tree, an owner group, a join group and a page model. When you create a new page, you must to</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Provide a title and a code in the Info section.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Provide, selecting them from the dropdown menus, an Owner Group and a Join Group in the Page Groups section,</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Select a Page Template from the available templates.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/Publish2.png" alt="image" width="642" height="277"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Click the green â€œ<strong>Save and Configure</strong>â€ button. This brings you to the configuration section, which lists all the frames defined in the page model you associated with that page.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/Publish3.png" alt="image" width="642" height="310"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Add widgets, available in the right pane, to the page, by dragging and dropping them in the desired frame. Regarding the content, you can drag and drop in an available frame, the WEB CMS Widget â€œ<strong>Publish a Content</strong>â€. A Widget setting page will be shown.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/Publish4.png" alt="image" width="652" height="207"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>In the Search field, you can type the name of the content that you would like to publish and then hit the plus <strong>(+)</strong> button. Remember that in order to publish the content on your page, it must be saved and approved.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Choose the suitable content template from the Content Template drop-down list</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Press the blue <strong>Save</strong> button.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/Publish5.png" alt="image" width="630" height="291"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Click on the <strong>Preview</strong> button in Configuration Page to show its preview with the published content.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/Publish6.png" alt="image" width="642" height="313"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Finally, click on the <strong>Publish</strong> button to publish the page and show your Content</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/Publish7.png" alt="image" width="229" height="147"></span></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_digital_assets">Digital Assets</h5>
<div class="sect5">
<h6 id="_objective_7">Objective</h6>
<div class="paragraph">
<p>This document provides an overview of the Digital Assets and functionalities needed to manage images and documents.</p>
</div>
</div>
<div class="sect5">
<h6 id="_overview_7">Overview</h6>
<div class="paragraph">
<p>The WEB CMS includes capabilities that let you manage contents and digital assets. Digital Assets are images, documents, and other media files supported in specific format.</p>
</div>
<div class="paragraph">
<p><strong>Default Supported document formats:</strong>
The Entando CMS can be configured to allow you to load or exclude any type of file extension from being loaded to your site. The default set of extensions are:</p>
</div>
<div class="paragraph">
<p>pdf,xls,doc,ppt,txt,rtf,sxw,sxc,odt,ods,odp,tar,gz,zip,rar,flv,swf,avi,wmv,ogg,mp3,wav,ogm,mov,iso,nrg,docx,docm,xlsx,xlsm,xlsb,pptx,pptm,ppsx,ppsm,sldx,sldm.</p>
</div>
<div class="paragraph">
<p><strong>Supported image formats</strong>: jpg, jpeg, png</p>
</div>
</div>
<div class="sect5">
<h6 id="_how_to_create_a_digital_asset">How to create a Digital Asset</h6>
<div class="paragraph">
<p>To manage the Digital Assets through the Web CMS integrated with App Builder application</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Select the CMS section and click on the Digital Assets subsection</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/DigitalAssets1.png" alt="image" width="642" height="316"></span></p>
</div>
<div class="paragraph">
<p>Add a new image or a new document file</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Press the <strong>Drag and Drop or Browse your computer</strong> button and choose, from your file system, images and documents files that you would like to upload</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/DigitalAssets2.png" alt="image" width="642" height="310"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>From the <strong>Add file</strong> modal window, you must choose one the available Groups and then the <strong>Upload</strong> button. If categories have been defined and displayed , you can join the file with the categories you want.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/DigitalAssets3.png" alt="image" width="642" height="266"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>The image file that you just uploaded is displayed in the list; a statistical overview of the number of the uploaded resources (images and documents) is provided. The App Builderâ€™s interface allows the users to choose grid and list view; most of the time, users prefer to use list view when they are searching with specific requirements, while they love grid view for exploring. For every resource, image, or document, the list shows the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p><strong>Preview</strong></p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Name</strong></p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Type</strong></p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Uploaded By</strong></p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Uploaded At</strong></p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Group</strong></p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Categories</strong></p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Actions</strong></p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Furthermore, the interface lets you perform all management actions, as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p><strong>Edit:</strong> update the information data related to every single resource (image and document)</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Duplicate:</strong> copy identically the resource from the original</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Download:</strong> transfer the resource in your local machine</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Delete:</strong> remove the resource</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/DigitalAssets4.png" alt="image" width="642" height="310"></span></p>
</div>
<div class="paragraph">
<p>You can list the contents by filtering with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p><strong>All</strong>: All added files are displayed, images and documents both.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Images</strong>: All added images are displayed</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p><strong>Attachments</strong><sup class="footnote">[<a id="_footnoteref_3" class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup>: All added documents are displayed</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/extracted-media/media/DigitalAssets5.png" alt="image" width="642" height="308"></span></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_list_of_attribute_types">List of Attribute Types</h5>
<div class="sect5">
<h6 id="_objective_8">Objective</h6>
<div class="paragraph">
<p>This document provides a list and an overview of all available attribute types.</p>
</div>
</div>
<div class="sect5">
<h6 id="_overview_8">Overview</h6>
<div class="paragraph">
<p>Attributes can be seen as the smallest elements that compose a Content Type. In other words, a Content Type is just a collection of different attributes. Attributes are responsible for carrying the actual information inside a Content in Entando and could be of different types. In this chapter, we will review and describe the different attribute types.</p>
</div>
<div class="paragraph">
<p>Firstly, we can distinguish simple attribute types from composite attribute types. In the first case, the attribute type carries a single piece of information (for example, an image), while the latter is an aggregation of simple attribute types (for example, a set of images).</p>
</div>
</div>
<div class="sect5">
<h6 id="_simple_attribute_types">Simple Attribute Types</h6>
<div class="paragraph">
<p>Attach</p>
</div>
<div class="paragraph">
<p>This represents the information carried by a file, which is attached to the content.</p>
</div>
<div class="paragraph">
<p>It consists of an URL corresponding to the desired file present in the systemâ€™s resources, and a text which can either indicate the description or the name of the file.</p>
</div>
<div class="paragraph">
<p>This attribute type is rendered as a button named â€œAddâ€. By pushing that button, the user is prompted to select a desired file present in the systemâ€™s Digital Assets Attachments list.</p>
</div>
<div class="paragraph">
<p>Boolean</p>
</div>
<div class="paragraph">
<p>This attribute type represents a boolean value which can either be true or false. This attribute type is rendered as two radio buttons labeled â€œYesâ€ and â€œNoâ€.</p>
</div>
<div class="paragraph">
<p>Checkbox</p>
</div>
<div class="paragraph">
<p>This attribute type behaves in the same way as a Boolean does â€“ it is actually an alternative to the Boolean attribute type - but it is rendered with a checkbox labeled â€œYesâ€ or â€œNoâ€.</p>
</div>
<div class="paragraph">
<p>Date</p>
</div>
<div class="paragraph">
<p>This attribute type represents a date, tracking time within a content; it is often used to filter contents appearing in lists by publication date, etc.</p>
</div>
<div class="paragraph">
<p>It is rendered as a datepicker.</p>
</div>
<div class="paragraph">
<p>Timestamp</p>
</div>
<div class="paragraph">
<p>This attribute type is specialized for the Date attribute, allowing you to also specify the hour, minute and second.</p>
</div>
<div class="paragraph">
<p>It is rendered as a datepicker for the date, and a select for hours, minutes and seconds.</p>
</div>
<div class="paragraph">
<p>Enumerator</p>
</div>
<div class="paragraph">
<p>The enumerator attribute type represents textual information with a predefined set of choices; it is defined by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Elements which are mandatory and declares the set of available choices;</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Separator, which is optional and declares the character to use to separate the arguments of the enumerator. By default the comma â€œ,â€ is used.</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>ExtractorBean: this parameter represents the name of the Spring bean to use to process the values of the enumerator. The name must exactly match the id of the bean as defined in the Spring configuration file.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is rendered as a select list.</p>
</div>
<div class="paragraph">
<p>Enumerator Map</p>
</div>
<div class="paragraph">
<p>The enumerator map attribute type represent textual information with a predefined set of choices; it is defined by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Elements in the form of a separated list of key=value pairs, (i.e. key1=value1,key2=value2)</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>Separator, which is optional and declares the character to use to separate the key, values pairs. By default the comma is used.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is rendered as a select list which shows the available values.</p>
</div>
<div class="paragraph">
<p>Hypertext</p>
</div>
<div class="paragraph">
<p>This attribute type holds HTML tagged text; it retains a single value for all languages.</p>
</div>
<div class="paragraph">
<p>Even if this attribute type could support all HTML tags, we strongly recommend using only tags which provide meaning and avoid those which decorate or add graphics.</p>
</div>
<div class="paragraph">
<p>Hypertext attributes are rendered as a text area in the content edit page; if the CKEditor is active, the user has access to a set of additional functionalities from a dedicated editorâ€™s toolbar. Such as table insertion and table manipulation, special characters insertion, string formatting, links creation.</p>
</div>
<div class="paragraph">
<p>Image</p>
</div>
<div class="paragraph">
<p>This attribute type binds an image resource to the content.</p>
</div>
<div class="paragraph">
<p>The image is always taken from the Digital Assets images list. The user will need to specify the description accompanying the image.</p>
</div>
<div class="paragraph">
<p>Usually attributes of type Image are not indexed and are not used to filter contents.</p>
</div>
<div class="paragraph">
<p>It is rendered as a button named â€œAddâ€ that, when pushed, allows the user to select an image from the Digital Assets images list. Once selected the user is presented with a preview, as a thumbnail, of the image and has the possibility to define some parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p></p>
<div class="paragraph">
<p>Text which is mandatory and by default takes the name of the selected image</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>legend (optional)</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>alt (optional)</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>description (optional)</p>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>title (optional)</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Link</p>
</div>
<div class="paragraph">
<p>This attribute type represents an hypertext link; it is normally used to include a link in your content: it is possible to define up to three different types of links:</p>
</div>
<div class="paragraph">
<p>1. external links: a link pointing to a location external to the Entando portal</p>
</div>
<div class="paragraph">
<p>2. link to page: a link which points to a page of the portal</p>
</div>
<div class="paragraph">
<p>3. link to a content: a link to another content</p>
</div>
<div class="paragraph">
<p>It is rendered as a button named â€œAddâ€ that when pushed opens up a modal window from which the user can select the link type.</p>
</div>
<div class="paragraph">
<p>Longtext</p>
</div>
<div class="paragraph">
<p>This attribute type represents a simple unformatted text; it supports several languages and is normally used for small descriptions, when a short string won&#8217;t suffice.</p>
</div>
<div class="paragraph">
<p>It supports minimum length , maximal length and regular expressions as optional parameters.</p>
</div>
<div class="paragraph">
<p>It is rendered as a textarea.</p>
</div>
<div class="paragraph">
<p>Monotext</p>
</div>
<div class="paragraph">
<p>Monotext represents the information in textual form, but supports only a language; it is used for all</p>
</div>
<div class="paragraph">
<p>those fields which do not require localization.</p>
</div>
<div class="paragraph">
<p>It supports minimum length, maximal length, and regular expressions as optional parameters.</p>
</div>
<div class="paragraph">
<p>It is rendered as a textfield.</p>
</div>
<div class="paragraph">
<p>Number</p>
</div>
<div class="paragraph">
<p>This attribute type holds an integer number; it retains a single value for all languages.</p>
</div>
<div class="paragraph">
<p>Supports the optional parameters: From, To, and Equal to.</p>
</div>
<div class="paragraph">
<p>It is rendered as a textfield.</p>
</div>
<div class="paragraph">
<p>Text</p>
</div>
<div class="paragraph">
<p>This attribute type holds a string; it retains a single value for all languages.</p>
</div>
<div class="paragraph">
<p>It supports minimum length, maximal length, and regular expressions as optional parameters.</p>
</div>
<div class="paragraph">
<p>It is rendered as a textfield.</p>
</div>
<div class="paragraph">
<p>ThreeState</p>
</div>
<div class="paragraph">
<p>Conceptually similar to the Boolean attribute, this attribute type allows a third status â€œBothâ€ to be present.</p>
</div>
<div class="paragraph">
<p>It is rendered as a radio button with â€œYesâ€, â€œNoâ€, â€œBothâ€ options.</p>
</div>
</div>
<div class="sect5">
<h6 id="_composed_attribute_types">Composed attribute types</h6>
<div class="paragraph">
<p>All the attributes types of the previous chapter can only retain a single type of information, but sometimes it is desirable to aggregate different types of attributes into one attribute: this is where composed attributes are used.</p>
</div>
<div class="paragraph">
<p>From a functional point of view, it would be perfectly legal to build a content type specifying all the attributes back to back: the content would be formally complete, but from a logical point of view the attributes would appear mutually unrelated and, worse, the relationship between them would not be explicit.</p>
</div>
<div class="paragraph">
<p>Entando offers three types of composed attributes: List, Monolist, Composite.</p>
</div>
<div class="paragraph">
<p>List</p>
</div>
<div class="paragraph">
<p>This Attribute Type represents a set of independent and homogeneous elementary Attribute types, each associated with one of the languages defined in the system.</p>
</div>
<div class="paragraph">
<p>An immediate consequence is that this kind of list can handle only mono-language basic attributes.</p>
</div>
<div class="paragraph">
<p>It is rendered with a button named â€œAddâ€ that if pushed presents the user a prompt to select or define the single elements which compose the list.</p>
</div>
<div class="paragraph">
<p>Monolist</p>
</div>
<div class="paragraph">
<p>This attribute type is a list that is common to all the system languages; this kind of list handles multi-language and mono-language attributes.</p>
</div>
<div class="paragraph">
<p>It is rendered with a button named â€œAddâ€ that, if pushed, presents the user with a prompt to select or define the single elements that compose the monolist.</p>
</div>
<div class="paragraph">
<p>Composite</p>
</div>
<div class="paragraph">
<p>This attribute type is an aggregate of different, non-homogeneous, simple attributes types. The aggregation of different types is treated as a single unit.</p>
</div>
<div class="paragraph">
<p>It is rendered as a combination of the elementary attribute types, where each attribute type presents the proper rendering.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_release_notes">1.11. Release Notes</h3>
<div class="sect3">
<h4 id="_release_notes_entando_6_1_0">1.11.1. Release Notes Entando 6.1.0</h4>
<div class="sect4">
<h5 id="_highlights">Highlights</h5>
<div class="sect5">
<h6 id="_helm_based_getting_started">Helm Based Getting Started</h6>
<div class="paragraph">
<p>With the release of 6.1 Entando is using a Helm 2 client to assist in the generation and installation of the full suite of Entando 6 capability. The new getting started simplifies the process of installing Entando 6 and automatically generates everything needed to install a full Entando instance in your Kuberentes environment.
Check out the helm based getting started here:
<a href="http://docs.entando.com/#_getting_started" class="bare">http://docs.entando.com/#_getting_started</a></p>
</div>
</div>
<div class="sect5">
<h6 id="_micro_frontend_configuration_in_app_builder">Micro Frontend Configuration in App Builder</h6>
<div class="paragraph">
<p>The App Builder now gives developers the ability to create a micro frontend to render configuration to the App Builder user when you add a widget to a page. The configuration is stored in the Entando application database and can be referenced by the runtime micro frontend via custom tags or an API call.
Tutorials and more details in documentation:
<a href="http://docs.entando.com/#_tutorial_add_app_builder_configuration_screen_for_an_entando_6_widget" class="bare">http://docs.entando.com/#_tutorial_add_app_builder_configuration_screen_for_an_entando_6_widget</a></p>
</div>
</div>
<div class="sect5">
<h6 id="_new_process_driven_applications_micro_frontends">New Process Driven Applications Micro Frontends</h6>
<div class="paragraph">
<p>With the release of Entando 6.1 we are introducing an all new set of micro frontends for Process Driven Applications (PDAs). The release includes eight micro frontends (smart task inbox, task details, notes, attachments, form generation,  summary card, and over time dashboard) that integrate with your underlying process automation engine. The release also includes a default integration with Red Hat PAM.
More on the new PDA functionality in 6.1.0.
<a href="http://docs.entando.com/#_process_driven_apps" class="bare">http://docs.entando.com/#_process_driven_apps</a></p>
</div>
</div>
<div class="sect5">
<h6 id="_entando_blueprint_bundle_generation">Entando Blueprint Bundle Generation</h6>
<div class="paragraph">
<p>The Entando Blueprint now includes scripts and functionality to assist developers in automatically generating a bundle for the ECR. The scripts build micro frontends and generate the Kubernetes custom resource definitions needed to deploy components created using the blueprint to the ECR.
Updated tutorial here: See also:  The Entando command line tool in the Tech Preview section below</p>
</div>
</div>
<div class="sect5">
<h6 id="_entando_blueprint_local_development_updates">Entando Blueprint Local Development Updates</h6>
<div class="paragraph">
<p>With Entando 6.1 developers can now launch their blueprint generated applications without any changes. In prior versions developers were required to update CORs settings, add Options call support to security configuration, and to create environmental configuration to run their Entando Blueprint generated applications.
<a href="http://docs.entando.com/#_blueprint" class="bare">http://docs.entando.com/#_blueprint</a></p>
</div>
</div>
<div class="sect5">
<h6 id="_cms_enhancements_in_the_app_builder">CMS Enhancements in the App Builder</h6>
<div class="paragraph">
<p>With Entando 6.1 the Entando CMS has been enhanced to include image editing and cropping, additional attribute types, updated layouts and user interaction, an updated editor for hypertext content, and new asset search. The App Builder CMS also now includes the widgets that will allow a user to configure and render their content via the app builder page configuration screen.
See documentation on the Entando 6.1 CMS here
<a href="http://docs.entando.com/#_cms" class="bare">http://docs.entando.com/#_cms</a></p>
</div>
</div>
<div class="sect5">
<h6 id="_new_and_updated_cms_rest_apis">New and Updated CMS REST APIs</h6>
<div class="paragraph">
<p>Entando 6.1 includes updates to the REST APIs exposed by the Entando CMS. In particular, updated support for advanced filtering and updates to APIs for image and document storage. Checkout the Entando Swagger definition for more details:
<a href="http://docs.entando.com/#_the_entando_core_apis" class="bare">http://docs.entando.com/#_the_entando_core_apis</a></p>
</div>
</div>
<div class="sect5">
<h6 id="_operator_and_kubernetes_infrastructure_updates">Operator and Kubernetes Infrastructure Updates</h6>
<div class="paragraph">
<p>The infrastructure in Entando 6.1 includes significant changes to the deployment workflow internal to the Entando infrastructure. Many of the jobs performed by the operator have been updated to short lived run to completion pods to minimize resource utilization and to speed up overall deployment time.</p>
</div>
</div>
<div class="sect5">
<h6 id="_added_the_ability_to_integrated_google_analytics_in_progressive_web_app">Added the Ability to Integrated Google Analytics in Progressive Web App</h6>
<div class="paragraph">
<p>The Entando Progressive Web App shell now provides support for including a Google Analytics token to track page and content views in the application.
These changes are available as part of a manual upgrade to a 5.x version of the PWA.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tech_preview">Tech Preview</h5>
<div class="paragraph">
<p>The release of Entando 6.1 also includes a new command line tool to support all of the operations needed to interact with the Entando platform. Checkout the tech preview version of the tool and its usage here
<a href="https://github.com/entando/entando-cli" class="bare">https://github.com/entando/entando-cli</a></p>
</div>
</div>
<div class="sect4">
<h5 id="_released_image_versions">Released Image Versions</h5>
<div class="literalblock">
<div class="content">
<pre>app-builder:  Image Version: 6.0.99
entando-component-manager:  Image Version: 6.0.27
entando-de-app:  Image Version: 6.0.45
entando-de-app-eap:  Image Version: 6.0.45
entando-de-app-wildfly:  Image Version: 6.0.45
entando-k8s-app-controller:  Image Version: 6.0.33
entando-k8s-app-plugin-link-controller:  Image Version: 6.0.9
entando-k8s-cluster-infrastructure-controller:  Image Version: 6.0.27
entando-k8s-composite-app-controller:  Image Version: 6.0.22
entando-k8s-controller-coordinator:  Image Version: 6.0.66
entando-k8s-dbjob:  Image Version: 6.0.32
entando-k8s-keycloak-controller:  Image Version: 6.0.33
entando-k8s-plugin-controller:  Image Version: 6.0.19
entando-k8s-service:  Image Version: 6.0.17
entando-keycloak:  Image Version: 6.0.11
entando-plugin-sidecar:  Image Version: 6.0.2
entando/entando-pam-app-wildfly:  Image Version:  6.1.0
entando/entando-process-driven-plugin:  Image Version: 6.1.0</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_known_issues">Known Issues</h5>
<div class="paragraph">
<p>This section includes key known open items against the components released in Entando 6.1 that can impact user experience. The list is not comprehensive. Check with your customer or professional services representative for a full list or for questions.</p>
</div>
<div class="sect5">
<h6 id="_key_open_issues">Key Open Issues</h6>
<div class="ulist">
<ul>
<li>
<p>In the App Builder some composite list content types do not render or persist correctly ( Tracking ENG - 383, ENG-385, and ENG-363)</p>
</li>
<li>
<p>An available workaround is to use the legacy admin console to interact with composite list content types and other content types not yet supported</p>
</li>
<li>
<p>Page preview in the app builder when deployed on the default EAP and Wildfly images doesnâ€™t render correctly (Tracking  ENG-338)</p>
</li>
<li>
<p>The page settings link on the page configuration screen doesnâ€™t persist correctly
As a workaround  use the page settings under Page Tree â†’ Select Page â†’ Edit</p>
</li>
<li>
<p>Editing an image that has  been uploaded via the app builder can result in errors (ENG-382)
As a workaround use the image editing capability in the legacy admin console</p>
</li>
<li>
<p>Direct Jira Link for Full Up to Date List of Open Items on 6.1
<a href="https://jira.entando.org/issues/?filter=10904" class="bare">https://jira.entando.org/issues/?filter=10904</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_entando_6_0_0">2. ENTANDO 6.0.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_see_6_1_0"><a class="anchor" href="#_see_6_1_0"></a>2.1. See 6.1.0</h3>
<div class="ulist">
<ul>
<li>
<p>See Entando 6.1.0 for documentation on using Entando 6.0.0. The concepts and commands are identical</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_entando_5_2_0"><a class="anchor" href="#_entando_5_2_0"></a>3. ENTANDO 5.2.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="current-release-notes"><a class="anchor" href="#current-release-notes"></a>3.1. ENTANDO 6.0.0 RELEASE NOTES</h3>
<div class="sect3">
<h4 id="_new_capabilities_and_features"><a class="anchor" href="#_new_capabilities_and_features"></a>3.1.1. NEW CAPABILITIES AND FEATURES</h4>
<div class="sect4">
<h5 id="_goal_of_e6"><a class="anchor" href="#_goal_of_e6"></a>GOAL OF E6</h5>
<div class="paragraph">
<p>The goal of Entando 6 is to bring leading edge tools and architectures like micro frontends and Spring Boot to help developers build web applications that are truly modern. Entando 6 is Kubernetes-native and provides additional capabilities and functionalities to accelerate development, allow dynamic deployment, and simplify the life of the enterprise in Kubernetes. Entando 6 also provides blueprints to allow rapid development of applications and widgets using modern JS Frameworks.</p>
</div>
</div>
<div class="sect4">
<h5 id="_about_e6"><a class="anchor" href="#_about_e6"></a>ABOUT E6</h5>
<div class="paragraph">
<p>Entando is the leading open source UX Innovation Platform that provides a modern development stack  for building cloud-native applications, allowing enterprises to rapidly innovate and develop exceptional user experiences.</p>
</div>
</div>
<div class="sect4">
<h5 id="_whats_new_in_e6"><a class="anchor" href="#_whats_new_in_e6"></a>WHAT&#8217;S NEW IN E6</h5>

</div>
<div class="sect4">
<h5 id="_improved_developer_experience"><a class="anchor" href="#_improved_developer_experience"></a>Improved Developer Experience</h5>
<div class="paragraph">
<p>One of the main objectives of Entando 6 is to modernize and update the toolkit available to developers working on an Entando application. With this release the Entando platform provides an entirely updated developer experience focusing on modern tools and architecture like kubernetes, microservices, modern JS frameworks, and many other standard toolkits.</p>
</div>
<div class="sect5">
<h6 id="_microservice_integration"><a class="anchor" href="#_microservice_integration"></a>Microservice Integration</h6>
<div class="ulist">
<ul>
<li>
<p>Build and deploy Entando plugins using microservices</p>
<div class="ulist">
<ul>
<li>
<p>Any application packaged as a container can be integrated and deployed alongside your Entando application</p>
<div class="ulist">
<ul>
<li>
<p>Tools, examples, and new features using SpringBoot</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_micro_frontends_as_foundation_for_ux_development"><a class="anchor" href="#_micro_frontends_as_foundation_for_ux_development"></a>Micro Frontends as Foundation for UX Development</h6>
<div class="ulist">
<ul>
<li>
<p>Microservices for the Frontend</p>
<div class="ulist">
<ul>
<li>
<p>Develop self-contained, decoupled frontend UIs that can be managed and deployed as containerized bundles</p>
</li>
<li>
<p>Works with any modern JS framework that supports Custom Elements</p>
</li>
<li>
<p>Communicate between widgets supported via custom events</p>
</li>
</ul>
</div>
</li>
<li>
<p>Compose micro frontends into a user facing application using Entando</p>
<div class="ulist">
<ul>
<li>
<p>Built on Custom Elements from Web Component specifications</p>
</li>
<li>
<p>Inherit configuration, microservice, and identity management from Entando</p>
</li>
</ul>
</div>
</li>
<li>
<p>Backed by domain or use-case specific microservices</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_the_entando_blueprint"><a class="anchor" href="#_the_entando_blueprint"></a>The Entando Blueprint</h6>
<div class="paragraph">
<p>The Entando Blueprint is an extension of the JHipster microservices generation framework. The Entando Blueprint will automatically generate a Spring Boot microservice that is ready to be run as an Entando plugin including  micro-frontends, packaging, apis and other features needed to develop a ready to run web applications.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Provides tools to automatically generate a complete web app ready to run as a service</p>
<div class="ulist">
<ul>
<li>
<p>With defaults generated from an Entando JHipster blueprint</p>
</li>
<li>
<p>Widgets, APIs, security, and runnable microservices that can be deployed and integrated with the Entando Kubernetes infrastructures</p>
</li>
</ul>
</div>
</li>
<li>
<p>Automatically generate micro-frontends for every entity added to your JHipster service</p>
</li>
<li>
<p>Generated plugins installable in Digital Exchange</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_updates_to_infrastructure"><a class="anchor" href="#_updates_to_infrastructure"></a>Updates to Infrastructure</h6>
<div class="paragraph">
<p>The Entando Kubernetes infrastructure allows for the automated management of the plugin lifecycle via the Digital Exchange and the app builder.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Kubernetes (operator, sidecar, ingress) for automated integration, deployment, and DevOps lifecycles</p>
</li>
<li>
<p>Entando Kubernetes operator</p>
<div class="ulist">
<ul>
<li>
<p>Automated integration and installation of plugins, micro frontends, and microservices</p>
</li>
<li>
<p>Out of the box integration with Micro App Engine and microservices</p>
</li>
<li>
<p>Enables Digital Exchange to install full stack applications</p>
</li>
</ul>
</div>
</li>
<li>
<p>First class support on OpenShift - supports OpenShift 3.11 and 4</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_plugins_as_a_service"><a class="anchor" href="#_plugins_as_a_service"></a>Plugins as a Service</h6>
<div class="paragraph">
<p>With Entando 6 the developer experience is focused on the development of plugins that run as microservices. An Entando plugin also has the ability to package and expose user experience in the form of micro frontends.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Update Entando plugin architecture to be driven by microservices</p>
</li>
<li>
<p>Plugins run as standalone microservices and take advantage of the APIs exposed by the Entando core to integrate with the Entando infrastructure</p>
</li>
<li>
<p>Integrated via Entando Kubernetes infrastructure (operator, sidecar, ingress)</p>
</li>
<li>
<p>Micro frontends (aka widgets) automatically registered and available for use</p>
</li>
<li>
<p>New code generation and templating features</p>
</li>
<li>
<p>Keycloak for identity management and security</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_all_new_identity_management"><a class="anchor" href="#_all_new_identity_management"></a>All New Identity Management</h6>
<div class="ulist">
<ul>
<li>
<p>Keycloak as foundation for API security for both internal and external calls</p>
</li>
<li>
<p>Users and roles in Keycloak used between services and end user identity management</p>
</li>
<li>
<p>Entando automatically creates roles and permissions when creating a new Plugin as a Service and enables plugins to access those roles</p>
</li>
<li>
<p>Supports standard protocols (OpenID Connect, OAuth 2.0 and SAML 2.0)</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_progressive_web_apps"><a class="anchor" href="#_progressive_web_apps"></a>Progressive Web Apps</h6>
<div class="paragraph">
<p>The Entando progressive web app architecture allows developers to take advantage of the Entando CMS APIs to easily drive content to a progressive web app. Entando also provides a React-based progressive web app application that can be used to bootstrap progressive web app development integrated with the Entando infrastructure.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Drive content on mobile devices by using the Entando progressive web app architecture using the Entando CMS APIs</p>
</li>
<li>
<p>Extends and utilizes Entando APIs and authentication</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_improved_app_builder"><a class="anchor" href="#_improved_app_builder"></a>Improved App Builder</h6>
<div class="ulist">
<ul>
<li>
<p>CMS now a part of the app builder</p>
</li>
<li>
<p>Updated digital exchange UI</p>
</li>
<li>
<p>Extend the app builder by creating an App Builder app. The App Builder exposes build time hooks to add rich user experience to the Entando App Builder to support customer specific requirements</p>
</li>
<li>
<p>Add widget configuration</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_known_issues_2"><a class="anchor" href="#_known_issues_2"></a>Known Issues</h6>
<div class="ulist">
<ul>
<li>
<p>Some of the documentation is out of date relative to Entando 6 and will be incrementally updated to reflect new processes and tools</p>
</li>
<li>
<p>At release the Entando CMS will be disabled in the App Builder at release</p>
<div class="ulist">
<ul>
<li>
<p>The CMS will be added in a subsequent patch release (ETA week of Nov. 14)</p>
</li>
</ul>
</div>
</li>
<li>
<p>The CMS widgets to render content through the page model will not be available at release</p>
</li>
<li>
<p>The CMS widgets will be added in a subsequent patch release (ETA week of Nov. 14)
*Plugins that require a configuration screen will need to manually enable the Integrations section and provide a micro-frontend to render that configuration</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_software_requirements"><a class="anchor" href="#_software_requirements"></a>SOFTWARE REQUIREMENTS</h5>
<div class="ulist">
<ul>
<li>
<p>Java 1.8 or later required</p>
</li>
<li>
<p>npm 5.6.0+ (for ReactJS front ends and blueprint execution)</p>
</li>
<li>
<p>node LTS (for blueprint execution)</p>
</li>
<li>
<p>Kubernetes environment required to run infrastructure or production code</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_legal_notice"><a class="anchor" href="#_legal_notice"></a>LEGAL NOTICE</h5>
<div class="ulist">
<ul>
<li>
<p>LGPL v2.1 License for the Core</p>
</li>
<li>
<p>MIT License for the components</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_links_and_resources"><a class="anchor" href="#_links_and_resources"></a>LINKS AND RESOURCES</h5>
<div class="ulist">
<ul>
<li>
<p>Explore the code on GitHub: <a href="https://github.com/entando" class="bare">https://github.com/entando</a></p>
</li>
<li>
<p>See our Getting Started guide: <a href="http://docs.entando.com/#getting-started" class="bare">http://docs.entando.com/#getting-started</a></p>
</li>
<li>
<p>See our Custom App Building guide: <a href="http://docs.entando.com/#_custom_app_building_with_entando" class="bare">http://docs.entando.com/#_custom_app_building_with_entando</a></p>
</li>
<li>
<p>Contribute to the software: <a href="https://central.entando.com/en/community.page" class="bare">https://central.entando.com/en/community.page</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="installation"><a class="anchor" href="#installation"></a>3.2. INSTALLING ENTANDO ENTANDO 6</h3>
<div class="sect3">
<h4 id="_prerequisites_7"><a class="anchor" href="#_prerequisites_7"></a>3.2.1. PREREQUISITES</h4>
<div class="sect4">
<h5 id="_space_and_hardware_requirements"><a class="anchor" href="#_space_and_hardware_requirements"></a>SPACE AND HARDWARE REQUIREMENTS</h5>
<div class="paragraph">
<p>Entando is a built to be a very light framework requiring limited runtime resources. When extending Entando in a development setting, sizing for development environments that add to an Entando install is up to individual user requirements.</p>
</div>
</div>
<div class="sect4">
<h5 id="_installed_prerequisites"><a class="anchor" href="#_installed_prerequisites"></a>INSTALLED PREREQUISITES:</h5>
<div class="ulist">
<ul>
<li>
<p>Java 1.8+</p>
</li>
<li>
<p>npm 5.6.0+</p>
</li>
<li>
<p>Maven 3.0.5+</p>
</li>
<li>
<p>Ant 1.8.0+</p>
</li>
<li>
<p>Git</p>
</li>
<li>
<p>A kubernetes environment. (OpenShift 3.11 or 4.x or kubernetes 1.14+)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_preparation"><a class="anchor" href="#_preparation"></a>3.2.2. PREPARATION</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Determine routing suffix of your kubernetes instance</p>
</li>
<li>
<p>Determine the docker registry to use. By default the Entando infrastructure will use docker.io</p>
</li>
<li>
<p>Establish if you can get a K8S cluster admin role for the controllers</p>
</li>
<li>
<p>Download these files for installation</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.entando.com/resources/crds.zip">CRDS</a></p>
</li>
<li>
<p><a href="https://docs.entando.com/resources/custom_resources_yamls.zip">Custom Resource Yamls</a></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_introduction_3"><a class="anchor" href="#_introduction_3"></a>3.2.3. INTRODUCTION</h4>
<div class="paragraph">
<p>Many of the services and containers deployed in an Entando 6 instance are meant to be deployed once and be shared
as cluster level infrastructure. For getting started purposes you can deploy everything in the same namespace if preferred. The instructions
below walk you through deploying the cluster level infrastructure separately so that you only have to do that deployment once. Then you can
simply create new Entando Apps in their own namespace for future deployments.</p>
</div>
</div>
<div class="sect3">
<h4 id="_steps_with_a_cluster_admin_role"><a class="anchor" href="#_steps_with_a_cluster_admin_role"></a>3.2.4. STEPS WITH A CLUSTER ADMIN ROLE</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create entando-controllers namespace</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>OpenShift</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>oc new-project entando-controllers</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Kubernetes</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>kubectl create namespace entando-controllers</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Assign the cluster-admin cluster role to the entando-controllers default service account</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>OpenShift</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>oc adm policy add-cluster-role-to-user cluster-admin system:serviceaccount:entando-controllers:default</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Kubernetes</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>kubectl create clusterrolebinding entando-controllers --clusterrole=cluster-admin --serviceaccount=entando-controllers:default</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Modify the operator.yaml file to reflect the two variables and modify the yaml accordingly</p>
<div class="ulist">
<ul>
<li>
<p>ENTANDO_DEFAULT_ROUTING_SUFFIX</p>
</li>
<li>
<p>ENTANDO_K8S_OPERATOR_REGISTRY</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>If you're using a local minikube instance, as value for ENTANDO_DEFAULT_ROUTING_SUFFIX use your minikube ip (or microk8s ip) + `.nip.io` suffix. With minikube, this command should return what you need echo "$(minikube ip).nip.io"</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Create the operator deployment.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
There&#8217;s a small difference between OpenShift and Kubernetes supported versions for this. The provided file works out-of-the box for OpenShift, but in order to use it with Kubernetes you need to change the version to use <code>apps/v1</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>OpenShift</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>oc create -f operator.yaml -n entando-controllers</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Kubernetes</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>kubectl create -f operator.yaml -n entando-controllers</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Setup keycloak</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If you&#8217;re using an external-keycloak instance.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Create external keycloak secret after updating the yaml file with the keycloak admin credentials</p>
</div>
<div class="paragraph">
<p><strong>OpenShift</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>oc create -f keycloak-secret.yaml -n entando-controllers</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Kubernetes</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>kubectl create -f keycloak-secret.yaml -n entando-controllers</pre>
</div>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If you need to create a local keycloak instance</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Create a keycloak project</p>
</div>
<div class="paragraph">
<p><strong>OpenShift</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>oc new-project keycloak-namespace</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Kubernetes</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>kubectl create namespace keycloak-namespace</pre>
</div>
</div>
<div class="paragraph">
<p>Create the keycloak resource</p>
</div>
<div class="paragraph">
<p><strong>OpenShift</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>oc create -f keycloak-server.yaml -n keycloak-namespace</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Kubernetes</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>kubectl create -f keycloak-server.yaml -n keycloak-namespace</pre>
</div>
</div>
<div class="paragraph">
<p>Make sure the <code>keycloak-admin-secret</code> has been created in the entando-controllers namespace. If not, something went wrong during keycloak installation and you need to reinstall it</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Create Entando Cluster infrastructure (Digital Exchange, UserManagement and EntandoK8SService)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>OpenShift</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre># Create the project
oc new-project entando-infra-namespace

# Add the cluster-admin role to the default service account on entando-infra-namespace, required for k8s-service
oc adm policy add-cluster-role-to-user cluster-admin system:serviceaccount:entando-infra-namespace:default

# Create the resource from the file
oc create -f entando-infra.yaml -n entando-infra-namespace</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Kubernetes</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre># Create the namespace
kubectl create namespace entando-infra-namespace

# Add the cluster-admin role to the default service account on entando-infra-namespace, required for k8s-service
kubectl create clusterrolebinding entando-k8ssvc --clusterrole=cluster-admin --serviceaccount=entando-infra-namespace:default

# Create the resource from the file
kubectl create -f entando-infra.yaml -n entando-infra-namespace</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Create Entando App</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>OpenShift</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre># Create the project
oc new-project test-namespace

# Create the entando-app starting from the yaml
oc create -f entando-app.yaml -n test-namespace</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Kubernetes</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre># Create the namespace
kubectl create namespace test-namespace

# Create the entando-app starting from the yaml
kubectl create -f entando-app.yaml -n test-namespace</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_steps_without_a_cluster_admin_role"><a class="anchor" href="#_steps_without_a_cluster_admin_role"></a>3.2.5. STEPS WITHOUT A CLUSTER ADMIN ROLE</h4>
<div class="ulist">
<ul>
<li>
<p>These instructions assume the target namespace/project is e6-namespace. If that&#8217;s not your case, change the instructions accordingly *</p>
</li>
</ul>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Manually install our Custom Resource Definitions:
Make a copy of the Entando CRD files that can be downloaded at:</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>On a command line change to the resulting ./crd directory</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Temporary log in as a K8S cluster admin</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Execute this command:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>oc create -f EntandoAppCRD.yaml -f EntandoAppPluginLinkCRD.yaml \
  -f  EntandoPluginCRD.yaml -f ExternalDatabaseCRD.yaml  \
  -f EntandoClusterInfrastructureCRD.yaml -f EntandoKeycloakServerCRD.yaml</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Grant cluster wide CRD read access only, and full access to Entando Custom resources. This requirement should not be a problem because there is no sensitive information in Entandoâ€™s custom resources.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>oc create -f CRDAccessRole.yaml
oc adm policy add-cluster-role-to-user entando-operator system:serviceaccount:e6-namespace:default</pre>
</div>
</div>
<div class="paragraph">
<p>Please heed all warnings from oc. There should be no warnings at this stage</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Create the operator deployment
Modify the operator.yaml file to reflect the two variables and modify the yaml accordingly</p>
<div class="ulist">
<ul>
<li>
<p>ENTANDO_DEFAULT_ROUTING_SUFFIX *</p>
</li>
<li>
<p>ENTANDO_K8S_OPERATOR_REGISTRY *</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>If you're using a local minikube instance, as value for ENTANDO_DEFAULT_ROUTING_SUFFIX use your minikube ip (or microk8s ip) + `.nip.io` suffix. With minikube, this command should return what you need echo "$(minikube ip).nip.io"</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Give namespace scoped admin rights to the default service-account:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>oc policy add-role-to-user admin system:serviceaccount:e6-namespace:default</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Create the operator deployment:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>oc create -f operator.yaml -n e6-namespace</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>Setup keycloak</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If you&#8217;re using an external-keycloak instance.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Create external keycloak secret after updating the yaml file with the keycloak admin credentials</p>
</div>
<div class="paragraph">
<p><strong>OpenShift</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>oc create -f keycloak-secret.yaml -n entando-controllers</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Kubernetes</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>kubectl create -f keycloak-secret.yaml -n entando-controllers</pre>
</div>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If you need to create a local keycloak instance</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Create a keycloak project</p>
</div>
<div class="paragraph">
<p><strong>OpenShift</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>oc new-project keycloak-namespace</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Kubernetes</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>kubectl create namespace keycloak-namespace</pre>
</div>
</div>
<div class="paragraph">
<p>Create the keycloak resource</p>
</div>
<div class="paragraph">
<p><strong>OpenShift</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>oc create -f keycloak-server.yaml -n keycloak-namespace</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Kubernetes</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>kubectl create -f keycloak-server.yaml -n keycloak-namespace</pre>
</div>
</div>
<div class="paragraph">
<p>Make sure the <code>keycloak-admin-secret</code> has been created in the entando-controllers namespace. If not, something went wrong during keycloak installation and you need to reinstall it</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="10">
<li>
<p>Create Entando Cluster infrastructure (Digital Exchange, UserManagement and EntandoK8SService)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>OpenShift</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre># Create the project
oc new-project entando-infra-namespace

# Add the cluster-admin role to the default service account on entando-infra-namespace, required for k8s-service
oc adm policy add-cluster-role-to-user cluster-admin system:serviceaccount:entando-infra-namespace:default

# Create the resource from the file
oc create -f entando-infra.yaml -n entando-infra-namespace</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Kubernetes</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre># Create the namespace
kubectl create namespace entando-infra-namespace

# Add the cluster-admin role to the default service account on entando-infra-namespace, required for k8s-service
kubectl create clusterrolebinding entando-k8ssvc --clusterrole=cluster-admin --serviceaccount=entando-infra-namespace:default

# Create the resource from the file
kubectl create -f entando-infra.yaml -n entando-infra-namespace</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="11">
<li>
<p>Create Entando App</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>OpenShift</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre># Create the project
oc new-project test-namespace

# Create the entando-app starting from the yaml
oc create -f entando-app.yaml -n test-namespace</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Kubernetes</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre># Create the namespace
kubectl create namespace test-namespace

# Create the entando-app starting from the yaml
kubectl create -f entando-app.yaml -n test-namespace</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_after_installation"><a class="anchor" href="#_after_installation"></a>3.2.6. AFTER INSTALLATION</h4>

</div>
</div>
<div class="sect2">
<h3 id="_app_building_with_entando"><a class="anchor" href="#_app_building_with_entando"></a>3.3. APP BUILDING WITH ENTANDO</h3>
<div class="sect3">
<h4 id="_introducing_the_entando_app_builder"><a class="anchor" href="#_introducing_the_entando_app_builder"></a>3.3.1. INTRODUCING THE ENTANDO APP BUILDER</h4>
<div class="paragraph">
<p>The App Builder is Entandoâ€™s application to help you integrate, configure and customize any kind of modern web application, regardless of your programming proficiency. The App Builder provides an Admin Console, a visual environment, that collects elements for configuring your web application and managing your activities.</p>
</div>
<div class="paragraph">
<p>The App Builder is a ReactJS-based application that uses REST APIs to communicate with the Entando Core.</p>
</div>
<div class="paragraph">
<p>This document describes the elements and functionalities of the Admin Console.</p>
</div>
<div class="sect4">
<h5 id="_entando_admin_console_version_5_0"><a class="anchor" href="#_entando_admin_console_version_5_0"></a>ENTANDO ADMIN CONSOLE VERSION 5.0</h5>
<div class="paragraph">
<p>With Entando version 5.0 the Admin Console has been redesigned and renewed with the adoption of the PatternFly framework and guidelines. PatternFly is built on top of Bootstrap3 and provides an enterprise grade UX look and feel based on research and UX best practices.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_app_builder_overview"><a class="anchor" href="#_app_builder_overview"></a>3.3.2. APP BUILDER OVERVIEW</h4>
<div class="paragraph">
<p>The Entando main view is the entry point for every administration activity. On the up side of the screen there is an horizontal menu, which gives access to all Entandoâ€™s functionalities, while on the down-side of the screen, the Dashboard provides an overview of Entando status and a quick access to some functionalities.</p>
</div>
</div>
<div class="sect3">
<h4 id="_dashboard"><a class="anchor" href="#_dashboard"></a>3.3.3. DASHBOARD</h4>
<div class="paragraph">
<p>The dashboard is divided into distinct areas.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/custom_dashboard.png" alt="custom dashboard">
</div>
</div>
<div class="olist arabic">
<div class="title">Dashboard areas:</div>
<ol class="arabic">
<li>
<p>Page Status (gives an overview of the status of the pages: Online, Online /= Draft and Draft)</p>
</li>
<li>
<p>List of Pages (gives an overview of the list of all Pages: Name, configured Page Model, Number of configured Widgets, Status, Last Modified)</p>
</li>
<li>
<p>Add Page (possibility to add a new Page)</p>
</li>
<li>
<p>User Management (quick access to Users list and Group list)</p>
</li>
<li>
<p>Add User (possibility to add a new User)</p>
</li>
<li>
<p>UX Patterns (gives an overview of the number of configured Widgets and Page Models)</p>
</li>
<li>
<p>Add Widget (possibility to add a new Widget)</p>
</li>
<li>
<p>Integrations (gives an overview of the number of integrated components and APIs)</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_creating_and_managing_pages_with_page_designer"><a class="anchor" href="#_creating_and_managing_pages_with_page_designer"></a>3.3.4. CREATING AND MANAGING PAGES WITH PAGE DESIGNER</h4>
<div class="paragraph">
<p>The Page Designer section deals with all page management-related activities.</p>
</div>
<div class="olist arabic">
<div class="title">The Page Designer section offers the following subsections:</div>
<ol class="arabic">
<li>
<p>Page Tree</p>
</li>
<li>
<p>Page Configuration</p>
</li>
<li>
<p>Page Settings</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_using_the_page_tree"><a class="anchor" href="#_using_the_page_tree"></a>USING THE PAGE TREE</h5>
<div class="paragraph">
<p>The Page Tree subsection shows the hierarchical structure of the pages and their statuses, and lets you perform all page management actions.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/custom_page_tree.png" alt="custom page tree">
</div>
</div>
<div class="sect5">
<h6 id="_creating_a_new_page"><a class="anchor" href="#_creating_a_new_page"></a>CREATING A NEW PAGE</h6>
<div class="olist arabic">
<div class="title">To add a new page:</div>
<ol class="arabic">
<li>
<p>From the tabs along the time, choose the Page Designer &gt; Page Tree &gt; <strong>Add</strong>.</p>
</li>
<li>
<p>Enter a name in both the English and Italian fields.</p>
</li>
<li>
<p>(Optional) Enter a code. By default, Entando generates a code similar to the page title, but you can manually enter a different code. The field accepts alphanumeric characters and underscores, with a character limit of 30.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Once you save the page, you will no longer be able to edit the page&#8217;s Code field.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p><a id="ownjoingroups"></a>Select an Owner Group and a Join Group from the drop-down menus in the Page groups section. Owner Group members can administer the page. Join Group members can view the page.</p>
</li>
<li>
<p>Select from the Page Tree section the page or folder that will be the parent of the new page.</p>
</li>
<li>
<p>Select a Page Model from the Page Model drop-down menu. The Page Model determines the layout of your new page. See the <a href="#page-models">Using Page Models</a> section below.</p>
</li>
<li>
<p>Set additional options from the Settings section as needed.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Displayed in menu:</strong> toggles the page&#8217;s presence in the menu on or off.</p>
</li>
<li>
<p><strong>SEO:</strong> sets toggles on or off optimization of the page for Search Engine Optimization (SEO)</p>
</li>
<li>
<p><strong>Charset:</strong> specifies the character encoding to use. Selectable between utf8 and iso-88591</p>
</li>
<li>
<p><strong>Mime Type:</strong> identifies the type of content on the page</p>
</li>
</ul>
</div>
</li>
<li>
<p>After you have made your selections, click <strong>Save and Configure</strong> to open the Configuration section. Learn more in the <a href="#configuring-page">Configuring a Page</a> section below.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/custom_newpage.png" alt="custom newpage">
</div>
</div>
<div class="olist arabic">
<div class="title">To edit an existing page:</div>
<ol class="arabic">
<li>
<p>Open the Page Tree and find the page to edit.</p>
</li>
<li>
<p>Click the <strong>Actions</strong> (three vertical dots) button in line with the page and select "Edit."</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="configuring-page"><a class="anchor" href="#configuring-page"></a>CONFIGURING A PAGE</h5>
<div class="paragraph">
<p>The Page Configuration section is where you assign widgets to the frames defined by the Page Model you applied to your page. The available widgets are in the right pane. Apply widgets by dragging and dropping them to a frame of your choice.</p>
</div>
<div class="paragraph">
<p>This is also where you publish or unpublish the page or preview the layout prior to publishing.</p>
</div>
<div class="paragraph">
<p>Click the <strong>Info</strong> button for a summary of options you assigned when creating the page, e.g., Title and Owner Group.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/custom_configure.png" alt="custom configure">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ux_patterns_managing_widgets_page_models_and_fragments"><a class="anchor" href="#_ux_patterns_managing_widgets_page_models_and_fragments"></a>3.3.5. UX PATTERNS: MANAGING WIDGETS, PAGE MODELS, AND FRAGMENTS</h4>
<div class="paragraph">
<p>The UX Patterns section provides settings options for your general UX Patterns.</p>
</div>
<div class="sect4">
<h5 id="_using_widgets"><a class="anchor" href="#_using_widgets"></a>USING WIDGETS</h5>
<div class="paragraph">
<p>A Widget is an independent software component configured and executed within your applicationâ€™s page. Widgets provide UX/UI blocks that deliver a specific function.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/custom_widgets.png" alt="custom widgets">
</div>
</div>
<div class="ulist">
<div class="title">The following are the categories of widgets:</div>
<ul>
<li>
<p><strong>User Widgets:</strong> user-generated widgets created via the Admin Console</p>
</li>
<li>
<p><strong>Custom Widgets:</strong> widgets designed to meet specific applications needs such as Red Hat PAM widgets</p>
</li>
<li>
<p><strong>Stock Widgets:</strong> default widgets provided by the App Builder to perform common tasks</p>
</li>
<li>
<p><strong>Specific Application Widgets:</strong> widgets that apply only to a specific tool in Entando, e.g., the installation of CMS module provides Content Management related widgets</p>
</li>
<li>
<p><strong>Plugins Widgets:</strong> widgets provided by the installed plugins</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Each widget&#8217;s Action menu differs depending on the type, including no available actions at all.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_using_fragments"><a class="anchor" href="#_using_fragments"></a>USING FRAGMENTS</h5>
<div class="paragraph">
<p>Fragments are single portions of front-end interface used in widgets (including plugins) and Page Models. They are are HTML blocks that include Freemarker instructions by using specific tags that you replace with appropriate values each time you use the fragment. Entando then renders the widgets using the fragments. The FRAGMENTS section lets you manage existing fragments or add new ones.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/custom_fragments.png" alt="custom fragments">
</div>
</div>
<div class="sect5">
<h6 id="_adding_a_new_fragment"><a class="anchor" href="#_adding_a_new_fragment"></a>ADDING A NEW FRAGMENT</h6>
<div class="olist arabic">
<div class="title">To add a new fragment:</div>
<ol class="arabic">
<li>
<p>From the tabs along the top, choose the UX Patters tab &gt; Fragments &gt; <strong>New</strong>.</p>
</li>
<li>
<p>Enter a Code value. This value represents the fragment&#8217;s unique identifier and appears in the Name column of the Fragments table.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Once you save the fragment, you will no longer be able to edit its Code field.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="page-models"><a class="anchor" href="#page-models"></a>USING PAGE MODELS</h5>
<div class="paragraph">
<p>The Page Model is the look and feel of an application&#8217;s page. It defines the structure of the page using frames or areas of the page that contain widgets.</p>
</div>
<div class="ulist">
<div class="title">Page models have two configuration elements:</div>
<ul>
<li>
<p><strong>JSON Configuration:</strong> formatted text that defines the frame structure of the page.</p>
</li>
<li>
<p><strong>Template:</strong> the look and feel and the real layout of the page. In other words, the template defines where to show a frame and how it will be rendered. Templates use Velocity Template Language (VTL) to provide an simple and clean way to incorporate dynamic content into a web page. It supports statements and directives, references and comments, access to exposed java objects, and methods.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_creating_a_page_model"><a class="anchor" href="#_creating_a_page_model"></a>CREATING A PAGE MODEL</h6>
<div class="olist arabic">
<div class="title">To create a new page model:</div>
<ol class="arabic">
<li>
<p>From the tabs along the top, select UX Patterns &gt; Page Models &gt; <strong>Add</strong>.</p>
</li>
<li>
<p>Assign the page model a code and a name. Codes represent the page modelâ€™s unique identifier. The name can be more human readable. For example:<br>
<strong>Code:</strong> <em>entando_page_purple</em><br>
<strong>Name:</strong> <em>Purple - BPM</em></p>
</li>
<li>
<p>In the JSON Configuration field, enter JSON content to structure the page. For example:</p>
<div class="listingblock">
<div class="content">
<pre>{
  "frames": [
    {
      "pos": 0,
      "descr": "Top bar 1",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 0,
        "y1": 0,
        "x2": 2,
        "y2": 0
      }
    }
  ]
}</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The JSON content must be a single object defining "frames." In other words, the content you enter must go within the <code>frames: []</code> object.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See the Getting Started with Entando App Builder document for a complete example.</p>
</div>
</li>
<li>
<p>In the Template field, enter XML formatting to determine where each defined frame belongs and how to render it. See for a complete example.</p>
</li>
<li>
<p>When finished, click <strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/custom_pagemodel.png" alt="custom pagemodel">
</div>
</div>
</div>
<div class="sect5">
<h6 id="_using_the_inspinia_bpm_case_management_widgets_page_model"><a class="anchor" href="#_using_the_inspinia_bpm_case_management_widgets_page_model"></a>USING THE "INSPINIA - BPM CASE MANAGEMENT WIDGETS" PAGE MODEL</h6>
<div class="paragraph">
<p>The <em>Inspinia - BPM Case Management Widgets</em> page model is a pre-designed model that displays all Process Application Management (PAM) case management widgets on a single page. The list of widgets that this page model deploys is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Case selector</p>
</li>
<li>
<p>Case details</p>
</li>
<li>
<p>Case progress status</p>
</li>
<li>
<p>Case roles</p>
</li>
<li>
<p>Case comments</p>
</li>
<li>
<p>Case instance diagram</p>
</li>
<li>
<p>BPM case charts</p>
</li>
<li>
<p>Case instance file</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">To use the BPM Case Management Widgets page model:</div>
<ol class="arabic">
<li>
<p>Select <em>Inspinia - BPM Case Management widgets</em> when declaring the page model for your page.</p>
</li>
<li>
<p>Click <strong>Save and Configure</strong> when you have set all options for your page.</p>
</li>
<li>
<p>On the resulting screen, click <strong>Apply the default widget</strong>.</p>
<div class="imageblock">
<div class="content">
<img src="images/custom_app_inspinia1.png" alt="custom app inspinia1">
</div>
</div>
</li>
<li>
<p>After the page model loads, select the <strong>Actions</strong> menu from the top frame titled "PAM - Case instance selector" and select "Settings."</p>
<div class="imageblock">
<div class="content">
<img src="images/custom_app_inspinia2.png" alt="custom app inspinia2">
</div>
</div>
</li>
<li>
<p>Select the relevant Knowledge Source and Deployment Unit and click the orange button if you changed any options.</p>
</li>
<li>
<p>Click <strong>Save</strong> and view the page.</p>
</li>
<li>
<p>Select a case from the list of cases and click <strong>Select</strong> to populate all widgets with data from your selected case.</p>
<div class="imageblock">
<div class="content">
<img src="images/custom_app_inspinia3.png" alt="custom app inspinia3">
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For more information on PAM integrations, see the Integrating with a Process Application Manager section.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_integrating_with_red_hat_process_automation_manager_pam"><a class="anchor" href="#_integrating_with_red_hat_process_automation_manager_pam"></a>3.3.6. INTEGRATING WITH RED HAT PROCESS AUTOMATION MANAGER (PAM)</h4>
<div class="paragraph">
<p>Entando integrates with Red Hat&#8217;s Process Automation Manager (formerly Red Hat JBoss BPM Suite), a middleware platform for creating cloud-native business automation applications and microservices. It enables enterprise business and IT users to document, simulate, manage, automate and monitor business processes and policies. It is designed to empower business and IT users to collaborate more effectively, so business applications can be changed more easily and quickly.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/custom_integrations.png" alt="custom integrations">
</div>
</div>
<div class="olist arabic">
<div class="title">To integrate with Red Hat PAM:</div>
<ol class="arabic">
<li>
<p>From the tabs along the top, choose Integrations &gt; Red Hat BPM Config &gt; <strong>Add Integration</strong>.</p>
</li>
<li>
<p>In the Connection section, add all server information. For example:<br></p>
<div class="ulist">
<ul>
<li>
<p>General Settings section:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Active:</strong> On</p>
</li>
<li>
<p>(Optional) <strong>Debug:</strong> On</p>
</li>
</ul>
</div>
</li>
<li>
<p>Connection section:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name:</strong> Ansible Server</p>
</li>
<li>
<p><strong>Host name:</strong> ansible.serv.run</p>
</li>
<li>
<p><strong>Schema:</strong> http</p>
</li>
<li>
<p><strong>Port:</strong> 8080</p>
</li>
<li>
<p><strong>Webapp name:</strong> kie-server</p>
</li>
<li>
<p><strong>Username:</strong> username for the process server administrator</p>
</li>
<li>
<p><strong>Password:</strong> password for the process server administrator</p>
</li>
<li>
<p><strong>Conn. Timeout (in millis):</strong> 500</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>Test Connection</strong> to verify a valid the configuration, then click <strong>Save</strong>.</p>
</li>
<li>
<p>Open the Page Tree by choosing the Page Designer tab &gt; Page Tree.</p>
</li>
<li>
<p>Find your new page in the Page Tree and click its <strong>More Options</strong> button &gt; Configure.</p>
</li>
<li>
<p>In the right pane, search for the â€œBPM-form by Data Typeâ€ widget and drag it to a frame established by your page model.</p>
</li>
<li>
<p>Click the <strong>Preview</strong> button to verify the correct appearance.</p>
</li>
<li>
<p>Click <strong>Publish</strong> once your page is complete.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_managing_users"><a class="anchor" href="#_managing_users"></a>3.3.7. MANAGING USERS</h4>
<div class="paragraph">
<p>The Entando App Builder assigns access rights using combinations of roles and groups. You can manage all activities and privileges for roles and groups through the User Management tab.</p>
</div>
<div class="ulist">
<div class="title">User management definitions:</div>
<ul>
<li>
<p><strong>Users:</strong> perform operations and access information. Users are characterized by a Profile Type that identifies the individual, such as name and email address. The actions that a user can take in an Entando program derive from combinations of Roles and Groups.</p>
</li>
<li>
<p><strong>Roles:</strong> assigned sets of permissions, e.g., content editing rights, or user profile editing rights. Roles are mutually independent, meaning one user can be associated with multiple roles.</p>
</li>
<li>
<p><strong>Groups:</strong> assigned sets of users, with each user given a role within the group. One user can belong to multiple groups. For example, Lynne is a member of the Content Editing group and has the role of Administrator, giving her the ability to perform any task on pages that the Content Editing group is assigned to. Sheâ€™s also a member of the Newsletter group with the role of Editor, meaning she can edit content, but does not have full access to the pages the Newsletter group is assigned to.</p>
</li>
<li>
<p><strong>User Restrictions:</strong> perform access restrictions on the users, e.g., months availability since the last access, or months validity of the user password, etc.</p>
</li>
<li>
<p><strong>Profiles Types:</strong> perform different userâ€™s profile types and  creation of the new profile types.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>For first time projects, consider creating profiles from largest to smallest. For example:<br></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Groups:</strong> are containers of users. Groups grant or restrict access to information and services independently from the Roles of the single Users. For example, all members of the Page Editors group would have access to pages assigned to Page Editors<br></p>
</li>
<li>
<p><strong>Roles:</strong> assign responsibilities within the group, e.g., group Administrators of the Page Editors group have full administrative access to the page, while Newsletter Managers in the Page Editors group can only manage newsletter functions<br></p>
</li>
<li>
<p><strong>Users:</strong> represent an entity with the ability to perform operations and access information. The actions allowed for a certain user are given by the combination of the Roles and Groups.</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_working_with_users"><a class="anchor" href="#_working_with_users"></a>WORKING WITH USERS</h5>
<div class="sect5">
<h6 id="_creating_a_role"><a class="anchor" href="#_creating_a_role"></a>CREATING A ROLE</h6>
<div class="olist arabic">
<div class="title">To create a new role:</div>
<ol class="arabic">
<li>
<p>From the tabs along the top, select User Management &gt; Roles &gt; <strong>Add</strong>.</p>
</li>
<li>
<p>Enter a name.</p>
</li>
<li>
<p>(Optional) Enter a code. The code is the Role&#8217;s unique identifier. By default, Entando generates a code similar to the page title, but you can manually enter a different code. The field accepts alphanumeric characters and underscores, with a character limit of 30.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Once you save the role, you will no longer be able to edit the page&#8217;s Code field.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>In the Permissions section, toggle to "On" the access rights all users assigned to this role will possess. For example, public users may have no options toggled while power users may have the "All Permissions" option toggled to On.</p>
</li>
<li>
<p>Click <strong>Save</strong>.
To edit a Role after saving, return to the Roles screen. In the Roles table, select the Actions menu (three vertical dots) for the role to change and select "Edit."</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/custom_roles.png" alt="custom roles">
</div>
</div>
</div>
<div class="sect5">
<h6 id="_creating_a_group"><a class="anchor" href="#_creating_a_group"></a>CREATING A GROUP</h6>
<div class="olist arabic">
<div class="title">To create a new group:</div>
<ol class="arabic">
<li>
<p>From the tabs along the top, select User Management &gt; Groups &gt; <strong>Add</strong>.</p>
</li>
<li>
<p>Enter a name.</p>
</li>
<li>
<p>(Optional) Enter a code. The code is the Group&#8217;s unique identifier. By default, Entando generates a code similar to the page title, but you can manually enter a different code. The field accepts alphanumeric characters and underscores, with a character limit of 30.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Once you save the group, you will no longer be able to edit the group&#8217;s Code field.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To edit a Group after saving, return to the Groups screen. In the Groups table, select the Actions menu (three vertical dots) for the group to change and select "Edit."</p>
</div>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/custom_groups.png" alt="custom groups">
</div>
</div>
</div>
<div class="sect5">
<h6 id="_creating_a_user"><a class="anchor" href="#_creating_a_user"></a>CREATING A USER</h6>
<div class="olist arabic">
<div class="title">To create a new user:</div>
<ol class="arabic">
<li>
<p>From the tabs along the top, choose User Management &gt; Users &gt; <strong>Add</strong>.</p>
</li>
<li>
<p>In the Username field, enter</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The username must be between 8-20 characters. You can use numbers, underscores, special characters, and upper or lowercase letters.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Enter a password.</p>
</li>
<li>
<p>From the Profile Type drop-down menu, select â€œDefault User Profile.â€</p>
</li>
<li>
<p>Toggle the Status to â€œOnâ€ to ensure that individuals can sign in with this user&#8217;s credentials.</p>
</li>
<li>
<p>Click <strong>Save</strong> to create the user and return to the Users screen.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/custom_users.png" alt="custom users">
</div>
</div>
</div>
<div class="sect5">
<h6 id="_setting_a_users_authorizations"><a class="anchor" href="#_setting_a_users_authorizations"></a>SETTING A USER&#8217;S AUTHORIZATIONS</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From the table on the Users screen, find your new user profile and click <strong>More Options</strong> &gt; Manage authorizations for: <em>your profile name</em>. Set the following options:</p>
<div class="ulist">
<ul>
<li>
<p><strong>User Group:</strong> select a group to assign this user to. You can assign a user to as many groups as you want.</p>
</li>
<li>
<p><strong>User Role:</strong> select the role this user should have in the group. You can only assign a user to one role per user group.<br></p>
<div class="paragraph">
<p>The User Group/Role pairing will appear in the Authorizations table at the top of the screen.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>Add</strong> and then click <strong>Save</strong>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_restricting_access"><a class="anchor" href="#_restricting_access"></a>RESTRICTING ACCESS</h5>
<div class="paragraph">
<p>Entando lets you set restrictions on users (see Figure below), specifically a shelf life for passwords and a maximum time between log ins before the password expires.</p>
</div>
<div class="olist arabic">
<div class="title">Setting user restrictions:</div>
<ol class="arabic">
<li>
<p>From the tabs along the top, choose User Management &gt; User Restrictions.</p>
</li>
<li>
<p>Toggle the Password Always Active option.</p>
<div class="ulist">
<ul>
<li>
<p>On - the password never expires and users have unlimited time between logins</p>
</li>
<li>
<p>Off - activates the password limitation fields, allowing you to set expirations</p>
</li>
</ul>
</div>
</li>
<li>
<p>Toggle the Enable Gravatar integration (Avatar of users) option.</p>
<div class="ulist">
<ul>
<li>
<p>On - enables management of the userâ€™s avatar</p>
</li>
<li>
<p>Off - disables Gravatar integration</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/custom_userrestrictions.png" alt="custom userrestrictions">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_presenting_data"><a class="anchor" href="#_presenting_data"></a>3.3.8. PRESENTING DATA</h4>
<div class="paragraph">
<p>Data Types are collections of attributes. They are used to gather and manage data coming from external sources, like APIs or the IoT. This abstraction layer allows Entando to perform core features like searching on external data.</p>
</div>
<div class="paragraph">
<p>Data Models are used to agnostically render data coming from data types, ensuring that the same data can be represented differently, such as with forms, tables, or graphs. By separating the definition and presentation of data, the Entando App Builder gives you the ability to display the same data in a context- and user-aware way without requiring a data source or integration.</p>
</div>
<div class="olist arabic">
<div class="title">To manage Data Types:</div>
<ol class="arabic">
<li>
<p>Create a Data Type.</p>
</li>
<li>
<p>Create one or more Data Models per Data Type.</p>
</li>
<li>
<p>Publish the data on web pages with one or more widgets.
The Data section allows you to manage the Data.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_structuring_with_data_types"><a class="anchor" href="#_structuring_with_data_types"></a>STRUCTURING WITH DATA TYPES</h5>
<div class="paragraph">
<p>The Data Types section lists all available Data Types, their attributes, and is where you can create a new data structure.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/custom_datatype.png" alt="custom datatype">
</div>
</div>
<div class="olist arabic">
<div class="title">To create a new data type:</div>
<ol class="arabic">
<li>
<p>From the tabs along the top, choose Data &gt; Data Type &gt; <strong>New</strong>.</p>
</li>
<li>
<p>Enter a Code. The code must be three letters.</p>
</li>
<li>
<p>Enter a Name.</p>
</li>
<li>
<p>Click <strong>Save</strong>. This opens the Attributes section where you specify OGNL validation.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configuring_entando"><a class="anchor" href="#_configuring_entando"></a>3.3.9. CONFIGURING ENTANDO</h4>
<div class="paragraph">
<p>The Configuration section (far right of the toolbar, gives you access to Entando general duty functionalities, such as configuring Categories, Labels, Configuration Reload, Database backup, file browsing and groups management.</p>
</div>
<div class="sect4">
<h5 id="_categories"><a class="anchor" href="#_categories"></a>CATEGORIES</h5>
<div class="paragraph">
<p>Categories are dividers and parent folders for pages in your Entando page tree. Add a new category by clicking the <strong>Add</strong> button.</p>
</div>
</div>
<div class="sect4">
<h5 id="_labels_and_languages"><a class="anchor" href="#_labels_and_languages"></a>LABELS AND LANGUAGES</h5>
<div class="paragraph">
<p>The Languages tab displays a list of all configured languages in the system. You can add as many different languages to the system as you need by selecting a language from the Select Language drop down menu and clicking <strong>Add</strong>. You can then include the appropriate vocabulary for any term in the System Labels section.</p>
</div>
<div class="paragraph">
<p>The System Labels tab displays system labels that apply to the entire Entando application. By default, system labels are available in English and Italian. If you add additional languages in the Languages tab, you can enter the appropriate word for a label in your choice language.</p>
</div>
</div>
<div class="sect4">
<h5 id="_database"><a class="anchor" href="#_database"></a>DATABASE</h5>
<div class="paragraph">
<p>The Database section lets you back up your entire Entandoâ€™s database by clicking the <strong>Create Backup</strong> button. The backed up files become available from the Protected folder of the File Browser section once the backup process completes.</p>
</div>
</div>
<div class="sect4">
<h5 id="_file_browser"><a class="anchor" href="#_file_browser"></a>FILE BROWSER</h5>
<div class="paragraph">
<p>The File Browser section lets you browse files, upload, create text files and folders, and access database backups from two distinct areas of the file-system:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Public:</strong> /project_name/src/main/webapp/resources</p>
</li>
<li>
<p><strong>Protected:</strong> /project_name/src/main/webapp/protected</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Backed up database files are in the Protected section by default.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="getting-started-app-builder"><a class="anchor" href="#getting-started-app-builder"></a>3.4. GETTING STARTED WITH ENTANDO</h3>
<div class="sect3">
<h4 id="_sample_mortgage_application"><a class="anchor" href="#_sample_mortgage_application"></a>3.4.1. SAMPLE MORTGAGE APPLICATION</h4>
<div class="sect4">
<h5 id="_preface"><a class="anchor" href="#_preface"></a>PREFACE</h5>
<div class="paragraph">
<p>The Entando App Builder helps you create a variety of applications and integrate them with Red Hat BPM. It uses an intuitive UI, reusable templates, and drag-and-drop functionality that allows you to participate in every stage of the application design process regardless of your level of coding knowledge.</p>
</div>
<div class="paragraph">
<p>This demonstration walks through creating an applicant page for a mortgage application, and then integrates with Red Hat PAM.</p>
</div>
<div class="paragraph">
<p><strong>Prerequisites:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entando MApp Engine and App Builder installed</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_configuring_the_applicant_page"><a class="anchor" href="#_configuring_the_applicant_page"></a>CONFIGURING THE APPLICANT PAGE</h5>
<div class="paragraph">
<p>The Applicant page is a public-facing webpage.</p>
</div>
<div class="sect5">
<h6 id="_creating_a_new_page_model"><a class="anchor" href="#_creating_a_new_page_model"></a>CREATING A NEW PAGE MODEL</h6>
<div class="paragraph">
<p>Page models are reusable templates. They determine the page layout via frames into which you can then drag and drop content and widgets.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/custom_pagemodel.png" alt="custom pagemodel">
</div>
</div>
<div class="olist arabic">
<div class="title">To create a new page model:</div>
<ol class="arabic">
<li>
<p>Open the Entando App Builder.</p>
</li>
<li>
<p>From the tabs along the top, select UX Patterns &gt; Page Models &gt; <strong>Add</strong>.</p>
</li>
<li>
<p>Assign the page model a code and a name. Codes represent the page modelâ€™s unique identifier. The name can be more human readable. For example:<br>
<strong>Code:</strong> <em>entando_page_purple</em><br>
<strong>Name:</strong> <em>Purple - BPM</em></p>
</li>
<li>
<p>In the JSON Configuration field, enter JSON content to structure the page. See the following text for an example.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">{
  "frames": [
    {
      "pos": 0,
      "descr": "Top bar 1",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 0,
        "y1": 0,
        "x2": 2,
        "y2": 0
      }
    },
    {
      "pos": 1,
      "descr": "Top Bar 2",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 3,
        "y1": 0,
        "x2": 5,
        "y2": 0
      }
    },
    {
      "pos": 2,
      "descr": "Top Bar 3",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 6,
        "y1": 0,
        "x2": 8,
        "y2": 0
      }
    },
    {
      "pos": 3,
      "descr": "Top Bar 4",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 9,
        "y1": 0,
        "x2": 11,
        "y2": 0
      }
    },
    {
      "pos": 4,
      "descr": "Central Bar 1",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 0,
        "y1": 1,
        "x2": 11,
        "y2": 1
      }
    },
    {
      "pos": 5,
      "descr": "Central Bar mortgage 2",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 2,
        "y1": 2,
        "x2": 9,
        "y2": 2
      }
    },
    {
      "pos": 6,
      "descr": "Central Bar left",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 2,
        "y1": 3,
        "x2": 4,
        "y2": 3
      }
    },
    {
      "pos": 7,
      "descr": "Central Bar Center",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 5,
        "y1": 3,
        "x2": 7,
        "y2": 3
      }
    },
    {
      "pos": 8,
      "descr": "Central Bar right",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 8,
        "y1": 3,
        "x2": 9,
        "y2": 3
      }
    },
    {
      "pos": 9,
      "descr": "Banner Advisor",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 0,
        "y1": 4,
        "x2": 11,
        "y2": 4
      }
    },
    {
      "pos": 10,
      "descr": "Full",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 0,
        "y1": 5,
        "x2": 11,
        "y2": 5
      }
    },
    {
      "pos": 11,
      "descr": "Footer Left",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 0,
        "y1": 6,
        "x2": 5,
        "y2": 6
      }
    },
    {
      "pos": 12,
      "descr": "Footer right",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 6,
        "y1": 6,
        "x2": 11,
        "y2": 6
      }
    },
    {
      "pos": 13,
      "descr": "Footer 2 Left",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 0,
        "y1": 7,
        "x2": 5,
        "y2": 7
      }
    },
    {
      "pos": 14,
      "descr": "Footer 2 right",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 6,
        "y1": 7,
        "x2": 11,
        "y2": 7
      }
    }
  ]
}</code></pre>
</div>
</div>
</li>
<li>
<p>In the Template field, enter XML formatting to determine where each defined frame belongs and how to render it. See the example content below:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;#assign wp=JspTaglibs["/aps-core"]&gt;
&lt;#assign c=JspTaglibs["http://java.sun.com/jsp/jstl/core"]&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
    &lt;head&gt;
        &lt;meta charset="utf-8" /&gt;
        &lt;title&gt;
            &lt;@wp.currentPage param="title" /&gt; - &lt;@wp.i18n key="PORTAL_TITLE" /&gt;
        &lt;/title&gt;
        &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;
        &lt;meta name="description" content="" /&gt;
        &lt;meta name="author" content="" /&gt;
        &lt;link rel="icon" href="&lt;@wp.info key="systemParam" paramName="applicationBaseURL" /&gt;
              favicon.png" type="image/png" /&gt;
              &lt;!-- Le HTML5 shim, for IE6-8 support of HTML5 elements --&gt;
              &lt;!--[if lt IE 9]&gt;
              &lt;script src="&lt;@wp.resourceURL /&gt;static/js/entando-misc-html5-essentials/html5shiv.js"&gt;&lt;/script&gt;
              &lt;![endif]--&gt;
              &lt;@c.import url="/WEB-INF/aps/jsp/models/inc/content_inline_editing.jsp" /&gt;
              &lt;@c.import url="/WEB-INF/aps/jsp/models/inc/header-inclusions_light.jsp" /&gt;

              &lt;style&gt;
              .editableform .control-group {
               margin-bottom: 0;
                white-space: nowrap;
               line-height: 28px;
               }
              &lt;/style&gt;
    &lt;/head&gt;
     &lt;body class="purple" data-spy="scroll" data-target="#navbar-menu"&gt;
        &lt;!-- Navbar --&gt;
        &lt;div class="navbar navbar-custom navbar-fixed-top sticky" role="navigation" id="sticky-nav"&gt;
            &lt;div class="container"&gt;
                &lt;!-- Navbar-header --&gt;
                &lt;div class="navbar-header"&gt;
                    &lt;!-- Responsive menu button --&gt;
                    &lt;button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"&gt;
                        &lt;span class="sr-only"&gt;Toggle navigation&lt;/span&gt;
                        &lt;span class="icon-bar"&gt;&lt;/span&gt;
                        &lt;span class="icon-bar"&gt;&lt;/span&gt;
                        &lt;span class="icon-bar"&gt;&lt;/span&gt;
                    &lt;/button&gt;
                    &lt;!-- LOGO --&gt;
                    &lt;a class="navbar-brand logo" href="#"&gt;
                        &lt;img alt="acme-logo"  class="logo-img" src="&lt;@wp.imgURL /&gt;Logo_Acme_Bank.png"&gt;
                    &lt;/a&gt;
                &lt;/div&gt;
                &lt;!-- end navbar-header --&gt;
                &lt;!-- menu --&gt;
                &lt;div class="navbar-collapse collapse" id="navbar-menu"&gt;
                    &lt;!--Navbar left--&gt;
                    &lt;ul class="nav navbar-nav nav-custom-left"&gt;
                        &lt;!--frame 0 1--&gt;
                        &lt;@wp.show frame=0 /&gt;
                        &lt;@wp.show frame=1 /&gt;
                    &lt;/ul&gt;
                    &lt;!-- Navbar right --&gt;
                    &lt;ul class="nav navbar-nav navbar-right"&gt;
                        &lt;!--frame 2 3--&gt;
                        &lt;@wp.show frame=2 /&gt;
                        &lt;@wp.show frame=3 /&gt;
                    &lt;/ul&gt;
                &lt;/div&gt;
                &lt;!--/Menu --&gt;
            &lt;/div&gt;
            &lt;!-- end container --&gt;
        &lt;/div&gt;
        &lt;!-- End navbar-custom --&gt;

        &lt;!-- HOME --&gt;
        &lt;section&gt;
               &lt;!--frame 4--&gt;
                 &lt;@wp.show frame=4 /&gt;
               &lt;!--frame 4--&gt;
        &lt;/section&gt;
        &lt;!-- END HOME --&gt;

        &lt;!-- Features Alt --&gt;
        &lt;section class="section" id="mortgage"&gt;
            &lt;div class="container"&gt;
                &lt;div class="row"&gt;
                    &lt;div class="col-sm-12"&gt;
                        &lt;!--frame 5--&gt;
                        &lt;@wp.show frame=5 /&gt;
                        &lt;!--frame 5--&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/section&gt;

        &lt;section class="section"&gt;
            &lt;div class="container"&gt;
                &lt;div class="col-sm-4"&gt;
                        &lt;!--frame 6--&gt;
                        &lt;@wp.show frame=6 /&gt;
                        &lt;!--frame 5--&gt;
                    &lt;/div&gt;
                    &lt;div class="col-sm-4"&gt;
                        &lt;!--frame 7 frame bpm --&gt;
                        &lt;@wp.show frame=7 /&gt;
                        &lt;!--frame 7--&gt;
                    &lt;/div&gt;
                     &lt;div class="col-sm-4"&gt;
                        &lt;!--frame 8 frame bpm --&gt;
                        &lt;@wp.show frame=8 /&gt;
                        &lt;!--frame 8--&gt;
                    &lt;/div&gt;
            &lt;/div&gt;
        &lt;/section&gt;

        &lt;section&gt;
            &lt;!--frame 9--&gt;
            &lt;@wp.show frame=9 /&gt;
            &lt;!--frame 9--&gt;
        &lt;/section&gt;
        &lt;section class=""&gt;
                &lt;!--frame 10--&gt;
                &lt;@wp.show frame=10 /&gt;
                &lt;!--frame 10--&gt;
        &lt;/section&gt;

        &lt;section class=""&gt;
            &lt;div class="container"&gt;
                &lt;div class="col-md-12"&gt;
                    &lt;div class="text-center"&gt;
                        &lt;!--frame 11--&gt;
                        &lt;@wp.show frame=11 /&gt;
                    &lt;/div&gt;
                    &lt;!--frame 11--&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/section&gt;

        &lt;!-- FOOTER --&gt;
        &lt;footer class=" "&gt;
            &lt;div class="container text-center"&gt;
                &lt;div class="row"&gt;
                    &lt;div class="col-md-12"&gt;
                        &lt;!--frame 12--&gt;
                        &lt;@wp.show frame=12 /&gt;
                        &lt;!--frame 12--&gt;
                    &lt;/div&gt;
                &lt;/div&gt; &lt;!-- end row --&gt;

                &lt;div class="row"&gt;
                    &lt;div class="col-sm-6"&gt;
                        &lt;!--frame 13--&gt;
                        &lt;@wp.show frame=13 /&gt;
                        &lt;!--frame 13--&gt;
                    &lt;/div&gt;
                    &lt;div class="col-sm-6"&gt;
                        &lt;!--frame 14--&gt;
                        &lt;@wp.show frame=14 /&gt;
                        &lt;!--frame 14--&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/footer&gt;
        &lt;!-- END FOOTER --&gt;

        &lt;script src="&lt;@wp.resourceURL /&gt;static/js/jquery.ajaxchimp.js"&gt;&lt;/script&gt;
        &lt;script src="&lt;@wp.resourceURL /&gt;static/js/jquery.sticky.js"&gt;&lt;/script&gt;
        &lt;script src="&lt;@wp.resourceURL /&gt;static/js/jquery.app.js"&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>When finished, click <strong>Save</strong>.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_create_the_applicant_page"><a class="anchor" href="#_create_the_applicant_page"></a>CREATE THE APPLICANT PAGE</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From the tabs along the top, select Page Designer &gt; Page Tree &gt; <strong>Add</strong>.</p>
</li>
<li>
<p>Enter a page title and a code. The Code field will auto-populate with a value similar to the Title and acts as the pageâ€™s unique identifier. For example:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Title:</strong> <em>Application Home</em></p>
</li>
<li>
<p><strong>Code:</strong> <em>application_home</em></p>
</li>
</ul>
</div>
</li>
<li>
<p>From the Select Page Placement drop-down menu, select the page to act as this pageâ€™s hierarchical parent.</p>
</li>
<li>
<p>In the Page Groups section, select an Owner Group and a Join Group.</p>
<div class="ulist">
<ul>
<li>
<p>Owner Group members have administrative access to this page</p>
</li>
<li>
<p>Join Group members are able to see the page</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the Settings section, select the page model you just created from the Page Model drop-down menu. Once selected, set the options for the remaining options in the Settings section.</p>
</li>
<li>
<p>Click <strong>Save and Configure</strong>. This opens the Page Configuration screen.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_add_widgets"><a class="anchor" href="#_add_widgets"></a>ADD WIDGETS</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>On the Page Configuration screen, locate the Widgets section on the right side of the screen.</p>
<div class="imageblock">
<div class="content">
<img src="images/custom_configure.png" alt="custom configure">
</div>
</div>
</li>
<li>
<p>Search for the following widgets and drag them into the specified frame:</p>
<div class="ulist">
<ul>
<li>
<p>Choose a language purple/light and drag to Top Bar 4</p>
</li>
<li>
<p>Main banner purple and drag to Central Bar 1</p>
</li>
<li>
<p>Left 3 steps purple and drag to Central Bar Left</p>
</li>
<li>
<p>Right col help purple and drag to Central Bar Right</p>
</li>
<li>
<p>Banner advisor purple/light and drag to Banner Advisor</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Click the <strong>Preview</strong> button to verify the appearance of the page before publishing.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>When the widgets are in place and you are satisfied with the preview, click <strong>Publish</strong>.</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Only click <strong>Publish</strong> after confirming that each widget has been configured properly.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="_integrate_the_bpm_form"><a class="anchor" href="#_integrate_the_bpm_form"></a>INTEGRATE THE BPM FORM</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From the tabs along the top, choose Integrations &gt; Red Hat PAM Config &gt; Add Integration.</p>
<div class="imageblock">
<div class="content">
<img src="images/custom_integrations.png" alt="custom integrations">
</div>
</div>
</li>
<li>
<p>In the Connection section, add all server information. For example:<br></p>
<div class="ulist">
<ul>
<li>
<p>General Settings section:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Active:</strong> On</p>
</li>
<li>
<p>(Optional) <strong>Debug:</strong> On</p>
</li>
</ul>
</div>
</li>
<li>
<p>Connection section:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name:</strong> My Application</p>
</li>
<li>
<p><strong>Host name:</strong> &lt;my.redhat.pamInstance.com&gt;</p>
</li>
<li>
<p><strong>Schema:</strong> http</p>
</li>
<li>
<p><strong>Port:</strong> 8080</p>
</li>
<li>
<p><strong>Webapp name:</strong> kie-server</p>
</li>
<li>
<p><strong>Username:</strong> username for the process server administrator</p>
</li>
<li>
<p><strong>Password:</strong> password for the process server administrator</p>
</li>
<li>
<p><strong>Conn. Timeout (in millis):</strong> 500</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>Test Connection</strong> to verify a valid the configuration, then click <strong>Save</strong>.</p>
</li>
<li>
<p>Open the Page Tree by choosing the Page Designer tab &gt; Page Tree.</p>
</li>
<li>
<p>Find your new page in the Page Tree and click its <strong>More Options</strong> button &gt; Configure.</p>
</li>
<li>
<p>Search for the â€œBPM-form by Data Typeâ€ widget and drag it to the Central Bar Center frame.</p>
</li>
<li>
<p>Click the <strong>Preview</strong> button to verify the correct appearance.</p>
</li>
<li>
<p>Click <strong>Publish</strong>.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rh-getting-started"><a class="anchor" href="#rh-getting-started"></a>3.4.2. GETTING STARTED WITH ENTANDO AND PAM</h4>
<div class="sect4">
<h5 id="_overview_9"><a class="anchor" href="#_overview_9"></a>Overview</h5>
<div class="paragraph">
<p>This document provides an introduction to using the Entando App Builder integrated with Red Hat Process Application Manager. This template application provides a page with a task list, task details, case comments (optional), and case management widgets (optional). The provided application can then be extended and customized using the App Builder functionality.</p>
</div>
<div class="sect5">
<h6 id="_launch_the_template_application"><a class="anchor" href="#_launch_the_template_application"></a>Launch the Template Application</h6>
<div class="paragraph">
<p>Unzip the provided project (entando-pam-app-5.0.3.zip)</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>On a command line cd into the application (for example cd entando-pam-demo-app)</p>
</li>
<li>
<p>Start the project with this command:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><code>mvn jetty:run -Djetty.reload=manual -Djetty.port=8083 -Dspring.profiles.active=swagger</code></p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Notes on this command and the environment</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><strong>mvn jetty:run</strong>&#8201;&#8212;&#8201; Run in jetty for quick start and development</p>
</li>
<li>
<p><strong>jetty.reload=manual</strong>&#8201;&#8212;&#8201;to prevent jetty from reloading changes in your project</p>
</li>
<li>
<p><strong>-Djetty.port=8083</strong> &#8201;&#8212;&#8201;Change the default port to 8083. Without this jetty will start on 8080 and usually conflict with something else in the environment</p>
</li>
<li>
<p><strong>-Dspring.profiles.active=swagger</strong>&#8201;&#8212;&#8201;Enable swagger on the project so we can look at the APIs and API documentation. Disabled by default. This can also be exported as an environment variable: export spring_profiles_active=swagger</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Wait for the project to start. Look for: Started Jetty Server.  Console Reloading is Enabled</p>
</li>
<li>
<p>In a browser navigate to: <a href="http://localhost:8083/entando-pam-app-5.0.3" class="bare">http://localhost:8083/entando-pam-app-5.0.3</a></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_add_the_kie_server_configuration"><a class="anchor" href="#_add_the_kie_server_configuration"></a>Add the KIE server configuration</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to  <a href="http://localhost:8083/entando-pam-app-5.0.3/do/login" class="bare">http://localhost:8083/entando-pam-app-5.0.3/do/login</a></p>
</li>
<li>
<p>Login with</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>User: admin</p>
</li>
<li>
<p>Password: adminadmin</p>
</li>
</ol>
</div>
</li>
<li>
<p>On the left pane select Integrations â†’ Components â†’ Red Hat PAM Config</p>
</li>
<li>
<p>In the upper right select Add Configuration</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Name - Enter the name of your choice for the configuration</p>
</li>
<li>
<p>Hostname - The host where your KIE server is running. For example (localhost). Do not include http:// or ports</p>
</li>
<li>
<p>Schema: One of http or https depending on where your KIE server is running</p>
</li>
<li>
<p>Port - Enter the port of the http interface of your KIE server. If any. Can be left blank. For example 8080 is common if KIE is running locally</p>
</li>
<li>
<p>WebApp Name - The value that comes after the port in your KIE URL. If any. Can be left blank. A common value is kie-server when running KIE locally</p>
</li>
<li>
<p>Username - PAM Admin username. Common value is pamAdmin</p>
</li>
<li>
<p>Password - The password for the KIE user</p>
</li>
<li>
<p>Conn. Timeout (in millis) - Millisecond timeout for connecting to KIE. Can be blank</p>
</li>
</ol>
</div>
</li>
<li>
<p>Hit Test connection and youâ€™ll get a green banner if the connection is valid</p>
</li>
<li>
<p>Select Save <em>(donâ€™t forget this)</em></p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_configure_the_widgets_to_use_your_pam_connection"><a class="anchor" href="#_configure_the_widgets_to_use_your_pam_connection"></a>- Configure the Widgets to Use your PAM Connection</h6>
<div class="paragraph">
<p>The demo app comes with a collection of widgets pre-applied in the pages but they need to be configured to use the new KIE configuration created in Part 2 above.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the left nave select Page Designer â†’ Page Tree</p>
</li>
<li>
<p>In the page tree in the kebab menu on the right select the menu for the page named Task List</p>
</li>
<li>
<p>Select Configure</p>
</li>
<li>
<p>On this page the widget in the middle of the screen called PAM-Datatable Task List holds the task list for our application. Select the kebab menu on the right and select settings</p>
</li>
<li>
<p>On this page fill out the configuration for you new PAM instance</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Knowledge Source - this will be the name of the PAM integration you selected and configured above</p>
</li>
<li>
<p>Process - The process you want to fetch tasks for</p>
</li>
<li>
<p>Open new page on table row click - Select ON</p>
</li>
<li>
<p>Show Claim button - Select ON</p>
</li>
<li>
<p>Show Complete Button  - Select ON</p>
</li>
<li>
<p>Under BPM Groups - Select ON for all of the provided groups</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Note: If modeling a process with different groups you need to add those groups to Entando under the left menu Setting â†’ Groups and enter the names to match exactly the groups used in PAM</p>
</li>
</ol>
</div>
</li>
<li>
<p>Override Fields</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>These are the columns that will show up in your table. They are fetched from Task and Process variables. You can provide a different column header under Override fields and remove columns using the check boxes</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Select Save at the bottom of the screen</p>
</li>
<li>
<p>Hit the green Publish button at the top of the page</p>
</li>
<li>
<p>In the upper right select Pages</p>
</li>
<li>
<p>On the row that says task-details click on the row and then on the right and select the kebab button</p>
</li>
<li>
<p>Select configure</p>
</li>
<li>
<p>Select the kebab button on the widget labeled PAM-Task Form by Data Type</p>
</li>
<li>
<p>Select settings</p>
</li>
<li>
<p>Select the Knowledge Source and Process</p>
</li>
<li>
<p>Click Save</p>
</li>
<li>
<p>Click the green publish button</p>
</li>
<li>
<p>Optional step</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If the application you are building is using Case Management functionality you can also add the PAM Case Comments widget to the box labeled Widget 4 by searching for the widget on the right and dragging it to the page. Then configure that widget with the Knowledge Source and Process</p>
</li>
<li>
<p>Click Save and Publish</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_update_the_home_screen_of_your_application"><a class="anchor" href="#_update_the_home_screen_of_your_application"></a>Update the Home Screen of your Application</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>On the left menu select Page Designer â†’ Page Settings</p>
</li>
<li>
<p>In the top dropdown labeled Home page* select ../Task List</p>
</li>
<li>
<p>Select Save</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_view_your_application"><a class="anchor" href="#_view_your_application"></a>View your Application</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the upper right of the application select Go to Homepage</p>
</li>
<li>
<p>If there are human tasks available in your PAM process for the roles assigned to your PAM user they will show up in the table</p>
</li>
<li>
<p>Clicking on a row in the table will take you to the task details page in a new tab</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_content_management_system"><a class="anchor" href="#_content_management_system"></a>3.5. CONTENT MANAGEMENT SYSTEM</h3>
<div class="sect3">
<h4 id="_introduction_4"><a class="anchor" href="#_introduction_4"></a>3.5.1. INTRODUCTION</h4>
<div class="paragraph">
<p>Access Entando&#8217;s Content Management System features from the left pane by selecting APPS &gt; CMS. The CMS modules contain functions that let you manage contents, their type, model, and digital assets. This section provides an overview of the tasks associated with each of the CMS subsections, which are not necessarily arranged sequentially for a first-time setup.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Contents</p>
</li>
<li>
<p>Digital Assets</p>
</li>
<li>
<p>Content Types</p>
</li>
<li>
<p>Content Models</p>
</li>
<li>
<p>Content Settings</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Generally speaking, the flow for creating content is:
Create a Content Type &gt; Create a Content Model for the newly created Type &gt; Create Contents and Digital Assets &gt; Publish the contents</p>
</div>
<div class="sect4">
<h5 id="_defining_content_management_sections"><a class="anchor" href="#_defining_content_management_sections"></a>DEFINING CONTENT MANAGEMENT SECTIONS</h5>
<div class="dlist">
<dl>
<dt class="hdlist1">Contents</dt>
<dd>
<p>Contents are the human consumable pieces of information presented in your applications. Newspaper articles, blog posts, press releases, and their associated images and attachments. The Contents section is where the management of your content happens as well as a search utility for quickly accessing your assets.</p>
</dd>
<dt class="hdlist1">Digital Assets</dt>
<dd>
<p>Digital Assets are the rich media files you can use to provide a more robust experience in your application, including photos, audio and video files, and documentation. By using the Digital Assets section, you create a repository from which you can access any asset with minimal effort, can repurpose it in multiple locations, and specify user and management rights to that asset.</p>
<div class="paragraph">
<p>The Entando platform divides Digital Assets into two broad categories: Images (jpg/jpeg and png files) and Attachments (all other file formats).</p>
</div>
</dd>
<dt class="hdlist1">Content Types</dt>
<dd>
<p>Entando&#8217;s Content Types define the different content elements in your repository and enable you to manage settings for each category in centralized, reusable way. Each type defines the unique attributes associated with that given type through a series of attributes.</p>
</dd>
<dt class="hdlist1">Content Models</dt>
<dd>
<p>Content Models are templates for your information. They determine a structure for how the content is organized, similar to file templates in Microsoft Word or PowerPoint.</p>
</dd>
<dt class="hdlist1">Content Settings</dt>
<dd>
<p>Content Settings provide a method for managing aspects of your Digital Assets such as metadata as well as activating or deactivating Entando&#8217;s WYSIWYG editor called CKEditor.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_contents_section"><a class="anchor" href="#_contents_section"></a>3.5.2. CONTENTS SECTION</h4>
<div class="olist arabic">
<div class="title">To add new content:</div>
<ol class="arabic">
<li>
<p>Click the <strong>Add</strong> button and select the <a href="#bookmark-contenttypes">Content Type</a> to create.</p>
<div class="imageblock">
<div class="content">
<img src="images/cms_add_content.png" alt="cms add content" width="50%">
</div>
</div>
</li>
<li>
<p>Populate each field with the requisite information. See <a href="#ownjoingroups">Creating a New Page</a> for specifics on Owner Groups and Join Groups. When each field is complete, click <strong>Save</strong>.</p>
</li>
<li>
<p>Once created, you content appears in the table of results at the bottom of the Content List page. You can edit or copy and paste the content through the menu under the <em>Actions</em> column.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Publishing and unpublishing content:</div>
<p>You must publish your content in the CMS before you can display it in an application, and you can unpublish it to remove it from display. To publish or unpublish content:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select the checkbox next to the requisite content item. You may select multiple content items at once.</p>
</li>
<li>
<p>Above the content table, click either the <strong>Approve the content</strong> or <strong>Unpublish</strong> button.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_adding_images_and_tags"><a class="anchor" href="#_adding_images_and_tags"></a>ADDING IMAGES AND TAGS</h5>
<div class="paragraph">
<p>You can add images from the <a href="#bookmark-digitalassets">Digital Assets</a> repository to content. When you do, the image comes with five image tags:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Text</p>
</li>
<li>
<p>Alt</p>
</li>
<li>
<p>Description</p>
</li>
<li>
<p>Legend</p>
</li>
<li>
<p>Title</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You have the option to manually assign values to these tags or automatically populate them with metadata values.</p>
</div>
<div class="olist arabic">
<div class="title"><a id="bookmark-manual_metadata"></a>To manually assign values:</div>
<ol class="arabic">
<li>
<p>Add a new content or select a content from the table and click <strong>Actions</strong> &gt; Edit.</p>
</li>
<li>
<p>Click the <strong>Picture</strong> button and select the Digital Asset to include.</p>
</li>
<li>
<p>Populate the image tags with values and then click <strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">To autopopulate image tags with metadata:</div>
<ol class="arabic">
<li>
<p>Select Apps &gt; CMS &gt; Content Settings.</p>
</li>
<li>
<p>In the Resource Metadata Mapping section, populate any of the fields with the value in the Name column of the Metadata table. You can add multiple values by separating them with commas.</p>
<div class="paragraph">
<p>For example, enter â€œDetected File Type,Compression Typeâ€ in the Alt field to instruct Entando to use those values in the imageâ€™s Alt tag.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/cms_resource_metadata_mappings.png" alt="cms resource metadata mappings" width="50%">
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_digital_assets_2"><a class="anchor" href="#_digital_assets_2"></a>3.5.3. DIGITAL ASSETS</h4>
<div class="paragraph">
<p>The Digital Assets section separates content into Images and Attachments via tabs along the top of the Digital Assets home screen.</p>
</div>
<div class="olist arabic">
<div class="title">To add digital assets:</div>
<ol class="arabic">
<li>
<p>Choose the <em>Images</em> or <em>Attachments</em> tab at the top of the screen, depending on the asset to upload, and click <strong>Add</strong>.</p>
<div class="imageblock">
<div class="content">
<img src="images/cms_digital_assets.png" alt="cms digital assets" width="40%">
</div>
</div>
</li>
<li>
<p>Select a Group and home category, and name the asset.</p>
</li>
<li>
<p>Click the <strong>Choose File</strong> button to select the file to add to the CMS.</p>
</li>
<li>
<p>Click <strong>Done</strong>. The asset appears in the asset list at the bottom of the List of Images or Attachments screen.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_editing_assets"><a class="anchor" href="#_editing_assets"></a>EDITING ASSETS</h5>
<div class="paragraph">
<p>Once you have a digital asset in place, you have several editing and viewing options. Click the asset&#8217;s <strong>More Actions</strong> button and select "Edit" to update the asset&#8217;s name, location, and the file represented.</p>
</div>
</div>
<div class="sect4">
<h5 id="_working_with_an_assets_metadata"><a class="anchor" href="#_working_with_an_assets_metadata"></a>WORKING WITH AN ASSET&#8217;S METADATA</h5>
<div class="paragraph">
<p>Starting with Entando 4.3.4, the platform has captured metadata for every image you have uploaded. View the metadata from the Images tab of the Digital Assets screen by clicking an asset&#8217;s <strong>Actions</strong> menu &gt; Edit. The metadata appears in a table at the bottom of the screen.</p>
</div>
<div class="paragraph">
<p>See the <a href="#bookmark-content_metadata">Adding Images and Tags</a> section for details on using image metadata in contents.</p>
</div>
</div>
<div class="sect4">
<h5 id="_cropping_images"><a class="anchor" href="#_cropping_images"></a>CROPPING IMAGES</h5>
<div class="paragraph">
<p>Beginning with Entando 4.3.5, you can crop images newly uploaded via Digital Assets. You can either crop the image dynamically or by using pre-configured crop ratios.</p>
</div>
<div class="olist arabic">
<div class="title">To set pre-configured crop ratios:</div>
<ol class="arabic">
<li>
<p>Select Apps &gt; CMS &gt; Content Settings.</p>
</li>
<li>
<p>Under â€œSettings Image Crop Dimensions,â€ click <strong>Add</strong>.</p>
</li>
<li>
<p>Enter a crop ratio, using numeric values separated by a colon. See the screenshot below for an example.</p>
</li>
<li>
<p>Click <strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">To dynamically crop an image:</div>
<ol class="arabic">
<li>
<p>Uploading an image to digital assets opens the Edit Image screen with tools to crop the image.</p>
<div class="ulist">
<ul>
<li>
<p>Buttons representing your pre-defined crop ratios are below the image. Clicking any of those buttons changes the selected crop area based on the chosen ratio.</p>
</li>
<li>
<p>You can create multiple crops of a single image as part of the upload process. The right side of the screen displays the list of crops created during the current session.</p>
<div class="imageblock">
<div class="content">
<img src="images/cms_more_cropping.png" alt="cms more cropping">
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Use your mouse or the buttons below the image to move or change the crop area, then click <strong>Save</strong> to crop the selected area. Repeat the process as many times as needed. Each new crop of the image appears under the List of Images to the right of the screen.</p>
<div class="ulist">
<ul>
<li>
<p>Click <strong>Close</strong> to return to the Add Digital Assets screen. Notice that each individual crop of the image now has its own row in the list of resources, as well as a <strong>More Actions</strong> button you can use to edit or delete the image.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Click <strong>Done</strong> to exit the Edit screen.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_content_types_2"><a class="anchor" href="#_content_types_2"></a>3.5.4. CONTENT TYPES</h4>
<div class="paragraph">
<p>Content Types determine the fields that differentiate one piece of content, such as a blog post, from another, like an employee profile.</p>
</div>
<div class="olist arabic">
<div class="title">To create a content type:</div>
<ol class="arabic">
<li>
<p>Navigate to APPS &gt; CMS &gt; Content Types and click the <strong>Add</strong> button.</p>
</li>
<li>
<p>Assign a Code for the type and then a Name, again, such as blog post or employee profile.</p>
</li>
<li>
<p>In the Attributes section, select from the Type drop-down menu an attribute that is necessary to include with this type of content. For example, a blog post would require fields such as Author, Title (text), Timestamp, and Picture (Image). Click the <strong>Add</strong> button to add the attribute to your content type.</p>
</li>
<li>
<p>In the Add Attribute screen, enter code and name values for this attribute. The remaining fields on the screen are optional. When finished, click <strong>Continue</strong> to return to the Add screen.</p>
</li>
<li>
<p>Add as many additional attributes as necessary and then click <strong>Save</strong>. The content type will appear in the table at the top of the Content Types screen.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To edit a content type, click the <strong>Actions</strong> menu in-line with a content type and select "Edit."</p>
</div>
</div>
<div class="sect3">
<h4 id="_content_models"><a class="anchor" href="#_content_models"></a>3.5.5. CONTENT MODELS</h4>
<div class="paragraph">
<p>Content models determine how the CMS arranges your content. The Model section defines the structural layout while any stylesheet that you attach handles the design elements like font, color, and link styles.</p>
</div>
<div class="olist arabic">
<div class="title">To create a content model:</div>
<ol class="arabic">
<li>
<p>Navigate to APPS &gt; CMS &gt; Content Models and click the <strong>Add</strong> button.</p>
</li>
<li>
<p>Select the Content Type that this model applies to, then enter identifiers in the Name and Code fields. Selecting the Content Type helps the Inline Editing feature suggest attributes that are available to arrange. For example, if your Blog Post content type contains attributes for Title, Picture, and Caption, the Inline Editor will be able to suggest those attributes as you enter code into the Model field.</p>
</li>
<li>
<p>Enter code into the Model field. Entando uses Apache Velocity as its template engine to reference objects in Java code. If you&#8217;ve selected a Content Type, the Inline Editing Assist will format the code for easier reading.<br></p>
</li>
</ol>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Hint: Press <strong>CTRL + SPACE</strong> to open Content Assist.<br></p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_content_settings"><a class="anchor" href="#_content_settings"></a>3.5.6. CONTENT SETTINGS</h4>
<div class="paragraph">
<p>The Content Settings section is for fine tuning contents that you have added from the Digital Assets section. You can perform tasks such as autopopulating or excluding metadata for images, or adding and removing metadata fields in the Content Settings section.</p>
</div>
<div class="sect4">
<h5 id="_autopopulating_image_tags"><a class="anchor" href="#_autopopulating_image_tags"></a>AUTOPOPULATING IMAGE TAGS</h5>
<div class="paragraph">
<p>You can also <a href="#bookmark-manual_metadata">manually adjust metadata</a> for an image in the Contents section.</p>
</div>
<div class="olist arabic">
<div class="title">To autopopulate image tags:</div>
<ol class="arabic">
<li>
<p>Select Apps &gt; CMS &gt; Content Settings.</p>
</li>
<li>
<p>In the Resource Metadata Mapping section, populate any of the fields with the value in the Name column of the Metadata table. You can add multiple values by separating them with commas.<br></p>
<div class="paragraph">
<p>For example, enter â€œDetected File Type,Compression Typeâ€ in the Alt field to instruct Entando to use those values in the imageâ€™s alt tag.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_excluding_metadata"><a class="anchor" href="#_excluding_metadata"></a>EXCLUDING METADATA</h5>
<div class="paragraph">
<p>You can exclude metadata fields by name by setting the following property in systemParams.properties:
<code>jacms.imgMetadata.ignoreKeys</code></p>
</div>
<div class="paragraph">
<p>For example:<br>
<code>jacms.imgMetadata.ignoreKeys=Blue TRC,Red TRC,Green TRC</code></p>
</div>
</div>
<div class="sect4">
<h5 id="_adding_and_removing_metadata_fields"><a class="anchor" href="#_adding_and_removing_metadata_fields"></a>ADDING AND REMOVING METADATA FIELDS</h5>
<div class="paragraph">
<p>You can customize the metadata fields displayed in the Resource Metadata Mapping section. By default, the values are Alt, Description, Legend, and Title, but you can add and remove fields.</p>
</div>
<div class="olist arabic">
<div class="title">To add new metadata fields:</div>
<ol class="arabic">
<li>
<p>Enter values in the Key and Mapping fields in line with the â€œAdd metadataâ€ field. The Key field represents the metadataâ€™s name (e.g., Alt or Title). The Mapping field defines the value that populates the field.</p>
</li>
<li>
<p>Click <strong>Add</strong>. You can add as many new metadata fields as necessary.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">To remove a metadata field:</div>
<ol class="arabic">
<li>
<p>Click the <strong>Delete</strong> button in line with the field to remove.<br></p>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
You do not receive a warning before deleting the field and it is not recoverable.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_entando_pwa"><a class="anchor" href="#_entando_pwa"></a>3.6. ENTANDO PWA</h3>
<div class="paragraph">
<p><strong>Progressive Web Apps (<em>PWA</em>)</strong> is the new way to deploy your apps into different platforms without any hassle. Whether you use it as web or even a native-feel app, PWA is one of the great, efficient solution that you can deploy your app in no time.</p>
</div>
<div class="paragraph">
<p>So we took this technology as an advantage to bring you <strong>Entando PWA</strong> which provides you content-driven solutions and deploy in less time.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pwa_shell.png" alt="pwa shell" width="25%">
</div>
</div>
<div class="sect3">
<h4 id="_defining_the_structure"><a class="anchor" href="#_defining_the_structure"></a>3.6.1. DEFINING THE STRUCTURE</h4>
<div class="paragraph">
<p>The system has two main instances,</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>PWA Provider</strong> - Entando core instance that basically manages your content with the use of <a href="#_content_management_system"><strong>CMS (Content Management System)</strong></a>.</p>
</li>
<li>
<p><strong>PWA Shell</strong> - This is the interface-level instance when you can deploy and view your contents from your PWA Provider.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_installation"><a class="anchor" href="#_installation"></a>3.6.2. INSTALLATION</h4>
<div class="paragraph">
<p>This will provide step-by-step installation on launching your very first Entando PWA using your local machine.</p>
</div>
<div class="sect4">
<h5 id="_prerequisites_8"><a class="anchor" href="#_prerequisites_8"></a>PREREQUISITES</h5>
<div class="paragraph">
<p>Ensure that you have installed (<em>mvn install</em>) both Entando Core and Entando Components.</p>
</div>
<div class="paragraph">
<p>For database requirements, you need to make sure that you have a running DBMS (Postgres or MySQL) ready for installation.</p>
</div>
</div>
<div class="sect4">
<h5 id="_git_clone"><a class="anchor" href="#_git_clone"></a>GIT CLONE</h5>
<div class="paragraph">
<p>Enter this in your command line: <code>git clone <a href="https://github.com/entando/entando-pwa.git" class="bare">https://github.com/entando/entando-pwa.git</a></code></p>
</div>
<div class="paragraph">
<p>After cloning, you will notice that there are two folders inside <em>entando-pwa</em> which are "<em>pwa-provider</em>" and "<em>pwa-shell</em>". Go inside "<em>pwa-provider</em>" and follow the next steps.</p>
</div>
</div>
<div class="sect4">
<h5 id="_provider_instance_setup"><a class="anchor" href="#_provider_instance_setup"></a>PROVIDER INSTANCE SETUP</h5>
<div class="paragraph">
<p>This section will give you a quick guide on installation and running the provider instance.</p>
</div>
<div class="paragraph">
<p><strong>1. CREATING DATABASE</strong></p>
</div>
<div class="paragraph">
<p>PWA provider includes Ant tasks for you to use first-hand without the need to setup database manually. Refer to the <a href="#_developers_guide">Developers' guide</a> on configuring Ant and executing afterwards. In default, this system is being setup on a Postgres database environment, so make sure you indicated your preferred database by modifying it in "<em>pwa-provider/buildproperties.xml</em>".</p>
</div>
<div class="paragraph">
<p>For the sake of this procedure (and a possibility that you may have installed PostgreSQL), you can try running <code>ant PG-db-create</code> under "<em>pwa-provider</em>" to install the postgres database.</p>
</div>
<div class="paragraph">
<p><strong>2. SETUP PWA PROVIDER SYSTEM PARAMETERS</strong></p>
</div>
<div class="paragraph">
<p>This has been configured to use Keycloak Authentication, but in this guide, we will be using the default Entando authentication included in the provider instance. So to make sure you have configured the authentication type properly, you need to check on "<em>pwa-provider/src/main/config/systemParams.properties</em>" and see at the end of the line configuration that the keycloak mode is not enabled. Check the line with <strong><em>keycloak.enabled</em></strong> has been set to <strong><em>false</em></strong>.</p>
</div>
<div class="paragraph">
<p><strong>3. RUNNING THE INSTANCE</strong></p>
</div>
<div class="paragraph">
<p>Using the console, and still under "<em>pwa-provider</em>" folder, just simply enter this command line: <code>mvn jetty:run</code> to launch the PWA Provider instance. First time launching the instance can take a little more time because of dependency installations.</p>
</div>
<div class="paragraph">
<p>When you see these lines in the console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[INFO] Started ServerConnector@23746f63{HTTP/1.1,[http/1.1]}{0.0.0.0:8080}
[INFO] Started @80840ms
[INFO] Started Jetty Server</code></pre>
</div>
</div>
<div class="paragraph">
<p>This means your provider instance is ready. You can access this with the URL <a href="http://localhost:8080/pwa-provider" class="bare">http://localhost:8080/pwa-provider</a> using your web browser. This is basically the same interface from your Entando Core Instance. <a href="#_content_management_system">Please refer to CMS</a> on setting up and publishing your content.</p>
</div>
<div class="paragraph">
<p>Now this guarantees that your provider is up and running, it&#8217;s now time to setup your PWA-powered web app!</p>
</div>
</div>
<div class="sect4">
<h5 id="_pwa_instance_setup"><a class="anchor" href="#_pwa_instance_setup"></a>PWA INSTANCE SETUP</h5>
<div class="paragraph">
<p>This section will provide you quick steps on installing your Entando-powered Progressive Web App.</p>
</div>
<div class="paragraph">
<p><strong>1. INSTALL NPM DEPENDENCIES</strong></p>
</div>
<div class="paragraph">
<p>The very first thing you need to do is install the app&#8217;s module dependencies by going into <em>pwa-shell</em> folder and running <code>npm install</code> (or <code>npm i</code>). This may take a while, so maybe grab a coffee or you can proceed on configuring your environment variables.</p>
</div>
<div class="paragraph">
<p><strong>2. CONFIGURE .ENV VARIABLES</strong></p>
</div>
<div class="paragraph">
<p>Before launching the app, you need to ensure that the environment variables are correct. When you open "<em>.env</em>" file under "<em>pwa-shell</em>" folder, you will see variables being preconfigured. For local environment, you should create a file named "<em>.env.local</em>" and enter the following variables:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>REACT_APP_DOMAIN=http://localhost:8080/pwa-provider
REACT_APP_AUTH_TYPE=default
REACT_APP_USE_MOCKS=false
REACT_APP_CLIENT_ID=appbuilder
REACT_APP_CLIENT_SECRET=appbuilder_secret</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><em>REACT_APP_DOMAIN</em></strong> represents your PWA provider instance - the one you launch as a provider in your local environment.</p>
</li>
<li>
<p><strong><em>REACT_APP_AUTH_TYPE</em></strong> will be set as <em>default</em> to tell your app to use the Entando authentication in the provider instance.</p>
</li>
<li>
<p><strong><em>REACT_APP_USE_MOCKS</em></strong> is whether the app will use mock data that exist within the app for testing purposes. In this example, we should use the data provided from PWA provider, so you must set this variable to <em>false</em></p>
</li>
<li>
<p><strong><em>REACT_APP_CLIENT_ID</em></strong> and <strong><em>REACT_APP_CLIENT_SECRET</em></strong> are the required ID&#8217;s to ensure validity of connection between the provider and the app.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>3. LAUNCH THE APP</strong></p>
</div>
<div class="paragraph">
<p>Run the command <code>npm start</code> in <em>pwa-shell</em> folder to launch your app in development mode and you should see the app opened in your web browser as <a href="http://localhost:3000" class="bare">http://localhost:3000</a>. Perfect!</p>
</div>
<div class="paragraph">
<p><strong>4. APP DEPLOYMENT</strong></p>
</div>
<div class="paragraph">
<p>Run command <code>npm run build</code> to build production-level files that will reside under "<em>build</em>" folder after the build process. There are different server platforms to choose to host your app. Visit <a href="https://facebook.github.io/create-react-app/docs/deployment" class="bare">https://facebook.github.io/create-react-app/docs/deployment</a> for more information on deployment.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_keycloak_authentication_feature"><a class="anchor" href="#_keycloak_authentication_feature"></a>3.6.3. KEYCLOAK AUTHENTICATION FEATURE</h4>
<div class="paragraph">
<p>Entando PWA also features Keycloak as the type of authentication for your app. Keycloak is an open source identity and access management solution. This is the good choice if you want extra security for user access. Follow the steps below on how to use the feature.</p>
</div>
<div class="sect4">
<h5 id="_prerequisites_9"><a class="anchor" href="#_prerequisites_9"></a>PREREQUISITES</h5>
<div class="paragraph">
<p>For this feature, you will need to install and launch <strong>Docker</strong> (<a href="https://www.docker.com/" class="bare">https://www.docker.com/</a>). Make sure that your PWA provider and PWA shell are not running as of this point.</p>
</div>
</div>
<div class="sect4">
<h5 id="_keycloak_setup_in_pwa_provider"><a class="anchor" href="#_keycloak_setup_in_pwa_provider"></a>KEYCLOAK SETUP IN PWA PROVIDER</h5>
<div class="paragraph">
<p>This section will provide you extra steps on activating Keycloak authentication feature.</p>
</div>
<div class="paragraph">
<p><strong>1. INSTALL ENTANDO KEYCLOAK PLUGIN</strong></p>
</div>
<div class="paragraph">
<p>Run <code>git clone <a href="https://github.com/entando/entando-keycloak-plugin.git" class="bare">https://github.com/entando/entando-keycloak-plugin.git</a></code> on your terminal console to grab our plugin that is needed in PWA Provider later on. After downloading using git, go in by running <code>cd entando-keycloak-plugin</code> and then run <code>mvn install -DskipTests</code> to maven install Entando Keycloak plugin. It won&#8217;t take long to finish the process.</p>
</div>
<div class="paragraph">
<p><strong>2. LAUNCH DOCKER INSTANCE</strong></p>
</div>
<div class="paragraph">
<p>Going back to the <em>pwa-provider</em> folder, you should see <strong><em>docker-compose.yml</em></strong> file. This will be used to create and launch the keycloak instance. Make sure your Docker is ready, go to console (and <em>pwa-provider</em> folder, of course), run <code>docker-compose up</code> and this will begin launching the instance. For first time, this will take time because of downloading dependencies. You might see these similar lines in your launch console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>keycloak_1  | 03:06:52,998 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0060: Http management interface listening on http://127.0.0.1:9990/management
keycloak_1  | 03:06:52,998 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0051: Admin console listening on http://127.0.0.1:9990
keycloak_1  | 03:06:52,999 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0025: Keycloak 5.0.0 (WildFly Core 7.0.0.Final) started in 22717ms - Started 671 of 931 services (649 services are lazy, passive or on-demand)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This means your keycloak instance is ready. Open <a href="http://localhost:8081" class="bare">http://localhost:8081</a> into your web browser and you should see this screen:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pwa_keycloak_1.png" alt="pwa keycloak 1" width="60%">
</div>
</div>
<div class="paragraph">
<p><strong>3. CONFIGURE KEYCLOAK</strong></p>
</div>
<div class="paragraph">
<p>This section will give you a walkthrough on how you should setup your realm, client ID and other configurables.</p>
</div>
<div class="paragraph">
<p>To begin with the last screen shown, click "<em>Administration Console</em>" and you will be brought to a login screen. Provide our usual login credentials:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>username: admin
password: adminadmin</code></pre>
</div>
</div>
<div class="paragraph">
<p>And now you should be inside the Keycloak admin console.</p>
</div>
<div class="paragraph">
<div class="title">CREATE A REALM:</div>
<p>Navigate to the top left of the screen, under the Keycloak logo, you should see a dropdown with the default realm name <em>master</em>. Below the dropdown, there&#8217;s a button labeled <strong>Add realm</strong>. Click that button.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pwa_keycloak_2_add_realm.png" alt="pwa keycloak 2 add realm" width="40%">
</div>
</div>
<div class="paragraph">
<p>This will only ask for the name of the realm. For this guide, we shall name this as "<em>entando-development</em>". Click <strong>Create</strong> to proceed.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pwa_keycloak_3_realm_form.png" alt="pwa keycloak 3 realm form" width="50%">
</div>
</div>
<div class="paragraph">
<p>Afterwards, this will prompt you to fill more details on your new realm. You don&#8217;t need to touch those. Moving on to next.</p>
</div>
<div class="paragraph">
<div class="title">CLIENTS SETTINGS:</div>
<p>When you look at the navigation again, you should be seeing "<em>Clients</em>" menu.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pwa_keycloak_4_clients_nav.png" alt="pwa keycloak 4 clients nav" width="20%">
</div>
</div>
<div class="paragraph">
<p>Click on that then this will bring you to list of Clients for your realm. With this, we need to create two clients named "<em>entando-app</em>" and "<em>entando-pwa</em>".</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pwa_keycloak_5_clients_list.png" alt="pwa keycloak 5 clients list" width="70%">
</div>
</div>
<div class="paragraph">
<p>Click "<strong>Create</strong>" button on top right of the list to begin.</p>
</div>
<div class="paragraph">
<p>For the first entry, give the client an ID with <em>entando-app</em>. Then click <strong>Save</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pwa_keycloak_6_create_client.png" alt="pwa keycloak 6 create client" width="40%">
</div>
</div>
<div class="paragraph">
<p>Now on the Client details form and under <strong>Settings</strong> tab,</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Give it a name "<em>entandoApp</em>".</p>
</li>
<li>
<p>Make the <strong>Access Type</strong> "<em>confidential</em>".</p>
</li>
<li>
<p>Turn on <strong>Implicit Flow Enabled</strong>.</p>
</li>
<li>
<p>Turn on <strong>Service Accounts Enabled</strong>.</p>
</li>
<li>
<p>on the <strong>Valid Redirect URIs</strong> field, place "<em><a href="http://localhost:8080/*" class="bare">http://localhost:8080/*</a></em>" and press the + button.</p>
</li>
<li>
<p>click <strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pwa_keycloak_7_entando_app_client_detail.png" alt="pwa keycloak 7 entando app client detail" width="40%">
</div>
</div>
<div class="paragraph">
<p>After saving, go to the <strong>Credentials</strong> tab and should see the secret key. Take note of the secret key because we&#8217;re going to use this later on under the PWA shell configuration.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pwa_keycloak_8_entando_app_client_credentials.png" alt="pwa keycloak 8 entando app client credentials" width="40%">
</div>
</div>
<div class="paragraph">
<p>Now go to <strong>Roles</strong> tab, then it should show that there are no client roles available. You must add the roles into the list. Click the <strong>Add Role</strong> button on top right to start adding the following roles (with patience):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>manageCategories</strong></p>
</li>
<li>
<p><strong>manageResources</strong></p>
</li>
<li>
<p><strong>editContents</strong></p>
</li>
<li>
<p><strong>editUserProfile</strong></p>
</li>
<li>
<p><strong>viewUsers</strong></p>
</li>
<li>
<p><strong>validateContents</strong></p>
</li>
<li>
<p><strong>managePages</strong></p>
</li>
<li>
<p><strong>enterBackend</strong></p>
</li>
<li>
<p><strong>superuser</strong></p>
</li>
<li>
<p><strong>editUsers</strong></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pwa_keycloak_9_entando_app_client_roles.png" alt="pwa keycloak 9 entando app client roles" width="70%">
</div>
</div>
<div class="paragraph">
<p>After that, go to <strong>Service Account Roles</strong> tab and go to the lower right where you can see the <strong>Client Roles</strong> dropdown and select "<em>realm-management</em>". On right you should see a menu list that you can add to the <strong>Assigned Roles</strong> list. Choose "<em>realm-admin</em>" and press <strong>Add selected</strong> to add <em>realm-admin</em> to the <strong>Assigned Roles</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pwa_keycloak_10_entando_app_client_service_accounts.png" alt="pwa keycloak 10 entando app client service accounts" width="35%">
</div>
</div>
<div class="paragraph">
<p>Now you&#8217;re done with <strong><em>entando-app</em></strong> client. But you need to add one more, which is "<em>entando-pwa</em>". On the left nav, click <strong>Clients</strong> again and go to the rightmost side and click <strong>Create</strong>.</p>
</div>
<div class="paragraph">
<p>For the second entry, give the client an ID with <em>entando-pwa</em>. Then click <strong>Save</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pwa_keycloak_11_entando_pwa_client.png" alt="pwa keycloak 11 entando pwa client" width="50%">
</div>
</div>
<div class="paragraph">
<p>Now for the details form and under <strong>Settings</strong> tab, do the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Give it a name "<em>entandoPwa</em>".</p>
</li>
<li>
<p>Change the <strong>Login Theme</strong> to "<em>entando</em>".</p>
</li>
<li>
<p><strong>Direct Access Grants Enabled</strong> should be <strong><em>off</em></strong></p>
</li>
<li>
<p>on the <strong>Valid Redirect URIs</strong> field, add "<em><a href="http://localhost:8080/*" class="bare">http://localhost:8080/*</a></em>" and "<em><a href="http://localhost:3000/*" class="bare">http://localhost:3000/*</a></em>".</p>
</li>
<li>
<p>under <strong>Web Origins</strong> field, add "<em><a href="http://localhost:8080" class="bare">http://localhost:8080</a></em>" and "<em><a href="http://localhost:3000" class="bare">http://localhost:3000</a></em>".</p>
</li>
<li>
<p>click <strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pwa_keycloak_12_entando_pwa_client_detail.png" alt="pwa keycloak 12 entando pwa client detail" width="40%">
</div>
</div>
<div class="paragraph">
<p>And that should be it for the <strong>Clients</strong> section.</p>
</div>
<div class="paragraph">
<div class="title">AUTHENTICATION SETTINGS:</div>
<p>This should be pretty quick for this section. This is for demo purposes only since we don&#8217;t want to use OTP in the local environment, we should disable it. So going to the <strong>Authentication</strong> settings on the left nav, under <strong>Flows</strong> tab, open the dropdown (with <strong>HTTP Challenge</strong> in it) and change it to <strong>Browser</strong>. At the bottomost part of the table, you should see a field <strong>OTP Form</strong>. Choose "<em>Disabled</em>" and you&#8217;re done.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pwa_keycloak_13_authentication_browser.png" alt="pwa keycloak 13 authentication browser" width="70%">
</div>
</div>
<div class="paragraph">
<div class="title">CREATE A USER:</div>
<p>If you wanted to test its user access capability, we need to create a user. On the left nav, go to <strong>Users</strong> and on the (supposedly empty) user list, press <strong>Add User</strong> at the right side of it.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pwa_keycloak_14_users.png" alt="pwa keycloak 14 users" width="50%">
</div>
</div>
<div class="paragraph">
<p>Give it a username, and some basic information. For this guide, We&#8217;ll use "<em>admin</em>" as the username and other basic information you see on the screenshot below, then hit <strong>Save</strong> button.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pwa_keycloak_15_add_user.png" alt="pwa keycloak 15 add user" width="40%">
</div>
</div>
<div class="paragraph">
<p>Lastly, you need to set its password. Go to <strong>Credentials</strong> tab and fill out its new password and make sure to switch <strong>Temporary</strong> field to "<em>off</em>". Then press <strong>Reset Password</strong> button to set the password.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pwa_keycloak_16_user_credentials.png" alt="pwa keycloak 16 user credentials" width="40%">
</div>
</div>
<div class="paragraph">
<p>Now you have finally finished configuring your Keycloak instance. Time for us to go back to your PWA Provider and configure it with Keycloak!</p>
</div>
</div>
<div class="sect4">
<h5 id="_configure_pwa_provider_instance_with_keycloak"><a class="anchor" href="#_configure_pwa_provider_instance_with_keycloak"></a>CONFIGURE PWA PROVIDER INSTANCE WITH KEYCLOAK</h5>
<div class="paragraph">
<p>You should be in your <em>pwa-provider</em> in your terminal console. Locate again <em>pwa-provider/src/main/config/systemParams.properties</em> and open it. We need to reconfigure the Keycloak settings. See again at the end part of the file and change the ff:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>keycloak.enabled=true</strong> - enabling keycloak auth</p>
</li>
<li>
<p><strong>keycloak.authUrl=${KEYCLOAK_AUTH_URL:http://localhost:8081/auth}</strong> - your keycloak console url, this usually ends with "<em>auth</em>".</p>
</li>
<li>
<p><strong>keycloak.realm=${KEYCLOAK_REALM:entando-development}</strong> - your realm name</p>
</li>
<li>
<p><strong>keycloak.clientId=${KEYCLOAK_CLIENT_ID:entando-app}</strong> - from your client in realm</p>
</li>
<li>
<p><strong>keycloak.clientSecret=${KEYCLOAK_CLIENT_SECRET:&lt;YOUR CLIENT SECRET KEY&gt;}</strong> - The secret key (remember about the secret key that you took note earlier in Keycloak setup)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Save it. and then run <code>mvn jetty:run</code> in your console to launch your PWA Provider instance. This should go well if you have followed the procedure on setting up Keycloak.</p>
</div>
</div>
<div class="sect4">
<h5 id="_configure_pwa_app_pwa_shell_with_keycloak"><a class="anchor" href="#_configure_pwa_app_pwa_shell_with_keycloak"></a>CONFIGURE PWA APP (PWA-SHELL) WITH KEYCLOAK</h5>
<div class="paragraph">
<p>We need to tell the app that we are now using Keycloak authentication for user management and security. Go now to <em>pwa-shell</em> folder and open <strong><em>.env.local</em></strong> to make changes on the environmental variables:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>REACT_APP_AUTH_TYPE=keycloak
...
REACT_APP_KEYCLOAK_REALM=entando-development
REACT_APP_KEYCLOAK_CLIENT_ID=entando-pwa</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong><em>REACT_APP_AUTH_TYPE</em></strong> is now "<em>keycloak</em>" and we add two variables named <strong><em>REACT_APP_KEYCLOAK_REALM</em></strong> with your realm name "<em>entando-development</em>" and <strong><em>REACT_APP_KEYCLOAK_CLIENT_ID</em></strong> with "<em>entando-pwa</em>" for this is the 2nd client we created back at Keycloak setup.</p>
</div>
<div class="paragraph">
<p>Don&#8217;t forget to save it. Then run command <code>npm start</code> to test it out.</p>
</div>
<div class="paragraph">
<p>This concludes your setup guide your Keycloak-powered Entando PWA!</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_styling_rebranding"><a class="anchor" href="#_styling_rebranding"></a>3.6.4. STYLING / REBRANDING</h4>
<div class="paragraph">
<p>This section will help you style your Entando PWA <em>(pwa-shell)</em> app in no time. We should start with the name of your app.</p>
</div>
<div class="sect4">
<h5 id="_app_naming"><a class="anchor" href="#_app_naming"></a>APP NAMING</h5>
<div class="paragraph">
<p>There are 2 files we need to modify:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong><em>public/manifest.json</em></strong> - This is the <a href="https://developers.google.com/web/fundamentals/web-app-manifest/">Web App Manifest</a> file of your app. All you need to do is change the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><strong>"short_name"</strong> - that will be used on the user&#8217;s home screen, launcher, or limited-space areas</p>
</li>
<li>
<p>and <strong>"name"</strong> - that will be used on <em>App Install Prompt</em>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><em>src/HomePageHead.js</em></strong> - look for the lines:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>const name = 'Entando PWA';
const shortName = 'Entando';</code></pre>
</div>
</div>
<div class="paragraph">
<p>Modify them with same <em>name</em> and <em>short_name</em> you placed in the web app manifest file.</p>
</div>
</div>
<div class="sect4">
<h5 id="_icons_splash_screens"><a class="anchor" href="#_icons_splash_screens"></a>ICONS &amp; SPLASH SCREENS</h5>
<div class="paragraph">
<p>Your logo will be needed to represent your app (as an icon and splash screen when user starts your app). They will be needed once your app is being added to user&#8217;s device. These are already specified in your <em>public/manifest.json</em>. All you need to do is replace the icons using your own.</p>
</div>
<div class="paragraph">
<p>For the icons, there are two areas for you to modify:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <strong>"public"</strong> folder - basically there are two specifics in this folder you need to customize:</p>
<div class="ulist">
<ul>
<li>
<p>the Favicon (<strong>favicon.png</strong>) - you can also use .ico for this</p>
</li>
<li>
<p><strong>app-icons</strong> subfolder - inside there are two files, <em>icon-192.png</em> and <em>icon-512.png</em>. Both must be similar and has dimensions of 192x192 pixels and 512x512 pixels, respectively.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>"src/images/apple"</strong> folder - there will be a handful of files for you to customize. They are all going to be used under iOS platforms. Take note of these files mentioned below for you to convert:</p>
<div class="ulist">
<ul>
<li>
<p><strong>icon-&lt;size&gt;.png</strong> - 4 icon sizes you have to provide: 152x152, 167x167, 180x180, and 512x512.</p>
</li>
<li>
<p><strong>launch-&lt;size&gt;.png</strong> - 9 launch screens for various <a href="http://iosres.com/">iOS phones and tablets</a>:</p>
<div class="ulist">
<ul>
<li>
<p>750x1334 - iPhone 6, 6s, 7, 8</p>
</li>
<li>
<p>828x1792 - iPhone XR</p>
</li>
<li>
<p>1125x2436 - iPhone X &amp; Xs</p>
</li>
<li>
<p>1242x2208 - iPhone 8 Plus, 6 Plus, 6s Plus, 7 Plus</p>
</li>
<li>
<p>1242x2688 - iPhone Xs Max</p>
</li>
<li>
<p>1536x2048 - iPad Pro (9.7-inch), all iPad Air&#8217;s, all iPad Mini&#8217;s</p>
</li>
<li>
<p>1668x2224 - iPad Pro (10.5-inch)</p>
</li>
<li>
<p>1668x2388 - iPad Pro (11-inch)</p>
</li>
<li>
<p>2048x2732 - iPad Pro 12.9-inch (2nd generation), iPad Pro (12.9-inch)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_logos_icons_other_image_assets"><a class="anchor" href="#_logos_icons_other_image_assets"></a>LOGOS, ICONS &amp; OTHER IMAGE ASSETS</h5>
<div class="paragraph">
<p>This section will give you a quick guide on what are in-app image assets you can modify. Take note that all image assets you can find are inside <strong><em>pwa-shell/src/images</em></strong> folder.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>The Header Logo</strong> - this is a horizontal-type image that is obviously located at the header of your app. Look for the image file <strong><em>Logo_horizontal@2x.jpg</em></strong> under <em>src/images</em> folder.</p>
</li>
<li>
<p><strong><em>Vertical</em> Logo</strong> - this is a square-type logo that is usually found on login page and an empty-state notification page. Refer to the image file <strong><em>Logo_vertical@2x.png</em></strong> and <strong><em>Logo_vertical@1x.png</em></strong>.</p>
</li>
<li>
<p><strong>Other icons</strong> - other icons you can find (like search, notification, menu, etc.) are found under <strong><em>src/images/icons</em></strong> folder. These are SVG files so you can easily change its colors using CSS.</p>
</li>
<li>
<p><strong><em>Footer</em> Background Image</strong> - You can see this background image file when you scroll to the bottommost of the page. You can replace this with the file <strong><em>Vegetato@2x.png</em></strong> under <em>src/images</em> folder.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_color_themes"><a class="anchor" href="#_color_themes"></a>COLOR THEMES</h5>
<div class="paragraph">
<p>Your App colors can be modified by changing SCSS variables under <strong><em>src/styles/variables.scss</em></strong> file. At the beginning of the file, you should see these lines:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$color-primary: #203752;
$color-primary-light: #455b71;
$color-primary-lightest: #cfcfd4;
$color-primary-text: #fff;
$color-secondary: #f6f6f7;
$color-secondary-light: #d1d6db;
$color-secondary-lightest: #fff;
$color-secondary-text: #7b7f82;
$color-accent: #19bcff;

$color-red: #ff7e7d;
$color-dark: #7b7f82;
$color-darkest: #1c2024;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The theme is consist of 5 representations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Primary</strong> - the main color of your app. This is used basically on the header background. It is recommended to use a color that is in visually contrast to the specified secondary color. This has 4 sub entites:</p>
<div class="ulist">
<ul>
<li>
<p><strong>"color-primary"</strong> - the main primary color</p>
</li>
<li>
<p><strong>"color-primary-light"</strong> - a light version of the main primary color</p>
</li>
<li>
<p><strong>"color-primary-lightest"</strong> - a more, lighter version of the main primary color</p>
</li>
<li>
<p><strong>"color-primary-text"</strong> - text color to be used against the primary color (specifically when primary color is used as background).</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Secondary</strong> - the second color of your app. This is used basically on the body background. It is recommended to use a color that is in visually contrast to the specified primary color. This has 4 sub entites:</p>
<div class="ulist">
<ul>
<li>
<p><strong>"color-secondary"</strong> - the main secondary color</p>
</li>
<li>
<p><strong>"color-secondary-light"</strong> - a light version of the main secondary color</p>
</li>
<li>
<p><strong>"color-secondary-lightest"</strong> - a more, lighter version of the main secondary color</p>
</li>
<li>
<p><strong>"color-secondary-text"</strong> - text color to be used against the secondary color (specifically when secondary color is used as background).</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Accent / color-accent</strong> - this is basically used as color for call-to-Action buttons. It is recommended to use a color that stands out against the two color groups mentioned above.</p>
</li>
<li>
<p><strong>The error color / color-red</strong> - the color used for erroneous entities such as alerts.</p>
</li>
<li>
<p><strong>The dark color / color-dark(darkest)</strong> - the color used for some parts of the app that are needed a dark contrast.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_the_pwa_shell_code_structure"><a class="anchor" href="#_the_pwa_shell_code_structure"></a>3.6.5. THE PWA SHELL CODE STRUCTURE</h4>
<div class="paragraph">
<p>If you want to take your PWA app into the next level with regards to changing the layout, you can to customize it deeper. In order for you to achieve customization, you need React JS experience, browse to <strong>"pwa-shell"</strong> folder and these guides below.</p>
</div>
<div class="sect4">
<h5 id="_layout_components"><a class="anchor" href="#_layout_components"></a>LAYOUT COMPONENTS</h5>
<div class="paragraph">
<p>All layout-related components are located in <strong>"src/ui"</strong> folder. It&#8217;s corresponding stylesheets (SCSS) are located in <strong>"src/styles"</strong> folder. Here are some essential files that are commonly known to modify for customisation:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>App.js</strong> - the main shell of your app. The stylesheet file is in <em>"src/styles/app.scss"</em>.</p>
</li>
<li>
<p><strong>HomePageHead.js</strong> - contains head metadata of your app including the name, icon locations, etc.</p>
</li>
<li>
<p><strong>content-list</strong> folder - consist of components that are used around the main page or your content list. The stylesheet file is in <em>"src/styles/content-list.scss"</em>. You can modify the layout with the following files:</p>
<div class="ulist">
<ul>
<li>
<p><strong>ContentListTopBar.js</strong> - the top bar of your content list page. Stylesheet file is in <em>"src/styles/topbar.scss"</em>.</p>
</li>
<li>
<p><strong>ContentList.js</strong> - the body (excluding top bar) of your content list page. This includes the selected categories (<code>&lt;SelectedCategoryList /&gt;</code>) and content list items (<code>&lt;ContentListItem /&gt;</code>)</p>
</li>
<li>
<p><strong>SelectedCategoryList.js</strong> - selected categories block related to the current content list. Stylesheet file is in <em>"src/styles/selected-category-list.scss"</em>.</p>
</li>
<li>
<p><strong>ContentListItem.js</strong> - the shell of the content item (or content model) used to the list. You can refer to both <em>"src/styles/content-list-item.scss"</em> for the shell style and <em>"src/styles/content-model.css"</em> for the content model stylesheet.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>content-detail</strong> folder - contains components that are used in the content detail view.</p>
<div class="ulist">
<ul>
<li>
<p><strong>ContentDetailTopBar.js</strong> - the top bar of your content view page.</p>
</li>
<li>
<p><strong>ContentDetail.js</strong> - the body layout of content view page. The stylesheet file is in <em>"src/styles/content-detail.scss"</em>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>menu</strong> folder - areas used around the app working as essential controls (such as menu, search, etc.)</p>
<div class="ulist">
<ul>
<li>
<p><strong>Drawer.js</strong> - the app drawer. Stylesheet is in <em>"src/styles/drawer.scss"</em>.</p>
</li>
<li>
<p><strong>CategoryFilter.js</strong> - the category filtering control found in the app drawer. Stylesheet is in <em>"src/styles/category-filter.scss"</em>.</p>
</li>
<li>
<p><strong>Logout.js</strong> - Simply contains the logged user information and logout button control. Stylesheet is in <em>"src/styles/drawer.scss"</em>.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_api_methods"><a class="anchor" href="#_api_methods"></a>API METHODS</h5>
<div class="paragraph">
<p>API methods in this app are used with <a href="https://github.com/entando/frontend-libraries/tree/master/packages/entando-apimanager#api-requests">Entando&#8217;s API Manager</a> going to specified PWA Provider instance. All related files are located inside <strong>pwa-shell/src/api</strong> folder. Here are the following files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>content.js</strong> - All content related requests such as content details (protected and public), and content list.</p>
</li>
<li>
<p><strong>category.js</strong> - contains category listing around your PWA app.</p>
</li>
<li>
<p><strong>contentType.js</strong> - contains content type listing including your default content type for your app.</p>
</li>
<li>
<p><strong>notification.js</strong> - notification related requests such as the user&#8217;s notification list.</p>
</li>
<li>
<p><strong>userProfile.js</strong> - profile details of the logged user</p>
</li>
<li>
<p><strong>login.js</strong> - login request for viewing protected contents</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information on section details mentioned above, see <a href="#_content_management_system">CMS (Content Management System)</a> for more details.</p>
</div>
</div>
<div class="sect4">
<h5 id="_i18n"><a class="anchor" href="#_i18n"></a>I18N</h5>
<div class="paragraph">
<p>Entando PWA features a quick way to generate a language (JSON) file generator for the developer to easily customise. This is powered by react-intl with the efficient tools of <a href="https://github.com/evenchange4/react-intl.macro">react-intl.macro</a> to extract messages around the app and followed by <a href="https://github.com/GertjanReynaert/react-intl-translations-manager">react-intl translations manager</a> to gather all the extracted messages and place them all under one JSON file per language to efficiently let the developer translate the needed messages depending on your specified language.</p>
</div>
<div class="paragraph">
<p>Should you need to create or change the language, here are some steps for you to do:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>open <strong>"pwa-shell/scripts/bundleTranslations.js"</strong> and look for this code:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>bundleTranslations({
  messagesDirectory: '.messages',
  translationsDirectory: 'src/i18n/translations/',
  languages: ['it'],
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can set for the language by modifying <code>languages</code> array. You can have multiple languages if you  want. For this example, we have indicated to use <strong>'it'</strong> as your language.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>After indicating your languages. Save the modified file. Then in <strong>"pwa-shell"</strong> console, run this command:</p>
<div class="literalblock">
<div class="content">
<pre>npm run i18n</pre>
</div>
</div>
</li>
<li>
<p>this will process on creating language JSON structure that is used around the app. You can check the result under the folder <strong>"pwa-shell/src/i18n/translations/it.json"</strong> and modify the necessary messages that fits with the default message.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
  "categoryfilter.selectTopic": "Seleziona i tuoi argomenti di interesse",
  "categorylist.topicsViewing": "Argomenti che stai visualizzando",
  "contentdetail.loadingProgress": "Caricamento...",
  "contentlist.loadingProgress": "Caricamento...",
  ...,
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the example above, you have modified the message translations with <strong>'it'</strong> (Italian) language.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In order for you to use the translation you just worked on, you should modify the file <strong>"pwa-shell/src/i18n/locales.js"</strong> and include your newly generated and modified json file from the previous step.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>import it from 'i18n/translations/it.json';

// English is the default message in each of our source files, so no need for a separate en.json file
const en = {};

export default { en, it };</code></pre>
</div>
</div>
<div class="paragraph">
<p>for the example above, <strong>"it"</strong> language has been added to the list of locales.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>open <code>pwa-shell/src/state/appConfig.js</code>, and set <strong>"languageCode"</strong> to <strong>'it'</strong>. Save it then you should be good to go using your new language. Run <code>npm start</code> to check it out.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_entandos_custom_jsp_tags"><a class="anchor" href="#_entandos_custom_jsp_tags"></a>3.7. ENTANDO&#8217;S CUSTOM JSP TAGS</h3>
<div class="paragraph">
<p><strong>Tag name:</strong> action<br>
<strong>Function:</strong> Build the URL to call a jsp or a functionality of a servlet defined within the system.<br>
<strong>Available subtags:</strong> Parameter tag for adding URL parameters.<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The relative path of the JSP or servlet to invoke, relative to the context of the web-application.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page-scoped variable where to place the URL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> categories<br>
<strong>Function:</strong> Return the list of the system categories on SelectItem objects<br>
<strong>Available subtags:</strong> None.<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">titleStyle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The style of the single select item. Currently it can be â€œdefaultâ€ (single title node), â€œfullâ€ (title with all parents), or â€œprettyFullâ€ (title with all parents in form of â€˜..â€™). The default when none is given is â€œdefaultâ€.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fullTitleSeparator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the separator between the titles when 'titleStyle' is 'full' or 'prettyFull'.]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page-scoped variable where to place the list of categories.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">root</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The root of the categories to show. The default is the system root categories.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> checkHeadInfoOuputter - Use only in widgets<br>
<strong>Function:</strong> this subtag verifies the availability of the information to display. Use this subtag ONLY in a page model, in conjunction with â€˜outputHeadInfoâ€™.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the type of information to analyze.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> contentNegotiation * DEPRECATED. This function was moved into the executor service since Entando 4.1.</p>
</div>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> cssURL<br>
<strong>Function:</strong> Extension of the resourceURL tag. It returns the URL of the css files.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong> None</p>
</div>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> currentPage<br>
<strong>Function:</strong> Returns the requested information held by the current page bean.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The wanted parameter; can be either â€œtitleâ€, â€œownerâ€ (group), â€œcodeâ€, â€œhasChildâ€, or â€œchildOf (with attribute â€œtargetPageâ€. The default when none is given is â€œtitleâ€.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">langCode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code of the language to use for the page information being returned.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page context variable where the information is placed. Note that in this case, special characters are not escaped.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">targetPage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Target page when "param" is "childOf".</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decides whether to escape the special characters in the information retrieved. Values admitted are true/false. Default is true.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> currentWidget<br>
<strong>Function:</strong> Returns information about the widget where the tag resides. To retrieve information about a widget placed in a frame other than the current one, use the â€œframeâ€ attribute.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The requested parameter. It can assume one of the following values:<br>
* "code" returns the code of the associated widget type (empty if none associated)<br>
* "title" returns the name of the associated widget type (empty if none associated)<br>
* "config" returns the value of the configuration parameter declared in the "configParam" attribute<br>
The default is â€œtitleâ€</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">configParam</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the configuration parameter request. This attribute is mandatory when the attribute â€œparamâ€ is set to â€œconfig.â€</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page context variable where the requested information is pushed. In this case the special characters will not be escaped.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">frame</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Id of the frame hosting the widget with the desired information.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decides whether to escape the special characters in the information retrieved. Values admitted are true/false. Default is true.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> currentShowlet * DEPRICATED - Use currentWidget for Entando versions 4.0.0+<br>
<strong>Function:</strong> Returns informations about the widget where the tag resides. To obtain information about a widget placed in a frame other than the current, use the "frame" attribute.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The requested parameter. It can assume one of the following values:<br>
* "code" returns the code of the associated widget type (empty if none associated)<br>
* "title" returns the name of the associated widget type (empty if none associated)<br>
* "config" returns the value of the configuration parameter declared in the "configParam" attribute<br>
The default is â€œtitleâ€</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">configParam</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the configuration parameter request. This attribute is mandatory when the attribute â€œparamâ€ is set to â€œconfig.â€</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page context variable where the requested information is pushed. In this case the special characters will not be escaped.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">frame</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Id of the frame hosting the widget with the desired information.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decides whether to escape the special characters in the information retrieved. Values admitted are true/false. Default is true.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> fragment<br>
<strong>Function:</strong> Print a gui fragment by the given code.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">code</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The code of the fragment to return.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page context variable where the requested information is pushed. In this case the special characters will not be escaped.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decides whether to escape the special characters in the information retrieved. Values admitted are true/false. Default is true.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> freemarkerTemplateParameter<br>
<strong>Function:</strong> Add a parameter into the Freemarker&#8217;s TemplateModel Map<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the variable where the requested information is pushed.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">valueName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the variable of the page context where extract the information.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">removeOnEndTag</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to remove the parameter on end of Tag.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> headInfo * SPECIAL SYSTEM TAG - Use only in widgets<br>
<strong>Function:</strong> Declares the information to insert in the header of the HTML page. The information can be passed as an attribute or, in an indirect manner, through a variable of the page context.<br></p>
</div>
<div class="paragraph">
<p>It is mandatory to specify the type of the information.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaration of the information type. Currently only "CSS" is currently supported.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Information to declare. This is an alternative of the "var" attribute.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the variable holding the information to declare.This attribute is the alternative of the "info" one. This variable can be used for those types of information that cannot be held by an attribute.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> i18n<br>
<strong>Function:</strong> Return the string associated to the given key in the specified language.This string is either returned (and rendered) or can be optionally placed in a page context variable.<br></p>
</div>
<div class="paragraph">
<p>This tag can use the ParameterTag sub-tag to add label parameters.<br>
<strong>Available subtags:</strong> ParameterTag<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key of the label to return.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lang</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code of the language requested for the label.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page context variable where the requested information is pushed. In this case the special characters will not be escaped.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decides whether to escape the special characters in the information retrieved. Values admitted are true/false. Default is true.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> ifauthorized<br>
<strong>Function:</strong> Toggles the visibility of the elements contained in its body, depending on user permissions.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">permission</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The code of the permission required.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">groupName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the group membership required.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the (boolean) page context parameter where the result of the authorization check is placed.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> imageURL<br>
<strong>Function:</strong> Extension of the ResourceURL tag. It returns the URL of the images to display as static content outside the cms.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong> None</p>
</div>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> info<br>
<strong>Function:</strong> Returns the information of the desired system parameter.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key of the desired system parameter, admitted values are:<br>
* "startLang" returns the code of start language of web browsing<br>
* "defaultLang" returns the code of default language<br>
* "currentLang" returns the code of current language<br>
* "langs" returns the list of the languages defined in the system<br>
* "systemParam" returns the value of the system param specified in the "paramName" attribute.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the variable where to store the retrieved information (page scope).
In this case the special characters will not be escaped.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">paramName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the wanted system parameter; it is mandatory if the "key" attribute is "systemParam", otherwise it is ignored.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Toggles the escape of special characters in the information retrieved. Values admitted are true/false. Default is true.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> internalServlet * SPECIAL SYSTEM TAG - Use only in widgets<br>
<strong>Function:</strong> Tag for the "Internal Servlet" functionality. Publishes a function served by an internal Servlet; the servlet is invoked from a path specified in the attribute "actionPath" or by the widget parameter sharing the same name. This tag can be used only in a widgets.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">actionPath</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The initial action path.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">staticAction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to execute only the given action path. Possible entries (true/false). Default value: false.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> externalFramework * DEPRECATED*; use "internalServlet" instead.<br>
<strong>Function:</strong> Tag for the "External Framework" widget.</p>
</div>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> outputHeadInfo * SPECIAL SYSTEM TAG - Use only in page models<br>
<strong>Function:</strong> Iterates over various information in HTML header displaying them; this tag works in conjunction with other specific sub-tags. Note that the body can contain <strong>only</strong> a sub-tag, or information, at once. This tag must be used <strong>only</strong> in a page model.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Attribute</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Function</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Required?</strong></p>
<p class="tableblock">type
Specifies the type of information to return, in accordance with the sub-tag to use.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> pageInfo<br>
<strong>Function:</strong> Returns the information of the specified page. This tag can use the sub-tag "ParameterTag" to add url parameters if the info attribute is set to 'url'.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pageCode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The code of the page.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code of required page parameter. Possible entries: "code" (default value) , "title", "owner" (group), "url", "hasChild" or "childOf" (with attribute "targetPage").</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">langCode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code of the language to use for the returned information.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name used to reference the value pushed into the pageContext. In this case, the system <strong>will not</strong> escape the special characters in the value entered in pageContext.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">targetPage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Target page when "param" is "childOf".</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to escape HTML. Possible entries (true/false). Default value: true.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> pager<br>
<strong>Function:</strong> List pager.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum value for each object group.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">listName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the list as found in the request.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">objectName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the object currently iterated. The following methods are exposed: getMax, getPrevItem, getNextItem, getCurrItem, getSize, getBegin, getEnd, getMaxItem, getPagerId.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pagerId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the ID of the pager itself, it has to be used when two or more pagers exist in the same page. This attributes overrides "pagerIdFromFrame".</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pagerIdFromFrame</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the ID of the pager (mandatory when two or more pagers share the same page) based upon the frame where the tag is placed. Admitted values are (true/false), the latter being the default. Note that the "pagerId" attribute takes precedence over this one.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">advanced</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Toggles the pager in advanced mode. Admitted values are (true/false). Use the advanced mode the tag is used when the list to iterate over is excessively large.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">offset</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This attribute is considered only when the pager is in advanced mode. This is the numeric value of the single step increment (or decrement) when iterating over the list.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> parameter<br>
<strong>Function:</strong> This tag can be used to parameterise other tags. The parameter value can be added through the 'value' attribute or the body tag. When you declare the param tag, the value can be defined in either a value attribute or as text between the start and the ending of the tag.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the parameter.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value of the parameter.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> printHeadInfo - Use only with pagemodels<br>
<strong>Function:</strong> Returns the information to display. This sub-tag must be used <strong>only</strong> in a page model, in conjunction with 'outputHeadInfo'.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong> None</p>
</div>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> resourceURL<br>
<strong>Function:</strong> Returns URL of the resources.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">root</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the resource root. If not otherwise specified, the value of SystemConstants.PAR_RESOURCES_ROOT_URL is used.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">folder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares a specific directory for the desired resources. Unless specified,the value "" (empty string) is used to generate the URL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> show * SPECIAL SYSTEM TAG - Use only in pagemodels<br>
<strong>Function:</strong> Defines the position of inclusion of a widget. This tag can be used <strong>only</strong> in a page model.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">frame</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The positional number of the frame, starting from 0.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> url<br>
<strong>Function:</strong> Generates the complete URL of a portal page. The URL returned is either returned (and rendered) or placed in the given variable. To insert parameters in the query string the sub-tag "ParameterTag" is provided.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">page Code of the destination page. The default is the current page.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lang</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code of the language to use in the destination page.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page-scoped variable where to place the URL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">paramRepeat</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Repeats in the URL all the parameters of the actual request.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">excludeParameters</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> urlPar * DEPRECATED - use ParameterTag instead<br>
<strong>Function:</strong> This is the sub-tag of the "url" tag. Adds a parameter in the URL query string generated.</p>
</div>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> pageWithWidget<br>
<strong>Function:</strong> Search and return the page (or the list of pages) with the given widget type. When "filterParamName" and "filterParamValue" attributes are present, the returned list will be filtered by a specific widget configuration.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">widgetTypeCode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The code of the widget to search.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">filterParamName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional widget config param name.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">filterParamValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional widget config param value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">listResult</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional, dafault false. When true the result is a list of pages, when false the returned page is the first occurence.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> currentUserProfileAttribute<br>
<strong>Function:</strong> Current User Profile tag. Return an attribute value of the current user profile.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributeName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the attribute from which extract the value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributeRoleName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the attribute role from which extract the value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name used to reference the value pushed into the pageContext.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decides whether to escape the special characters in the information retrieved or not. Value admitted (true/false). The default is true.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> userProfileAttribute<br>
<strong>Function:</strong> User profile tag. Returns an attribute value from the profile give a an username.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">username</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the username.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributeName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the attribute from which to extract the value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributeRoleName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the name of the attribute role from which extract the value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name used to reference the value pushed into the pageContext.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decides whether to escape the special characters in the information retrieved or not. Value admitted (true/false), the default is true.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_entando_faqs"><a class="anchor" href="#_entando_faqs"></a>3.8. ENTANDO FAQs</h3>
<div class="sect3">
<h4 id="_error_messages"><a class="anchor" href="#_error_messages"></a>3.8.1. ERROR MESSAGES</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Error creating bean with nameâ€¦â€‹ Unsatisfied dependency</dt>
<dd>
<p>This error can occur if you develop on Jetty but deploy to JBoss and Jettyâ€™s web.xml file does not match the web.xml used for JBoss. You need to manually update the web.xml files (e.g., after adding a bean xml path) in both the JBoss config directory (<em>src/main/config/jboss/web.xml</em>) and the one used by Jetty (<em>src/main/config/web.xml</em>) so that the values match.<br></p>
<div class="paragraph">
<p>Remember that if you use an Entando image for Openshift, JBoss, or Wildfly, these images will also use the web.xml in the JBoss config directory.</p>
</div>
</dd>
</dl>
</div>
<hr>
<div class="dlist">
<dl>
<dt class="hdlist1">java.lang.NoClassDefFoundError: javax/servlet/jsp/jstl/core/ConditionalTagSupport</dt>
<dd>
<p>This error can occur if you are trying to deploy entando 5.0.3 release on the latest version of Tomcat (Actually 8.5.39) and your project is missing the <em>jstl</em> dependency. To solve this issue just add this dependency to your <em>pom.xml</em> file.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">    &lt;dependency&gt;
        &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
        &lt;artifactId&gt;jstl&lt;/artifactId&gt;
        &lt;version&gt;1.2&lt;/version&gt;
    &lt;/dependency&gt;</code></pre>
</div>
</div>
<hr>
</div>
<div class="sect3">
<h4 id="_how_tos"><a class="anchor" href="#_how_tos"></a>3.8.2. HOW TOs</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Where can I modify the port in a Maven-generated standalone webapp?</dt>
<dd>
<p>You can change the port value by updating the appropriate filter in <em>src/main/filters</em>. Each filter is specific to the environment in which it runs. If you&#8217;re running Jetty (dev env mode) you can also pass the port as a command line option with <code>-Djetty.port=&lt;newPort&gt;</code></p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_widgets_2"><a class="anchor" href="#_widgets_2"></a>3.8.3. WIDGETS</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">When do I need to include the <em>action</em> tag in my widget and plugin configurations?</dt>
<dd>
<p>You only need to include information in the <em>action</em> tag when using Entando&#8217;s legacy Admin Portal. If you are using the App Builder, you do not need to include any information in the <em>action</em> tag.</p>
</dd>
<dt class="hdlist1">How can I access widget config data from React at runtime?</dt>
<dd>
<p>There are three ways to do this:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Following an example</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click or navigate to <a href="https://github.com/entando/entando-components/blob/master/plugins/entando-plugin-jpkiebpm/src/main/webapp/WEB-INF/plugins/jpkiebpm/aps/jsp/internalservlet/bpm-case-roles.jsp" class="bare">https://github.com/entando/entando-components/blob/master/plugins/entando-plugin-jpkiebpm/src/main/webapp/WEB-INF/plugins/jpkiebpm/aps/jsp/internalservlet/bpm-case-roles.jsp</a></p>
</li>
<li>
<p>Invoke REACT in the JSP where you import and reference your React component. In this example, you push the config elements into the DOM (note they are all hidden) and then pass that DOM to your React components. Following the example at the link above you would import React at the top and do something like:<br>
<code>ReactDOM.render(element, document.getElementById('&lt;%=cId%&gt;'))</code></p>
</li>
<li>
<p>The example above reproduces the same form used at config time but you can use a simpler structure to make the information available.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Using configuration parameters in the dom</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Use the currentWidget parameter jsp tags to reference your configuration parameters and make them available in the dom. For example, you can reference the widget configuration with this tag:<br>
<a href="https://github.com/entando/entando-core/blob/8291b863250ce00b76808a1134b8ef2ab62a041d/engine/src/main/tld/aps-core.tld#L140" class="bare">https://github.com/entando/entando-core/blob/8291b863250ce00b76808a1134b8ef2ab62a041d/engine/src/main/tld/aps-core.tld#L140</a>)</p>
</li>
<li>
<p>For example referencing a configuration parameter height:<br>
<code>&lt;wp:currentWidget param="config" configParam="height" /&gt;</code></p>
</li>
<li>
<p>Or pass them directly to your React component:<br>
<code>&lt;MyReactComponent  height="&lt;wp:currentWidget param="config" configParam="height" /&gt;"  /&gt;</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>Make the existing REST call</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Pass the page code, frame ID, and token to your React component using the JSP tags and then invoke the REST endpoint.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_prior_entando_release_notes"><a class="anchor" href="#_prior_entando_release_notes"></a>3.9. PRIOR ENTANDO RELEASE NOTES</h3>
<div class="sect3">
<h4 id="prior-release-notes"><a class="anchor" href="#prior-release-notes"></a>3.9.1. ENTANDO 5.2.0 RELEASE NOTES</h4>
<div class="sect4">
<h5 id="_new_capabilities_and_features_2"><a class="anchor" href="#_new_capabilities_and_features_2"></a>NEW CAPABILITIES AND FEATURES</h5>

</div>
<div class="sect4">
<h5 id="_documentation_and_deployment"><a class="anchor" href="#_documentation_and_deployment"></a>DOCUMENTATION AND DEPLOYMENT</h5>
<div class="ulist">
<ul>
<li>
<p>New OpenShift templates and documentation including a new getting started experience to deploy Entando applications on OpenShift</p>
<div class="ulist">
<ul>
<li>
<p>See: <a href="http://docs.entando.com/#entando-on-openshift" class="bare">http://docs.entando.com/#entando-on-openshift</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>New examples, documentation, and templates to deploy Entando applications and AWS, Azure, and Google Cloud Engine using Kubernetes</p>
<div class="ulist">
<ul>
<li>
<p>See: <a href="http://docs.entando.com/#_cloud_deployments_on_aws_azure_and_gce" class="bare">http://docs.entando.com/#_cloud_deployments_on_aws_azure_and_gce</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Added documentation and examples for deploying using an Oracle database</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_content_management"><a class="anchor" href="#_content_management"></a>CONTENT MANAGEMENT</h5>
<div class="ulist">
<ul>
<li>
<p>The Entando CMS now gives the content editor the ability to crop, flip, and generally interact with an image uploaded to the application. This includes the ability to define pre-built crop ratios that are available to image editors</p>
</li>
<li>
<p>The digital assets section of the CMS now allows for multiple images or attachments to be uploaded concurrently</p>
</li>
<li>
<p>Metadata attached to images can now be stored attached to an image and that metadata can be used to
automatically populate attributes defined in content types. For example, a description metadata tag on an image can be used to
populate a caption or text in the content</p>
</li>
<li>
<p>The Entando CMS now supports the manual upload of very large files via digital
assets. The files are loaded in chunks using base 64</p>
</li>
<li>
<p>The Entando CMS now allows for configuration to exclude content by id and
by type from versioning plugin. Generally useful when high volume content
delivered by API is generating large numbers of history records.</p>
</li>
<li>
<p>For updated CMS documentation and how to use the new features see:</p>
<div class="ulist">
<ul>
<li>
<p><a href="http://docs.entando.com/#_content_management_system" class="bare">http://docs.entando.com/#_content_management_system</a>
=== DIGITAL EXCHANGE
 The release of Entando 5.1.0 includes the tech preview release of the Entando Digital Exchange which is a new model for distributing and installing Entando components. This release includes the ability to install and manage all of the UI elements of an Entando application. Follow our blog and YouTube channels for more to come on the Digital Exchange.
 For documentation and getting started see:
 <a href="http://docs.entando.com/#_digital_exchange" class="bare">http://docs.entando.com/#_digital_exchange</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_apis_and_endpoints"><a class="anchor" href="#_apis_and_endpoints"></a>APIs AND ENDPOINTS</h5>
<div class="ulist">
<ul>
<li>
<p>Added new PATCH API capability to merge changes to page settings endpoints and established the framework for applying a PATCH in a custom API</p>
</li>
<li>
<p>Added the refresh token flow for OAuth and implemented token refresh in the App Builder</p>
</li>
<li>
<p>Added JSON REST APIs for content models and content types</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_fixes_and_updates"><a class="anchor" href="#_fixes_and_updates"></a>FIXES AND UPDATES</h5>
<div class="ulist">
<ul>
<li>
<p>Resolved an issue where joinGroups werenâ€™t updating on PUT calls</p>
</li>
<li>
<p>Resolved an issue in App Builder where in some cases the locale of the App
Builder was lost on a refresh</p>
</li>
<li>
<p>Updated processing around category creation when creating a new category
during the content creation workflow</p>
</li>
<li>
<p>Updated errors in the Inspinia and PAM page models included in the PAM
template</p>
</li>
<li>
<p>Resolved an issue where datatype date attributes were not returned correctly
in the app builder and updated data type actions in app builder</p>
</li>
<li>
<p>Resolved an issue where page model titles were not displayed correctly in some
cases</p>
</li>
<li>
<p>Resolved an issue in the CMS where the action button could become replicated</p>
</li>
<li>
<p>Resolved issues related to moving page nodes in the App Builder</p>
</li>
<li>
<p>General locale and translation updates for App Builder in Italian</p>
</li>
<li>
<p>Resolved CMS image category and search issues related to category join groups</p>
</li>
<li>
<p>Updated file download flow in the CMS to correctly download files on all
browsers</p>
</li>
<li>
<p>Updated scripts and builds to resolve issues in Windows</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_new_capabilities_in_integration_with_red_hat_pam"><a class="anchor" href="#_new_capabilities_in_integration_with_red_hat_pam"></a>NEW CAPABILITIES IN INTEGRATION WITH RED HAT PAM</h5>
<div class="ulist">
<ul>
<li>
<p>Added a new widget to display task details related to a selected task in Red Hat PAM. See PAM Process Task Detail widget in the app</p>
</li>
<li>
<p>Added a new widget to allow a task form to be displayed independently on a page (the modal dialog functionality is unchanged.) See PAM-Task Form by DataType</p>
</li>
<li>
<p>Added significant new configuration options to the PAM Datatable task list widget including</p>
<div class="ulist">
<ul>
<li>
<p>Added configurable ability to claim a task directly from the task list</p>
</li>
<li>
<p>Added configurable ability to open a new page with task details when clicking on a row in the task list</p>
</li>
<li>
<p>Added the ability to include task variables as columns in the task list
Added the ability to disable the complete button in the task list</p>
</li>
</ul>
</div>
</li>
<li>
<p>Added process diagram widget to Inspinia BPM default widgets</p>
</li>
<li>
<p>Updated case comment</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_changes_and_updates_in_5_1_0_in_integration_with_red_hat_pam"><a class="anchor" href="#_changes_and_updates_in_5_1_0_in_integration_with_red_hat_pam"></a>CHANGES AND UPDATES IN 5.1.0 IN INTEGRATION WITH RED HAT PAM</h5>
<div class="ulist">
<ul>
<li>
<p>Resolved an issue viewing the SVG for the process diagram based on browser updates</p>
</li>
<li>
<p>Resolved an issue where task details wouldnâ€™t populate in some forms</p>
</li>
<li>
<p>Updated integration with PAM based on integration with additional process and task configurations in customer test cases</p>
</li>
<li>
<p>Updated task buttons to be fixed on the left hand side of task table</p>
</li>
<li>
<p>Resolved an issue rendering and selecting checkbox values in forms</p>
</li>
<li>
<p>Updated and resolved issues in form submission process for complex forms</p>
</li>
<li>
<p>Various updates to task list to support integration with additional PAM field types</p>
</li>
<li>
<p>Fixed round tripping for null values in forms and checkboxes</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_known_issues_3"><a class="anchor" href="#_known_issues_3"></a>KNOWN ISSUES</h5>
<div class="ulist">
<ul>
<li>
<p>There is a known issue rendering the case comments widget independently. A patch will be provided to resolve this issue.</p>
</li>
<li>
<p>On AWS and Azure there is a library missing to run the demo on Wildfly. A patch will be provided to resolve this issue.</p>
</li>
<li>
<p>The process list widget will not render against PAM in some process definitions. To be patched in 5.1.1</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_software_requirements_2"><a class="anchor" href="#_software_requirements_2"></a>SOFTWARE REQUIREMENTS</h5>
<div class="ulist">
<ul>
<li>
<p>Java 1.8</p>
</li>
<li>
<p>npm 5.6.0+ (for ReactJS front ends)</p>
</li>
<li>
<p>Maven 3.0.5+</p>
</li>
<li>
<p>Ant 1.8.0+</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_legal_notice_2"><a class="anchor" href="#_legal_notice_2"></a>LEGAL NOTICE</h5>
<div class="ulist">
<ul>
<li>
<p>LGPL v2.1 License for the Core</p>
</li>
<li>
<p>MIT License for the components</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_links_and_resources_2"><a class="anchor" href="#_links_and_resources_2"></a>LINKS AND RESOURCES</h5>
<div class="ulist">
<ul>
<li>
<p>Explore the code on GitHub: <a href="https://github.com/entando" class="bare">https://github.com/entando</a></p>
</li>
<li>
<p>See our Getting Started guide: <a href="http://docs.entando.com/#getting-started" class="bare">http://docs.entando.com/#getting-started</a></p>
</li>
<li>
<p>See our Custom App Building guide: <a href="http://docs.entando.com/#_custom_app_building_with_entando" class="bare">http://docs.entando.com/#_custom_app_building_with_entando</a></p>
</li>
<li>
<p>Contribute to the software: <a href="https://central.entando.com/en/community.page" class="bare">https://central.entando.com/en/community.page</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_entando_5_0_2_release_notes"><a class="anchor" href="#_entando_5_0_2_release_notes"></a>3.9.2. ENTANDO 5.0.2 RELEASE NOTES</h4>

</div>
<div class="sect3">
<h4 id="_abstract"><a class="anchor" href="#_abstract"></a>3.9.3. ABSTRACT</h4>
<div class="paragraph">
<p>This document contains release notes for Entando 5.0.2. See <a href="#prior-release-notes">previous Entando release notes</a> for notes on earlier versions.</p>
</div>
</div>
<div class="sect3">
<h4 id="_changes_in_5_0_2"><a class="anchor" href="#_changes_in_5_0_2"></a>3.9.4. CHANGES IN 5.0.2</h4>
<div class="paragraph">
<p>Resolved an incorrect dependency version in entando-core and entando-components that reference a SNAPSHOT rather than a released library.</p>
</div>
<div class="sect4">
<h5 id="_known_issues_4"><a class="anchor" href="#_known_issues_4"></a>KNOWN ISSUES</h5>
<div class="paragraph">
<p>None</p>
</div>
</div>
<div class="sect4">
<h5 id="_versioning_information"><a class="anchor" href="#_versioning_information"></a>VERSIONING INFORMATION</h5>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Jars and artifacts included in this release:</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Artifact</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Version</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-core</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-archetypes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-ux-packages</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-components</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">app-builder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.2</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_software_requirements_3"><a class="anchor" href="#_software_requirements_3"></a>SOFTWARE REQUIREMENTS</h5>
<div class="ulist">
<ul>
<li>
<p>Java 1.8+</p>
</li>
<li>
<p>npm 5.6.0+ (for ReactJS front ends)</p>
</li>
<li>
<p>Maven 3.0.5+</p>
</li>
<li>
<p>Ant 1.8.0+</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_legal_notice_3"><a class="anchor" href="#_legal_notice_3"></a>LEGAL NOTICE</h5>
<div class="ulist">
<ul>
<li>
<p>LGPL v2.1 License for the Entando Core</p>
</li>
<li>
<p>MIT License for the components</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_links_and_resources_3"><a class="anchor" href="#_links_and_resources_3"></a>LINKS AND RESOURCES</h5>
<div class="ulist">
<ul>
<li>
<p>Explore the code on GitHub: <a href="https://github.com/entando" class="bare">https://github.com/entando</a></p>
</li>
<li>
<p>See our Getting Started guide: <a href="http://docs.entando.com/#getting-started" class="bare">http://docs.entando.com/#getting-started</a></p>
</li>
<li>
<p>See our Custom App Building guide: <a href="http://docs.entando.com/#_custom_app_building_with_entando" class="bare">http://docs.entando.com/#_custom_app_building_with_entando</a></p>
</li>
<li>
<p>Contribute to the software: <a href="https://central.apps.entando.com/en/community.page" class="bare">https://central.apps.entando.com/en/community.page</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_entando_5_0_1_release_notes"><a class="anchor" href="#_entando_5_0_1_release_notes"></a>3.9.5. ENTANDO 5.0.1 RELEASE NOTES</h4>
<div class="sect4">
<h5 id="_abstract_2"><a class="anchor" href="#_abstract_2"></a>ABSTRACT</h5>
<div class="paragraph">
<p>This document contains release notes for Entando 5.0.1.</p>
</div>
</div>
<div class="sect4">
<h5 id="_changes_in_5_0_1"><a class="anchor" href="#_changes_in_5_0_1"></a>CHANGES IN 5.0.1</h5>
<div class="paragraph">
<p><strong>Library and dependency updates</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>We have updated the following as part of a general review of dependencies and updates based on Sonar scans:<br></p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Dependency</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Updated to</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apache taglibs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.2.3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">commons-bean-utils</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.9.2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">commons-io</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CXF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.1.16</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Freemarker</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.3.36-incubating</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Junit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.8.2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">log4j</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.10.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.8.RELEASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring Security (new)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.7.RELEASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Struts2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.5.17</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Struts2-jquery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.0.3</p></td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Security updates</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>The dependency version updates above include changes based on Sonar OWASP dependency scans</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Swagger</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>This release includes the addition of Swagger API documentation on top of the existing Entando REST endpoints</p>
</li>
<li>
<p>Entando applications can extend Entando APIs and configure endpoints to be exposed via Swagger</p>
</li>
<li>
<p>Learn more here: <a href="http://docs.entando.com/#_configuring_swagger_optional" class="bare">http://docs.entando.com/#_configuring_swagger_optional</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>REST API Definition</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Resolved a bug that prevented custom package scans from exposing endpoints in Entando REST endpoints</p>
</li>
<li>
<p>Learn more about exposing REST endpoints in an Entando application: <a href="http://docs.entando.com/#_building_a_rest_api" class="bare">http://docs.entando.com/#_building_a_rest_api</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Red Hat Process Automation Manager (PAM) plugin</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Added a new page model to integrate and display all of the Entando case management widgets on a single page</p>
</li>
<li>
<p>Added support for new field types:</p>
<div class="ulist">
<ul>
<li>
<p>Check boxes</p>
</li>
<li>
<p>Radio buttons</p>
</li>
<li>
<p>List boxes</p>
</li>
<li>
<p>Text areas</p>
</li>
<li>
<p>Dates</p>
</li>
</ul>
</div>
</li>
<li>
<p>Available to be added to projects as a Maven dependency</p>
</li>
<li>
<p>Resolved error condition when connecting to PAM 7.1 instances</p>
</li>
<li>
<p>Updated <em>Form by Datatype</em> widget to support additional fields and resolved issues related to rendering forms for different models</p>
</li>
<li>
<p>Resolved issues related to rendering PAM widgets and pages</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Authentication and Authorization Model</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>The release in Entando 5.0.1 includes a change in authentication models from OLTU to Spring Security</p>
</li>
<li>
<p>Entando endpoints and user management are all now integrated with Spring security</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_defect_resolution_and_general_updates"><a class="anchor" href="#_defect_resolution_and_general_updates"></a>Defect Resolution and General Updates</h5>
<div class="paragraph">
<p><strong>App Builder</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Resolved issue displaying and selecting join groups</p>
</li>
<li>
<p>Resolved page title display</p>
</li>
<li>
<p>Resolved label issue in data type and data model</p>
</li>
<li>
<p>Resolved issue related to the display of groups for widget types, content, and resources</p>
</li>
<li>
<p>Resolved username and email display issue in User Management</p>
</li>
<li>
<p>Resolved issue moving nodes in page tree</p>
</li>
<li>
<p>Added the ability to save an empty user profile</p>
</li>
<li>
<p>Added warning about deleting locked Fragments</p>
</li>
<li>
<p>Updated display of file and folder size in File Browser</p>
</li>
<li>
<p>Updated validation rules for username and password to match API requirements</p>
</li>
<li>
<p>Updated validation rules for page model and page naming to match API requirements</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>CMS</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Resolved issue with duplicated column names</p>
</li>
<li>
<p>Resolved issues editing content after adding a join group</p>
</li>
<li>
<p>Resolved breadcrumb display issue</p>
</li>
<li>
<p>Resolved edge condition in content preview actions</p>
</li>
<li>
<p>Resolved various issues surrounding the addition of attachments to content</p>
</li>
<li>
<p>Resolved issues in the addition and management of categories</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_known_issues_5"><a class="anchor" href="#_known_issues_5"></a>Known Issues</h5>
<div class="paragraph">
<p>Some dependencies in 5.0.1 still reference snapshot versions of components and other related products. This will be resolved in 5.0.2.</p>
</div>
<div class="paragraph">
<p><strong>Versioning Information</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Jars and artifacts included in this release:</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Artifact</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Version</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-core</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-archetypes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-ux-packages</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-components</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">app-builder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.1</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_software_requirements_4"><a class="anchor" href="#_software_requirements_4"></a>Software Requirements</h5>
<div class="ulist">
<ul>
<li>
<p>Java 1.8+</p>
</li>
<li>
<p>npm 5.6.0+ (for ReactJS front ends)</p>
</li>
<li>
<p>Maven 3.0.5+</p>
</li>
<li>
<p>Ant 1.8.0+</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_legal_notice_4"><a class="anchor" href="#_legal_notice_4"></a>Legal Notice</h5>
<div class="ulist">
<ul>
<li>
<p>LGPL v2.1 license for the Entando core</p>
</li>
<li>
<p>MIT license for the components</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_links_and_resources_4"><a class="anchor" href="#_links_and_resources_4"></a>Links and Resources</h5>
<div class="ulist">
<ul>
<li>
<p>Explore the code on GitHub: <a href="https://github.com/entando" class="bare">https://github.com/entando</a></p>
</li>
<li>
<p>See our Getting Started guide: <a href="http://docs.entando.com/#getting-started" class="bare">http://docs.entando.com/#getting-started</a></p>
</li>
<li>
<p>See our Custom App Building guide: <a href="http://docs.entando.com/#_custom_app_building_with_entando" class="bare">http://docs.entando.com/#_custom_app_building_with_entando</a></p>
</li>
<li>
<p>Contribute to the software: <a href="https://central.apps.entando.com/en/community.page" class="bare">https://central.apps.entando.com/en/community.page</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_entando_5_0_0_release_notes"><a class="anchor" href="#_entando_5_0_0_release_notes"></a>3.9.6. ENTANDO 5.0.0 RELEASE NOTES</h4>
<div class="sect4">
<h5 id="_abstract_3"><a class="anchor" href="#_abstract_3"></a>ABSTRACT</h5>
<div class="paragraph">
<p>This document contains release notes for Entando 5.0.</p>
</div>
</div>
<div class="sect4">
<h5 id="_preface_2"><a class="anchor" href="#_preface_2"></a>PREFACE</h5>
<div class="paragraph">
<p>These release notes highlight new features in Entando 5.0, list features that are in technical preview, and include any known issues.</p>
</div>
</div>
<div class="sect4">
<h5 id="_goal_of_entando_5"><a class="anchor" href="#_goal_of_entando_5"></a>GOAL OF ENTANDO 5</h5>
<div class="paragraph">
<p>The goal of Entando 5.0 is to fully engage our platform with the Modern Applications revolution by designing for a cloud-based infrastructure, adapting our architecture to be more distributed, and fully supporting DevOps methodologies.</p>
</div>
</div>
<div class="sect4">
<h5 id="_about_entando_5"><a class="anchor" href="#_about_entando_5"></a>ABOUT ENTANDO 5</h5>
<div class="paragraph">
<p>Entando 5 represents a fundamental update to the Entando infrastructure to support modern application development processes including: new options for clustering, cloud native deployment, out of the box support for deploying apps in OpenShift, new UI technologies, and an updated widget development process.</p>
</div>
<div class="paragraph">
<p>These release notes provide a technical introduction to the changes included in Entando 5. Check out our Installation guide, Getting Started guide, or our blog for examples and more on putting Entando 5 to work.</p>
</div>
</div>
<div class="sect4">
<h5 id="_whats_new_with_entando_5"><a class="anchor" href="#_whats_new_with_entando_5"></a>WHAT&#8217;S NEW WITH ENTANDO 5</h5>
<div class="ulist">
<ul>
<li>
<p>Infrastructure/Platform</p>
<div class="ulist">
<ul>
<li>
<p>Hybrid hosting environment</p>
<div class="ulist">
<ul>
<li>
<p>Entando 5 supports deployment in both public and private cloud configurations including deployment using Docker and OpenShift</p>
</li>
</ul>
</div>
</li>
<li>
<p>Cloud native clustering using a JSR 107 compliant cache for scaling in the cloud</p>
<div class="ulist">
<ul>
<li>
<p>Entando 5 introduces the ability to back an installation of the MApp Engine-engine with a JSR 107 cache for multinode high availability (HA) configuration</p>
</li>
<li>
<p>A reference implementation using Infinispan is provided in the entando-components project</p>
</li>
</ul>
</div>
</li>
<li>
<p>Container deployment</p>
<div class="ulist">
<ul>
<li>
<p>Deploy directly to OpenShift using images published to the Red Hat catalog</p>
</li>
<li>
<p>Deploy using Docker images provided on DockerHub</p>
</li>
<li>
<p>Install an Entando project using provided Source to Image (S2I) Docker images</p>
</li>
</ul>
</div>
</li>
<li>
<p>New public facing REST APIs</p>
<div class="ulist">
<ul>
<li>
<p>Entando 5 exposes a new set of REST APIs for interacting with App Builder assets</p>
</li>
</ul>
</div>
</li>
<li>
<p>Decoupled application builder and micro engine for updated deployment options</p>
<div class="ulist">
<ul>
<li>
<p>This release decouples the application builder&#8217;s front end from the Entando engine allowing the engine and App Builder to be deployed separately. The updated application builder is a ReactJS based application that uses REST APIs and can be deployed and managed separately from the MApp Engine</p>
</li>
</ul>
</div>
</li>
<li>
<p>Upgrade to Spring 5</p>
</li>
<li>
<p>Security updates
We have performed security scans as part of the Entando 5 software release to ensure that we are using secure libraries and practicing secure coding practices within our application. We continue to use automated tools and manual security reviews to monitor and evaluate the security of the Entando platform. Notable updates include:</p>
<div class="ulist">
<ul>
<li>
<p>Various library version upgrades to match OWASP security scan results at time of release</p>
</li>
<li>
<p>Software updates to support SonarQube security scans and improve software security</p>
</li>
<li>
<p>The Entando core has been updated to Spring 5.0.5</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Processes</p>
<div class="ulist">
<ul>
<li>
<p>Supports DevOps processes</p>
<div class="ulist">
<ul>
<li>
<p>First class support for deploying Entando projects on Docker and OpenShift</p>
</li>
<li>
<p>New archetypes to deploy to OpenShift and Docker using Fabric8</p>
</li>
<li>
<p>Created Docker base images for quick extension and deployment</p>
</li>
</ul>
</div>
</li>
<li>
<p>Manage full CI/CD life cycle</p>
<div class="ulist">
<ul>
<li>
<p>Created reference implementation of Entando Docker images in Jenkins to create, deploy, and manage an application built using Entando in a CI/CD environment</p>
</li>
</ul>
</div>
</li>
<li>
<p>Decoupled CMS from MApp Engine</p>
<div class="ulist">
<ul>
<li>
<p>The CMS capability available in Entando 4.3.2 has been decoupled from the core MApp Engine implementation and will be available as a plugin to Entando 5 in a future release</p>
</li>
</ul>
</div>
</li>
<li>
<p>New component development experience</p>
<div class="ulist">
<ul>
<li>
<p>The Entando Component Generator (formerly edo) has been updated to use a configuration file to more easily select different types of components to generate</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_known_issues_6"><a class="anchor" href="#_known_issues_6"></a>KNOWN ISSUES</h6>
<div class="ulist">
<ul>
<li>
<p>The ability to associate attributes with User Profiles is not implemented in the decoupled App Builder</p>
<div class="ulist">
<ul>
<li>
<p>Workaround: use the legacy application screens to add attributes to user profiles</p>
</li>
<li>
<p>Anticipated fix in first patch release</p>
</li>
</ul>
</div>
</li>
<li>
<p>Manually editing and saving Data Types and Data Models in the decoupled App Builder has errors</p>
<div class="ulist">
<ul>
<li>
<p>Workaround: use the legacy application screens to edit Data Types</p>
</li>
<li>
<p>Anticipated fix in future patch release</p>
</li>
</ul>
</div>
</li>
<li>
<p>If you move the homepage to a child of itself in the page tree it can result in browser and application stability problems</p>
</li>
<li>
<p>Anticipated fix in future patch release</p>
<div class="ulist">
<ul>
<li>
<p>The PAM Datatable and Task List widgets only function in the legacy App Builder</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_versioning_information_2"><a class="anchor" href="#_versioning_information_2"></a>VERSIONING INFORMATION</h5>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Jars and artifacts included in this release:</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Artifact</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-core</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-archetypes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-ux-packages</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-vfs-manager</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">app-builder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MApp-Engine-admin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.0</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_software_requirements_5"><a class="anchor" href="#_software_requirements_5"></a>SOFTWARE REQUIREMENTS</h5>
<div class="ulist">
<ul>
<li>
<p>Java 1.8+</p>
</li>
<li>
<p>npm 5.6.0+ (for ReactJS front ends)</p>
</li>
<li>
<p>Maven 3.0.5+</p>
</li>
<li>
<p>Ant 1.8.0+</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_legal_notice_5"><a class="anchor" href="#_legal_notice_5"></a>LEGAL NOTICE</h5>
<div class="ulist">
<ul>
<li>
<p>LGPL v2.1 License for the Core</p>
</li>
<li>
<p>MIT License for the components</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_links_and_resources_5"><a class="anchor" href="#_links_and_resources_5"></a>LINKS AND RESOURCES</h5>
<div class="ulist">
<ul>
<li>
<p>Explore the code on GitHub: <a href="https://github.com/entando" class="bare">https://github.com/entando</a></p>
</li>
<li>
<p>See our Getting Started guide: <a href="http://docs.entando.com/#getting-started" class="bare">http://docs.entando.com/#getting-started</a></p>
</li>
<li>
<p>See our Custom App Building guide: <a href="http://docs.entando.com/#_custom_app_building_with_entando" class="bare">http://docs.entando.com/#_custom_app_building_with_entando</a></p>
</li>
<li>
<p>Contribute to the software: <a href="https://central.entando.com/en/community.page" class="bare">https://central.entando.com/en/community.page</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_entando_5_1_0"><a class="anchor" href="#_entando_5_1_0"></a>4. ENTANDO 5.1.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_see_5_2_0"><a class="anchor" href="#_see_5_2_0"></a>4.1. See 5.2.0</h3>
<div class="ulist">
<ul>
<li>
<p>See Entando 5.2.0 for documentation on using Entando 5.1.0. The concepts and commands are identical.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_entando_5_0_0"><a class="anchor" href="#_entando_5_0_0"></a>5. ENTANDO 5.0.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="installation-e5"><a class="anchor" href="#installation-e5"></a>5.1. INSTALLING ENTANDO APP BUILDER 5.0</h3>
<div class="sect3">
<h4 id="_prerequisites_10"><a class="anchor" href="#_prerequisites_10"></a>5.1.1. PREREQUISITES</h4>
<div class="sect4">
<h5 id="_space_and_hardware_requirements_2"><a class="anchor" href="#_space_and_hardware_requirements_2"></a>SPACE AND HARDWARE REQUIREMENTS</h5>
<div class="paragraph">
<p>Entando is a built to be a very light framework requiring limited runtime resources. When extending Entando in a development setting, sizing for development environments that add to an Entando install is up to individual user requirements.</p>
</div>
</div>
<div class="sect4">
<h5 id="_installed_prerequisites_2"><a class="anchor" href="#_installed_prerequisites_2"></a>INSTALLED PREREQUISITES:</h5>
<div class="ulist">
<ul>
<li>
<p>Java 1.8+</p>
</li>
<li>
<p>npm 5.6.0+ (for ReactJS front ends)</p>
</li>
<li>
<p>Maven 3.0.5+</p>
</li>
<li>
<p>Ant 1.8.0+</p>
</li>
<li>
<p>Git (only if building from source code)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_running_the_mapp_engine_instance"><a class="anchor" href="#_running_the_mapp_engine_instance"></a>5.1.2. RUNNING THE MAPP ENGINE INSTANCE</h4>
<div class="sect4">
<h5 id="_creating_a_new_entando_project"><a class="anchor" href="#_creating_a_new_entando_project"></a>CREATING A NEW ENTANDO PROJECT</h5>
<div class="paragraph">
<p>Set up an Entando application via a Maven archetype. The archetype creates the project and structure needed to develop and add to an application.</p>
</div>
<div class="paragraph">
<p><strong>Steps:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open your command line and navigate to the directory that will house your new project.</p>
</li>
<li>
<p>Run the following command:<br>
<code>mvn archetype:generate -Dfilter=entando-archetype-webapp-generic</code></p>
</li>
<li>
<p>Select Option 1, displayed as follows:<br>
<code>1: remote &gt; org.entando.entando:entando-archetype-webapp-generic (Generic web app Archetype for Entando: an agile, modern and user-centric open source web app like platform.)</code></p>
</li>
<li>
<p>If prompted for a version, select 5.0.0.</p>
</li>
<li>
<p>Enter values for groupId, artifactId, version, and package. These values go into the Maven setup in the new project. See the Maven documentation for more information on these values. <a href="https://maven.apache.org/guides/mini/guide-naming-conventions.html" class="bare">https://maven.apache.org/guides/mini/guide-naming-conventions.html</a></p>
</li>
<li>
<p>Open the directory created by the Maven archetype in Step 2. The directory will have the same name as the value you entered for artifactId in Step 5. This directory contains all of the structure necessary to start the Entando MApp-Engine and execute the application. See Launching the Application section below for instructions on starting the newly created project.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_launching_the_mapp_engine"><a class="anchor" href="#_launching_the_mapp_engine"></a>LAUNCHING THE MAPP ENGINE</h5>
<div class="sect5">
<h6 id="_quick_start_using_derby_and_jetty"><a class="anchor" href="#_quick_start_using_derby_and_jetty"></a>QUICK START USING DERBY AND JETTY</h6>
<div class="paragraph">
<p>Once you have created an Entando application, you can launch it using Jetty and an embedded Derby database.</p>
</div>
<div class="paragraph">
<p>To do so, run the following command inside your project:<br>
<code>mvn clean jetty:run</code></p>
</div>
<div class="paragraph">
<p><strong>Once started the logs will print the following messages:</strong><br>
  [INFO] Started SelectChannelConnector@0.0.0.0:8080<br>
  [INFO] Started Jetty Server<br>
  [INFO] Starting scanner at interval of 5 seconds</p>
</div>
<div class="paragraph">
<p>The logs will indicate that your application is running. To launch your application, point your browser toÂ <a href="http://localhost:8080/">your app name</a></p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_launching_the_app_builder"><a class="anchor" href="#_launching_the_app_builder"></a>5.1.3. LAUNCHING THE APP BUILDER</h4>
<div class="paragraph">
<p>This section provides several options for launching the App Builder which is used to manage a separately running Mapp Engine instance.  The App Builder is completely stateless and relies on the Engine to store the application configuration.  If no Mapp engine is specified, the App Builder will default to providing mock data so that the functionality can be demonstrated.</p>
</div>
<div class="paragraph">
<p><strong>Prerequisites:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>git</p>
</li>
<li>
<p>npm</p>
</li>
<li>
<p>node</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_clone_and_setup"><a class="anchor" href="#_clone_and_setup"></a>CLONE AND SETUP</h5>
<div class="paragraph">
<p><strong>Enter the following commands in your command line:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>git clone https://github.com/entando/app-builder.git</code></p>
</li>
<li>
<p><code>cd app-builder</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>It is recommended to checkout the release branch corresponding to the version of the Mapp Engine, e.g.,<br>
<code>git checkout v5.0.0-release</code></p>
</li>
<li>
<p>Available release branches can be listed with: <code>git branch -a</code></p>
</li>
</ol>
</div>
</li>
<li>
<p><code>npm install</code><br></p>
</li>
<li>
<p><code>npm start</code>&#8201;&#8212;&#8201;Starts the application in dev mode (local web server).</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The npm install command installs npm dependencies inside the node_modules folder</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This will give you a running app-builder instance using mock data. The Configuration section below covers connecting your App Builder to a running MApp engine.</p>
</div>
</div>
<div class="sect4">
<h5 id="_configuration"><a class="anchor" href="#_configuration"></a>CONFIGURATION</h5>
<div class="paragraph">
<p>There are two methods for using the App Builder, depending on whether the API calls will be to the live Entando Core or if they will use mock data.</p>
</div>
<div class="olist arabic">
<div class="title">Configurable properties</div>
<ol class="arabic">
<li>
<p><strong>USE_MOCKS (boolean):</strong> a Boolean setting that determines if the App Builder uses a live connection to the Entando Core or uses mock data. A value of "true" instructs the App Builder to use mock data. A value of "false" allows the App Builder&#8217;s APIs to make live data calls to the Entando Core.</p>
</li>
<li>
<p><strong>DOMAIN (string):</strong> a string representing the domain name of the Entando Core instance. The protocol is optional and you can specify a subdirectory of the domain. Trailing slashes are invalid and it only validates up to third-level domains.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you set USE_MOCKS to "false," you must run an Entando Core (MApp Engine) instance and
then to connect the App Builder to the MApp Engine using the following steps:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Run the MApp Engine instance. See Running the MApp Engine section for more information.</p>
</li>
<li>
<p>Connect the MApp Engine.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you set USE_MOCKS to "true," you do not need to run the App Builder instance because you are only using mock data.</p>
</div>
<div class="paragraph">
<p><strong>To connect the MApp Engine</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a file at the root of the app-builder called <em>.env.development.local</em>.</p>
</li>
<li>
<p>Add 'USE_MOCKS=false'</p>
</li>
<li>
<p>Add DOMAIN=&lt;url of running MApp Engine&gt;</p>
</li>
<li>
<p>Run <code>npm start</code> in your App Builder.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_additional_commands"><a class="anchor" href="#_additional_commands"></a>ADDITIONAL COMMANDS</h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>npm run lint</code></dt>
<dd>
<p>Runs the linter to check code style. It fails if linting rules are not matched.</p>
</dd>
<dt class="hdlist1"><code>npm run coverage</code></dt>
<dd>
<p>Runs unit tests. It fails if a unit test fails, or if the minimum coverage threshold is not met.</p>
</dd>
<dt class="hdlist1"><code>npm run import-plugins</code></dt>
<dd>
<p>Compiles and imports Entando plugins.</p>
</dd>
<dt class="hdlist1"><code>npm run build</code></dt>
<dd>
<p>Compiles the project and creates the a production build</p>
</dd>
<dt class="hdlist1"><code>npm run build-full</code></dt>
<dd>
<p>Runs npm run lint, npm run coverage, npm run import-plugins and npm run build</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_setting_up_a_database_optional"><a class="anchor" href="#_setting_up_a_database_optional"></a>5.1.4. SETTING UP A DATABASE (OPTIONAL)</h4>
<div class="paragraph">
<p>You can configure a newly created Entando application to connect to a database as its backing store. Derby is the default configuration in archetype-created applications, but you can change the default to a different value. Open the Filter Properties file in src/main/filters and enter the appropriate environment and database configuration.</p>
</div>
<div class="paragraph">
<p>Create two databases in your dbms.</p>
</div>
<div class="paragraph">
<p><strong>To connect the MApp Engine to a database server:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In your database server, create a user for the application.</p>
</li>
<li>
<p>Create two databases. Give the user from Step 1 permission to create, read, and write. For the quickstart, you should name the databases as follows:</p>
<div class="literalblock">
<div class="content">
<pre>&lt;your-project-name&gt;Port
&lt;your-project-name&gt;Serv</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>These are the default names included in the default properties files.
You can adjust the names and then change the connection information in the project&#8217;s configuration filters in src/main/filters.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>You also need to uncomment the maven dependency for the database that your are using from the <em>pom.xml</em> file. For example for MySQL you would uncomment:</p>
<div class="literalblock">
<div class="content">
<pre>&lt;dependency&gt;
        &lt;groupId&gt;mysql&lt;/groupId&gt;
        &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
        &lt;version&gt;5.1.18&lt;/version&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</li>
<li>
<p>Update the appropriate Filter Properties file in src/main/filters to use the configuration for the database properties. For example, on a MacOS, you would update  <em>filter-development-unix.properties</em>.</p>
</li>
<li>
<p>Set the user, database, and password for the values created in Steps 1 and 2.</p>
</li>
<li>
<p>Launch the application with <code>mvn jetty:run</code></p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>When launching with the <code>mvn jetty:run command</code>, Jetty will automatically create the table structure required
to run the application if the tables aren&#8217;t already present. This can be used to instantiate an empty database
for future use when the target deployment is an app server such as JBoss or Tomcat.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_configuring_swagger_optional"><a class="anchor" href="#_configuring_swagger_optional"></a>5.1.5. CONFIGURING SWAGGER (OPTIONAL)</h4>
<div class="paragraph">
<p>When generating an application, Entando automatically includes an instance of Swagger, a tool that lets you describe the structure of your APIs to make them easier for other machines to read. Configuring Swagger for use only takes a few steps.</p>
</div>
<div class="sect4">
<h5 id="_enabling_swagger_in_a_development_environment"><a class="anchor" href="#_enabling_swagger_in_a_development_environment"></a>ENABLING SWAGGER IN A DEVELOPMENT ENVIRONMENT</h5>
<div class="paragraph">
<p>To enable swagger in your development environment, you need to run your application with an enabled Swagger profile. There are two options. Run ONE of the following from the  root of your generated project&#8217;s directory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Start the container with a JVM parameter using the following command:<br>
<code>mvn clean jetty:run -Dspring.profiles.active=swagger</code></p>
</li>
<li>
<p>Add an environment variable by using the following commands:<br>
<code>export spring_profiles_active=swagger</code><br>
<code>mvn clean jetty:run</code></p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">To access the Swagger interface:</div>
<ol class="arabic">
<li>
<p>In a browser, navigate to your applicationâ€™s URL (e.g., <a href="http://localhost:8080/appname" class="bare">http://localhost:8080/appname</a>).</p>
</li>
<li>
<p>Append the URL with api/swagger-ui.html. Again, for example, <a href="http://localhost:8080/appname/api/swagger-ui.html" class="bare">http://localhost:8080/appname/api/swagger-ui.html</a></p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>For security purposes, you should only run this with the default credentials in a development environment. If enabling swagger in production for integration purposes be sure to change the clientId and secret.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_authentication_details"><a class="anchor" href="#_authentication_details"></a>AUTHENTICATION DETAILS</h5>
<div class="paragraph">
<p><strong>Default login details:</strong><br>
<strong>Username:</strong> admin<br>
<strong>Password:</strong> adminadmin</p>
</div>
<div class="paragraph">
<p><strong>Default Swagger OAuth details:</strong><br>
<strong>Type:</strong> Request Body<br>
<strong>clientId:</strong> swagger<br>
<strong>Secret:</strong> = swaggerswagger</p>
</div>
</div>
<div class="sect4">
<h5 id="_how_does_the_integration_work"><a class="anchor" href="#_how_does_the_integration_work"></a>HOW DOES THE INTEGRATION WORK?</h5>
<div class="paragraph">
<p>The Swagger integration is based on three components and is activated by a Spring profile. The components are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>SwaggerConfig</strong> - responsible for configuring most of the Swagger UI behavior (or the library Springfox that provides Swagger UI functionality). It configures which paths to scan, where to find the oAuth endpoints, and other essentials</p>
</li>
<li>
<p><strong>SwaggerMvcAdapter</strong> - makes the Swagger UI&#8217;s human-friendly HTML page and its resources available for the application</p>
</li>
<li>
<p><strong>SwaggerInitializer</strong> - assists the Swagger UI with talking to your new application. Swagger UI needs to talk to the application backend, which require oAuth authentication to communicate back to the Swagger UI. The backend uses standard oAuth authentication, requiring an oAuth client_id and secret, and also that any requested redirect matches a specific URL. SwaggerInitializer is also responsible for adding the oAuth consumer details for Swagger in the database. If Swagger is enabled when the application starts, SwaggerInitializer will check for an existing configuration for a Swagger consumer in the database and adds one if necessary</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <em>swagger</em> Spring profile is active, Spring will initialize and wire all three components during application startup. If inactive, Entando ignores the components.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_building_the_mapp_engine_from_source_code_optional"><a class="anchor" href="#_building_the_mapp_engine_from_source_code_optional"></a>5.1.6. BUILDING THE MAPP ENGINE FROM SOURCE CODE (OPTIONAL)</h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Building the MApp Engine from the source code is use case for heavily customizing your Entando project. As such, we recommend that all but the most advanced projects use the standard process outlined beginning with the Creating an Entando Project section above.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>To download the latest source code:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open your terminal and create an empty directory for your project:<br>
<code>mkdir ~/my_new_project</code></p>
</li>
<li>
<p>Move to the new directory:<br>
<em>cd ~/my_new_project</em></p>
</li>
<li>
<p>Clone the following repositories IN ORDER: entando-core, entando-components, entando-archetypes, entando-ux-packages projects:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Entando-core:<br>
<code>git clone https://github.com/entando/entando-core</code></p>
</li>
<li>
<p>Entando-components:<br>
<code>git clone https://github.com/entando/entando-components</code></p>
</li>
<li>
<p>Entando-archetypes:<br>
<code>git clone https://github.com/entando/entando-archetypes</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>Install, IN ORDER, the entando-core, entando-components, entando-archetypes projects:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>cd entando-core<br>
<code>mvn clean install -DskipTests</code></p>
</li>
<li>
<p>cd entando-components<br>
<code>mvn clean install -DskipTests</code></p>
</li>
<li>
<p>cd entando-archetypes<br>
<code>mvn clean install -DskipTests</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>Complete the download by following the steps from the Creating a New Entando Project section.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>At this point you have installed all of the dependencies required to build a new MApp Engine instance.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The command to use the artifacts you have installed locally with an additional switch on the archetype command to use local values only is:<br>
<code>mvn archetype:generate -Dfilter=entando-archetype-webapp-generic -DarchetypeCatalog=local</code></p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deployment_on_docker_and_openshift"><a class="anchor" href="#_deployment_on_docker_and_openshift"></a>5.2. DEPLOYMENT ON DOCKER AND OPENSHIFT</h3>
<div class="sect3">
<h4 id="containers"><a class="anchor" href="#containers"></a>5.2.1. Overview</h4>
<div class="paragraph">
<p>Entando currently offers a variety of Docker images that can be used in different container environments, such as
'vanilla' Docker, Openshift or Kubernetes. These images were also developed with different use cases in mind, such as
for simple demos, for getting started with your own app, for more advanced CI/CD, or for production deployments.
Supporting different environments and use cases inevitably comes with some level of complexity. In this chapter,
we will gradually take you from the simpler use cases to the more complex use cases, hopefully easing the learning
curve required for using our Docker images.</p>
</div>
<div class="sect4">
<h5 id="_a_word_on_docker_tooling"><a class="anchor" href="#_a_word_on_docker_tooling"></a>A word on Docker tooling.</h5>
<div class="paragraph">
<p>While it is theoretically possible to manage this multitude of Entando Docker containers using the 'docker' command, we
strongly recommend using container management tools that allow you to manage multiple containers in concert. Entando
itself is typically deployed on Docker in sets of two to three images. As containerization gains more traction in the
industry, we expect more Entando Docker images to be added to these deployments. We therefor advise even the die-hard
'docker' command line users to familiarize themselves with one or more  container management tool that allows you to easily
deploy, start and stop multiple containers collectively using a single command.</p>
</div>
<div class="paragraph">
<p>Entando supports Docker Compose and Openshift, both of which simplify the management of multiple Docker containers and setting
up connectivity amongst them. Since Entando Apps are still Java projects built with Maven, we have also added support
for the Fabric8 Maven Docker Plugin for multiple Entando Docker images to be built built and tested during the development and
build processes. We have developed quick starts for all three these technologies to make it easier for new users to
get Entando up and running on Docker.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="getting-started"><a class="anchor" href="#getting-started"></a>5.2.2. Getting Started</h4>
<div class="paragraph">
<p>You can get started on Entando using either Docker Compose, the Maven Docker Plugin or Openshift. In order to choose the
option that fits your needs the best, consider the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Docker Compose:</strong> For 'vanilla' Docker installations, the Docker Compose tool allows you to run
several of our images together by using one of the Docker Compose 'YAML' files that we offer. If you have some skill
in Docker, but you have limited interest or skills in development, this would be best way for you to get started.
You can deploy and run a selection of our pre-built, deployment-ready images as configured in our
<a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack">Docker Compose 'YAML' files</a>.
Get started with <a href="#getting-started-with-docker-compose">Docker Compose in a 'vanilla' Docker environment</a></p>
</li>
<li>
<p><strong>Maven with Docker:</strong> If you have some development skills, especially around the use of Maven, but
Docker is not necessarily (yet) your forte, this approach may be the best for you. We have an
<a href="https://github.com/entando/entando-sample-full/tree/v5.0.3-dev">example Maven project</a>
you can use as a template to help you build your project image and run the resulting image in Docker.
<a href="#maven-docker-quickstart">Getting started on Maven and Docker</a></p>
</li>
<li>
<p><strong>Openshift:</strong> If you have an Openshift environment at your disposal and you know how to deploy an
Openshift template, the Openshift approach would be best. Openshift doesn&#8217;t require extensive
knowledge of either the Development world or the Ops world to get started, but it does reward your knowledge of either.
If DevOps is your thing, this approach is ideal for you, and you can choose from our selection of
<a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/templates">Openshift Templates</a> to match
your use case. Get started with an <a href="#openshift-quickstart">Openshift Quick Start</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="getting-started-with-docker-compose"><a class="anchor" href="#getting-started-with-docker-compose"></a>5.2.3. Docker Compose in a 'vanilla' Docker environment</h4>
<div class="olist arabic">
<div class="title">Prerequisites:</div>
<ol class="arabic">
<li>
<p>You have installed Docker locally.</p>
</li>
<li>
<p>You are either running a Linux distribution or MacOS. (Windows still to be tested)</p>
</li>
<li>
<p>The <a href="https://docs.docker.com/compose/install/">docker-compose command line tool</a> has also been installed. Some Docker distributions may require you to install this separately.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Steps:</div>
<ol class="arabic">
<li>
<p>Download the Entando Full Stack docker-compose 'YAML' file from <a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/docker-compose.yml">Github</a> to a directory of your choice.</p>
</li>
<li>
<p>In the same directory, create a file named '.env' such as <a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/docker-compose.yml">this</a>
to define the environment variables to apply to the docker-compose yaml file</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>ENTANDO_IMAGE_VERSION: the version of Entando you are interested in</p>
</li>
<li>
<p>DOCKER_HOST_ADDRESS: the TCP/IP name or address of where the Docker service is hosted. On Linux, localhost would suffice. On Windows or Apple it will be the IP Address of the Docker virtual machine.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Open a terminal window and change the present working directory to the directory that you have downloaded the yaml file to.</p>
</li>
<li>
<p>It is highly recommended that you first pull the required images from Docker Hub running the command <code>docker-compose pull</code></p>
</li>
<li>
<p>Run the command <code>docker-compose up</code> to spin up the required Docker containers</p>
</li>
<li>
<p>Open your browser and point it to <a href="http://${DOCKER_HOST_ADDRESS}:5000" class="bare">http://${DOCKER_HOST_ADDRESS}:5000</a>. This will open the AppBuilder. Replace ${DOCKER_HOST_ADDRESS} with the correct address of your Docker service.</p>
</li>
<li>
<p>Use the credentials admin/adminadmin to log in. Consult our documentation for more details on how to build an Entando App from AppBuilder</p>
</li>
<li>
<p>To open the resulting web app, point your browser to <a href="http://localhost:8080/entando" class="bare">http://localhost:8080/entando</a>.  Replace ${DOCKER_HOST_ADDRESS} with the correct address of your Docker service.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Next steps</div>
<p>Now that you got started on Entando in your Docker platform, you have a couple of different options on how to proceed.
You can have a look at our <a href="#demos-on-docker">Demos on Docker</a> section to see some more demos that you can deploy to Docker. If you are
serious about getting your images deployed to production, we would recommend working through the <a href="#openshift-quickstart">Openshift Quick Start</a>
section, as Openshift is currently our recommended approach.</p>
</div>
</div>
<div class="sect3">
<h4 id="maven-docker-quickstart"><a class="anchor" href="#maven-docker-quickstart"></a>5.2.4. Getting started on Maven and Docker</h4>
<div class="olist arabic">
<div class="title">Prerequisites:</div>
<ol class="arabic">
<li>
<p>You have installed Docker locally.</p>
</li>
<li>
<p>You have installed Java and Maven locally.</p>
</li>
<li>
<p>You are either running a Linux distribution or MacOS. (Windows still to be tested)</p>
</li>
<li>
<p>It is highly recommended that you have pulled the required images into your Docker environment
using the <a href="https://github.com/entando/entando-ops/blob/master/Docker/base-images/pull-quickstart-images.sh">pull-quickstart-images.sh script</a></p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Steps:</div>
<ol class="arabic">
<li>
<p>Open a terminal to the folder you want to place you Maven project in.</p>
</li>
<li>
<p>Clone the sample project to this folder , and change the present working directory into the newly created folder:</p>
<div class="literalblock">
<div class="content">
<pre>git clone git@github.com:entando/entando-sample-full.git
cd  entando-sample-full</pre>
</div>
</div>
</li>
<li>
<p>To view the different versions of the sample project, list all the branches:</p>
<div class="literalblock">
<div class="content">
<pre>git branch -a</pre>
</div>
</div>
</li>
<li>
<p>Select the version you want to use by checking out its corresponding branch, e.g.:</p>
<div class="literalblock">
<div class="content">
<pre>git checkout origin/v5.0.3-dev --track</pre>
</div>
</div>
</li>
<li>
<p>Run a Maven build using the 'docker-eap-derby' profile, and start the Docker containers. Specify the  the TCP/IP name or address of where the Docker service is hosted using the JVM property 'docker.host.adress'. On Linux, localhost would suffice. On Windows or Apple it will be the IP Address of the Docker virtual machine.:</p>
<div class="literalblock">
<div class="content">
<pre>mvn clean package -Pdocker-eap-derby docker:start -Ddocker.host.address=192.168.0.106</pre>
</div>
</div>
</li>
<li>
<p>When the build process finishes, one of the last log entries will list the URL where you can access the AppBuilder. Maven dynamically allocates a port on the Docker host for this URL:</p>
<div class="literalblock">
<div class="content">
<pre>[INFO] DOCKER&gt; [entando/appbuilder:5.0.3-SNAPSHOT]: Waited on url http://192.168.0.106:32769 1895 ms</pre>
</div>
</div>
</li>
<li>
<p>Open this URL and use the credentials admin/adminadmin to log in. Consult our documentation for more details on how to build an Entando App from AppBuilder</p>
</li>
<li>
<p>Similarly, a couple of log entries above this, Maven lists base URL where you can access the resulting web app on the Entando Engine from your browser:</p>
<div class="literalblock">
<div class="content">
<pre>[INFO] DOCKER&gt; [entandosamples/entando-sample-full:5.0.3-SNAPSHOT] "entando-sample-full": Waited on url http://192.168.0.106:32772/entando-sample-full 72063 ms</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Next steps</div>
<p>Now that you got started on Entando using Maven and the Docker platform, you may want to
consider managing the database yourself, or find out how to use a different base image.
For guidance on how to do this, please consult our <a href="#maven-and-docker">Maven and Docker</a> section
on the use of Docker with our Maven archetypes. If you are serious about getting
your images deployed to production, we would recommend working through the <a href="#openshift-quickstart">Openshift Quick Start</a>
section, as Openshift is currently our recommended approach.</p>
</div>
</div>
<div class="sect3">
<h4 id="openshift-quickstart"><a class="anchor" href="#openshift-quickstart"></a>5.2.5. Openshift Quick Start</h4>
<div class="olist arabic">
<div class="title">Prerequistes:</div>
<ol class="arabic">
<li>
<p>You have access to a fully operational Openshift cluster (could also be a local Minishift installation).</p>
</li>
<li>
<p>You have credentials to log into this environment.</p>
</li>
<li>
<p>Your user has access to the project named 'openshift'</p>
</li>
<li>
<p>Where it is feasible at all, it is highly recommended that you or your system admin has pulled all the required images into the Docker environment supporting your Openshift cluster
using the <a href="https://github.com/entando/entando-ops/blob/master/Openshift/installers/pull-quickstart-images.sh">pull-quickstart-images.sh script</a></p>
</li>
<li>
<p>If you require RedHat Process Automation Manager, we recommend deploying the
<a href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.0/html-single/deploying_a_red_hat_process_automation_manager_7.0_authoring_environment_on_red_hat_openshift_container_platform/index">Authoring environment template</a>
 to Openshift and take down the connection details (baseUrl, username and password) of the KIE Server.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>There are two different approaches you can follow to deploy Entando to your Openshift environment:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Using the browser based console. This approach is ideal if you are new to Openshift, if you are not comfortable with the commandline terminal and
if you won&#8217;t be expected to automate deployment and confguration any time soon.</p>
</li>
<li>
<p>Using the <code>oc</code> command line interface. This approach is intended for the more low level technical audience, especially if you will be expected
to automate deployment and configuration.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Steps using the browser based console:</div>
<ol class="arabic">
<li>
<p>Log into the browser based console using your credentials.</p>
</li>
<li>
<p>Navigate to the 'openshift' project</p>
</li>
<li>
<p>Use the 'Add to project'&#8594;'Import YAML/JSON' menu item to import some files to your catalog. The easiest would be to open these files
in your browser and copy and paste their contents into the YAML/JSON text area.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>the Entando EAP Quick Start image stream: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-eap71-quickstart-openshift.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-eap71-quickstart-openshift.json</a></p>
</li>
<li>
<p>the Entando AppBuilder image stream: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json</a></p>
</li>
<li>
<p>the Entando EAP Quick Start template: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/templates/entando-eap71-quickstart.yml" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/templates/entando-eap71-quickstart.yml</a></p>
</li>
</ol>
</div>
</li>
<li>
<p>Go back to the Openshift landing page by clicking the 'OPENSHIFT' text in the top left corner</p>
</li>
<li>
<p>Click on the 'Create Project' button in the top right area and type in the name 'entando-sample' for your new project</p>
</li>
<li>
<p>Click on the link that displays the newly created project&#8217;s name</p>
</li>
<li>
<p>Click on the 'Browse Catalog' button</p>
</li>
<li>
<p>Scroll until you find the template 'Entando in EAP 7.1'. (Sometimes there is a delay before this item shows up. If you cannot find it, delete your project, go drink some coffee, and then recreate your project again.)</p>
</li>
<li>
<p>Click on the 'Entando in EAP 7.1' template, and follow the wizard. When you are prompted for parameter values, type the following parameter values:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Find out from your admins what the default domain suffix is for your Openshift cluster, usually something like
'YOUR.CLUSTER.IP.nip.io'.</p>
</li>
<li>
<p><strong>Custom HTTP Route Hostname for the Entando runtime engine</strong>: type 'entando.YOUR.CLUSTER.IP.nip.io'. Your Entando app will be available at this domain name</p>
</li>
<li>
<p><strong>Context root of the Entando runtime engine web app</strong> should be set to "entando-sample" as this will be the context of the web app on the EAP server</p>
</li>
<li>
<p>If you have installed RedHat Process Automation Manager, you would require valid values for the following parameters:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><strong>KIE Server Base URL:</strong>  the URL of the route that exposes the KIE Server, or any URL that can be used to access the KIE Server web application.</p>
</li>
<li>
<p><strong>KIE Server Username:</strong> The username that you configured for the KIE Server. This would be the value you provided for the 'KIE Server User' parameter
when installing  RedHat Process Automation Manager, or the value of the KIE_SERVER_USER environment variable on the KIE Server
deployment configuration in Openshift.</p>
</li>
<li>
<p><strong>KIE Server Pasword:</strong> The password that you configured for the KIE Server. This would be the value you provided for the 'KIE Server Password' parameter
when installing  RedHat Process Automation Manager, or the value of the KIE_SERVER_PWD environment variable on the KIE Server
deployment configuration in Openshift.</p>
</li>
</ol>
</div>
</li>
<li>
<p>The default values would suffice for all the other parameters</p>
</li>
</ol>
</div>
</li>
<li>
<p>Navigate to the Builds&#8594;Builds menu item, confirm that a build has been triggered, and wait for this build to complete</p>
</li>
<li>
<p>Once completed, navigate to Applications&#8594;Deployments and wait until you have two active deployments</p>
</li>
<li>
<p>Once completed, navigate to Application&#8594;Routes</p>
</li>
<li>
<p>To access the Entando App Builder, click on the URL for AppBuilder Route and log in using the following username/password: admin/adminadmin.</p>
</li>
<li>
<p>To view the resulting Entando web app, click on the URL for Entando 'runtime-http' Route and log in using admin/adminadmin as well.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Steps using the <code>oc</code> command line interface:</div>
<ol class="arabic">
<li>
<p>Log into your openshift cluster using <code>oc login -u USERNAME -p PASSWORD OPENSHIFT_CLUSTER_IP:8443</code> where
<code>OPENSHIFT_CLUSTER_IP</code> is the hostname or ip address of your Openshift cluster</p>
</li>
<li>
<p>Set the current project to 'openshift': <code>oc project openshift</code></p>
</li>
<li>
<p>Install the following YAML and JSON files:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The Entando EAP image stream: <code>oc create -f <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-eap71-quickstart-openshift.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-eap71-quickstart-openshift.json</a></code></p>
</li>
<li>
<p>The Entando AppBuilder image stream: <code>oc create -f <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json</a></code></p>
</li>
<li>
<p>The Quickstart template: <code>oc create -f <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/templates/entando-eap71-quickstart.yml" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/templates/entando-eap71-quickstart.yml</a></code></p>
</li>
</ol>
</div>
</li>
<li>
<p>Create an Openshift project for your Entando App: <code>oc new-project entando-sample</code></p>
</li>
<li>
<p>Deploy the template:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Determine what the default domain suffix is for your Openshift cluster, usually something like 'YOUR.CLUSTER.IP.nip.io'. Decide what domain name you
want your Entando instance to run on by specifying the <strong>ENTANDO_ENGINE_HOSTNAME</strong> parameter, e.g. ENTANDO_ENGINE_HOSTNAME=entando.YOUR.CLUSTER.IP.nip.io</p>
</li>
<li>
<p>The <strong>ENTANDO_ENGINE_WEB_CONTEXT</strong> paramater should be set to "/entando-sample" as this will be the context of the web app on the EAP server</p>
</li>
<li>
<p>If you have installed RedHat Process Automation Manager, you would require valid values for the following parameters:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><strong>KIE_SERVER_BASE_URL</strong>: the URL of the route that exposes the KIE Server. You have installed Red Hat Process Automation Manager on your Openshift cluster and exposed it using the hostname kieserver.YOUR.CLUSTER.IP.nip.io it would be <a href="http://kieserver.YOUR.CLUSTER.IP.nip.io" class="bare">http://kieserver.YOUR.CLUSTER.IP.nip.io</a></p>
</li>
<li>
<p><strong>KIE_SERVER_USERNAME</strong>: the username that you configured for the KIE Server. This would be the value you provided for the 'KIE Server User' parameter
when installling  RedHat Process Automation Manager, or the value of the KIE_SERVER_USER environment variable on the KIE Server
deployment configuration in Openshift.</p>
</li>
<li>
<p><strong>KIE_SERVER_PASSWORD</strong>: the password that you configured for the KIE Server. This would be the value you provided for the 'KIE Server Password' parameter
when installing  RedHat Process Automation Manager, or the value of the KIE_SERVER_PWD environment variable on the KIE Server
deployment configuration in Openshift.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Instantiating the template would then look something like this:</p>
<div class="literalblock">
<div class="content">
<pre>oc process openshift//entando-eap-quickstart -p ENTANDO_ENGINE_HOSTNAME=entando.YOUR.CLUSTER.IP.nip.io
-p ENTANDO_ENGINE_WEB_CONTEXT="/entando-sample" -p KIE_SERVER_BASE_URL=http://kieserver.YOUR.CLUSTER.IP.nip.io -p KIE_SERVER_USERNAME=john_smith -p KIE_SERVER_PASSWORD=mypassword
|oc create -f -</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Confirm that a build has been triggered by runnning: <code>oc get builds</code>. Wait for build to complete.</p>
</li>
<li>
<p>Comfirm that two deployments have been triggered by running: <code>oc get dc`and then `oc get pods</code>. Wait until all pods are
in 'Running' status.</p>
</li>
<li>
<p>List all the routes that were created using the command : <code>oc get routes</code>.</p>
</li>
<li>
<p>To access the Entando App Builder, open its Route&#8217;s URL in your browser and log in using the following username/password: admin/adminadmin.</p>
</li>
<li>
<p>To view the resulting Entando web app, open the 'runtime-http'  Route&#8217;s URL in your browser log in using admin/adminadmin as well.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Next steps</div>
<p>Now that you got started with Entando on Openshift, you may want to delve into the
process of managing the database yourself, or how to leverage Jenkins in Openshift
to setup your own pipeline, or how to promote your changes from one environment to the next.
For guidance on how to do this, please consult our <a href="#entando-on-openshift">Entando on Openshift</a> section on
the use of our Openshift images and templates.</p>
</div>
</div>
<div class="sect3">
<h4 id="common-variables"><a class="anchor" href="#common-variables"></a>5.2.6. Common Variables on Docker</h4>
<div class="paragraph">
<p>Once you have completed one of our <a href="#getting-started">Getting Started</a> tutorials, you should have one or more Docker containers running
either on Docker or on Openshift. Ultimately, that is what this chapter is about - taking a Docker image, configuring
the various variables required to successfully create a container from that image, and the creating and running the container.
Whether we do this from Docker Compose, the Fabric8 Docker Maven Plugin or from Openshift, at some point we have an
image to configure.</p>
</div>
<div class="paragraph">
<p>When configuring a Docker image for container creation, three different types of variables typically need to be provided
by the user:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The environment variables required by the image</p>
</li>
<li>
<p>The ports on the host that will be used to exposed the container&#8217;s ports on</p>
</li>
<li>
<p>The volumes on the host that will be used to map the container&#8217;s hard drive volumes on</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In order to provide the correct values for these variables, the user needs to understand what the function of each
environment variable, image port and image volume is. We have kept these configuration variables
of our Entando Docker images as consistent as possible. The Entando images consistently associate the same functionality
with the same ports, volumes and environment variables. You can use this section as a reference on how to configure
the Entando images.</p>
</div>
<div class="sect4">
<h5 id="_environment_variables_for_images_hosting_the_entando_database"><a class="anchor" href="#_environment_variables_for_images_hosting_the_entando_database"></a>Environment Variables for images hosting the Entando database</h5>
<div class="ulist">
<div class="title">Applicable Images:</div>
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/base-images/entando-postgresql95-base">Entando PostgreSQL 9.5 Base Image (entando/entando-postgresql95-base:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/s2i-images/entando-postgresql95-openshift">Entando PostgreSQL 9.5 Openshift S2I Image (entando/entando-postgresql95-openshift:latest)</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Environment Variables</div>
<ul>
<li>
<p><strong>PORTDB_DATABASE</strong> - the name of the Entando PORT database that is created and hosted in the image</p>
</li>
<li>
<p><strong>PORTDB_USERNAME</strong> - the username of the user that has read/write access to the Entando PORT database</p>
</li>
<li>
<p><strong>PORTDB_PASSWORD</strong> - the password of the above-mentioned username.</p>
</li>
<li>
<p><strong>SERVDB_DATABASE</strong> - - the name of the Entando SERV database that is created and hosted in the image</p>
</li>
<li>
<p><strong>SERVDB_USERNAME</strong> - the username of the user that has read/write access to the Entando SERV database. For compatibility with mvn jetty:run, please keep this the same as PORTDB_USERNAME</p>
</li>
<li>
<p><strong>SERVDB_PASSWORD</strong> - the password of the above-mentioned username.  For compatibility with mvn jetty:run, please keep this the same as PORTDB_PASSWORD</p>
</li>
<li>
<p><strong>ADMIN_USERNAME</strong> - the username of a user that has admin rights on both the SERV and PORT databases. For compatibility with Postgresql, keep this value to 'postgres'</p>
</li>
<li>
<p><strong>ADMIN_PASSWORD</strong> - the password of the above-mentioned username.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_environment_variables_for_images_hosting_the_entando_engine"><a class="anchor" href="#_environment_variables_for_images_hosting_the_entando_engine"></a>Environment Variables for images hosting the Entando Engine</h5>
<div class="ulist">
<div class="title">Applicable Images</div>
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/base-images/entando-eap71-base">Entando EAP 7.1 Base Image (entando/entando-eap71-base:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/base-images/entando-eap71-clustered-base">Entando EAP 7.1 Clustered Base Image (entando/entando-eap71-clustered-base:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/base-images/entando-wildfly12-base">Entando Wildfly 12 Base Image (entando/entando-wildfly12-base:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/s2i-images/entando-eap71-quickstart-openshift">Entando EAP 7.1 Openshift Quickstart Image (entando/entando-eap71-quickstart-openshift:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/s2i-images/entando-wildfly12-quickstart-openshift">Entando Wildfly 12 Openshift Quickstart Image (entando/entando-wildfly12-quickstart-openshift:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/s2i-images/entando-eap71-clustered-openshift">Entando EAP 7.1 Clustered Openshift Image (entando/entando-eap71-clustered-openshift:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/demos/fsi-cc-dispute-customer">Entando FSI Credit Card Dispute Customer Image (entando/fsi-cc-dispute-customer:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/demos/fsi-cc-dispute-admin">Entando FSI Credit Card Dispute Back Office Image (entando/fsi-cc-dispute-admin:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/entando">The Full Entando Engine API (entando/engine-api:latest)</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Environment Variables</div>
<ul>
<li>
<p><strong><a id="portdb_url"></a>PORTDB_URL</strong> - the full JDBC connection string used to connect to the Entando PORT database</p>
</li>
<li>
<p><strong><a id="portdb_jndi"></a>PORTDB_JNDI</strong> - the full JNDI name where the Entando PORT datasource will be made available to the Entando Engine JEE application</p>
</li>
<li>
<p><strong><a id="portdb_driver"></a>PORTDB_DRIVER</strong> - the name of the driver for the Entando PORT database as configured in the JEE application server</p>
</li>
<li>
<p><strong><a id="portdb_username"></a>PORTDB_USERNAME</strong> - the username of the user that has read/write access to the Entando PORT database</p>
</li>
<li>
<p><strong><a id="portdb_password"></a>PORTDB_PASSWORD</strong> - the password of the above-mentioned username.</p>
</li>
<li>
<p><strong><a id="portdb_service_host"></a>PORTDB_SERVICE_HOST</strong> - the  name of the server that hosts the Entando PORT database.</p>
</li>
<li>
<p><strong><a id="portdb_service_port"></a>PORTDB_SERVICE_PORT</strong> - the port on the above-mentioned server that serves the Entando PORT database. Generally we keep to the default port for each RDBMS, e.g. for PostgreSQL it is 5432</p>
</li>
<li>
<p><strong><a id="servdb_url"></a>SERVDB_URL</strong> - the full JDBC connection string used to connect to the Entando SERV database</p>
</li>
<li>
<p><strong><a id="servdb_jndi"></a>SERVDB_JNDI</strong> - the full JNDI name where the Entando SERV datasource will be made available to the Entando Engine JEE application</p>
</li>
<li>
<p><strong><a id="servdb_driver"></a>SERVDB_DRIVER</strong> - the name of the driver for the Entando SERV database as configured in the JEE application server</p>
</li>
<li>
<p><strong><a id="servdb_username"></a>SERVDB_USERNAME</strong> - the username of the user that has read/write access to the Entando SERV database. For compatibility with mvn jetty:run, please keep this the same as PORTDB_USERNAME</p>
</li>
<li>
<p><strong><a id="servdb_password"></a>SERVDB_PASSWORD</strong> - the password of the above-mentioned username.  For compatibility with mvn jetty:run, please keep this the same as PORTDB_PASSWORD</p>
</li>
<li>
<p><strong><a id="servdb_service_host"></a>SERVDB_SERVICE_HOST</strong> - the  name of the server that hosts the Entando SERV database</p>
</li>
<li>
<p><strong><a id="servdb_service_port"></a>SERVDB_SERVICE_PORT</strong> - the port on the above-mentioned server that serves the Entando SERV database. Generally we keep to the default port for each RDBMS, e.g. for PostgreSQL it is 5432</p>
</li>
<li>
<p><strong><a id="kie_server_base_url"></a>KIE_SERVER_BASE_URL</strong> - The base URL where a KIE Server instance is hosted, e.g. <a href="http://entando-kieserver701.apps.serv.run/" class="bare">http://entando-kieserver701.apps.serv.run/</a></p>
</li>
<li>
<p><strong><a id="kie_server_username"></a>KIE_SERVER_USERNAME</strong> - The username of a user that be used to log into the above-mentioned KIE Server</p>
</li>
<li>
<p><strong><a id="kie_server_password"></a>KIE_SERVER_PASSWORD</strong> - The password of the above-mentioned KIE Server user.</p>
</li>
<li>
<p><strong><a id="entando_oidc_active"></a>ENTANDO_OIDC_ACTIVE</strong> set this variable&#8217;s value to "true" to activate Entando&#8217;s Open ID Connect and the related OAuth authentication infrastructure. If set to "false" all the subsequent OIDC  variables will be ignored. Once activated, you may need to log into Entando using the following url: &lt;application_base_url&gt;/&lt;lang_code&gt;/&lt;any_public_page_code&gt;.page?username=&lt;MY_USERNAME&gt;&amp;password=&lt;MY_PASSWORD&gt;</p>
</li>
<li>
<p><strong><a id="entando_oidc_auth_location"></a>ENTANDO_OIDC_AUTH_LOCATION</strong> - the URL of the authentication service, e.g. the 'login page' that Entando needs to redirect the user to in order to  allow the OAuth provider to authenticate the user.</p>
</li>
<li>
<p><strong><a id="entando_oidc_token_location"></a>ENTANDO_OIDC_TOKEN_LOCATION</strong> - the URL of the token service where Entando can retrieve the OAuth token from after authentication</p>
</li>
<li>
<p><strong><a id="entando_oidc_client_id"></a>ENTANDO_OIDC_CLIENT_ID</strong> - the Client ID that uniquely identifies the Entando App in the OAuth provider&#8217;s configuration</p>
</li>
<li>
<p><strong><a id="entando_oidc_redirect_base_url"></a>ENTANDO_OIDC_REDIRECT_BASE_URL</strong> - the optional base URL, typically the protocol, host and port (<a href="https://some.host.com:8080/" class="bare">https://some.host.com:8080/</a>) that will be prepended to the path segment of the URL requested by the user and provided as a redirect URL to the OAuth provider. If empty, the requested URL will be used as is.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_environment_variables_for_images_hosting_the_appbuilder_and_other_javascript_apps"><a class="anchor" href="#_environment_variables_for_images_hosting_the_appbuilder_and_other_javascript_apps"></a>Environment Variables for images hosting the AppBuilder (and other JavaScript apps)</h5>
<div class="ulist">
<div class="title">Applicable Images</div>
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/appbuilder">Entando App Builder Image (entando/appbuilder:latest)</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Environment Variables</div>
<ul>
<li>
<p><strong>DOMAIN</strong> - the HTTP URL on which the associated Entando Engine instance will be served</p>
</li>
<li>
<p><strong>CLIENT_SECRET</strong> - the HTTP URL on which the associated Entando Engine instance will be served</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_common_ports"><a class="anchor" href="#_common_ports"></a>5.2.7. Common Ports</h4>
<div class="ulist">
<ul>
<li>
<p><strong>5000</strong> - the port for the NodeJS HTTP Service on images that serve JavaScript applications</p>
</li>
<li>
<p><strong>8080</strong> - the port for the HTTP service hosted by JEE Servleit Containers on images that host Java services</p>
</li>
<li>
<p><strong>8443</strong> - the port for  the HTTPS service hosted by JEE Servlet Containers that support HTTPS. (P.S. generally we prefer to configure HTTPS on a router such as the Openshift Router)</p>
</li>
<li>
<p><strong>8778</strong> - the port for the Jolokia service on JBoss. This service is used primarily for monitoring.</p>
</li>
<li>
<p><strong>8888</strong> - the port that a ping service will expose to on support JGroups on images that support JGroups such as the JBoss EAP images</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="common-volumes"><a class="anchor" href="#common-volumes"></a>5.2.8. Common Volumes</h4>
<div class="ulist">
<ul>
<li>
<p><strong>/entando-data</strong> - contains the data that will be used and/or generated by the Entando app running in the container. In order to keep things simple, we generally map the following Maven
filter properties to subdirectories inside this volume:</p>
<div class="ulist">
<ul>
<li>
<p><strong>profile.resources.path=/entando-data/resources</strong> - this is where uploaded files are stored</p>
</li>
<li>
<p><strong>profile.resources.path.protected=/entando-data/protected</strong> - this is where sensitive files are stored such as database backups</p>
</li>
<li>
<p><strong>profile.index.path=/entando-data/indexdir</strong> - this is where Entando builds its indices</p>
</li>
<li>
<p><strong>Embedded Derby Databases: /entando-data/databases</strong> this contains the embedded Derby database for optional use, which can be ignored if you are pointing to a different database.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="demos-on-docker"><a class="anchor" href="#demos-on-docker"></a>5.2.9. Demos on Docker</h4>
<div class="paragraph">
<p>Entando offers a couple of demos, such as the Entando Full Stack demo we had a look at in the <a href="#getting-started">Getting Started</a> section. In this section we will delve a bit deeper into
these demos on Docker and the various options they offer you. All of these demos have been configured for docker-compose using the standard docker-compose yaml file format.
You will notice that these files generally required two environment variables:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>ENTANDO_IMAGE_VERSION: the version of Entando you are interested in</p>
</li>
<li>
<p>DOCKER_HOST_ADDRESS: the TCP/IP name or address of where the Docker service is hosted. On Linux, localhost would suffice. On Windows or Apple it will be the IP Address of the Docker virtual machine.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Depending on the operating system you use, there are various ways that you can make these variables available to docker-compose. We recommend creating a file with the name '.env'
in the same folder as the docker-compose yaml files that you will be downloading. This is the most portable solution as it works consistently across all platforms. An example '.env' file
is available in our <a href="https://github.com/entando/entando-ops/blob/EN-2348/Docker/Production/entando-full-stack/.env">GitHub repository</a></p>
</div>
<div class="sect4">
<h5 id="entando-ful-stack-demo"><a class="anchor" href="#entando-ful-stack-demo"></a>Default Entando Full Stack demo</h5>
<div class="paragraph">
<p>This demo was briefly discussed in the <a href="#getting-started">Getting Started</a> section. The entando Full Stack demo deploys two images. Follow their links to read more about the image in question</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/appbuilder">Entando App Builder Image (entando/appbuilder:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/entando">The Full Entando Engine API (entando/engine-api:latest)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This demo exports the standard ports of 5000 and 8080 to the Docker host. On Linux this would be localhost, but on Windows and Apple it will be the IP address of the virtual machine
that hosts the Docker service.</p>
</div>
<div class="paragraph">
<p>The demo also allocates a local volume for the /entando-data volume. This volume contains the usual uploaded resources, protected and index files as described in the <a href="#common-volumes">Common Volumes</a> section.
This particular configuration of the Entando Full Stack image comes with two pre-built embedded Derby databases that will be copied to the /entando-data/databases directory. Any changes
made to the underlying database will therefore be persisted in this volume and will thus survive container restarts, even when the container itself is removed.</p>
</div>
<div class="paragraph">
<p>To determine the location of the volume, first list the volumes using <code>docker volume ls</code> and then describe the
appropriate volume in more detail using <code>docker inspect entando-full-stack_entando-volume</code>. For Windows and Apple, keep in mind that those volumes are hosted inside the virtual machine
that hosts the Docker service. If you want to clear the volume, stop the Docker containers and run <code>docker volume rm entando-full-stack_entando-volume</code>. This will reset all data
stored in the volume.</p>
</div>
</div>
<div class="sect4">
<h5 id="_entando_full_stack_on_postgresql"><a class="anchor" href="#_entando_full_stack_on_postgresql"></a>Entando Full Stack on Postgresql</h5>
<div class="paragraph">
<p>Wherease the default confguration of the Entando Full Stack image uses the two embeded Derby  databases, the configuration in
<a href="https://raw.githubusercontent.com/entando/entando-ops/EN-2348/Docker/Production/entando-full-stack/docker-compose-postgresql.yml">docker-compose-postgresql.yml</a>
points Entando to an external database provided by our PostgreSQL. To run this demo, do the following:</p>
</div>
<div class="olist arabic">
<div class="title">Steps:</div>
<ol class="arabic">
<li>
<p>Download the Entando Full Stack docker-compose-postgresql.yml  file from <a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/docker-compose-postgresql.yml">Github</a></p>
</li>
<li>
<p>Open a terminal window and change the present working directory to the directory that you have downloaded the yaml file to.</p>
</li>
<li>
<p>It is highly recommended that you first pull the required images from Docker Hub running the command <code>docker-compose -f docker-compose-postgresql.yml pull</code></p>
</li>
<li>
<p>Run the command <code>docker-compose -f docker-compose-postgresql.yml up</code> to spin up the required Docker containers</p>
</li>
<li>
<p>Open your browser and point it to <a href="http://localhost:5000" class="bare">http://localhost:5000</a>. This will open the AppBuilder. Note that on Apple or Windows you won&#8217;t be using localhost but rather the IP address of the Docker virtual machine.</p>
</li>
<li>
<p>Use the credentials admin/adminadmin to log in. Consult our documentation for more details on how to build an Entando App from AppBuilder</p>
</li>
<li>
<p>To open the resulting web app, point your browser to <a href="http://localhost:8080/entando" class="bare">http://localhost:8080/entando</a>. Note that on Apple or Windows you won&#8217;t be using localhost but rather the IP address of the Docker virtual machine.</p>
</li>
<li>
<p>To access the PostgreSQL databases, point your database client to jdbc:postgresql://localhost:5432 and connect using postgres/adminpwd. (On Apple or Windows use the IP address of the Docker virtual machine.)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The key difference between this demo and the <a href="#entando-ful-stack-demo">Default Entando Full Stack demo</a> is that the database here is hosted in a different container. For this reason, this demo requires
two Docker volumes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>entando-volume.</p>
</li>
<li>
<p>entando-pg-volume.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The first volume contains the usual uploaded resources, protected and index files as described in the <a href="#common-volumes">Common Volumes</a> section, but no database.
The second volume contains the PostgreSQL database. If you want to reset the database, please delete this volume and let the PostgreSQL image recreate the database.</p>
</div>
<div class="paragraph">
<p>For more information on the individual images that this demo is composed of, follow these links:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/appbuilder">Entando App Builder Image (entando/appbuilder:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/entando">The Full Entando Engine API (entando/engine-api:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/postgresql">PostgreSQL Database Image (entando/postgresql:latest</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_fsi_credit_card_dispute_demo"><a class="anchor" href="#_fsi_credit_card_dispute_demo"></a>FSI Credit Card Dispute Demo</h5>
<div class="paragraph">
<p>The Entando team, Red Hat and our business partners have collaborated to bring you a demo that illustrates how Entando can be used as the user experience layer for your Red Hat Process Automation Manager processes. The process in question allows customers to initiate a dispute case against a specific transaction. This demo provides two Entando apps - a customer facing app and a back-office app. These apps connect to a shared KIE Server instance.</p>
</div>
<div class="olist arabic">
<div class="title">Steps:</div>
<ol class="arabic">
<li>
<p>Download the Entando FSI Credit Card Dispute Demo docker-compose.yml file from <a href="https://github.com/entando/entando-ops/blob/EN-2348/Docker/demos/docker-compose.yml">Github</a></p>
</li>
<li>
<p>Open a terminal window and change the present working directory to the directory that you have downloaded the yaml file to.</p>
</li>
<li>
<p>It is highly recommended that you first pull the required images from Docker Hub running the command <code>docker-compose pull</code></p>
</li>
<li>
<p>Run the command <code>docker-compose up</code> to spin up the required Docker containers</p>
</li>
<li>
<p>Open your browser and point it to <a href="http://localhost:5001" class="bare">http://localhost:5001</a>. This will open the AppBuilder for the customer facing app.</p>
</li>
<li>
<p>Use the credentials aryaStark/adminadmin to log in. Consult our documentation for more details on how to build an Entando App from AppBuilder</p>
</li>
<li>
<p>Point your browser to <a href="http://localhost:5002" class="bare">http://localhost:5002</a>. This will open the AppBuilder for the back-office app.</p>
</li>
<li>
<p>Use the credentials admin/adminadmin to log in. Consult our documentation for more details on how to build an Entando App from AppBuilder</p>
</li>
<li>
<p>To open the customer facing web app, point your browser to <a href="http://localhost:8081/fsi-credit-card-dispute-customer" class="bare">http://localhost:8081/fsi-credit-card-dispute-customer</a>. Use aryaStark/adminadmin to log in</p>
</li>
<li>
<p>To open the back-office web app, point your browser to <a href="http://localhost:8082/fsi-credit-card-dispute-backoffice" class="bare">http://localhost:8082/fsi-credit-card-dispute-backoffice</a>. Use admin/adminadmin to log in</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Both images in this demo come with their own embedded Derby databases. These databases are stored in the following Docker volumes</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>entando-customer-volume</p>
</li>
<li>
<p>entando-admin-volume</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For more information about the images this demo is composed of, follow these links:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/appbuilder">Entando App Builder Image (entando/appbuilder:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/demos/fsi-cc-dispute-customer">Entando FSI Credit Card Dispute Customer Image (entando/fsi-cc-dispute-customer:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/demos/fsi-cc-dispute-admin">Entando FSI Credit Card Dispute Back Office Image (entando/fsi-cc-dispute-admin:latest)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This demo is configured by default to use Entando&#8217;s public Red Hat PAM environment, where the necessary rules, processes and model objects have been pre-installed.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_designing_your_pipeline_for_entando"><a class="anchor" href="#_designing_your_pipeline_for_entando"></a>5.2.10. Designing your pipeline for Entando.</h4>
<div class="paragraph">
<p>Thus far we have only looked at Entando&#8217;s pre-built demos. They illustrate what the end product could look like when deployed in the target environment.
However, none of these demos illustrate how your Entando App should be built, tested and promoted through your pipeline. As we start looking at Entando&#8217;s Docker
support for Maven and Openshift, we will in fact start covering these topics. You will also be made aware of the different options that you have, and with this
you would need to be armed with the necessary knowledge to help you make the appropriate decision for your environment. In this section, we will take you through
a couple of significant issues to consider that will help you make these decisions.</p>
</div>
<div class="sect4">
<h5 id="_entando_app_granularity"><a class="anchor" href="#_entando_app_granularity"></a>Entando App Granularity</h5>
<div class="paragraph">
<p>The scope and granularity of an Entando app play a significant role in designing the pipeline. By "scope", we need
to look specifically at the organisational scope of the app, that is who it is that needs to work on the app. If several people in your organisation work on an Entando
app, it is likely to be more coarse grained and your selected pipeline would look different compare to the pipeline of an Entando App that only has
one or two developers working on it. This section offers some guidelines to decide what the best pipeline approach would be for your specific use case</p>
</div>
<div class="sect5">
<h6 id="coarse-grained-apps"><a class="anchor" href="#coarse-grained-apps"></a>Coarse Grained Apps</h6>
<div class="paragraph">
<p>A coarse grained Entando App typically involves a fairly complex site with a lot of content and a substantial database. In this case, you will find that
different authors with potentially different skill-sets contribute to the site concurrently. It is also very likely that some of your authors may not have
strong development skills and would not be comfortable addressing conflicts at a source code level. For this reason, you are likely to rely more on
Entando&#8217;s CMS functionality to ensure that concurrent work against the site produces the expected result with minimum conflicts.</p>
</div>
<div class="paragraph">
<p>If this describes your usage of Entando, you would need a shared environment that everyone can work on concurrently. As such, the database backing
this shared environment is an extremely important asset to your organisation, and you need to take care in how you propogate the state of this database
from one environment to the next. We recommend that you leverage as much as possible of your existing database infrastructure and governance. For instance,
rather configure Entando to point to your existing database servers than using one of our database images inside the Openshift cluster. Entando doesn&#8217;t currently
have any specific features that could simplify this for you, and we suggest  using a third party database migration tool such as Liquibase.
It is very important to ensure that the directory that you uploaded your content to is promoted exactly the same time as the database, and the responsibility
for this ultimately lies with your operations team.</p>
</div>
<div class="paragraph">
<p>In future releases of Entando we are hoping to provide more support for this use case. At this point in time, we do offer for a
<a href="https://access.redhat.com/containers/?tab=overview#/registry.connect.redhat.com/entando/entando-eap71-openshift-imagick">JBoss EAP Imagick image</a>. We have
pre-installed Imagick which is required for cropping and server side modification of uploaded images. Other than that, this image inherits the standard EAP
functionality from its <a href="https://access.redhat.com/containers/?tab=overview#/registry.access.redhat.com/jboss-eap-7/eap71-openshift">parent image</a>. You can
use this to build the appropriate configuration for your Entando app.</p>
</div>
<div class="paragraph">
<p>To summarize, this use case would typically involve the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The Entando customer allocates the necessary space for the Entando database on their existing database infrastructure for DEV, STAGE and PROD environments.</p>
</li>
<li>
<p>The Entando customer allocates the necessary space for uploaded files on network storage for DEV, STAGE and PROD environments.</p>
</li>
<li>
<p>The Entando customer allocates the necessary resources for the Entando App on their Openshift cluster for all the environments. This app will be fairly large and needs explicit planning.</p>
</li>
<li>
<p>The customer&#8217;s developers prepare the appropriate selection of plugins for the Entando App in a maven project, and commits it to a  source control management tool such as Git</p>
</li>
<li>
<p>The customer&#8217;s developers may optionally customize Entando with additional plugins.</p>
</li>
<li>
<p>The customer&#8217;s developers and ops team configures a build pipeline for the Entando app on their existing Java and Maven infrastructure,</p>
</li>
<li>
<p>At some point in the pipeline, a Docker image is built using the <a href="https://access.redhat.com/containers/?tab=overview#/registry.connect.redhat.com/entando/entando-eap71-openshift-imagick">JBoss EAP Imagick image</a></p>
</li>
<li>
<p>The source code of this Entando App will remain relatively static when compared to the database changes that will occur.</p>
</li>
<li>
<p>The customer&#8217;s content team does most of its work against one of the chosen shared environments, such as DEV or STAGE, but ideally not directly in PROD.</p>
</li>
<li>
<p>When the necessary QA work is done, business decides to promote the app to the next environment.</p>
</li>
<li>
<p>The customer&#8217;s operations team then co-ordinates efforts to ensure the Database changes, the Docker image and the uploaded resources are deployed to the target environemt at exactly the same time.</p>
</li>
<li>
<p>The customer&#8217;s end users use the Entando App once it is promoted to production.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="fine-grained-apps"><a class="anchor" href="#fine-grained-apps"></a>Fine Grained Apps</h6>
<div class="paragraph">
<p>A fine grained Entando App typically involves a smaller, self-contained site. It would still involve some content and data, but not so much that you
need a fully fledged content management system to eliminate conflicts. If the authors have more advanced development skills, they would be
able to sort out all potential conflicts using the source control management tool of their choice. In this case, the database remains small and simple
enough for you to resolve all conflicts at the source code level, comparing the various SQL files that will populate the database in the target environment.
Most of our Docker and Openshift infrastructure supports this particular use case out of the box. The resources and files that make up the content of your site
would also be small enough that you can commit it to your source control management system without minimal overhead.</p>
</div>
<div class="paragraph">
<p>In this particular scenario, your database is not a very important asset - it can be restored from source code at any point in time. It can be considered to
be a fairly ephemeral piece of the puzzle, an as such, it would be much easier to provision your database in the Openshift cluster using one of our database images.
You wouldn&#8217;t need to concern yourself with the synchronization of your uploaded content and your database, as both can be rebuilt from scratch every time you
deploy your Entando App to a given environment. In this scenario, it is therefore not necessary to tax your database administration and operations teams with the
details of database state propagation, and it would therefore be much lighter from a governance perspective.</p>
</div>
<div class="paragraph">
<p>This use case is significantly simpler to manage than <a href="#coarse-grained-apps">Coarse Grained Apps</a>, but it comes at a cost. You need at least some development skills, and some knowledge
of source control management tools to contribute to such an app. For some scenarios, this may not be a price worth paying. You also need to actively manage the
complexity and scope of your apps, and make sure that a fine grained app never grows to such a size that it starts hogging your build and source control infrastructure.
But if you can nail these skills, the you will reap the benefit from most of the advantages that a typical microservices architecture offers.</p>
</div>
<div class="paragraph">
<p>To summarize, this use case would typically involve the following steps.
. The Entando customer would classify the planned Entando App in terms of size. (CPU consumption, memory, storage and database storage)
. The Entando customer&#8217;s Openshift administration team would ensure that the necessary memory, storage and processing power is available to handle the required number of instances of this app.
. The customer&#8217;s developers would setup a full CI/CD pipeline using whichever infrastructure is already in place for their other microservices.
. The customer&#8217;s developers would implement all requirements using the <code>mvn jetty:run</code> command on a local machine.
. Once completed the developer would generate a database backup from Entando running in Jetty, and then commit the resulting SQL files.
. The developer would now resolve conflicts, and push the changes to the appropriate branch to trigger a build and test run in the appropriate environment, likely using ephemeral containers that were spun up just for these purposes.
. Once the automatic validation succeeds, the resulting Entando Image is tagged and deployed to a shared environment where non-technical people can verify its quality
. Once the QA has completed, the Entando App is tagged and deployed to Production for use by end users.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_your_existing_build_infrastructure"><a class="anchor" href="#_your_existing_build_infrastructure"></a>5.2.11. Your existing build infrastructure.</h4>
<div class="paragraph">
<p>In our interactions with our customers, we have come to realize that it is difficult to make a generalization as to where all our customers are in their DevOps journey.
Some customers have already invested a lot of time and effort into establishing a more traditional centralized build server instance with minimal integration with Docker.
Other customers may have embraced Kubernetes and/or Openshift for all of their infrastructure. Some even have their build, staging and production environments all hosted
in a single cluster whereas other have a set of interrelated clusters to do the job.  Still other customers may find themselves somewhere between having a centralized build
server and having a Kubernetes or Openshift cluster that hosts all the build infrastructure. For the purposes of designing your Entando pipeline, we will distinguish between
two different scenarios - a scenario where everything runs on Openshift, and a scenario where multiple divergent technologies are orchestrated to produce a Docker image
that will be deployed to Openshift (or any other Docker hosting environment for that matter).</p>
</div>
<div class="sect4">
<h5 id="pure-openshift-environment"><a class="anchor" href="#pure-openshift-environment"></a>Pure Openshift Environment</h5>
<div class="paragraph">
<p>Opting for a pure Openshift environment for your entire pipeline offers some significant benefits. You can manage and scale your build infrastructure as easily as you
can manage and scale your deployment environments. You can scale out to a cloud provider if needed. You also have a centralized catalog of all pipeline related activity
that is happening and there is definitely a benefit in reusing your Openshift knowledge for your build environment. On the negative side, one has to acknowledge that
certain advanced build techniques that are not yet implemented in Openshift. It is also true that, whilst the Jenkins/Openshift integration already provides a viable
option, there are still some features that are not fully integrated, which results in duplication and/or overlap that can be quite difficult to navigate. All in all though,
this offers an appealing if perhaps slightly cutting edge option.</p>
</div>
<div class="paragraph">
<p>In a pure Openshift environment you are free to use the various build and deployment techniques described in its
<a href="https://docs.openshift.com/container-platform/3.9/dev_guide/application_lifecycle/promoting_applications.html">official documentation</a>. Entando has also implemented
a set of templates that would allow you to repeat and customize your configuration for various environments. If you want to take it one level further, we have a beta
version of our reference pipeline based on the <a href="https://www.oreilly.com/library/view/devops-with-openshift/9781491975954/ch04.html">DevOps with Openshift book</a>.</p>
</div>
<div class="paragraph">
<p>In a pure Openshift environment we would recommend that you leverage the three types of BuildConfigs that Openshift offers to build your Docker images:
Source-to-Image builds, Dockerfile builds and Jenkins pipelines.</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Source-to-Image builds certainly provide the simplest solution, and require almost no knowledge of Docker to get going. This facility simply
builds your Entando war file using Maven and leaves it to the S2I image to contribute it to the correct location in the image&#8217;s file system. Entando does offer
<a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/s2i-images">several S2I images</a> to choose from, along with
<a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/templates">templates</a> that can facilitate the installation of these images.</p>
</li>
<li>
<p>The Dockerfile approach may be more appealing to those with strong Docker skills. Whereas we do use Dockerfile builds in our pipelines, Entando does not provide any
specific support for this approach other than offering several <a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/base-images">base images</a> that you can choose from.</p>
</li>
<li>
<p>The Jenkins Pipeline approach is more powerful, but also comes with significant build overheads and a steep learning curve. The integration between Jenkins and Openshift
can be a bit finicky at times, and there is significant overlap and repetition that need to be addressed at a conceptual level. But once you have a Jenkins pipeline in place,
the increased flexibility and power does help significantly, especially in synchronizing Image deployment and database migration.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>We will explore Entando&#8217;s offering in this space in more detail in the <a href="#entando-on-openshift">Entando on Openshift</a> section</p>
</div>
</div>
<div class="sect4">
<h5 id="hybrid-docker-environment"><a class="anchor" href="#hybrid-docker-environment"></a>Hybrid Docker Environment</h5>
<div class="paragraph">
<p>The hybrid Docker environment is common amongst customers that are growing from a more traditional continuous integration approach to a full DevOps approach.
Such organizations often have mature continuous integration infrastructure from which it already benefits significantly. They may have evaluated Openshift&#8217;s build
infrastructure but may have found it wanting on features that the organization already relies on, such as complex branch build algorithms required for pull requests.
It could also be that the organization simply has skills primarily in Bamboo and that the move to Jenkins doesn&#8217;t seem like a cost effective step to take. Another
motivation here could be that the organization is not using Openshift on Docker in the deployment environment, but some other container orchestration product that
does not necessarily have Openshift&#8217;s out-of-the-box support for builds. The end result though is the same: the organization uses existing continuous integration
infrastructure for all build related activities, and Docker is reserved primarily for the the deployment environment.</p>
</div>
<div class="paragraph">
<p>In hybrid Docker environments, it is best to think of the Docker image as the unit of delivery that is handed off from the build environment to the Docker environment.
It almost serves the same role as tradition JEE war files did in the days of monolithic application servers. Like a JEE war file, the traditional build infrastructure
therefore produces and verifies the Docker image, and the publishes it to a shared artifact repository, in this case a Docker registry. During deployment to
a shared environment, the deployment process then picks up the Docker image and instantiates it with the correct environment variables in the target environment.</p>
</div>
<div class="paragraph">
<p>We would recommend using the Maven Docker plugin for these types of scenarios. It is a powerful build tool that allows you to produce the image immediately after
the Entando war file is built. It does however require Docker capabilities on the Bamboo agent or Jenkins slave, even if it is just connected to a viable
Docker server. This can be a bit tricky when the agent/slave is a Docker container itself, but it is certainly doable. Once the image has been built and verified,
it can be handed off to any Docker based deployment environment. In fact, this makes the Maven Docker plugin very appealing for environments where the organization
does not want to be tied into a specific container orchestration vendor, such as Openshift or Kubernetes. We will look into this option in the <a href="#maven-and-docker">Maven and Docker</a>
section.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="maven-and-docker"><a class="anchor" href="#maven-and-docker"></a>5.2.12. Maven and Docker</h4>
<div class="paragraph">
<p>In the <a href="#maven-docker-quickstart">Getting started on Maven and Docker</a> section, we briefly looked at how to generate an Entando Maven project with the Maven Docker Plugin pre-configured. Once such
a project is in place, all one needs to do is run the following command and you have an Entando instance up and running:</p>
</div>
<div class="paragraph">
<p><code>mvn clean install -Pdocker-eap-derby docker:start -Ddocker.host.address=172.17.0.1</code></p>
</div>
<div class="paragraph">
<p>But happens behind the scenes here?</p>
</div>
<div class="sect4">
<h5 id="_the_pom_xml"><a class="anchor" href="#_the_pom_xml"></a>The pom.xml</h5>
<div class="paragraph">
<p>Central to building and running a Docker image from your Entando Maven project is the highly parameterized configuration of three 'image' elements in the
Docker Maven Plugin, and a set of Maven profiles that instantiate this configuration in different ways. This section will briefly look at each 'image' element
and the settings that were parameterized, and then look at the different profiles and the value of the abovementioned parameters in each profile. Ultimately,
we would very much like for developers to be armed with the necessary information to chop and change the pom.xml to best suited for their development
approach.</p>
</div>
<div class="sect5">
<h6 id="_entando_engine_server_image"><a class="anchor" href="#_entando_engine_server_image"></a>Entando Engine server image</h6>
<div class="paragraph">
<p>The most important image configuration is that of the Entando server engine. This image has both a 'build' configuration and a 'run' configuration which allows it
to be build as part of the Maven build process, and then started from Maven too. It looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>                        &lt;image&gt;
                            &lt;name&gt;entandosamples/${project.artifactId}:${project.version}&lt;/name&gt;
                            &lt;alias&gt;${project.artifactId}&lt;/alias&gt;
                            &lt;build&gt;
                                &lt;from&gt;entando/${server.base.image}:${entando.version}&lt;/from&gt;
                                &lt;skip&gt;${skipServerImage}&lt;/skip&gt;
                                &lt;assembly&gt;
                                    &lt;descriptorRef&gt;artifact&lt;/descriptorRef&gt;
                                    &lt;targetDir&gt;${jboss.home.in.image}/standalone/deployments&lt;/targetDir&gt;
                                &lt;/assembly&gt;
                                &lt;runCmds&gt;
                                    &lt;run&gt;${docker.db.init.command}&lt;/run&gt;
                                &lt;/runCmds&gt;
                            &lt;/build&gt;
                            &lt;run&gt;
                                &lt;skip&gt;${skipServerImage}&lt;/skip&gt;
                                &lt;namingStrategy&gt;alias&lt;/namingStrategy&gt;
                                &lt;network&gt;
                                    &lt;mode&gt;custom&lt;/mode&gt;
                                    &lt;name&gt;${project.artifactId}-network&lt;/name&gt;
                                    &lt;alias&gt;${project.artifactId}&lt;/alias&gt;
                                &lt;/network&gt;
                                &lt;volumes&gt;
                                    &lt;bind&gt;
                                        &lt;volume&gt;${project.artifactId}-entando-data:/entando-data&lt;/volume&gt;
                                    &lt;/bind&gt;
                                &lt;/volumes&gt;
                                &lt;env&gt;
                                    &lt;PORTDB_USERNAME&gt;agile&lt;/PORTDB_USERNAME&gt;
                                    &lt;PORTDB_USERNAME&gt;agile&lt;/PORTDB_USERNAME&gt;
                                    &lt;PORTDB_PASSWORD&gt;agile&lt;/PORTDB_PASSWORD&gt;
                                    &lt;SERVDB_USERNAME&gt;agile&lt;/SERVDB_USERNAME&gt;
                                    &lt;SERVDB_PASSWORD&gt;agile&lt;/SERVDB_PASSWORD&gt;
                                    &lt;PORTDB_DATABASE&gt;entandoPort&lt;/PORTDB_DATABASE&gt;
                                    &lt;SERVDB_DATABASE&gt;entandoServ&lt;/SERVDB_DATABASE&gt;
                                    &lt;PORTDB_URL&gt;${port.db.url}&lt;/PORTDB_URL&gt;
                                    &lt;SERVDB_URL&gt;${serv.db.url}&lt;/SERVDB_URL&gt;
                                    &lt;!--Uncomment this if you do not want the derby database to be overwritten with every build --&gt;
                                    &lt;!--&lt;PREPARE_DATA&gt;false&lt;/PREPARE_DATA&gt;--&gt;
                                &lt;/env&gt;
                                &lt;ports&gt;
                                    &lt;port&gt;entando.engine.port:8080&lt;/port&gt;
                                &lt;/ports&gt;
                                &lt;wait&gt;
                                    &lt;http&gt;
                                        &lt;url&gt;http://${docker.host.address}:${entando.engine.port}/${project.artifactId}&lt;/url&gt;
                                    &lt;/http&gt;
                                    &lt;time&gt;90000&lt;/time&gt;
                                &lt;/wait&gt;
                                &lt;log&gt;
                                    &lt;enabled&gt;true&lt;/enabled&gt;
                                    &lt;prefix&gt;server:&lt;/prefix&gt;
                                    &lt;color&gt;blue&lt;/color&gt;
                                &lt;/log&gt;
                            &lt;/run&gt;
                        &lt;/image&gt;</code></pre>
</div>
</div>
<div class="ulist">
<div class="title">Maven Properties</div>
<ul>
<li>
<p><strong>server.base.image</strong> Specifies which base-image to use. Current options are 'entando-wildfly12-base', 'entando-eap71-base' or 'entando-eap71-clustered-base'</p>
</li>
<li>
<p><strong>skipServerImage</strong>  Both the build configuration and run configuration of this image are activated or deactivated based on the <code>skipServerImage</code></p>
</li>
<li>
<p><strong>jboss.home.in.image</strong> The installation root of JBoss/Wildfly. On the EAP images, this would be '/opt/eap', and '/wildfly' on the Wildfly images</p>
</li>
<li>
<p><strong>docker.db.init.command</strong> An optional command that can be executed during the build process. Useful for DB initialization</p>
</li>
<li>
<p><strong>port.db.url</strong> A JDBC URL that points to the Entando 'PORT' Database, either a local Derby URL or a PostgreSQL URL</p>
</li>
<li>
<p><strong>serv.db.url</strong> A JDBC URL that points to the Entando 'SERV' Database, either a local Derby URL or a PostgreSQL URL</p>
</li>
<li>
<p><strong>entando.engine.port</strong> This property gets automatically populated by Maven when it finds a port on the Docker host to expose this service on. Can be used by downstream 'run' configurations</p>
</li>
<li>
<p><strong>docker.host.address</strong> The TCP/IP address or hostname where the Docker service is hosted. 172.17.0.1 is a 'cheat' that can be used in Linux environments as it represents the Docker software network&#8217;s gateway. Alternatively, use the virtual machine that hosts Docker</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_postgresql_image"><a class="anchor" href="#_postgresql_image"></a>PostgreSQL Image</h6>
<div class="paragraph">
<p>This image is optional and is only used if you decide to persist your Entando data in a separate image using PostgreSQL. It also has both a build and
a run configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>                        &lt;image&gt;
                            &lt;name&gt;entandosamples/postgresql-${project.artifactId}&lt;/name&gt;
                            &lt;alias&gt;postgresql-${project.artifactId}&lt;/alias&gt;
                            &lt;build&gt;
                                &lt;skip&gt;${skipDatabaseImage}&lt;/skip&gt;
                                &lt;from&gt;entando/entando-postgresql95-base:${entando.version}&lt;/from&gt;
                                &lt;assembly&gt;
                                    &lt;descriptorRef&gt;artifact&lt;/descriptorRef&gt;
                                    &lt;targetDir&gt;/tmp&lt;/targetDir&gt;
                                &lt;/assembly&gt;
                                &lt;env&gt;
                                    &lt;!--
                                    Required by the PostgreSQL image to create the correct databases.
                                    Ensure that the corresponding variables in the Server image have the same values
                                    --&gt;
                                    &lt;PORTDB_USERNAME&gt;agile&lt;/PORTDB_USERNAME&gt;
                                    &lt;PORTDB_PASSWORD&gt;agile&lt;/PORTDB_PASSWORD&gt;
                                    &lt;SERVDB_USERNAME&gt;agile&lt;/SERVDB_USERNAME&gt;
                                    &lt;SERVDB_PASSWORD&gt;agile&lt;/SERVDB_PASSWORD&gt;
                                    &lt;PORTDB_DATABASE&gt;entandoPort&lt;/PORTDB_DATABASE&gt;
                                    &lt;SERVDB_DATABASE&gt;entandoServ&lt;/SERVDB_DATABASE&gt;

                                    &lt;!--Required for the Jetty runner to be able to host the WAR file--&gt;
                                    &lt;SERVDB_JNDI&gt;${profile.datasource.jndiname.servdb}&lt;/SERVDB_JNDI&gt;
                                    &lt;PORTDB_JNDI&gt;${profile.datasource.jndiname.portdb}&lt;/PORTDB_JNDI&gt;
                                &lt;/env&gt;
                                &lt;runCmds&gt;
                                    &lt;run&gt;$STI_SCRIPTS_PATH/init-postgresql-from-war.sh --war-file=/tmp/${project.build.finalName}.war --jetty-version=${jetty.version} &lt;/run&gt;
                                &lt;/runCmds&gt;
                            &lt;/build&gt;
                            &lt;run&gt;
                                &lt;skip&gt;${skipDatabaseImage}&lt;/skip&gt;
                                &lt;namingStrategy&gt;alias&lt;/namingStrategy&gt;
                                &lt;network&gt;
                                    &lt;mode&gt;custom&lt;/mode&gt;
                                    &lt;name&gt;${project.artifactId}-network&lt;/name&gt;
                                    &lt;alias&gt;postgresql-${project.artifactId}&lt;/alias&gt;
                                &lt;/network&gt;
                                &lt;ports&gt;
                                    &lt;!-- Uncomment the next line if you want to connect to PogreSQL locally from another client --&gt;
                                    &lt;!--&lt;port&gt;5432:5432&lt;/port&gt;--&gt;
                                &lt;/ports&gt;
                                &lt;volumes&gt;
                                    &lt;bind&gt;
                                        &lt;volume&gt;entando-docker-entando-pg-data:/var/lib/pgsql/data&lt;/volume&gt;
                                    &lt;/bind&gt;
                                &lt;/volumes&gt;
                                &lt;wait&gt;
                                    &lt;log&gt;Future log output will appear in directory&lt;/log&gt;
                                &lt;/wait&gt;
                                &lt;log&gt;
                                    &lt;enabled&gt;true&lt;/enabled&gt;
                                    &lt;prefix&gt;postgres:&lt;/prefix&gt;
                                    &lt;color&gt;cyan&lt;/color&gt;
                                &lt;/log&gt;
                            &lt;/run&gt;
                        &lt;/image&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>skipDatabaseImage</strong>  Both the build configuration and run configuration of this image are activated or deactivated based on the <code>skipDatabaseImage</code></p>
</li>
<li>
<p><strong>profile.datasource.jndiname.servdb</strong> Set this to the JDNI location that has been 'compiled' into the war file. It will typically be a java:jboss/* location. This is just needed for Jetty to emulate an environment similar to JBoss</p>
</li>
<li>
<p><strong>profile.datasource.jndiname.portdb</strong> See above. Needed for Jetty to emulate an environment similar to JBoss</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_appbuilder_image"><a class="anchor" href="#_appbuilder_image"></a>AppBuilder Image</h6>
<div class="paragraph">
<p>You would use this image if you want to configure you Entando app after being deployed in Docker. For the <a href="#fine-grained-apps">Fine Grained Apps</a> use case, this will probably
not happen often, as you would be configuring your Entando app locally after starting it using the mvn jetty:run command. This image is run as is and does
not get built during the Maven build process.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>                        &lt;image&gt;
                            &lt;name&gt;entando/appbuilder:${entando.version}&lt;/name&gt;
                            &lt;run&gt;
                                &lt;skip&gt;${skipAppBuilderImage}&lt;/skip&gt;
                                &lt;network&gt;
                                    &lt;mode&gt;custom&lt;/mode&gt;
                                    &lt;name&gt;${project.artifactId}-network&lt;/name&gt;
                                    &lt;alias&gt;appbuilder&lt;/alias&gt;
                                &lt;/network&gt;
                                &lt;ports&gt;
                                    &lt;port&gt;${docker.host.address}:appbuilder.port:5000&lt;/port&gt;
                                &lt;/ports&gt;
                                &lt;dependsOn&gt;
                                    &lt;container&gt;${project.artifactId}&lt;/container&gt;
                                &lt;/dependsOn&gt;                                &lt;env&gt;
                                    &lt;DOMAIN&gt;http://${docker.host.address}:${entando.engine.port}/${project.artifactId}&lt;/DOMAIN&gt;
                                &lt;/env&gt;
                                &lt;wait&gt;
                                    &lt;http&gt;
                                        &lt;url&gt;http://${docker.host.address}:${appbuilder.port}&lt;/url&gt;
                                    &lt;/http&gt;
                                    &lt;time&gt;90000&lt;/time&gt;
                                &lt;/wait&gt;
                                &lt;log&gt;
                                    &lt;enabled&gt;true&lt;/enabled&gt;
                                    &lt;prefix&gt;appbuilder:&lt;/prefix&gt;
                                    &lt;color&gt;red&lt;/color&gt;
                                &lt;/log&gt;
                            &lt;/run&gt;
                        &lt;/image&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>skipAppBuilderImage</strong> Deactivates the AppBuilder image when set to 'false'</p>
</li>
<li>
<p><strong>docker.host.address</strong> TCIP/IP address or hastname of the Docker service</p>
</li>
<li>
<p><strong>entando.engine.port</strong> A dynamically populated property that holds the random port number that the Entando engine is hosted on.</p>
</li>
<li>
<p><strong>appbuilder.port</strong>A dynamically populated property that holds the random port number that the AppBuilder service is hosted on.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_the_docker_eap_derby_profile"><a class="anchor" href="#_the_docker_eap_derby_profile"></a>The 'docker-eap-derby' Profile</h6>
<div class="paragraph">
<p>This profile is not intended for production environments as it does not support caching and assumes a local Derby database. Notice how
the <code>docker.db.init.command</code> command initializes the local Derby databases from the resulting '.war' file. Also double check that
the <code>env.db.environment</code> corresponds to the value that was active when the database backup was made. For the default profile,
when running mvn jetty:run this wil be 'develop'</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>        &lt;profile&gt;
            &lt;id&gt;docker-eap-derby&lt;/id&gt;
            &lt;properties&gt;
                &lt;jboss&gt;jboss&lt;/jboss&gt;
                &lt;env&gt;docker&lt;/env&gt;
                &lt;skipDocker&gt;false&lt;/skipDocker&gt;
                &lt;!--Ensure that this value corresponds to the database backup made for Docker deployments--&gt;
                &lt;env.db.environment&gt;develop&lt;/env.db.environment&gt;
                &lt;!-- Filter properties --&gt;
                &lt;profile.datasource.jndiname.servdb&gt;java:jboss/datasources/entandoServDataSource&lt;/profile.datasource.jndiname.servdb&gt;
                &lt;profile.datasource.jndiname.portdb&gt;java:jboss/datasources/entandoPortDataSource&lt;/profile.datasource.jndiname.portdb&gt;
                &lt;profile.database.driverClassName&gt;org.apache.derby.jdbc.EmbeddedDriver&lt;/profile.database.driverClassName&gt;

                &lt;server.base.image&gt;entando-eap71-base&lt;/server.base.image&gt;
                &lt;jboss.home.in.image&gt;/opt/eap&lt;/jboss.home.in.image&gt;
                &lt;docker.db.init.command&gt;$STI_SCRIPTS_PATH/init-derby-from-war.sh --war-file=${jboss.home.in.image}/standalone/deployments/${project.build.finalName}.war --jetty-version=${jetty.version}&lt;/docker.db.init.command&gt;
                &lt;port.db.url&gt;jdbc:derby:/entando-data/databases/entandoPort;create=true&lt;/port.db.url&gt;
                &lt;serv.db.url&gt;jdbc:derby:/entando-data/databases/entandoServ;create=true&lt;/serv.db.url&gt;

                &lt;!--Image activation--&gt;
                &lt;skipServerImage&gt;false&lt;/skipServerImage&gt;
                &lt;skipDatabaseImage&gt;true&lt;/skipDatabaseImage&gt;
                &lt;skipAppBuilderImage&gt;false&lt;/skipAppBuilderImage&gt;
            &lt;/properties&gt;
        &lt;/profile&gt;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_the_docker_wildfly_derby_profile"><a class="anchor" href="#_the_docker_wildfly_derby_profile"></a>The 'docker-wildfly-derby' Profile</h6>
<div class="paragraph">
<p>This profile is also not intended for production environments as it does not support caching and assumes a local Derby database. Again,
the <code>docker.db.init.command</code> command initializes the local Derby databases. The <code>env.db.environment</code> property is set to 'develop'</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>        &lt;profile&gt;
            &lt;id&gt;docker-wildfly-derby&lt;/id&gt;
            &lt;properties&gt;
                &lt;jboss&gt;jboss&lt;/jboss&gt;
                &lt;env&gt;docker&lt;/env&gt;
                &lt;skipDocker&gt;false&lt;/skipDocker&gt;
                &lt;!--Ensure that this value corresponds to the database backup made for Docker deployments--&gt;
                &lt;env.db.environment&gt;develop&lt;/env.db.environment&gt;
                &lt;!-- Filter properties --&gt;
                &lt;profile.datasource.jndiname.servdb&gt;java:jboss/datasources/entandoServDataSource&lt;/profile.datasource.jndiname.servdb&gt;
                &lt;profile.datasource.jndiname.portdb&gt;java:jboss/datasources/entandoPortDataSource&lt;/profile.datasource.jndiname.portdb&gt;
                &lt;profile.database.driverClassName&gt;org.apache.derby.jdbc.EmbeddedDriver&lt;/profile.database.driverClassName&gt;

                &lt;server.base.image&gt;entando-wildfly12-base&lt;/server.base.image&gt;
                &lt;jboss.home.in.image&gt;/wildfly&lt;/jboss.home.in.image&gt;
                &lt;docker.db.init.command&gt;$STI_SCRIPTS_PATH/init-derby-from-war.sh --war-file=${jboss.home.in.image}/standalone/deployments/${project.build.finalName}.war --jetty-version=${jetty.version}&lt;/docker.db.init.command&gt;
                &lt;port.db.url&gt;jdbc:derby:/entando-data/databases/entandoPort;create=true&lt;/port.db.url&gt;
                &lt;serv.db.url&gt;jdbc:derby:/entando-data/databases/entandoServ;create=true&lt;/serv.db.url&gt;

                &lt;!--Image activation--&gt;
                &lt;skipServerImage&gt;false&lt;/skipServerImage&gt;
                &lt;skipDatabaseImage&gt;true&lt;/skipDatabaseImage&gt;
                &lt;skipAppBuilderImage&gt;false&lt;/skipAppBuilderImage&gt;
            &lt;/properties&gt;
        &lt;/profile&gt;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_the_docker_eap_clustered_profile"><a class="anchor" href="#_the_docker_eap_clustered_profile"></a>The 'docker-eap-clustered' Profile</h6>
<div class="paragraph">
<p>This is the typical profile to use for production environments. Please ensure that your organization has the necessary subscription and support
to allow for JBoss EAP in a production environment. In this case, the <code>port.db.url</code> and <code>serv.db.url</code> properties point to the local PostgreSQL image,
which is now activated with <code>skipDatabaseImage=false</code>. Keep in mind that these JDBC URL&#8217;s can be overridden by providing alternative values to these
URL&#8217;s in your different deployment environments. In this profile, all that the <code>docker.db.init.command</code> does is to generate
a file named 'build_id' with the current date/time as content. This is to ensure that scripts that restore the resources and protected
resources during image instantiation can check whether the resources in the '.war' file are newer than the previously extracted resources.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>        &lt;profile&gt;
            &lt;id&gt;docker-eap-clustered&lt;/id&gt;
            &lt;properties&gt;
                &lt;jboss&gt;jboss&lt;/jboss&gt;
                &lt;env&gt;docker&lt;/env&gt;
                &lt;skipDocker&gt;false&lt;/skipDocker&gt;
                &lt;!--Ensure that this value corresponds to the database backup made for Docker deployments--&gt;
                &lt;env.db.environment&gt;develop&lt;/env.db.environment&gt;
                &lt;!-- Filter properties --&gt;
                &lt;profile.datasource.jndiname.servdb&gt;java:jboss/datasources/entandoServDataSource&lt;/profile.datasource.jndiname.servdb&gt;
                &lt;profile.datasource.jndiname.portdb&gt;java:jboss/datasources/entandoPortDataSource&lt;/profile.datasource.jndiname.portdb&gt;
                &lt;profile.database.driverClassName&gt;org.postgresql.Driver&lt;/profile.database.driverClassName&gt;

                &lt;server.base.image&gt;entando-eap71-clustered-base&lt;/server.base.image&gt;
                &lt;jboss.home.in.image&gt;/opt/eap&lt;/jboss.home.in.image&gt;
                &lt;docker.db.init.command&gt;echo $(date +%s) &gt; /entando-data-templates/build_id&lt;/docker.db.init.command&gt;
                &lt;port.db.url&gt;jdbc:postgresql://postgresql-${project.artifactId}:5432/entandoPort&lt;/port.db.url&gt;
                &lt;serv.db.url&gt;jdbc:postgresql://postgresql-${project.artifactId}:5432/entandoServ&lt;/serv.db.url&gt;

                &lt;!--Image activation--&gt;
                &lt;skipServerImage&gt;false&lt;/skipServerImage&gt;
                &lt;skipDatabaseImage&gt;false&lt;/skipDatabaseImage&gt;
                &lt;skipAppBuilderImage&gt;false&lt;/skipAppBuilderImage&gt;
            &lt;/properties&gt;
        &lt;/profile&gt;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_the_docker_wildfly_postgresql_profile"><a class="anchor" href="#_the_docker_wildfly_postgresql_profile"></a>The 'docker-wildfly-postgresql' Profile</h6>
<div class="paragraph">
<p>Another configuration to illustrate a combination of Wildfly and PostgreSQL</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>        &lt;profile&gt;
            &lt;id&gt;docker-wildfly-postgresql&lt;/id&gt;
            &lt;properties&gt;
                &lt;jboss&gt;jboss&lt;/jboss&gt;
                &lt;env&gt;docker&lt;/env&gt;
                &lt;skipDocker&gt;false&lt;/skipDocker&gt;
                &lt;!--Ensure that this value corresponds to the database backup made for Docker deployments--&gt;
                &lt;env.db.environment&gt;develop&lt;/env.db.environment&gt;
                &lt;!-- Filter properties --&gt;
                &lt;profile.datasource.jndiname.servdb&gt;java:jboss/datasources/entandoServDataSource&lt;/profile.datasource.jndiname.servdb&gt;
                &lt;profile.datasource.jndiname.portdb&gt;java:jboss/datasources/entandoPortDataSource&lt;/profile.datasource.jndiname.portdb&gt;
                &lt;profile.database.driverClassName&gt;org.postgresql.Driver&lt;/profile.database.driverClassName&gt;

                &lt;server.base.image&gt;entando-wildfly12-base&lt;/server.base.image&gt;
                &lt;jboss.home.in.image&gt;/wildfly&lt;/jboss.home.in.image&gt;
                &lt;docker.db.init.command&gt;echo $(date +%s) &gt; /entando-data-templates/build_id&lt;/docker.db.init.command&gt;
                &lt;port.db.url&gt;jdbc:postgresql://postgresql-${project.artifactId}:5432/entandoPort&lt;/port.db.url&gt;
                &lt;serv.db.url&gt;jdbc:postgresql://postgresql-${project.artifactId}:5432/entandoServ&lt;/serv.db.url&gt;

                &lt;!--Image activation--&gt;
                &lt;skipServerImage&gt;false&lt;/skipServerImage&gt;
                &lt;skipDatabaseImage&gt;false&lt;/skipDatabaseImage&gt;
                &lt;skipAppBuilderImage&gt;false&lt;/skipAppBuilderImage&gt;
            &lt;/properties&gt;
        &lt;/profile&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_using_mvn_jettyrun_locally_with_appbuilder_and_postgresql_images"><a class="anchor" href="#_using_mvn_jettyrun_locally_with_appbuilder_and_postgresql_images"></a>5.2.13. Using mvn jetty:run locally with AppBuilder and PostgreSQL images</h4>
<div class="paragraph">
<p>Whereas it is entirely possible to use Maven to build and run the Entando Docker image in your day to day development flow,
this flow of events still takes significantly longer than simply running <code>mvn clean package jetty:run</code>. It also doesn&#8217;t
support the 'live' source update that the Jetty-based approach enables. If you are looking for quick feedback to see what
your Entando app looks like, we therefore recommend that you still use the Maven Jetty plugin to do this. Once you have
achieved the required results, it is then recommended that the developer verifies the resulting Entando App at least
once from the targeted Docker image. This will give the developer the confidence that the Image build will complete successfully on
the server and that all the integration points behave as expected.</p>
</div>
<div class="paragraph">
<p>Whereas the <code>mvn jetty:run</code> approach definitely provides the quickest feedback for developers compared to using the Entando engine image, using
the other Docker images can still contribute to productivity. By pointing the AppBuilder image to the Jetty service running at localhost:8080 offers
the developer access to AppBuilder without the need to install NodeJS and other JavaScript infrastructure and build AppBuilder from source. By
pointing the Jetty datasources to the PostgreSQL container already available in Docker, the developer also gets access to o his/her own,
isolated PostgreSQL instance. To achieve this, simply follow these steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deactivate your currently selected database property section by 'commenting it out' in the appropriate filter properties file
(filter-development-unix.properties  or filter-development-windows.properties depending on your operating system) eg:</p>
<div class="literalblock">
<div class="content">
<pre># --------------------- Database Configuration: DERBY ---------------------
#profile.database.hostname=localhost
#profile.database.port=1527
#profile.database.username=agile
#profile.database.password=agile
#
##usually no need to change the following group of 3 properties:
#profile.database.driverClassName=org.apache.derby.jdbc.EmbeddedDriver
#profile.database.url.portdb=jdbc:derby:${project.build.directory}/derby/production/${profile.application.name}Port;create=true
#profile.database.url.servdb=jdbc:derby:${project.build.directory}/derby/production/${profile.application.name}Serv;create=true</pre>
</div>
</div>
</li>
<li>
<p>Uncomment the section marked as <code>Database Configuration: PostgreSQL running in Docker</code> in the appropriate filter properties file:</p>
<div class="literalblock">
<div class="content">
<pre># --------------------- Database Configuration: PostgreSQL running in Docker ---------------------
profile.database.hostname=localhost
profile.database.port=5432
profile.database.username=agile
profile.database.password=agile</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>#usually no need to change the following group of 3 properties:
profile.database.driverClassName=org.postgresql.Driver
profile.database.url.portdb=jdbc:postgresql://${profile.database.hostname}:${profile.database.port}/entandoPort
profile.database.url.servdb=jdbc:postgresql://${profile.database.hostname}:${profile.database.port}/entandoServ</pre>
</div>
</div>
</li>
<li>
<p>If you are running on Windows or Apple, remember to use the TCP/IP address of the Docker virtual matching as database hostname (<code>profile.database.hostname</code>)</p>
</li>
<li>
<p>Expose the PostgreSQL port from the container to the Docker host by uncommenting this line in the pom.xml file:</p>
<div class="literalblock">
<div class="content">
<pre>&lt;!-- Uncomment the next line if you want to connect to PogreSQL locally from Jetty --&gt;
&lt;port&gt;5432:5432&lt;/port&gt;</pre>
</div>
</div>
</li>
<li>
<p>Build the PostgreSQL image and run it along with the AppBuilder image using the docker-with-local-jetty profile:</p>
<div class="literalblock">
<div class="content">
<pre>mvn clean package -Pdocker-with-local-jetty docker:start</pre>
</div>
</div>
</li>
<li>
<p>Start Jetty:</p>
<div class="literalblock">
<div class="content">
<pre>mvn clean package jetty:run</pre>
</div>
</div>
</li>
<li>
<p>Make your modifications and verify them, and terminate the Jetty process once you are done.</p>
</li>
<li>
<p>Now you can actually build and run the Entando Engine image of your choice, pointing to the same database:</p>
<div class="literalblock">
<div class="content">
<pre>mvn clean package -Pdocker-eap-clustered -DskipDatabaseImage=true -DskipAppBuilderImage=true docker:start -Dentando.engine.port=8080 -Ddocker.host.address=localhost</pre>
</div>
</div>
</li>
<li>
<p>Verify that it is behaving as expected at <a href="http://localhost:8080/entando-sample-full" class="bare">http://localhost:8080/entando-sample-full</a>.</p>
</li>
<li>
<p>Before checking in your changes, remember to backup the database to your Maven project</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_volumes"><a class="anchor" href="#_volumes"></a>5.2.14. Volumes</h4>
<div class="paragraph">
<p>In the pom.xml file, two Docker volumes have been configured:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>                    &lt;volumes&gt;
                        &lt;volume&gt;
                            &lt;!--Volume for JBoss and Derby data--&gt;
                            &lt;name&gt;${project.artifactId}-entando-data&lt;/name&gt;
                            &lt;driver&gt;local&lt;/driver&gt;
                        &lt;/volume&gt;
                        &lt;volume&gt;
                            &lt;!--Volume for PostgreSQL data--&gt;
                            &lt;name&gt;${project.artifactId}-entando-pg-data&lt;/name&gt;
                            &lt;driver&gt;local&lt;/driver&gt;
                        &lt;/volume&gt;
                    &lt;/volumes&gt;
You can look at the actual volumes in Docker by using the following command:</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>    docker volume ls
    DRIVER              VOLUME NAME
    local               entando-sample-full-entando-pg-data
    local               entando-sample-full-entando-data</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>entando-docker-entando-data</code> volume is the standard entando-data volume that is mounted at /entando-data in the container once it has started. In this scenario, this
volume contains the indices that are generated. In the scenario where the default embedded Derby databases are used, those will also be stored here. if you need to
reset this data, run the following command to delete this volume:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>docker volume rm entando-sample-full-entando-data</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>entando-sample-full-entando-pg-data</code> volume is where the PostgreSQL database is stored. If you are using the PostgreSQL image, you can reset the database by running
the following command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>docker volume rm entando-sample-full-entando-pg-data</pre>
</div>
</div>
<div class="paragraph">
<p>This will delete the existing database and allow the PostgreSQL image to restore the last database that was baked up before the '.war' file was built.</p>
</div>
<div class="paragraph">
<p>NB! If you switch from one of the JBoss EAP images to the Wildfly image, you would have to delete the <code>entando-docker-entando-data</code> volume entirely. This
is needed because these two images run under different user id&#8217;s.</p>
</div>
</div>
<div class="sect3">
<h4 id="_docker_host_ip_complexities"><a class="anchor" href="#_docker_host_ip_complexities"></a>5.2.15. Docker Host IP Complexities</h4>
<div class="paragraph">
<p>When integrating the Maven Docker Plugin into your existing build infrastructure, it may sometimes be challenging to figure out how to connect to the Docker server
that can perform the image build. The Maven Docker Plugin connects to the Docker host from a client process (Maven), and therefore may need to be told explicitly
where the Docker server is running. The <code>DOCKER_HOST</code> environment variable will allow you to specify the Docker server explicitly. There are a couple tips and tricks
to keep in mind in specifying the DOCKER_HOST variable:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>On most Docker distributions for Linux, it will be <code>localhost</code>. Your Linux configuration may also use a local unix socket /var/run/docker.sock</p>
</li>
<li>
<p>If you are using the Docker service in Minishift or Minikube, the DOCKER_HOST should be the IP address of the Minishit/Minikube virtual machine.</p>
</li>
<li>
<p>If you are using Docker on Windows or Apple, the DOCKER_HOST should be the IP address of the virtual machine that host the Docker server.</p>
</li>
<li>
<p>If you are running your Maven build inside a Docker container, the gateway IP address 172.17.0.1 is almost always a safe bet for the DOCKER_HOST.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>One more think to take note of is that, if you do have a <code>&lt;wait&gt;</code> element with an HTTP request url specified on your image run configuration, you need to use a correct Docker host as the
hostname segment of your URL. In fact, the same goes for any URL you use to access the exposed Docker port.</p>
</div>
</div>
<div class="sect3">
<h4 id="_verifying_and_pushing_your_images"><a class="anchor" href="#_verifying_and_pushing_your_images"></a>5.2.16. Verifying and Pushing your images</h4>
<div class="paragraph">
<p>With the Docker image build and run now forming part of the Entando App&#8217;s build process, it is fairly easy to do some automated testing against the resulting image.
You could use the Maven Failsafe plugin to initiate some integration tests after the container has started up successfully. This would allow you to performa some
verification before pushing the Image to the shared Docker registry.</p>
</div>
<div class="paragraph">
<p>The Maven Docker plugin also allows you to push the image to a shared Docker registry. It is highly recommended to use a secure registry for these purposes. You are
most likely to be pushing the image from a build server, in which case the recommended approach would be to define a <code>&lt;server&gt;</code> in the $HOME/.m2/settings.xml file. In
order for Maven to pick up the correct credentials, the <code>&lt;id&gt;</code> of the server element needs to be the same as the <code>hostname</code> segment in your Docker Image name. For example
if you have a Docker registry called <code>my.registry.com</code>, you need to specify your image as:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;image&gt;my.registry.com/somenamespace/myimage:1.0.4&lt;/image&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>and your server configuration in the settings.xml file as</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;servers&gt;
  &lt;server&gt;
    &lt;id&gt;my.registry.com&lt;/id&gt;
    &lt;username&gt;myusername&lt;/username&gt;
    &lt;password&gt;s!cr!t&lt;/password&gt;
  &lt;/server&gt;
  ....
&lt;/servers&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Once all of this is in place, you can push all images in the Maven project using a single command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn -Pdocker-eap-clustered docker:push</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="entando-on-openshift"><a class="anchor" href="#entando-on-openshift"></a>5.2.17. Entando on Openshift</h4>
<div class="paragraph">
<p>Thus far in this chapter on containers, we have demonstrated how Entando&#8217;s images can be used in a 'vanilla'
Docker deployment. We have also looked at how the Entando Docker base images can be used and extended using the
Fabric8 Maven Docker Plugin. However, none of these tools and techniques offer a viable solution for running your
Docker containers in deployment just yet. For that, you would ultimately need a more mature container orchestration and
clustering product, such as Kubernetes, Openshift or Docker Swarm. At Entando we have focused our initial efforts
primarily on supporting Openshift.</p>
</div>
<div class="paragraph">
<p>In this section, we will first get familiar with some of the core concepts in Openshift at the hand have a couple of
Entando&#8217;s pre-built images. Then we&#8217;ll explore how to build your own images from the images and templates Entando offers.
This section will conclude with a look at how to setup Jenkins pipelines for Entando in Openshift.</p>
</div>
<div class="paragraph">
<p>Before continuing with this section, it is perhaps worth noting how the two typical use cases of Entando,
<a href="#fine-grained-apps">Fine Grained Apps</a> and <a href="#coarse-grained-apps">Coarse Grained Apps</a>, feature in Entando&#8217;s Openshift offering. Openshift is
positioned primarily as a Platform As A Service offering for finer grained services. As such, it is very well
suited for the architectural approached commonly known as 'Microservices'. Although it certainly doesn&#8217;t prevent one
from deploying more coarse grained services, or even monolithic applications, it would be fair to say that this
is not its sweet spot. For this reason, Entando&#8217;s initial efforts in this space focused more on the <a href="#fine-grained-apps">Fine Grained Apps</a>
use case for Entando, as discussed earlier. We have some basic support for the <a href="#coarse-grained-apps">Coarse Grained Apps</a> use case,
and we will introduce more functionality in future to support this use case. Our initial focus was
just on the <a href="#fine-grained-app">[fine-grained-app]</a> use case as this is where Openshift&#8217;s value really comes to the fore.</p>
</div>
<div class="sect4">
<h5 id="_from_docker_compose_to_openshift"><a class="anchor" href="#_from_docker_compose_to_openshift"></a>From Docker Compose to Openshift</h5>
<div class="paragraph">
<p>In the section <a href="#demos-on-docker">Demos on Docker</a>, we used Docker Compose to install Entando&#8217;s two pre-built demos. The pre-built
images were configured using the standard 'docker-compose.yml' files. Openshift Templates fulfill a very similar
role to docker-compose.yml files, and in fact can also be developed in the YAML format. Openshift Templates are
used to configure the following objects that are used to build and deploy Docker images</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>At the heart of a typical Openshift Template would be one or more <strong>DeploymentConfig</strong> objects. We use these objects
to configure how containers are created from images, and what Openshift should do with the containers environment
variables, ports and volumes. A DeploymentConfig can be configured to create multiple containers based on a single
image, thus supporting clustering.</p>
</li>
<li>
<p>One typically configures a <strong>Service</strong> object For each signficant port exposed by the containers produced by
a DeploymentConfig. Services are essential in the Kubernetes clustering and networking model. Each Service
has a cluster IP address that can be used to access the port that the Service is mapped to, but the load balancer
decides which container will serve each request.</p>
</li>
<li>
<p><strong>Routes</strong> are used to assign externally accessible, user-friendly domain names and paths to specific services. Routes
are also used to configure HTTPS on Services that expose the HTTP protocol. One can therefore attached the necessary
certificates and keys to an HTTPS Route.</p>
</li>
<li>
<p>The <strong>BuildConfig</strong> complete the picture for those that want to host their entire pipeline in Openshift, as they allow you
to checkout source code and then perform some build operations on it with the goal of producing a new image.</p>
</li>
<li>
<p>The <strong>ImageStream</strong> is one last concept that is worth noting. It provides a level of indiretction between
DeploymentConfigs or BuildConfigs and the Docker Images that they use. It also allows Openshift to triger builds and
deployments when an ImageStream is updated. Similar to Docker Images, ImageStreams also contain tags called
ImageStreamTags that typically pin a build or deployment to a specific version of a Docker Image.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Openshift Templates can be instantiated either from the commandline, or from the web-based Openshift Console. In the
section on the <a href="#openshift-quickstart">Openshift Quick Start</a>, we did in fact instantiate such a template, and we gave instructions on
how to do so either from the commandline or from the web console. Please feel free to work through that example
again, perhaps also exploring the
<a href="https://github.com/entando/entando-ops/blob/EN-2348/Openshift/templates/entando-eap71-quickstart.yml">Template definition file</a>.
Have a look at how the different objects we discussed above feature in this template.</p>
</div>
</div>
<div class="sect4">
<h5 id="_entando_standard_openshift_template_parameters"><a class="anchor" href="#_entando_standard_openshift_template_parameters"></a>Entando Standard Openshift Template Parameters</h5>
<div class="paragraph">
<p>When instantiating an Openshift Template, you also need to provide valid values for the Parameters in a Template.
These parameter values are often passed on directly to one of the DeploymentConfigs as environment variables to the
containers it manages. You will therefore often encounter one of Entando&#8217;s standard image environment variable in the
form of an Openshift Template Parameter. There are also many Parameters in our templates that have exactly the same
function in each of the Templates they occur in. This is in line with our container design philosophy that we like
to keep things simple and consistent.</p>
</div>
<div class="ulist">
<div class="title">Parameters that map directly to Environment Variables</div>
<ul>
<li>
<p><strong>KIE_SERVER_BASE_URL</strong> - The base URL where a KIE Server instance is hosted, e.g. <a href="http://entando-kieserver701.apps.serv.run/" class="bare">http://entando-kieserver701.apps.serv.run/</a></p>
</li>
<li>
<p><strong>KIE_SERVER_USERNAME</strong> - The username of a user that be used to log into the above-mentioned KIE Server</p>
</li>
<li>
<p><strong>KIE_SERVER_PASSWORD</strong>- The password of the above-mentioned KIE Server user.</p>
</li>
<li>
<p><strong>ENTANDO_OIDC_AUTH_LOCATION</strong> - the URL of the authentication service, e.g. the 'login page' that Entando needs to redirect the user to in order to  allow the OAuth provider to authenticate the user.</p>
</li>
<li>
<p><strong>ENTANDO_OIDC_TOKEN_LOCATION</strong> - the URL of the token service where Entando can retrieve the OAuth token from after authentication</p>
</li>
<li>
<p><strong>ENTANDO_OIDC_CLIENT_ID</strong> - the Client ID that uniquely identifies the Entando App in the OAuth provider&#8217;s configuration</p>
</li>
<li>
<p><strong>ENTANDO_OIDC_REDIRECT_BASE_URL</strong> - the optional base URL, typically the protocol, host and port (<a href="https://some.host.com:8080/" class="bare">https://some.host.com:8080/</a>) that will be prepended to the path segment of the URL requested by the user and provided as a redirect URL to the OAuth provider. If empty, the requested URL will be used as is.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Standard Parameters in Entando Openshift Templates</div>
<ul>
<li>
<p><strong><a id="application_name"></a>APPLICATION_NAME</strong> - an Openshift compliant name that can be used as a prefix to automatically  generate names for related objects in the Template</p>
</li>
<li>
<p><strong><a id="image_stream_namespace"></a>IMAGE_STREAM_NAMESPACE</strong> - the name of the Openshift project that contains all the  ImageStreams required for the Template  in question. If the ImageStreams were created in the default 'openshift' project,  Openshift will automatically add it to  its application catalog. It is however possible to store them in any   project, including the project that the current Template is being instantiated in.</p>
</li>
<li>
<p><strong><a id="image_stream_tag"></a>ENTANDO_IMAGE_VERSION</strong> - the version number of the Entando images that will be used. In Docker, this will be the 'tag' segment of the Image repository reference. In Openshift, this will be the name of a Tag in the ImageStreams that will be used to bind all  S2I BuildConfigs and  DeploymentConfigs to. This generally corresponds with the version of Entando being used.</p>
</li>
<li>
<p><strong><a id="entando_engine_hostname"></a>ENTANDO_ENGINE_HOSTNAME</strong> - the fully qualified domain name of the Route that will be  created to expose the Entando Runtime Service using HTTP without SSL. This variable  is often used to connect to from the App Builder. You therefore need to make sure that it is accessible from outside the Openshift cluster.</p>
</li>
<li>
<p><strong><a id="entando_engine_secure_hostname"></a>ENTANDO_ENGINE_SECURE_HOSTNAME</strong> - the fully qualified domain name of the Route that will be  created to expose the Entando Runtime Service using SSL/HTTPS. This variable  is often used to connect to from the App Builder. You therefore need to make sure that it is accessible from outside the Openshift cluster.</p>
</li>
<li>
<p><strong><a id="domain_suffix"></a>DOMAIN_SUFFIX</strong> - the domain suffix will be appended to the various service names to form a full domain name for the Route of the  mapped to the service. This parameter is required to ensure that the AppBuider points to the externally accessible URL that serves Entando App.</p>
</li>
<li>
<p><strong><a id="entando_app_builder_hostname"></a>ENTANDO_APP_BUILDER_HOSTNAME</strong> - the fully qualified domain name of the Route that will be  created to expose the Entando App Builder JavaScript App  using HTTP without SSL.</p>
</li>
<li>
<p><strong><a id="entando_app_builder_secure_hostname"></a>ENTANDO_APP_BUILDER_SECURE_HOSTNAME</strong> - the fully qualified domain name of the Route that will be  created to expose the Entando App Builder JavaScript App using SSL/HTTPS.</p>
</li>
<li>
<p><strong><a id="entando_web_context"></a>ENTANDO_ENGINE_WEB_CONTEXT</strong> - the context root  of the Entando Web Application. This is the context  on the JEE server that will be used to dispatch requests to the Entando Web Application. Generally this would be the same as the APPLICATION_NAME. In typical JEE deployments this would be the name of the war file, excluding the '.war' extension and prefixed with a slash (/). In typical Maven projects, this would be the value of the &lt;finalName&gt; element in the pom.xml</p>
</li>
<li>
<p><strong><a id="source_repository_url"></a>SOURCE_REPOSITORY_URL</strong> - the full URL of the source repository where the source code of the image that needs to be built can be found</p>
</li>
<li>
<p><strong><a id="source_repository_ref"></a>SOURCE_REPOSITORY_REF</strong> - the branch or tag that will be checked out from the source repository specified at the SOURCE_REPOSITORY_URL</p>
</li>
<li>
<p><strong><a id="source_secret"></a>SOURCE_SECRET</strong> - the Openshift Secret containing the Username and Password for the source repository specified at the SOURCE_REPOSITORY_URL</p>
</li>
<li>
<p><strong><a id="context_dir"></a>CONTEXT_DIR</strong> - the relative directory inside the source repository from which the build should be  executed.</p>
</li>
<li>
<p><strong><a id="volume_capacity"></a>VOLUME_CAPACITY</strong> - the amount of storage space to be allocated to the Entando App. This needs to be large enough for documents and images that are uploaded, database backups that need to be made,  and the indices that Entando generates. Depending  on the exact template, this may aslo include the space required for the embedded Derby database.</p>
</li>
<li>
<p><strong><a id="memory_limit"></a>MEMORY_LIMIT</strong> - the maximum amount of memory to be allocated to the Entando JEE App.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_deploying_the_entando_pre_built_images"><a class="anchor" href="#_deploying_the_entando_pre_built_images"></a>Deploying the Entando pre-built images</h5>
<div class="paragraph">
<p>Entando&#8217;s two pre-built demos can be deployed to Openshift using a Templates built for these purposes. Refer
back to the <a href="#openshift-quickstart">Openshift Quick Start</a> on more detailed instructions on how to instantiate a Template. In this section
we will focus primarily on the Parameters of the Template in question, and how the images are configured inside the
Template' DeploymentConfigs. Remember to install the prerequisite ImageStreams in the Openshift project you have chosen
for these purposes.</p>
</div>
<div class="sect5">
<h6 id="_full_stack_template"><a class="anchor" href="#_full_stack_template"></a>Full Stack Template</h6>
<div class="paragraph">
<p>The Entando Full Stack Template installs an Entando App that contains all of the standard Entando plugins. You can
download the template from Github.</p>
</div>
<div class="ulist">
<div class="title">Template Location</div>
<ul>
<li>
<p><a href="https://raw.githubusercontent.com/entando/entando-ops/EN-2348/Openshift/templates/entando-full-stack.yml" class="bare">https://raw.githubusercontent.com/entando/entando-ops/EN-2348/Openshift/templates/entando-full-stack.yml</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Images used</div>
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/appbuilder">Entando App Builder Image (entando/appbuilder:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/entando">The Full Entando Engine API (entando/engine-api:latest)</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisite Image Streams</div>
<ul>
<li>
<p>Entando AppBuilder Image stream: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json</a></p>
</li>
<li>
<p>The Entando Full Stack Image stream: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-sample-full.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-sample-full.json</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Parameters</div>
<ul>
<li>
<p><strong><a href="#entando_app_builder_hostname">ENTANDO_APP_BUILDER_HOSTNAME</a></strong> - the fully qualified domain name of the Route that will be  created to expose the Entando App Builder JavaScript App  using HTTP without SSL.</p>
</li>
<li>
<p><strong><a href="#entando_engine_hostname">ENTANDO_ENGINE_HOSTNAME</a></strong> - the fully qualified domain name of the Route that will be  created to expose the Entando Runtime Service using HTTP without SSL. This variable  is often used to connect to from the App Builder. You therefore need to make sure that it is accessible from outside the Openshift cluster.</p>
</li>
<li>
<p><strong><a href="#image_stream_tag">ENTANDO_IMAGE_VERSION</a></strong> - the version number of the Entando images that will be used. In Docker, this will be the 'tag' segment of the Image repository reference. In Openshift, this will be the name of a Tag in the ImageStreams that will be used to bind all  S2I BuildConfigs and  DeploymentConfigs to. This generally corresponds with the version of Entando being used.</p>
</li>
<li>
<p><strong><a href="#image_stream_namespace">IMAGE_STREAM_NAMESPACE</a></strong> - the name of the Openshift project that contains all the  ImageStreams required for the Template  in question. If the ImageStreams were created in the default 'openshift' project,  Openshift will automatically add it to  its application catalog. It is however possible to store them in any   project, including the project that the current Template is being instantiated in.</p>
</li>
<li>
<p><strong><a href="#kie_server_baseurl">KIE_SERVER_BASE_URL</a></strong> - The base URL where a KIE Server instance is hosted, e.g. <a href="http://entando-kieserver701.apps.serv.run/" class="bare">http://entando-kieserver701.apps.serv.run/</a></p>
</li>
<li>
<p><strong><a href="#kie_server_username">KIE_SERVER_USERNAME</a></strong> - The username of a user that be used to log into the above-mentioned KIE Server</p>
</li>
<li>
<p><strong><a href="#kie_server_password">KIE_SERVER_PASSWORD</a></strong> - The password of the above-mentioned KIE Server user.</p>
</li>
<li>
<p><strong><a href="#volume_capacity">VOLUME_CAPACITY</a></strong> - the amount of storage space to be allocated to the Entando App. This needs to be large enough for documents and images that are uploaded, database backups that need to be made,  and the indices that Entando generates. Depending  on the exact template, this may aslo include the space required for the embedded Derby database.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Example Installation Script</div>
<p><a href="https://github.com/entando/entando-ops/blob/EN-2348/Openshift/installers/install-entando-full-stack.sh" class="bare">https://github.com/entando/entando-ops/blob/EN-2348/Openshift/installers/install-entando-full-stack.sh</a></p>
</div>
<div class="paragraph">
<div class="title">Resulting Routes.</div>
<p>You can navigate to the most significant URL&#8217;s from you browser by clicking on the URL&#8217;s of the following Routes.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Full Stack Entando app: click on the  <code>entando-full-stack-engine-http</code> Route</p>
</li>
<li>
<p>AppBuilder: click on the <code>entando-full-stack-appbuilder</code> Route</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Persistent Volume Claims</div>
<ul>
<li>
<p><strong>entando-full-stack-claim</strong> - Contains the two embedded Derby databases by default. Will also contain any uploaded
files, database backups and indices generated by Entando</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_fsi_template"><a class="anchor" href="#_fsi_template"></a>FSI Template</h6>
<div class="paragraph">
<p>The Entando team, Red Hat and our business partners have collaborated to bring you a demo that illustrates how Entando can be used as the user experience layer for your Red Hat Process Automation Manager processes. The process in question allows customers to initiate a dispute case against a specific transaction. This demo provides two Entando apps - a customer facing app and a back-office app. These apps connect to a shared KIE Server instance.  The FSI Credit Card Dispute Template installs all the pre-built images required
for you to explore the FSI Credit Card Dispute Demo.</p>
</div>
<div class="ulist">
<div class="title">Template Location</div>
<ul>
<li>
<p><a href="https://raw.githubusercontent.com/entando/entando-ops/EN-2348/Openshift/templates/fsi-ccd-demo.yml" class="bare">https://raw.githubusercontent.com/entando/entando-ops/EN-2348/Openshift/templates/fsi-ccd-demo.yml</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Images used</div>
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/appbuilder">Entando App Builder Image (entando/appbuilder:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/demos/fsi-cc-dispute-customer">Entando FSI Credit Card Dispute Customer Image (entando/fsi-cc-dispute-customer:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/demos/fsi-cc-dispute-admin">Entando FSI Credit Card Dispute Back Office Image (entando/fsi-cc-dispute-admin:latest)</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisite Image Streams</div>
<ul>
<li>
<p>Entando AppBuilder Image stream: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json</a></p>
</li>
<li>
<p>The Entando FSI Credit Card Dispute Image Streams: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-fsi-ccd-demo.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-fsi-ccd-demo.json</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Parameters</div>
<ul>
<li>
<p><strong>ADMIN_APP_BUILDER_HOSTNAME</strong> - for the Backoffice app, the fully qualified domain name of the Route that will be  created to expose the Entando App Builder JavaScript App  using HTTP without SSL.</p>
</li>
<li>
<p><strong>ADMIN_ENTANDO_ENGINE_HOSTNAME</strong> - for the Backoffice app, the fully qualified domain name of the Route that will be  created to expose the Entando Runtime Service using HTTP without SSL. This variable  is often used to connect to from the App Builder. You therefore need to make sure that it is accessible from outside the Openshift cluster.</p>
</li>
<li>
<p><strong>CUSTOMER_APP_BUILDER_HOSTNAME</strong> - for the Customer app, the fully qualified domain name of the Route that will be  created to expose the Entando App Builder JavaScript App  using HTTP without SSL.</p>
</li>
<li>
<p><strong>CUSTOMER_ENTANDO_ENGINE_HOSTNAME</strong> - for the Customer app, the fully qualified domain name of the Route that will be  created to expose the Entando Runtime Service using HTTP without SSL. This variable  is often used to connect to from the App Builder. You therefore need to make sure that it is accessible from outside the Openshift cluster.</p>
</li>
<li>
<p><strong><a href="#image_stream_tag">ENTANDO_IMAGE_VERSION</a></strong> - the version number of the Entando images that will be used. In Docker, this will be the 'tag' segment of the Image repository reference. In Openshift, this will be the name of a Tag in the ImageStreams that will be used to bind all  S2I BuildConfigs and  DeploymentConfigs to. This generally corresponds with the version of Entando being used.</p>
</li>
<li>
<p><strong><a href="#image_stream_namespace">IMAGE_STREAM_NAMESPACE</a></strong> - the name of the Openshift project that contains all the  ImageStreams required for the Template  in question. If the ImageStreams were created in the default 'openshift' project,  Openshift will automatically add it to  its application catalog. It is however possible to store them in any   project, including the project that the current Template is being instantiated in.</p>
</li>
<li>
<p><strong><a href="#kie_server_baseurl">KIE_SERVER_BASE_URL</a></strong> - The base URL where a KIE Server instance is hosted, e.g. <a href="http://entando-kieserver701.apps.serv.run/" class="bare">http://entando-kieserver701.apps.serv.run/</a></p>
</li>
<li>
<p><strong><a href="#kie_server_username">KIE_SERVER_USERNAME</a></strong> - The username of a user that be used to log into the above-mentioned KIE Server</p>
</li>
<li>
<p><strong><a href="#kie_server_password">KIE_SERVER_PASSWORD</a></strong> -The password of the above-mentioned KIE Server user.</p>
</li>
<li>
<p><strong><a href="#volume_capacity">VOLUME_CAPACITY</a></strong> - the amount of storage space to be allocated to the Entando App. This needs to be large enough for documents and images that are uploaded, database backups that need to be made,  and the indices that Entando generates. Depending  on the exact template, this may aslo include the space required for the embedded Derby database.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Example Installation Script</div>
<p><a href="https://github.com/entando/entando-ops/blob/EN-2348/Openshift/installers/install-fsi-ccd-demo.sh" class="bare">https://github.com/entando/entando-ops/blob/EN-2348/Openshift/installers/install-fsi-ccd-demo.sh</a></p>
</div>
<div class="paragraph">
<p>You can navigate to the most significant URL&#8217;s from you browser by clicking on the URL&#8217;s of the following Routes.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Entando Customer App: click on the  <code>entando-fsi-ccd-demo-ccd-customer-engine-http</code> Route</p>
</li>
<li>
<p>AppBuilder for the Customer App: click on the  <code>entando-fsi-ccd-demo-ccd-customer-appbuilder</code> Route</p>
</li>
<li>
<p>The Entando Back Office App: click on the  <code>entando-fsi-ccd-demo-ccd-admin-engine-http</code> Route</p>
</li>
<li>
<p>AppBuilder for the Back Office App: click on the  <code>entando-fsi-ccd-demo-ccd-admin-appbuilder</code> Route</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Persistent Volume Claims</div>
<ul>
<li>
<p><strong>entando-fsi-ccd-demo-ccd-customer-claim</strong> Contains the two embedded Derby databases for the Customer App</p>
</li>
<li>
<p><strong>entando-fsi-ccd-demo-ccd-admin-claim</strong> Contains the two embedded Derby databases for the Back Office App</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_building_your_own_entando_images"><a class="anchor" href="#_building_your_own_entando_images"></a>Building your own Entando images</h5>
<div class="paragraph">
<p>The first couple of Openshift examples illustrate how the end product of an Entando App can be deployed on Openshift in
the form of pre-built images. However, Openshift also allows for the images to be built on the Openshift platform itself.
In this section we will have a closer look at some of the Templates and S2I builder images that can be used to package
and deploy your Entand App Image</p>
</div>
<div class="sect5">
<h6 id="_quickstart_template"><a class="anchor" href="#_quickstart_template"></a>Quickstart Template</h6>
<div class="paragraph">
<p>We looked briefly at the Entando <a href="#openshift-quickstart">Openshift Quick Start</a> Template in an earlier section in this chapter. You can
download the template from Gitub. This section will explore the Quickstart template in a bit more detail.</p>
</div>
<div class="paragraph">
<p>Please note that this template is not intended for use in a production environment. The embedded Derby database is
not cluster safe. The <a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/s2i-images/entando-eap71-quickstart-openshift">Entando EAP 7.1 Openshift Quickstart Image (entando/entando-eap71-quickstart-openshift:latest)</a> used in this template also does not have
JGroups configured on EAP and therefore cannot support our Infinispan plugin for a cluster safe cache.</p>
</div>
<div class="paragraph">
<p>Please note that this configuration uses a child image of the official JBoss EAP commercial Docker Image. This would mean that  in order to deploy this in a production environment, you would need to purchase the necessary subscription from Red Hat first.</p>
</div>
<div class="ulist">
<div class="title">Template Location</div>
<ul>
<li>
<p><a href="https://raw.githubusercontent.com/entando/entando-ops/EN-2348/Openshift/templates/entando-eap71-quickstart.yml" class="bare">https://raw.githubusercontent.com/entando/entando-ops/EN-2348/Openshift/templates/entando-eap71-quickstart.yml</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Images used</div>
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/appbuilder">Entando App Builder Image (entando/appbuilder:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/s2i-images/entando-eap71-quickstart-openshift">Entando EAP 7.1 Openshift Quickstart Image (entando/entando-eap71-quickstart-openshift:latest)</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisite Image Streams</div>
<ul>
<li>
<p>Entando AppBuilder Image stream: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json</a></p>
</li>
<li>
<p>Entando EAP 7.1 Quickstart Openshift Image Stream: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-eap71-quickstart-openshift.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-eap71-quickstart-openshift.json</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Parameters</div>
<ul>
<li>
<p><strong>APPLICATION_NAME</strong> - an Openshift compliant name that can be used as a prefix to automatically  generate names for related objects in the Template</p>
</li>
<li>
<p><strong>ENTANDO_IMAGE_VERSION</strong> - the version number of the Entando images that will be used. In Docker, this will be the 'tag' segment of the Image repository reference. In Openshift, this will be the name of a Tag in the ImageStreams that will be used to bind all  S2I BuildConfigs and  DeploymentConfigs to. This generally corresponds with the version of Entando being used.</p>
</li>
<li>
<p><strong>ENTANDO_APP_BUILDER_HOSTNAME</strong> - the fully qualified domain name of the Route that will be  created to expose the Entando App Builder JavaScript App  using HTTP without SSL.</p>
</li>
<li>
<p><strong>ENTANDO_ENGINE_HOSTNAME</strong> - the fully qualified domain name of the Route that will be  created to expose the Entando Runtime Service using HTTP without SSL. This variable  is often used to connect to from the App Builder. You therefore need to make sure that it is accessible from outside the Openshift cluster.</p>
</li>
<li>
<p><strong>ENTANDO_ENGINE_WEB_CONTEXT</strong> - the context root  of the Entando Web Application. This is the context  on the JEE server that will be used to dispatch requests to the Entando Web Application. Generally this would be the same as the APPLICATION_NAME. In typical JEE deployments this would be the name of the war file, excluding the '.war' extension and prefixed with a slash (/). In typical Maven projects, this would be the value of the &lt;finalName&gt; element in the pom.xml</p>
</li>
<li>
<p><strong>KIE_SERVER_BASE_URL</strong> - The base URL where a KIE Server instance is hosted, e.g. <a href="http://entando-kieserver701.apps.serv.run/" class="bare">http://entando-kieserver701.apps.serv.run/</a></p>
</li>
<li>
<p><strong>KIE_SERVER_USERNAME</strong> - The username of a user that be used to log into the above-mentioned KIE Server</p>
</li>
<li>
<p><strong>KIE_SERVER_PASSWORD</strong> - The password of the above-mentioned KIE Server user.</p>
</li>
<li>
<p><strong>SOURCE_REPOSITORY_URL</strong> - the full URL of the source repository where the source code of the image that needs to be built can be found</p>
</li>
<li>
<p><strong>SOURCE_REPOSITORY_REF</strong> - the branch or tag that will be checked out from the source repository specified at the SOURCE_REPOSITORY_URL</p>
</li>
<li>
<p><strong>SOURCE_SECRET</strong> - the Openshift Secret containing the Username and Password for the source repository specified at the SOURCE_REPOSITORY_URL</p>
</li>
<li>
<p><strong>CONTEXT_DIR</strong> - the relative directory inside the source repository from which the build should be  executed.</p>
</li>
<li>
<p><strong>VOLUME_CAPACITY</strong> the amount of storage space to be allocated to the Entando App. This needs to be large enough for documents and images that are uploaded, database backups that need to be made,  and the indices that Entando generates. Depending  on the exact template, this may aslo include the space required for the embedded Derby database.</p>
</li>
<li>
<p><strong>GITHUB_WEBHOOK_SECRET</strong> - Github webhook secret that can be used from Github to trigger builds on this BuildConfig in the Openshift cluster</p>
</li>
<li>
<p><strong>GENERIC_WEBHOOK_SECRET</strong> - Generic webhook secret that can be used from any generic SCM tool to trigger builds on this BuildConfig in the Openshift cluster</p>
</li>
<li>
<p><strong>IMAGE_STREAM_NAMESPACE</strong> - the name of the Openshift project that contains all the  ImageStreams required for the Template  in question. If the ImageStreams were created in the default 'openshift' project,  Openshift will automatically add it to  its application catalog. It is however possible to store them in any   project, including the project that the current Template is being instantiated in.</p>
</li>
<li>
<p><strong>MAVEN_MIRROR_URL</strong> - Maven mirror to use for S2I builds. Specifying a Maven mirror such as Nexus, running in the same cluster can significantly speed up build execution.</p>
</li>
<li>
<p><strong>MAVEN_ARGS_APPEND</strong> - additional Maven arguments that will be appended to the standard Maven command used in the S2I build</p>
</li>
<li>
<p><strong>ARTIFACT_DIR</strong> - List of directories from which archives will be copied into the deployment folder. If unspecified, all archives in /target will be copied.</p>
</li>
<li>
<p><strong>MEMORY_LIMIT</strong> - the maximum amount of memory to be allocated to the Entando JEE App.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Example Installation Script</div>
<p><a href="https://github.com/entando/entando-ops/blob/EN-2348/Openshift/installers/install-entando-eap71-quickstart.sh" class="bare">https://github.com/entando/entando-ops/blob/EN-2348/Openshift/installers/install-entando-eap71-quickstart.sh</a></p>
</div>
<div class="paragraph">
<div class="title">Important URLS</div>
<p>The URLs you can access after the template was installed depends on the value of the relevant parameters you have provided
Use the standard admin username/password combination admin/adminadmin to log into both URLs.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Entando App: 'http://<a href="#entando_runtime_hostname_http">$ENTANDO_ENGINE_HOSTNAME</a>/<a href="#entando_web_context">$ENTANDO_ENGINE_WEB_CONTEXT</a>'</p>
</li>
<li>
<p>AppBuilder: 'http://<a href="#entando_app_builder_hostname_http">$ENTANDO_APP_BUILDER_HOSTNAME</a>/'</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Persistent Volume Claims</div>
<ul>
<li>
<p><strong>$APPLICATION_NAME-entando-claim</strong> - contains the two embedded Derby databases for the Entando App, along wth files that
will be uploaded, database backups and indices. (Replace $APPPLICATION_NAME with the value you provided for
the APPLICATION_NAME parameter)</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Usage Notes</div>
<p>After installing the Entando EAP Quickstart Template, you will find two BuildConfigurations with following generated names:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>$APPLICATION_NAME-s2i-dbrebuild</p>
</li>
<li>
<p>$APPLICATION_NAME-s2i-fast</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The primary difference is that 'DB Rebuild' BuildConfig, as it name implies, rebuilds the database from scratch, and
restores the database backup (if any) that was stored in the Maven project. If the database backup was created from Entando
running locally using <code>mvn jetty:run</code>, the database backup will be stored in the relative directory <code>src/main/webapp/protected</code>.
If this 'DB Rebuild' build detects a backup in that directory, it restores the database to that backup&#8217;s state.
Unfortunately this database rebuild adds significantly to the build execution time. If you have not modified anying
in your database state, you can perform the "Fast" build, which only builds the war file.</p>
</div>
<div class="paragraph">
<p>It is quite important to keep track of what will be happening to the Persistent Volumne when a container is started from
an Image that has been built using the 'DB Rebuild' process. On startup, the container it first checks if the database
that it contains inside the Image is newer than the database in the Persistent Volume. If so, it deletes the existing
databases from the Persistent Volume and copies the new ones across from the Image. After this, you are free to
add content to the database, but keep in mind that a 'DB Rebuild' could potentially destroy that content. It
is therefore still advisable to rather add content from an Entando instance that
was started using <code>mvn jetty:run</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_entando_jboss_eap_and_postgresql_template"><a class="anchor" href="#_entando_jboss_eap_and_postgresql_template"></a>Entando JBoss EAP and PostgreSQL Template</h6>
<div class="paragraph">
<p>For production environments that do not require a shared CMS environment, in other words, the <a href="#fine-grained-apps">Fine Grained Apps</a>
use case, we recommend the entando-eap71-postgresql95-persistent template. This Template introduces a configuration for
JBoss EAP that has the clustered caches configured for Entando&#8217;s Infinispan plugin. It also introduces a PostgreSQL 9.5
DeploymentConfig with pre-configured connectivity from the JBoss EAP DeploymentConfig to the resulting PostgreSQL
service. In addition, it also introduces a S2I BuildConfig for the PostgreSQL image that will rebuild the PostgreSQL
database based on the state of the Maven project. You can download the template from Github.</p>
</div>
<div class="paragraph">
<p>Please note that this configuration uses a child image of the official JBoss EAP commercial Docker Image. This would mean that  in order to deploy this in a production environment, you would need to purchase the necessary subscription from Red Hat first.</p>
</div>
<div class="ulist">
<div class="title">Template Location</div>
<ul>
<li>
<p><a href="https://raw.githubusercontent.com/entando/entando-ops/EN-2348/Openshift/templates/entando-eap71-with-postgresql95.yml" class="bare">https://raw.githubusercontent.com/entando/entando-ops/EN-2348/Openshift/templates/entando-eap71-with-postgresql95.yml</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Images used</div>
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/appbuilder">Entando App Builder Image (entando/appbuilder:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/s2i-images/entando-eap71-clustered-openshift">Entando EAP 7.1 Clustered Openshift Image (entando/entando-eap71-clustered-openshift:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/s2i-images/entando-postgresql95-openshift">Entando PostgreSQL 9.5 Openshift S2I Image (entando/entando-postgresql95-openshift:latest)</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisite Image Streams</div>
<ul>
<li>
<p>Entando AppBuilder Image stream: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json</a></p>
</li>
<li>
<p>Entando EAP 7.1 Clustered Openshift Image Stream: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-eap71-clustered-openshift.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-eap71-clustered-openshift.json</a></p>
</li>
<li>
<p>Entando PostgreSQL 9.5 Openshift Image Stream: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-postgresql95-openshift.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-postgresql95-openshift.json</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Parameters</div>
<ul>
<li>
<p><strong>APPLICATION_NAME</strong> - an Openshift compliant name that can be used as a prefix to automatically  generate names for related objects in the Template</p>
</li>
<li>
<p><strong>ENTANDO_IMAGE_VERSION</strong> - the version number of the Entando images that will be used. In Docker, this will be the 'tag' segment of the Image repository reference. In Openshift, this will be the name of a Tag in the ImageStreams that will be used to bind all  S2I BuildConfigs and  DeploymentConfigs to. This generally corresponds with the version of Entando being used.</p>
</li>
<li>
<p><strong>ENTANDO_APP_BUILDER_HOSTNAME</strong> - the fully qualified domain name of the Route that will be  created to expose the Entando App Builder JavaScript App  using HTTP without SSL.</p>
</li>
<li>
<p><strong>ENTANDO_ENGINE_HOSTNAME</strong> - the fully qualified domain name of the Route that will be  created to expose the Entando Runtime Service using HTTP without SSL. This variable  is often used to connect to from the App Builder. You therefore need to make sure that it is accessible from outside the Openshift cluster.</p>
</li>
<li>
<p><strong>ENTANDO_ENGINE_BASEURL</strong> - The full URL that AppBuilder must use to connect to the Entando Runtime. This parameter is required in situations where AppBuilder can connet to the Entando Runtime using either HTTP or HTTPS. AppBuilder does not work well with self-signed certificates so for test environments you may sometimes fall back on the HTTP Route. Also keep in mind that you may need to append the web context that the Entando app is served at by the JEE servlet container.</p>
</li>
<li>
<p><strong>SOURCE_REPOSITORY_URL</strong> - the full URL of the source repository where the source code of the image that needs to be built can be found</p>
</li>
<li>
<p><strong>SOURCE_REPOSITORY_REF</strong> - the branch or tag that will be checked out from the source repository specified at the SOURCE_REPOSITORY_URL</p>
</li>
<li>
<p><strong>SOURCE_SECRET</strong> - the Openshift Secret containing the Username and Password for the source repository specified at the SOURCE_REPOSITORY_URL</p>
</li>
<li>
<p><strong>CONTEXT_DIR</strong> - the relative directory inside the source repository from which the build should be  executed.</p>
</li>
<li>
<p><strong>ENTANDO_PORT_DATABASE</strong> - the name of the Entando PORT database that is created and hosted in the image</p>
</li>
<li>
<p><strong>ENTANDO_SERV_DATABASE</strong> - - the name of the Entando SERV database that is created and hosted in the image</p>
</li>
<li>
<p><strong>DB_SECRET</strong> - the Openshift secret containing the username and password to be used for the Entando user on PostgreSQL</p>
</li>
<li>
<p><strong>ENTANDO_OIDC_ACTIVE</strong> - set this variable&#8217;s value to "true" to activate Entando&#8217;s Open ID Connect and the related OAuth authentication infrastructure. If set to "false" all the subsequent OIDC  variables will be ignored. Once activated, you may need to log into Entando using the following url: &lt;application_base_url&gt;/&lt;lang_code&gt;/&lt;any_public_page_code&gt;.page?username=&lt;MY_USERNAME&gt;&amp;password=&lt;MY_PASSWORD&gt;</p>
</li>
<li>
<p><strong>ENTANDO_OIDC_AUTH_LOCATION</strong> - the URL of the authentication service, e.g. the 'login page' that Entando needs to redirect the user to in order to  allow the OAuth provider to authenticate the user.</p>
</li>
<li>
<p><strong>ENTANDO_OIDC_TOKEN_LOCATION</strong> - the URL of the token service where Entando can retrieve the OAuth token from after authentication</p>
</li>
<li>
<p><strong>ENTANDO_OIDC_CLIENT_ID</strong> - the Client ID that uniquely identifies the Entando App in the OAuth provider&#8217;s configuration</p>
</li>
<li>
<p><strong>ENTANDO_OIDC_REDIRECT_BASE_URL</strong> - the optional base URL, typically the protocol, host and port (<a href="https://some.host.com:8080/" class="bare">https://some.host.com:8080/</a>) that will be prepended to the path segment of the URL requested by the user and provided as a redirect URL to the OAuth provider. If empty, the requested URL will be used as is.</p>
</li>
<li>
<p><strong>KIE_SERVER_SECRET</strong> - the Openshift secret containing the 'username', 'password', 'url' that would provide access to a RedHat Process Automation Manager instance</p>
</li>
<li>
<p><strong>VOLUME_CAPACITY</strong> the amount of storage space to be allocated to the Entando App. This needs to be large enough for documents and images that are uploaded, database backups that need to be made,  and the indices that Entando generates. Depending  on the exact template, this may aslo include the space required for the embedded Derby database.</p>
</li>
<li>
<p><strong>HTTPS_SECRET</strong>  - the name of the secret containing the keystore file</p>
</li>
<li>
<p><strong>HTTPS_KEYSTORE</strong> - the name of the keystore file within the secret</p>
</li>
<li>
<p><strong>HTTPS_KEYSTORE_TYPE</strong> -the type of the keystore file (JKS or JCEKS)</p>
</li>
<li>
<p><strong>HTTPS_NAME</strong> -the name associated with the server certificate</p>
</li>
<li>
<p><strong>HTTPS_PASSWORD</strong> - the password for the keystore and certificate</p>
</li>
<li>
<p><strong>DB_MIN_POOL_SIZE</strong> - sets xa-pool/min-pool-size for the configured datasource.</p>
</li>
<li>
<p><strong>DB_MAX_POOL_SIZE</strong> - sets xa-pool/max-pool-size for the configured datasource.</p>
</li>
<li>
<p><strong>DB_TX_ISOLATION</strong> - sets transaction-isolation for the configured datasource.</p>
</li>
<li>
<p><strong>POSTGRESQL_MAX_CONNECTIONS</strong> - the maximum number of client connections allowed. This also sets the maximum number of prepared transactions.</p>
</li>
<li>
<p><strong>POSTGRESQL_SHARED_BUFFERS</strong> - configures how much memory is dedicated to PostgreSQL for caching data.</p>
</li>
<li>
<p><strong>GITHUB_WEBHOOK_SECRET</strong> - Github webhook secret that can be used from Github to trigger builds on this BuildConfig in the Openshift cluster</p>
</li>
<li>
<p><strong>GENERIC_WEBHOOK_SECRET</strong> - Generic webhook secret that can be used from any generic SCM tool to trigger builds on this BuildConfig in the Openshift cluster</p>
</li>
<li>
<p><strong>IMAGE_STREAM_NAMESPACE</strong> - the name of the Openshift project that contains all the  ImageStreams required for the Template  in question. If the ImageStreams were created in the default 'openshift' project,  Openshift will automatically add it to  its application catalog. It is however possible to store them in any   project, including the project that the current Template is being instantiated in.</p>
</li>
<li>
<p><strong>MAVEN_MIRROR_URL</strong> - Maven mirror to use for S2I builds. Specifying a Maven mirror such as Nexus, running in the same cluster can significantly speed up build execution.</p>
</li>
<li>
<p><strong>MAVEN_ARGS_APPEND</strong> - additional Maven arguments that will be appended to the standard Maven command used in the S2I build</p>
</li>
<li>
<p><strong>JGROUPS_ENCRYPT_SECRET</strong> - - the name of the secret containing the keystore file</p>
</li>
<li>
<p><strong>JGROUPS_ENCRYPT_KEYSTORE</strong> - - the name of the keystore file within the secret</p>
</li>
<li>
<p><strong>JGROUPS_ENCRYPT_NAME</strong> - - the name or alias of the kesytore entry containing the server certificate</p>
</li>
<li>
<p><strong>JGROUPS_ENCRYPT_PASSWORD</strong> - - the password for the keystore and certificate</p>
</li>
<li>
<p><strong>JGROUPS_PING_PROTOCOL</strong> - - JGroups protocol to use for node discovery. Can be either openshift.DNS_PING or openshift.KUBE_PING.</p>
</li>
<li>
<p><strong>JGROUPS_CLUSTER_PASSWORD</strong> --JGroups cluster password</p>
</li>
<li>
<p><strong>ARTIFACT_DIR</strong> - List of directories from which archives will be copied into the deployment folder. If unspecified, all archives in /target will be copied.</p>
</li>
<li>
<p><strong>MEMORY_LIMIT</strong> - the maximum amount of memory to be allocated to the Entando JEE App.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Example Installation Script</div>
<p><a href="https://github.com/entando/entando-ops/blob/EN-2348/Openshift/installers/install-entando-eap71-with-postgresql95.sh" class="bare">https://github.com/entando/entando-ops/blob/EN-2348/Openshift/installers/install-entando-eap71-with-postgresql95.sh</a></p>
</div>
<div class="paragraph">
<div class="title">Important URLS</div>
<p>The URLs you can access after the template was installed depends on the value of the relevant parameters you have provided
Use the standard admin username/password combination admin/adminadmin to log into both URLs.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Entando App: the value of the ENTANDO_ENGINE_BASEURL parameter</p>
</li>
<li>
<p>AppBuilder: the valule of the ENTANDO_APP_BUILDER_HOSTNAME parameter</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Persistent Volume Claims</div>
<ul>
<li>
<p><strong>$APPLICATION_NAME-entando-claim</strong> - the Persistent Volume where files  will be uploaded, database backups will be made and
 indices will be generated. (Replace $APPPLICATION_NAME with the value you provided for
the APPLICATION_NAME parameter)</p>
</li>
<li>
<p><strong>$APPLICATION_NAME-postgresql-claim</strong> - the Persistent Volume where the PostgreSQL server will store all its databases.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Usage Notes</div>
<p>After installing the Entando EAP Quickstart Template, you will find two BuildConfigurations with following generated names:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>$APPLICATION_NAME-s2i</strong> This is the standard EAP 7.1 S2I build that will generate a war file from the Maven project,
and contribute it to the resulting image at the location /opt/eap/standalone/deployments.</p>
</li>
<li>
<p><strong>$APPLICATION_NAME-postgresql-s2i</strong> This BuildConfig recreates a PostgreSQL database from the Maven project. It will
invoke all the necessary Entando plugins to ensure that the database schema reflects the current selection of Entando
plugins. If there is a database backup in the Maven project, it will restore that backup to the newly created database.
It there are any binary, 'tar' format backups, it will restore these backups. If you have been developing locally
on Entando using <code>mvn jetty:run</code>, you would need to run this build config every time you have changed the database which
you subsequently backed up.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Generating all the necessary keystores for this template can be quite a laborious task. Please work through our sample
installation script to see one approach of doing it. It is also perfectly acceptable not to use the HTTPS passthrouhg
Routes created by this Template, but instead create your own HTTPS edge Routes in Openshift.</p>
</div>
<div class="paragraph">
<p>You will notice that the default configuration of our PostgreSQL container does not support clustering (i.e.
its replciation count = 1). You are of course free to change this configuration yourself. However, keep
in mind that this Template only targets the Entando <a href="#fine-grained-apps">Fine Grained Apps</a> use case. Consider the following
before venturing into the complexity of setting up a clustered PostgreSQL server on Openshift for the fine grained
use case:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you map this Template&#8217;s PersistentVolumeClaims to a cluster safe, redundant, network file system such as Gluster,
you have addressed most of your requirements for redundant persistence.</p>
</li>
<li>
<p>Openshift&#8217;s replication controller will automatically restart this Pod if it crashes for some reason.</p>
</li>
<li>
<p>Entando itself is configured here with a clustered cache. For find grained apps, the majority of operations to
the database would be read-only and will therefore benefit signiciantly from the cache. Clustering the database
server would not add significantly to performance in this scenario.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Some shortcomings of the EAP/PostgreSQL template</div>
<ul>
<li>
<p>It doesn&#8217;t enforce a strict sequence of events that would ensure that the database is in the correct state before
the EAP Image is deployed. It is up to the DevOps professionals to ensure the database is in the correct state before
a new version of the EAP image is deployed.</p>
</li>
<li>
<p>This template runs a build on the same infrastructure as the deployment. This is not acceptable for a production
deployment. One would rather promote the images built in the CI/CD environment to production than rebuild them.
It is up to the DevOps professional to promote the correct images at the same time to production.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_entando_imagick_s2i_image"><a class="anchor" href="#_entando_imagick_s2i_image"></a>Entando Imagick S2I Image</h5>
<div class="paragraph">
<p>The Entando Imagick S2I Image is the only image that can be used safely for environments where you require a shared
CMS environment, and therefore the Entando <a href="#coarse-grained-apps">Coarse Grained Apps</a> use case. The reason for this is that it
has the Imagick image manipulation package installed on Red Hat Linux.
This package is required for uploaded images when it needs to be cropped or edited in other ways.</p>
</div>
<div class="paragraph">
<p>Please note that this configuration uses a child image of the official JBoss EAP commercial Docker Image. This would mean that  in order to deploy this in a production environment, you would need to purchase the necessary subscription from Red Hat first.</p>
</div>
<div class="paragraph">
<p>Currently you need to install this image manually, as the Template to install this image is still under development. The
image itself is also only a very basic extension of the original JBoss EAP image. Consider using it only if you are
already familiar  with the JBoss EAP image
(<a href="https://access.redhat.com/containers/?tab=overview#/registry.access.redhat.com/jboss-eap-7/eap71-openshift" class="bare">https://access.redhat.com/containers/?tab=overview#/registry.access.redhat.com/jboss-eap-7/eap71-openshift</a>). This image
is also only available on Red Hat&#8217;s container marketplace (registry.connect.redhat.com)</p>
</div>
<div class="olist arabic">
<div class="title">Prerequisites</div>
<ol class="arabic">
<li>
<p>Official Entando EAP 7.1.x Openshift Image downloaded from Red Hat container catalog (<a href="https://access.redhat.com/containers/" class="bare">https://access.redhat.com/containers/</a>)</p>
</li>
<li>
<p>An openshift cluster up and running â‰¥ 3.6.1</p>
</li>
<li>
<p>Openshift client tools (same version of the Openshift cluster)</p>
</li>
<li>
<p>An entando project â‰¥ 4.3.2-cloud-native release reachable by the openshift cluster instance (github, bitbucker or your corporate VCS server)</p>
</li>
<li>
<p>JBoss xml configuration file (<a href="https://pastebin.com/irnuyZM6">standalone-openshift.xml</a>). Take note specifically of the environment variables (${env.XYZ}) as we will be using those to configure the data sources.</p>
</li>
<li>
<p>A Postgresql server DB already configured with the entando port and serv databases</p>
</li>
<li>
<p>A good knowledge of Openshift platform and JBoss is required</p>
</li>
<li>
<p>A good knowledge of the configuration settings of the entando framework(where the configuration files are located)</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Installing Entando Imagick S2I image</div>
<ol class="arabic">
<li>
<p>Create a project in Openshift
We have to login to our Openshift instance with a user that has the permission to create a project so from the cli we are going to execute this command:</p>
<div class="literalblock">
<div class="content">
<pre>oc new-project [name of your project]</pre>
</div>
</div>
</li>
<li>
<p>Import the official Entando EAP 7.1.x image
We have to execute this command to import the official entando EAP 7.1.x image from the Red Hat container marketplace. Just remember that we will be able to import the image only if we have a valid user account from Red Hat (a simple developer account will be ok) that we are going to use to create a secret for authenticating us during the download procedure.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>So the first thing to do is to create a secret:</p>
<div class="literalblock">
<div class="content">
<pre>oc create secret docker-registry [name of your secret] --docker-username=[your redhat uid] --docker-password=[your redhat password] --docker-server=registry.connect.redhat.com --docker-email=[your email]</pre>
</div>
</div>
</li>
<li>
<p>The second one is to link the secret with the default serviceaccount for pulling the image:</p>
<div class="literalblock">
<div class="content">
<pre>oc secrets link default [yout secret name] --for=pull</pre>
</div>
</div>
</li>
<li>
<p>Now we can import the builder image on our project:</p>
<div class="literalblock">
<div class="content">
<pre>oc import-image [name of your imported image] --from=registry.connect.redhat.com/entando/entando-eap71-openshift-imagick --confirm</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Set permissions to allow pods to see each other in the cluster.
We have to to give the view permission to the system serviceaccount to let the pods see each other in the cluster:</p>
<div class="literalblock">
<div class="content">
<pre>oc policy add-role-to-user view system:serviceaccount:$(oc project -q):default -n $(oc project -q)</pre>
</div>
</div>
</li>
<li>
<p>Create a new app with the downloaded builder image. To create the entando application we have to execute this command:</p>
<div class="literalblock">
<div class="content">
<pre>oc new-app --name=[name of your application] [name of your imported image]~https://[your vcs server repository containing the entando project] \    -p PG_USERNAME=[agile] \
 -p PG_PASSWORD=[agile] \
 -p PG_ENTANDO_PORT_DB_JNDI_NAME=[JNDI for the port DB] \
 -p PG_ENTANDO_SERV_DB_JNDI_NAME=[JNDI for the serv DB] \
 -p PG_ENTANDO_PORT_DB_CONNECTION_STRING=[host:port/DB] \
 -p PG_ENTANDO_SERV_DB_CONNECTION_STRING=[host:port/DB] \
 -p OPENSHIFT_KUBE_PING_NAMESPACE=[name of the openshift project] \
 -p OPENSHIFT_KUBE_PING_LABELS=[app=[name of the entando application in Openshift]] \
 -p JGROUPS_CLUSTER_PASSWORD[random chars] \
 -p OPENSHIFT_KUBE_PING_PORT_NAME=ping \
 -p MAVEN_MIRROR_URL=[nexus url for entando maven dependencies] \
 -p JAVA_OPTS_APPEND=-Dfile.encoding=UTF-8</pre>
</div>
</div>
</li>
<li>
<p>Patch the deployment configuration.  Now that we have the entando application deployed we need to patch it to have the clustering work correctly:</p>
<div class="literalblock">
<div class="content">
<pre>oc patch dc/[your app name] -p '[{"op": "replace", "path": "/spec/template/spec/containers/0/ports/3", "value": {"name":"ping","containerPort":8888,"protocol":"TCP"}}]' --type=json</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_jenkins_pipelines"><a class="anchor" href="#_jenkins_pipelines"></a>5.2.18. Jenkins Pipelines</h4>
<div class="paragraph">
<p>Up to this point, the templates we have looked at all used Openshift&#8217;s "Source-to-image" BuildConfigs. In these
templates deployments are automatically triggered when such a BuildConfig produces a new version of an image.
This process works fairly well for most use cases, but sometimes business requires more control over exactly how
the promotion of the various deployment elements (e.g. the database state, the Docker images and the uploaded files)
is co-ordinated. For these slightly more complex use cases, Openshift offers another type of
BuildConfig: Jenkins pipelines.</p>
</div>
<div class="paragraph">
<p>Whereas S2I BuildConfigs are typically focused on producing a single image, Jenkins pipelines are typically used for more
coarse grained builds involving one or more images and the promotion of other build elements such as databases,
configuration data and other supporting data. Jenkins has an elegant Groovy based syntax to declare pipelines. It instantiates
images automatically for the build process based on the label that the pipeline specifies. Here is an example of
a simple pipeline</p>
</div>
<div class="literalblock">
<div class="content">
<pre>def templatePath = 'https://raw.githubusercontent.com/openshift/nodejs-ex/master/openshift/templates/nodejs-mongodb.json'
def templateName = 'nodejs-mongodb-example'
pipeline {
    agent {
      node {
        // spin up a node.js slave pod to run this build on
        label 'nodejs'
      }
    }
    options {
        // set a timeout of 20 minutes for this pipeline
        timeout(time: 20, unit: 'MINUTES')
    }
    stages {
        stage('preamble') {
            steps {
                script {
                    openshift.withCluster() {
                        openshift.withProject() {
                            echo "Using project: ${openshift.project()}"
                        }
                    }
                }
            }
        }
        stage('cleanup') {
            steps {
                script {
                    openshift.withCluster() {
                        openshift.withProject() {
                            // delete everything with this template label
                            openshift.selector("all", [ template : templateName ]).delete()
                            // delete any secrets with this template label
                            if (openshift.selector("secrets", templateName).exists()) {
                                openshift.selector("secrets", templateName).delete()
                            }
                        }
                    }
                } // script
            } // steps
        } // stage
    } // stages
} // pipeline</pre>
</div>
</div>
<div class="paragraph">
<p>In this particular example, the pipeline specifies that it needs a container with the label 'nodejs' to perform the various
build stages on. Once can also specificy a different agent for each stage. Stages are broken down into steps that are all
performed on the same container. In this example, steps are defined using Groovy scripts that use a Groovy based
API to perform operations on the current cluster. One can also define simple shell script steps.</p>
</div>
<div class="paragraph">
<p>Jenkins Pipelines solve a very important problem when releasing Entando Apps that would be very difficult to solve
with simple S2I builds - co-ordinating database migration with the deployment of new versions of the Entando App&#8217;s image.
Entando&#8217;s current automated database migration operations are relatively high risk, bulk database operations. While
a table is being recreated, active instances of the previous version of the Entando App could fail. Their caches
will go out of sync and the server side of the Entando App could end up in an unpredictable, potential invalid state.
For this reason, it is best to shut down all Entando App instances running against a database before migrating the
database. Such a process can be fairly easily orchestrated from a Jenkins Pipelines.</p>
</div>
<div class="paragraph">
<p>Pipelines can span over multiple Openshift clusters too. This make them particularly useful for running a pipeline that
needs to co-ordinate build tasks that span multiple clusters.</p>
</div>
<div class="paragraph">
<p>Another aspect of the Openshift Jenkins Pipeline integration that makes it worth your while is that most of the
integration is done on a Kubernetes level and therefore doesn&#8217;t require Openshift. This would be very
encouraging for those that are interested in 'vanilla' Kubernetes deployment. In future, we hope to provide similar
Jenkins Pipeline solutions for other container orchestration vendors too.</p>
</div>
<div class="paragraph">
<p>Pipelines can also make use of custom Docker images for agents, or Jenkins Slaves as they are commonly called.
We use this technique extensively in our Entando Reference pipeline. We have a Jenkins Slave image that comes
with Entando&#8217;s dependencies pre-cached, and another that can update a remote PostgreSQL server with the database
changes required for a specific Entando App. For more information about these images, have a look at their
documentation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/supporting-images/entando-maven-jenkins-slave-openshift39">Entando Maven Jenkins Slave Image for Openshift 3.9 (entando/entando-maven-jenkins-slave-openshift39:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/supporting-images/entando-postgresql-jenkins-slave-openshift39">Entando PostgreSQL Client Jenkins Slave Image for Openshift 3.9 (entando/entando-postgresql-jenkins-slave-openshift39:latest)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is important to note that our current Jenkins Pipelines and the supporting Jenkins Slave Images only cater
for the <a href="#fine-grained-apps">Fine Grained Apps</a> use case of Entando. It therefore assumes that the database needs to be
rebuilt from the Entando project every time a new instance of the app is deployed. Your existing database
will be backed up, but the new database will be based entirely on the state of the last database backup in
the your Entando App&#8217;s Maven project under src/main/webapp/protected.</p>
</div>
<div class="paragraph">
<p>There are plans to support the <a href="#coarse-grained-apps">Coarse Grained Apps</a> use case too. In fact, we started using Pipelines specifically
to find ways to support more complex database migration scenarios, and we believe that the solution for the
<a href="#coarse-grained-apps">Coarse Grained Apps</a> scenarios will be found in this space.</p>
</div>
<div class="sect4">
<h5 id="_entando_reference_pipeline"><a class="anchor" href="#_entando_reference_pipeline"></a>Entando Reference Pipeline</h5>
<div class="paragraph">
<p>Entando&#8217;s first reference Pipeline for Openshift based environments was based on Chapter 4
of the book <em>DevOps with OpenShift</em> which is available online at
<a href="https://www.oreilly.com/library/view/devops-with-openshift/9781491975954/ch04.html" class="bare">https://www.oreilly.com/library/view/devops-with-openshift/9781491975954/ch04.html</a>. The overall architecture
of this Pipeline is described quite accurately in the following diagram:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/BestPracticesPipeline.png" alt="Best Practice">
</div>
</div>
<div class="paragraph">
<p>In thise 'Best Practices' Pipeline, all the projects run in the same cluster. All the CI/CD elements reside
in a separate project depicted as the rectangle at the top of the diagram. The resulting Images are then
published to ImageStreams in the Development project, depicted as a rectangle on the left. Note that, even
though it does not preclude the use of an external Docker registry, all access to the Docker registry is mediated
by the ImageStreams in the Development project. The remaining rectangles represent the Test and Production
projects that contain similar deployment related objects to the Development project, but without the ImageStreams.</p>
</div>
<div class="paragraph">
<p>We have deviated slightly from this example pipeline. We decided to follow the more common pattern where the
Openshift cluster responsible for CI/CD and testing is separate from the production cluster. We also opted for
an external Docker registry which results in better support for build infrastructure outside of Openshift as well
as better support for multiple clusters. Lastly, we have collapsed the Development and Testing environments into
a single stage environment. We may support more complex deployment environments in future, but since Entando does
most of the high risk work for you behind the scenes, we do not the typical fine grained app to carry such
risk with it that it needs more than a single stage environment.</p>
</div>
<div class="paragraph">
<p>The overall architecture of the pipeline is as follows:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/EntandoReferencePipeline.png" alt="Entando Reference Pipeline">
</div>
</div>
<div class="paragraph">
<p>At the top, we have a project containing all the Jenkins Pipeline BuildConfigs. This project may or may not build
the Docker images, as you will see later, but it definitely contains all the Jenkins Pipeline BuildConfigs. This
is also the project from which the automatically provisioned Jenkins instance will be operating. For this reason,
we also have to install ImageStreams in this project to make each of our Entando Jenkins Slave images available.
Whoever has access to this project would be able to trigger a pipeline to either of the other two environments.
In our pipeline, this project will carry the suffix "-build" to distinguish it from other projects in
our application.</p>
</div>
<div class="paragraph">
<p>In the center of the image, we have an external registry. At Entando we use private Docker repositories running on
Docker&#8217;s cloud infrastructure. You could opt to use other registries in your organization, such as the Nexus 3
Docker registry. It is also entirely possible to use Openshift&#8217;s built-in registry, although from the perspectivce
of our BuildConfigs and DeploymentConfigs, it is still treated as an external Docker registry. This needs to be
a secure registry. Your production evironment would be reading and deploying images from othis registry.
Our deployment configs are setup to access this registry directly, rather than mediating
through ImageStreams. Our pipelines would not benefit much from ImageStreams as we would not want deployments to be
automatically triggered when an ImageStream is updated, and it would just add to the complexity of the deployment.</p>
</div>
<div class="paragraph">
<p>The project hosting the staging environment is depicted in the bottom left corner. This project only contains
the necessary DeploymentConfigs, Services and Routes to expose your application. There are no BuildConfigs in this
project. For our reference Pipeline, we decided to host both the EAP Image and the PostgreSQL image for the backing
database in this project. It wouldn&#8217;t be too difficult to configure the EAP Image to point to an external database
server, especially if you already have a clustered database server uup and running. However, for the purposes
of the <a href="#fine-grained-apps">Fine Grained Apps</a> use case it is unlikely that you would have massive scalability requirements on the
database tier, especially since the vast majority of the data is read only, not updated, and Entando also provides
you with a cluster safe cache in the form of the Infinispan plugin.</p>
</div>
<div class="paragraph">
<p>The project hosting the production environment is depicted in the bottom right corner. It is basically a mirror of the
staging project, but you do have the option of increasing your pod replica count to meet your requirements in production.
Other than that, the idea was to keep the staging and production projects as similar as possible. In fact, the
reference pipeline installation script uses the same templates for both projects.</p>
</div>
<div class="sect5">
<h6 id="_preparing_for_the_pipeline_installation"><a class="anchor" href="#_preparing_for_the_pipeline_installation"></a>Preparing for the Pipeline Installation</h6>
<div class="paragraph">
<p>Entando offers a BASH script that you can use to install the reference pipeline. The best way to run this script is
to clone or download our <code>entando-ops</code> project in Github:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>git clone git@github.com:entando/entando-ops.git</pre>
</div>
</div>
<div class="paragraph">
<p>This will download the bash script along with the other Openshift object definitions such as ImageStreams and Templates.
Once you have checked out the source code, open up a BASH console and change the present working directory to the
reference pipeline installer&#8217;s directory:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cd Openshift/installers/reference-pipeline</pre>
</div>
</div>
<div class="paragraph">
<p>In this directory, you will find a subdirectory named 'sample-config'. This directory contains a sample configuration for the pipeline.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cd sample-conf/</pre>
</div>
</div>
<div class="paragraph">
<p>The configuration is split up into three files:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ls -l</pre>
</div>
</div>
<div class="paragraph">
<p>Results:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>-rw-r--r-- 1 lulu lulu 406 Dec 13 15:09 build.conf
-rw-r--r-- 1 lulu lulu 750 Dec 13 15:12 prod.conf
-rw-r--r-- 1 lulu lulu 622 Nov  2 09:03 stage.conf</pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>build.conf</strong> file defines values for all the variables required to operate the Pipeline in both STAGE and PROD.
This includes credentials for both the STAGE and PROD cluster. You can provide the credentials for any user that
has the necessary permissions to create a new project.</p>
</div>
<div class="paragraph">
<p>The <strong>stage.conf</strong> file defines values for all the variables required to setup the STAGE environment. If you set
the variable DEPLOY_POSTGRESQL to 'true', the script will install a PostgreSQL Image in the project, and the rest
of the variable names will be used to create the databases to the required state. If you set it to 'false', you need
to make sure that the variable values correspond with your pre-configured PostgreSQL databases.</p>
</div>
<div class="paragraph">
<p>You will notice the following variables in this file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>OIDC_AUTH_LOCATION</strong> - the URL of the authentication service, e.g. the 'login page' that Entando needs to redirect the user to in order to  allow the OAuth provider to authenticate the user.</p>
</li>
<li>
<p><strong>OIDC_TOKEN_LOCATION</strong> - the URL of the token service where Entando can retrieve the OAuth token from after authentication</p>
</li>
<li>
<p><strong>OIDC_CLIENT_ID</strong> - the Client ID that uniquely identifies the Entando App in the OAuth provider&#8217;s configuration</p>
</li>
<li>
<p><strong>OIDC_REDIRECT_BASE_URL</strong> - the optional base URL, typically the protocol, host and port (<a href="https://some.host.com:8080/" class="bare">https://some.host.com:8080/</a>) that will be prepended to the path segment of the URL requested by the user and provided as a redirect URL to the OAuth provider. If empty, the requested URL will be used as is.</p>
</li>
<li>
<p><strong>KIE_SERVER_BASE_URL</strong> - The base URL where a KIE Server instance is hosted, e.g. <a href="http://entando-kieserver701.apps.serv.run/" class="bare">http://entando-kieserver701.apps.serv.run/</a></p>
</li>
<li>
<p><strong>KIE_SERVER_USERNAME</strong> - The username of a user that be used to log into the above-mentioned KIE Server</p>
</li>
<li>
<p><strong>KIE_SERVER_PASSWORD</strong> - The password of the above-mentioned KIE Server user.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <strong>prod.conf</strong> file defines values for all the variables required to setup the PROD environment. These variables
are semantically similar to those defined in the STAGE environment, but with values applicable to the PROD environment.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_installing_the_pipeline"><a class="anchor" href="#_installing_the_pipeline"></a>Installing the pipeline</h5>
<div class="paragraph">
<p>The installation script is contained in the file named <code>setup-entando-pipeline.sh</code>. This script takes a single
command as a first parameter, and then any combination of arguments to follow in the format <code>--arg-name=arg-value</code>.</p>
</div>
<div class="ulist">
<div class="title">The following commands are available</div>
<ul>
<li>
<p><strong>create</strong> - creates all three projects and sets up the necessary service account permissions across them. Also starts the Jenkins server instance in the CI/CD project</p>
</li>
<li>
<p><strong>create-stage</strong> - only creates the build project and the stage project. Also starts the Jenkins server instance in the CI/CD project</p>
</li>
<li>
<p><strong>create-prod</strong> - only creates the prod project</p>
</li>
<li>
<p><strong>delete</strong> - deletes all three projects and all of their content.. NB!! Use with care, it could delete your production deployments.</p>
</li>
<li>
<p><strong>delete-prod</strong> - deletes the production project and all of its content. NB!! Use with care, it could delete your production deployments.</p>
</li>
<li>
<p><strong>delete-stage</strong> - deletes the build and stage projects and all of their content.</p>
</li>
<li>
<p><strong>populate-prod</strong> - installs all the image streams for prod and installs the PostgreSQL and EAP templates</p>
</li>
<li>
<p><strong>populate-stage</strong>- installs all the image streams for build and stage, installs the Jenkins Pipeline BuildConfigs in the Build project and installs the PostgreSQL and EAP templates in stage</p>
</li>
<li>
<p><strong>populate</strong> - populates all image streams, templates and BuildConfigs</p>
</li>
<li>
<p><strong>clear</strong> - removes all object installed with the populate command</p>
</li>
<li>
<p><strong>clear-stage</strong>  - removes all object installed with the populate-stage command</p>
</li>
<li>
<p><strong>clear-prod</strong> - removes all object installed with the populate-prod command</p>
</li>
<li>
<p><strong>recreate-external-docker-secret</strong> - deletes the existing external docker secret and recreates it based on the variables in the build.conf file</p>
</li>
<li>
<p><strong>recreate-prod-cluster-secret</strong> - deletes the existing production cluster secret and recreates it based on the variables in the build.conf file</p>
</li>
<li>
<p><strong>recreate-source-secret</strong> - deletes the existing source secret and recreates it based on the variables in the build.conf file</p>
</li>
<li>
<p><strong>log-into-prod</strong> - establishes a session with the prod cluster using the prod credentials in the build.conf file</p>
</li>
<li>
<p><strong>log-into-stage</strong> - establishes a session with the prod cluster using the stage credentials in the build.conf file</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">The following arguments are available</div>
<ul>
<li>
<p><strong>application-name</strong> - a prefix that will be prepended to each project, and will be automatically assigned as a Kubernetes label for all objects created by this script.</p>
</li>
<li>
<p><strong>config-dir</strong> - a directory containing the build.conf, prod.conf and stage.conf files that you want to use for this script.</p>
</li>
<li>
<p><strong>image-stream-namespace</strong> - the name of the Openshift project that contains all the  ImageStreams required for the Template  in question. If the ImageStreams were created in the default 'openshift' project,  Openshift will automatically add it to  its application catalog. It is however possible to store them in any   project, including the project that the current Template is being instantiated in.</p>
</li>
<li>
<p><strong>entando-image-version</strong> - the version number of the Entando images that will be used. In Docker, this will be the 'tag' segment of the Image repository reference. In Openshift, this will be the name of a Tag in the ImageStreams that will be used to bind all  S2I BuildConfigs and  DeploymentConfigs to. This generally corresponds with the version of Entando being used.</p>
</li>
<li>
<p><strong>image-promotion-only</strong> - include this argument if you do not wish to build any images, but only promote them.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This concludes the overview of our generic Jenkins Pipeline infrastructure. At this point, you need to make a call
whether your requirements would be best addressed with a <a href="#hybrid-docker-environment">Hybrid Docker Environment</a>, or whether
a <a href="#pure-openshift-environment">Pure Openshift Environment</a> addresses your need. Our reference Pipeline script supports both.</p>
</div>
</div>
<div class="sect4">
<h5 id="_example_openshift_only_pipeline"><a class="anchor" href="#_example_openshift_only_pipeline"></a>Example Openshift Only Pipeline</h5>
<div class="paragraph">
<p>If you opt for an Openshift Only environment, your pipeline would look something like this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/OpenshiftOnlyPipeline.png" alt="Openshift Only Pipeline">
</div>
</div>
<div class="paragraph">
<p>As you can see, this Pipeline builds and pushes your Docker images to the external Docker registry. Under the
hoods, it still uses S2I BuildConfig, but the process is controlled entirely from the Jenkins Pipeline. When promoting
the resulting Image to one of the target deployment environments, this Pipeline follows the following process:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>scale the target DeploymentConfig to 0 replicas.</p>
</li>
<li>
<p>migrate the database for the target deployment to the latest</p>
</li>
<li>
<p>scale the target DeploymentConfig back up to 2 recplicas.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To install the entire pipeline, make sure that valid values have been given to all the variables in the configuration files.
Then navigate to the Openshift/installers/reference-pipeline directory.</p>
</div>
<div class="olist arabic">
<div class="title">Perform these steps</div>
<ol class="arabic">
<li>
<p>Create all projects</p>
<div class="literalblock">
<div class="content">
<pre>./setup-entando-pipeline create --application-name=entando-sample --config-dir=./sample-conf</pre>
</div>
</div>
</li>
<li>
<p>Populate all projects</p>
<div class="literalblock">
<div class="content">
<pre>./setup-entando-pipeline populate --application-name=entando-sample  --config-dir=./sample-conf</pre>
</div>
</div>
</li>
<li>
<p>Double check that there were no errors in the installation process.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Once the references Pipelines have been installed, you can now trigger one of the builds. You will notice that there are
the following seven different BuildConfigs.</p>
</div>
<div class="ulist">
<div class="title">Source to Image BuildConfigs</div>
<ul>
<li>
<p><strong>$APPLICATION_NAME-s2i-build</strong> - the BuildConfig at the heart of the EAP Image build. This build should only be triggered
by the Jenkins Pipeline. The Jenkins Pipeline prepares the input directory of this build in a very specific state which
ensures that all the correct files end up in all the correct place. It automatically pushes the resulting Image to
the external Docker registry. Please do not trigger this build manually.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Dockerfile BuildConfigs</div>
<ul>
<li>
<p><strong>$APPLICATION_NAME-tag-as-stage</strong> - this BuildConfig simply rebuilds the specified image but with a new tag - 'stage'. This
is  a tepmorary workaround for challenges we faced utilising the Docker 'tag' command from Jenkins.
 It automatically pushes the resulting tag to the external Docker registry.</p>
</li>
<li>
<p><strong>$APPLICATION_NAME-tag-as-prod</strong>  - this BuildConfig simply rebuilds the specified image but with a new tag - 'stage'. This
is  a tepmorary workaround for challenges we faced utilising the Docker 'tag' command from Jenkins.
It automatically pushes the resulting tag to the external Docker registry.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Jenkins Pipeline BuildConfigs</div>
<ul>
<li>
<p><strong>$APPLICATION_NAME-build-and-promote-to-stage-with-db-migration</strong> - this Jenkins Pipeline builds the EAP Docker image from scratch, then
it migrates the stage database, tags the image as 'stage' and deploys it to the stage environment.</p>
</li>
<li>
<p><strong>$APPLICATION_NAME-build-and-promote-to-stage-without-db-migration</strong>  - this Jenkins Pipeline builds the EAP Docker image from scratch,
tags the image as 'stage' and immediately deploys it to the stage environment.</p>
</li>
<li>
<p><strong>$APPLICATION_NAME-promote-to-production-with-db-migration</strong>  - this Jenkins Pipeline tags the 'stage' Docker image as 'prod',
migrates the production database and then deploys it to the stage environment.</p>
</li>
<li>
<p><strong>$APPLICATION_NAME-promote-to-production-without-db-migration</strong> - this Jenkins Pipeline tags the 'stage' Docker image as 'prod',
and then immediately deploys it to the stage environment.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_example_hybrid_pipeline"><a class="anchor" href="#_example_hybrid_pipeline"></a>Example Hybrid Pipeline</h5>
<div class="paragraph">
<p>If you opt for a hybrid environment, your pipeline would look something like this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/HybridPipeline.png" alt="hybrid Pipeline">
</div>
</div>
<div class="paragraph">
<p>As you can see, this Pipeline needs your existing build infrastructure to build and pushe your Docker images to the
external Docker registry. This Pipeline can then co-ordinate the promotion of the resulting Image to one of
the target deployment environments, this Pipeline still follows the following process:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>scale the target DeploymentConfig to 0 replicas.</p>
</li>
<li>
<p>migrate the database for the target deployment to the latest</p>
</li>
<li>
<p>scale the target DeploymentConfig back up to 2 recplicas.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To install the entire pipeline, make sure that valid values have been given to all the variables in the configuration files.
Then navigate to the Openshift/installers/reference-pipeline directory. Please note that each of the commands listed
below includes the argument <code>--promotion-only</code>. This instructs the installation script to bypass the installation
of any BuildConfigs or Pipeline steps that will actually build the Docker image.</p>
</div>
<div class="olist arabic">
<div class="title">Perform these steps</div>
<ol class="arabic">
<li>
<p>Create all projects</p>
<div class="literalblock">
<div class="content">
<pre>./setup-entando-pipeline create --application-name=entando-sample --config-dir=./sample-conf --promotion-only</pre>
</div>
</div>
</li>
<li>
<p>Populate all projects</p>
<div class="literalblock">
<div class="content">
<pre>./setup-entando-pipeline populate --application-name=entando-sample  --config-dir=./sample-conf  --promotion-only</pre>
</div>
</div>
</li>
<li>
<p>Double check that there were no errors in the installation process.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Once the references Pipelines have been installed, you can now trigger one of the builds. You will notice that there are
the following seven different BuildConfigs.</p>
</div>
<div class="ulist">
<div class="title">Dockerfile BuildConfigs</div>
<ul>
<li>
<p><strong>$APPLICATION_NAME-tag-as-stage</strong> - this BuildConfig simply rebuilds the specified image but with a new tag - 'stage'. This
is  a tepmorary workaround for challenges we faced utilising the Docker 'tag' command from Jenkins.
 It automatically pushes the resulting tag to the external Docker registry.</p>
</li>
<li>
<p><strong>$APPLICATION_NAME-tag-as-prod</strong>  - this BuildConfig simply rebuilds the specified image but with a new tag - 'stage'. This
is  a tepmorary workaround for challenges we faced utilising the Docker 'tag' command from Jenkins.
It automatically pushes the resulting tag to the external Docker registry.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Jenkins Pipeline BuildConfigs</div>
<ul>
<li>
<p><strong>$APPLICATION_NAME-promote-to-stage-with-db-migration</strong> - this Jenkins Pipeline migrates the stage database, tags the
'latest' image as 'stage' and deploys it to the stage environment.</p>
</li>
<li>
<p><strong>$APPLICATION_NAME-promote-to-stage-without-db-migration</strong>  - this Jenkins Pipeline tags the 'latest' image as 'stage'
and immediately deploys it to the stage environment.</p>
</li>
<li>
<p><strong>$APPLICATION_NAME-promote-to-production-with-db-migration</strong>  - this Jenkins Pipeline tags the 'stage' Docker image as 'prod',
migrates the production database and then deploys it to the stage environment.</p>
</li>
<li>
<p><strong>$APPLICATION_NAME-promote-to-production-without-db-migration</strong> - this Jenkins Pipeline tags the 'stage' Docker image as 'prod',
and then immediately deploys it to the stage environment.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As you can see, these Pipelines all assume that the specified Docker Image has already been built. If you used our
Maven archetype to generate your Entando App, it would be quite easy to introduce the necessary commands to achieve this.
Please refer back to our <a href="#maven-and-docker">Maven and Docker</a> section for more details. Generally you would do the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configure your build server&#8217;s Maven settings file, $HOME/.m2/settings.xml to have a <code>&lt;server&gt;</code> config for your
external Docker registry:</p>
<div class="literalblock">
<div class="content">
<pre>&lt;server&gt;
  &lt;id&gt;my.registry.com&lt;/id&gt;
  &lt;username&gt;myusername&lt;/username&gt;
  &lt;password&gt;s!cr!t&lt;/password&gt;
&lt;/server&gt;</pre>
</div>
</div>
</li>
<li>
<p>Make sure that your pom.xml references that registry in the name of the Image you want to build, and make sure
it tags the image as 'latest'</p>
<div class="literalblock">
<div class="content">
<pre>&lt;image&gt;
  &lt;name&gt;my.registry.com/myteam/${project.artifactId}:latest&lt;/name&gt;
  ...</pre>
</div>
</div>
</li>
<li>
<p>Build and push your image on you build server using the following command</p>
<div class="literalblock">
<div class="content">
<pre>mvn clean install -Pdocker docker:push</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cloud_deployments_on_aws_azure_and_gce"><a class="anchor" href="#_cloud_deployments_on_aws_azure_and_gce"></a>5.3. Cloud deployments on AWS, Azure and GCE</h3>
<div class="sect3">
<h4 id="cloud-deployments"><a class="anchor" href="#cloud-deployments"></a>5.3.1. Overview</h4>
<div class="paragraph">
<p>Entando currently offers a variety of Docker images that can be used in different container environments, such as
'vanilla' Docker, Openshift or Kubernetes. These images were also developed with different use cases in mind, such as
for simple demos, for getting started with your own app, for more advanced CI/CD, or for production deployments.
In this chapter we are mainly interested in showing you how to use those images in a Kubernetes environment hosted somewhere
in some datacenter of your favorite hosting cloud provider.</p>
</div>
</div>
<div class="sect3">
<h4 id="_assumptions"><a class="anchor" href="#_assumptions"></a>5.3.2. Assumptions</h4>
<div class="paragraph">
<p>We assume that you have already a kubernetes cluster up and running (also a minikube running on your local machine), that
 you know how to write a yaml file for kubernetes and that you already have your docker images
 (<a href="http://docs.entando.com/#_docker_overview" class="bare">http://docs.entando.com/#_docker_overview</a>) published on your docker registry and of course you have kubectl installed
  (<a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/">how to install kubectl</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="getting-started-k8s"><a class="anchor" href="#getting-started-k8s"></a>5.3.3. Getting started</h4>
<div class="sect4">
<h5 id="simplest-example"><a class="anchor" href="#simplest-example"></a>The Simplest example</h5>
<div class="paragraph">
<p>Let&#8217;s start with a very simple all in one docker image that contains everything needed to run an entando project:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>A java container</strong> (jetty)</p>
</li>
<li>
<p><strong>2 DBs</strong> (Derby)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is the Dockerfile that we are going to use for this example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dockerfile" data-lang="dockerfile">FROM entando/centos-base:master
USER entando

ENV PROJECT_HOME /home/entando
ENV PROJECT_NAME k8s-simplest

WORKDIR ${PROJECT_HOME}

RUN mvn archetype:generate -B -Dfilter=entando -DarchetypeGroupId=org.entando.entando -DarchetypeArtifactId=entando-archetype-webapp-generic -DgroupId=org.entando -DartifactId=${PROJECT_NAME} -Dversion=1.0-SNAPSHOT -Dpackage=test.entando

WORKDIR ${PROJECT_HOME}/${PROJECT_NAME}

CMD ["mvn", "jetty:run", "-Dorg.eclipse.jetty.annotations.maxWait=180"]

EXPOSE 8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this in place we are going to build our image and push it on our docker registry. This registry<strong> has to be reachable from our kubernetes</strong>
cluster.</p>
</div>
<div class="paragraph">
<p><code>docker build -t myregistry/k8s-simplest:test .</code></p>
</div>
<div class="paragraph">
<p><code>docker push myregistry/k8s-simplest:test</code></p>
</div>
<div class="paragraph">
<p>The next step is to create a <strong>deployment</strong> configuration file for kubernetes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml"># Deployment configuration definition for k8s-simplest
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: k8s-simplest-deploy
spec:
  selector:
    matchLabels:
      run: k8s-simplest
      app: k8s-simplest-demo
  replicas: 1
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      labels:
        run: k8s-simplest
        app: k8s-simplest-demo
    spec:
      containers:
        - name: k8s-simplest
          image: myregistry/k8s-simplest:test
          resources:
            requests:
              memory: 2048Mi
              cpu: 0.50
            limits:
              memory: 2Gi
          imagePullPolicy: Always
          ports:
            - containerPort: 8080
...
# Service definition for the k8s-simplest app
---
apiVersion: v1
kind: Service
metadata:
  name: k8s-simplest-service
  labels:
    name: k8s-simplest-service
    app:  k8s-simplest-demo
spec:
  type: LoadBalancer
  ports:
    - port: 80
      targetPort: 8080
  selector:
    run: k8s-simplest
    app: k8s-simplest-demo
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Save the content of this yaml file on your path (i.e k8s-simplest.yml) and execute:</p>
</div>
<div class="paragraph">
<p><code>kubectl create -f k8s-simplest.yml</code></p>
</div>
<div class="paragraph">
<p>This file also created a LoadBalancer to expose our entando project on port 80. That&#8217;s it.</p>
</div>
<div class="paragraph">
<p>We have just publish our first container on a kubernetes cluster.</p>
</div>
</div>
<div class="sect4">
<h5 id="n-tier-example"><a class="anchor" href="#n-tier-example"></a>An n-tier example</h5>
<div class="paragraph">
<p>Let&#8217;s continue from our k8s-simplest project. For this demo we are going to use:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Wildfly 15.0.1.Final release</p>
</li>
<li>
<p>Postgresql 9.6 release</p>
</li>
<li>
<p>Entando 5.0.3 release (our k8s-simplest project)</p>
</li>
<li>
<p>Infinispan 9.4.8.Final release</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>Please remember that the following instructions are not meant to be used on production environments but are only samples
on how to deploy entando on a kubernetes cluster.</code></p>
</div>
<div class="sect5">
<h6 id="postgresql-96-k8s"><a class="anchor" href="#postgresql-96-k8s"></a>Postgresql</h6>
<div class="paragraph">
<p>The first image that we need to deploy is the DB server. For the sake of this demonstration
we have already prepared a docker image that contains the two DBs (k8s-simplestPort, k8s-simplestServ) so the only
thing that we need now is the deployment configuration file for kubernetes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">---
apiVersion: v1
kind: Pod
metadata:
  name: postgres96-pod
  labels:
    name: postgres96-pod
    app:  k8s-demo
spec:
  containers:
    - name: postgres96
      image: entando/postgres-96:k8s-simplest
      ports:
        - containerPort: 5432
          protocol: TCP
      resources:
        requests:
          cpu: 0.50
...
# Service
---
apiVersion: v1
kind: Service
metadata:
  name: postgres96
  labels:
    name: postgres96-service
    app: k8s-demo
spec:
  ports:
    - port: 5432
      targetPort: 5432
  selector:
    name: postgres96-pod
    app:  k8s-demo
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>We have exposed the DB server on port 5432 and named it <code>postgres96-service</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="infinispan-cluster-k8s"><a class="anchor" href="#infinispan-cluster-k8s"></a>Infinispan cluster</h6>
<div class="paragraph">
<p>The second docker image that we are going to deploy on our kubernetes cluster is the infinispan&#8217;s one but to be able to
make this image works correctly first we need to set correct permissions to the service account and assign the view role
so that the jgroups subsystem is able to form a cluster.
We are going to execute the following command:</p>
</div>
<div class="paragraph">
<p><strong>Infinispan permissions</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">kubectl create rolebinding infinispan \
  --clusterrole=view \
  --user=default \
  --namespace=default \
  --group=system:serviceaccounts</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we can go on and set the deployment configuration file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
  labels:
    application: infinispan-server
  name: infinispan-server
  namespace: default
spec:
  replicas: 3
  selector:
    matchLabels:
      application: infinispan-server
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      creationTimestamp: null
      labels:
        application: infinispan-server
        deploymentConfig: infinispan-server
    spec:
      containers:
        - args:
            - cloud
            - -Djboss.default.jgroups.stack=kubernetes
          env:
            - name: KUBERNETES_LABELS
              value: application=infinispan-server
            - name: KUBERNETES_NAMESPACE
              valueFrom:
                fieldRef:
                  fieldPath: metadata.namespace
            - name: MGMT_USER
              value: "demo"
            - name: MGMT_PASS
              value: "demo"
            - name: APP_USER
              value: "demo"
            - name: APP_PASS
              value: "demo"
          image: entando/infinispan-server:k8s-simplest
          imagePullPolicy: Always
          name: infinispan-server
          ports:
            - containerPort: 8080
              protocol: TCP
            - containerPort: 8181
              protocol: TCP
            - containerPort: 8888
              protocol: TCP
            - containerPort: 9990
              protocol: TCP
            - containerPort: 11211
              protocol: TCP
            - containerPort: 11222
              protocol: TCP
            - containerPort: 11223
              protocol: TCP
          resources:
            requests:
              memory: 2Gi
              cpu: 0.50
            limits:
              memory: 4Gi
          terminationMessagePath: /dev/termination-log
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      securityContext: {}
      terminationGracePeriodSeconds: 30
...
# Internal service configuration
---
apiVersion: v1
kind: Service
metadata:
  annotations:
    description:  Hot Rod's port.
  name: infinispan-service
  labels:
    application: infinispan-server
    app: k8s-demo
spec:
  ports:
    - port: 11222
      targetPort: 11222
      name: hotrod
      protocol: TCP
    - port: 11223
      targetPort: 11223
      name: hotrod-internal
      protocol: TCP
  selector:
    deploymentConfig: infinispan-server
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The configuration file is self explanatory just have a look at the containers args that we are using (we have set the
default jgroups stack as kubernetes).</p>
</div>
<div class="paragraph">
<p>For this deployment the service (infinispan-service) exposes port 11222 and 11223 that we are going to use to populate and
retreive entries for/from the entando&#8217;s caches by the hotrod protocol.</p>
</div>
</div>
<div class="sect5">
<h6 id="wildfly-15-01-final-k8s"><a class="anchor" href="#wildfly-15-01-final-k8s"></a>Wildfly-15.0.1.Final</h6>
<div class="paragraph">
<p>Finally we need the deployment configuration file for our wildfly docker image to deploy our k8s-simplest war. As for the
infinispan docker image we need view permissions to be able to make the jgroups protocol to see other pods and form the cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">kubectl create rolebinding default-viewer \
  --clusterrole=view \
  --serviceaccount=default:default \
  --namespace=default</code></pre>
</div>
</div>
<div class="paragraph">
<p>After that we are going to create the deployment configuration file and the service definition that this time will be a
load balancer exposing the port 80 and mapping it to port 8080 of our wildfly pods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml"># Deployment configuration definition for wildfly15-01-ha
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: k8s-demo-deploy
spec:
  selector:
    matchLabels:
      run: wildfly15-01-ha
      app: k8s-demo
  replicas: 2
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      labels:
        run: wildfly15-01-ha
        app: k8s-demo
    spec:
      containers:
        - name: wildfly15-01-ha
          image: entando/wildlfy-15.0.1.final:k8s-simplest
          resources:
            requests:
              memory: 2048Mi
              cpu: 0.50
            limits:
              memory: 4Gi
          imagePullPolicy: Always
          ports:
            - containerPort: 8080
            - containerPort: 7600 #jgroups default
            - containerPort: 8888 #jgroups undertow
          env:
            - name: MY_POD_NAME
              valueFrom:
                fieldRef:
                  fieldPath: metadata.name
            - name: MY_POD_NAMESPACE
              valueFrom:
                fieldRef:
                  fieldPath: metadata.namespace
            - name: MY_POD_IP
              valueFrom:
                fieldRef:
                  fieldPath: status.podIP
            - name: PG_ENTANDO_PORT_DB_JNDI_NAME
              value: "java:jboss/datasources/k8s-simplestPortDataSource"
            - name: PG_ENTANDO_SERV_DB_JNDI_NAME
              value: "java:jboss/datasources/k8s-simplestServDataSource"
            - name: PG_ENTANDO_PORT_DB_CONNECTION_STRING
              value: "postgres96:5432/k8s-simplestPort"
            - name: PG_ENTANDO_SERV_DB_CONNECTION_STRING
              value: "postgres96:5432/k8s-simplestServ"
            - name: PG_USERNAME
              value: "agile"
            - name: PG_PASSWORD
              value: "agile"
            - name: INITIAL_POOL_SIZE
              value: "5"
            - name: MAX_POOL_SIZE
              value: "10"
...
# Service definition for the wildfly15-01-ha
---
apiVersion: v1
kind: Service
metadata:
  name: wildfly15-01-ha-service
  labels:
    name: wildfly15-01-ha-service
    app:  k8s-demo
spec:
  type: LoadBalancer
  ports:
    - port: 80
      targetPort: 8080
  selector:
    run: wildfly15-01-ha
    app: k8s-demo
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>We have passed as ENV vars to this deployment configuration the JNDI name, the DB&#8217;s connection string tha is linked to our
internal service name (postgres96). All the othe options are self explanatory.</p>
</div>
</div>
<div class="sect5">
<h6 id="entando-project-configuration-k8s"><a class="anchor" href="#entando-project-configuration-k8s"></a>Entanto project configuration</h6>
<div class="paragraph">
<p>To be able to use the remote infinispan server cluster we have modified the entando project to use the hotrod protocol for
all the tasks related to caching and to make the overall deployment more scalabale and
container (Java container) indipendent.</p>
</div>
<div class="paragraph">
<p>To see how the entando project has been modified to work with the datagrid implementation take a loook at the code on
github (<a href="https://github.com/entando/k8s-simplest/tree/kubernetes">kubernetes branch</a>)</p>
</div>
<div class="paragraph">
<p>Here is the client hotrod configuration file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">infinispan.client.hotrod.server_list=infinispan-service:11222
infinispan.client.hotrod.marshaller=org.infinispan.commons.marshall.jboss.GenericJBossMarshaller
infinispan.client.hotrod.async_executor_factory=org.infinispan.client.hotrod.impl.async.DefaultAsyncExecutorFactory
infinispan.client.hotrod.request_balancing_strategy=org.infinispan.client.hotrod.impl.transport.tcp.RoundRobinBalancingStrategy
infinispan.client.hotrod.tcp_no_delay=true
-infinispan.client.hotrod.key_size_estimate=128
infinispan.client.hotrod.value_size_estimate=1024
infinispan.client.hotrod.force_return_values=false
infinispan.client.hotrod.client_intelligence=HASH_DISTRIBUTION_AWARE
infinispan.client.hotrod.batch_Size=10000

# authentication
infinispan.client.hotrod.use_auth=true
infinispan.client.hotrod.sasl_mechanism=DIGEST-MD5
infinispan.client.hotrod.auth_username=demo
infinispan.client.hotrod.auth_password=demo
infinispan.client.hotrod.auth_realm=ApplicationRealm
infinispan.client.hotrod.auth_server_name=infinispan-service

## near cache
infinispan.client.hotrod.near_cache.mode=INVALIDATED
infinispan.client.hotrod.near_cache.max_entries=-1
infinispan.client.hotrod.near_cache.name_pattern=Entando_*

## below is connection pooling config
infinispan.client.hotrod.connection_pool.max_active=-1
infinispan.client.hotrod.connection_pool.exhausted_action=CREATE_NEW
infinispan.client.hotrod.connection_pool.min_evictable_idle_time=1800000
infinispan.client.hotrod.connection_pool.min_idle=1</code></pre>
</div>
</div>
<div class="paragraph">
<p>To deploy the project on kubernetes just follow this order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Deploy the DB server (<strong>kubectl create -f postgres96.yml</strong>)</p>
</li>
<li>
<p>Assign correct permissions to default user for infinispan and wildfly cluster</p>
</li>
<li>
<p>Deploy the infinispan cluster (<strong>kubectl create -f infinispan.yml</strong>)</p>
</li>
<li>
<p>Deploy the wildfly cluster (<strong>kubectl create -f wildfly.yml</strong>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Known Issues</strong></p>
</div>
<div class="paragraph">
<p>At this point this demo will not work correctly due to a missing jar required on wildfly. This will be patched in a new
Entando release.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_developers_guide"><a class="anchor" href="#_developers_guide"></a>5.4. DEVELOPERS' GUIDE</h3>
<div class="sect3">
<h4 id="firstdevelopers"><a class="anchor" href="#firstdevelopers"></a>5.4.1. INITIAL SETUP</h4>
<div class="paragraph">
<p>Entando manages projects with Maven; we also use Ant to automate several tasks.</p>
</div>
</div>
<div class="sect3">
<h4 id="_configuring_ant"><a class="anchor" href="#_configuring_ant"></a>5.4.2. CONFIGURING ANT</h4>
<div class="paragraph">
<p>To configure Ant, open the file <em>buildProperties.xml</em> in the root of the project. The root of an Entando project is the directory where the <em>pom.xml</em> file resides.</p>
</div>
<div class="paragraph">
<p>By default, the <em>buildProperties.xml</em> file includes the properties for PostGresSQL and MySQL. To configure Ant, you must edit the values that pertain to your target DBMS. You can ignore any unused properties.</p>
</div>
<div class="ulist">
<div class="title">Values you must configure:</div>
<ul>
<li>
<p>Database address, username, and password</p>
</li>
<li>
<p>Database executable path</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;property name="postgres.hostname" value="localhost" /&gt;
&lt;property name="postgres.port" value="5432" /&gt;
&lt;property name="postgres.username" value="agile" /&gt;
&lt;property name="postgres.password" value="agile" /&gt;

&lt;property name="mysql.hostname" value="localhost" /&gt;
&lt;property name="mysql.port" value="3306" /&gt;
&lt;property name="mysql.username" value="agile" /&gt;
&lt;property name="mysql.password" value="agile" /&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Once configured, you need to declare the path of the target DBMS executables in either the PostgreSQL or MySQL section. The following properties are grouped by operating system, so be sure to configure properties under the correction OS and then comment out the remaining operating systems.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;!-- Properties definitions for *nix machines START --&gt;
&lt;property name="tomcat.home.path" value="/opt/tomcat6" /&gt;
&lt;property name="postgres.bin.path" location="/Library/PostgreSQL/9.5/bin/" /&gt;
&lt;property name="postgres.bin.dump" value="pg_dump" /&gt;
&lt;property name="postgres.bin.psql" value="psql" /&gt;
&lt;property name="postgres.bin.restore" value="pg_restore" /&gt;
&lt;property name="postgres.bin.drop" value="dropdb" /&gt;
&lt;property name="postgres.bin.create" value="createdb" /&gt;
&lt;property name="mysql.bin.path" location="/usr/bin" /&gt;
&lt;property name="mysql.bin.dump" value="mysqldump" /&gt;
&lt;property name="mysql.bin.restore" value="mysql" /&gt;
&lt;property name="mysql.bin.create" value="mysql" /&gt;
&lt;property name="mysql.bin.drop" value="mysql" /&gt;
&lt;property name="ant-contrib.jar.path" location="/usr/bin/java/ant-contrib.jar" /&gt;
&lt;!-- Properties definitions for *nix machines END --&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>The only properties to adjust are those regarding the path of the executables, e.g., <em>postgres.bin.path</em> or <em>mysql.bin.path</em>.</p>
</div>
<div class="sect4">
<h5 id="_additional_settings_for_windows"><a class="anchor" href="#_additional_settings_for_windows"></a>ADDITIONAL SETTINGS FOR WINDOWS</h5>
<div class="paragraph">
<p>If you are a Windows user, you must also modify the file <em>buildTasks.xml</em>, otherwise Maven will not start correctly and will throw a â€œfile not foundâ€ error.</p>
</div>
</div>
<div class="sect4">
<h5 id="_windows_10"><a class="anchor" href="#_windows_10"></a>WINDOWS 10</h5>
<div class="paragraph">
<p>Find and edit all seven instances of executable=â€mvnâ€ in the <em>buildTasks.xml</em> file. Entando 5 contains seven total instances.</p>
</div>
<div class="paragraph">
<p><strong>Change from:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>executable="mvn"</pre>
</div>
</div>
<div class="paragraph">
<p><strong>to:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>executable="mvn.cmd"</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_other_windows_versions"><a class="anchor" href="#_other_windows_versions"></a>OTHER WINDOWS VERSIONS</h5>
<div class="paragraph">
<p>Find and edit all seven instances of executable=â€mvnâ€ in the <em>buildTasks.xml</em> file. Entando 5 contains seven total instances.</p>
</div>
<div class="paragraph">
<p><strong>Change from:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>executable="mvn"</pre>
</div>
</div>
<div class="paragraph">
<p>to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>executable="mvn.bat"</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ant_tasks"><a class="anchor" href="#_ant_tasks"></a>ANT TASKS</h5>
<div class="paragraph">
<p>After you have correctly declared the executable paths in <em>buildProperties.xml</em>, you can begin executing Ant tasks to perform management operations.</p>
</div>
<div class="paragraph">
<p>These tasks include the creation of the WAR file and database management.</p>
</div>
<div class="paragraph">
<p>To retrieve the list of available tasks, run the following command from the terminal window or command prompt:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ant -p</pre>
</div>
</div>
<div class="paragraph">
<p>The result shows all running tasks, similar to the following:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/firstdev_runningTasks.png" alt="639" width="439">
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Remember that the tasks aimed at database management will only impact the relevant projectâ€™s database. For example, in a project named <em>entandodemo</em>, the task <em>PG-db-drop</em> will only drop the <em>entandodemoPort</em> and <em>entandodemoServ</em> databases. Similarly, creating a dump will involve the same databases.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p><strong>Tasks for PostgreSQL:</strong></p>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Before using the PostgreSQL related tasks, you need to create the following directory in your project ./src/main/db/backup/tar. This directory is only necessary for using a PostGresSQL database.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>PG-db-create:</strong> creates the databases for the current project<br>
This item wonâ€™t appear in the list</p>
</li>
<li>
<p><strong>PG-db-drop:</strong> drops the default databases of the project<br>
This item wonâ€™t appear in the list</p>
</li>
<li>
<p><strong>PG-db-backup-tar:</strong> dumps and compresses the databases, placing the file in ./src/main/db/backup/tar<br>
Remember that you must create the 'tar' directory beforehand</p>
</li>
<li>
<p><strong>PG-db-full-update-tar:</strong> restores the dump created with the previous command<br>
The process drops databases before the restore takes place</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Tasks for MySQL:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>MySQL-db-backup:</strong> dumps the project databases<br>
NOTE: the dump will be placed in the src/db/mysql</p>
</li>
<li>
<p><strong>MySQL-db-create:</strong> creates the project databases</p>
</li>
<li>
<p><strong>MySQL-db-drop:</strong> drops default project databases</p>
</li>
<li>
<p><strong>MySQL-db-full-update:</strong> runs a database update<br>
NOTE: the dump must be present in src/db/mysql</p>
</li>
<li>
<p><strong>MySQL-db-restore:</strong> drops existing tables, then restores the dump<br>
NOTE: the dump must be present in src/db/mysql</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>General tasks:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>WAR-build:</strong> creates the WAR of the project for Apache Tomcat</p>
</li>
<li>
<p><strong>WAR-build-jboss:</strong> creates the WAR of the project for JBoss / Wildfly</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_troubleshooting"><a class="anchor" href="#_troubleshooting"></a>5.4.3. TROUBLESHOOTING</h4>
<div class="paragraph">
<p>Most setup errors result from an improper configuration in either <em>buildProperties.xml</em> or, for Windows users, <em>buildTasks.xml</em>.</p>
</div>
<div class="ulist">
<div class="title">To resolve an issue, ensure that each of the following is correct:</div>
<ul>
<li>
<p>The path of DBMS binaries <em>postgres.bin.path</em> or <em>mysql.bin.path</em></p>
</li>
<li>
<p>Username and password for accessing the database. By default, both the username and password are â€œagileâ€</p>
</li>
<li>
<p>The URL of the database. The default is â€localhostâ€</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_filter_management"><a class="anchor" href="#_filter_management"></a>5.4.4. FILTER MANAGEMENT</h4>
<div class="paragraph">
<p>Filters contain key:value pairs that Entando uses in templates to generate essential files such as <em>context.xml</em> and <em>web.xml</em>. Each filter generates slightly different xml depending on the target environment, developer, or production environment.</p>
</div>
<div class="paragraph">
<p>The contents of the filters are very similar with the main difference being the name. Different commands select different filters for use. Development filters are identical; production filters differ by one property. Filter contents are essentially identical in all the other respects.</p>
</div>
<div class="paragraph">
<p>Entando comes with the Jetty plugin and Derby as servlet container and database, respectively. As such, you do not need to edit any filter to run a newly created Entando project. Filters are only modified by developers when developing a project, such as one using a database other than Derby.</p>
</div>
<div class="sect4">
<h5 id="_development_filters"><a class="anchor" href="#_development_filters"></a>DEVELOPMENT FILTERS</h5>
<div class="paragraph">
<p>Development filters operate during the development phase of the project; each operating system has its own version of the filter.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Unix:</strong> filter-development-unix.properties</p>
</li>
<li>
<p><strong>Windows:</strong> filter-development-windows.properties</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The command <code>mvn clean jetty:run</code> selects the appropriate filter to generate the context or web XML files.</p>
</div>
</div>
<div class="sect4">
<h5 id="_production_filters"><a class="anchor" href="#_production_filters"></a>PRODUCTION FILTERS</h5>
<div class="paragraph">
<p>DevOps teams usually prepare the production filters and contain the values intended for the target production (staging) environment.</p>
</div>
<div class="paragraph">
<p>Production filters co-exist with development filters with no overlap between them.</p>
</div>
<div class="ulist">
<div class="title">There are two production filters:</div>
<ul>
<li>
<p><strong>Tomcat:</strong> filter-production.properties</p>
</li>
<li>
<p><strong>JBoss or Wildfly:</strong> filter-production-jboss.properties</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The command <code>ant WAR-build</code>, for Tomcat application servers, uses the filter-production.properties filter. Templates that generate the <em>context.xml</em> and <em>web.xml</em> files are in the directory ./src/main/config.</p>
</div>
<div class="paragraph">
<p>The command <code>ant WAR-build-jboss</code> uses the filter-production-jboss.properties filter. The template that generates the <em>web.xml</em> is in the directory ./src/main/config/jboss.</p>
</div>
</div>
<div class="sect4">
<h5 id="_filter_setup"><a class="anchor" href="#_filter_setup"></a>FILTER SETUP</h5>
<div class="paragraph">
<p>Filters are highly customizable. The following paragraphs list adjustments to the basic properties for getting started. Each of the values in this section are from the <em>filter-development-{operating system}.properties</em> file.</p>
</div>
</div>
<div class="sect4">
<h5 id="_network_setup"><a class="anchor" href="#_network_setup"></a>NETWORK SETUP</h5>
<div class="paragraph">
<p>Make changes to your network. The properties below come with predefined values for development and production filters. Change them as-needed to fit your target environment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>profile.application.baseurl.hostname
profile.application.baseurl.port
profile.application.baseurl.port.separator</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_servlet_container_setup_tomcat"><a class="anchor" href="#_servlet_container_setup_tomcat"></a>SERVLET CONTAINER SETUP - TOMCAT</h5>
<div class="paragraph">
<p>This is valid for the <em>filter-development-unix</em>, <em>filter-development-windows</em> and <em>filter-production</em>.</p>
</div>
<div class="paragraph">
<p>Edit the <em>profile.tomcat.home</em> property to reflect the path of Tomcatâ€™s installation directory.</p>
</div>
</div>
<div class="sect4">
<h5 id="_application_server_setup_jbosswildfly"><a class="anchor" href="#_application_server_setup_jbosswildfly"></a>APPLICATION SERVER SETUP - JBOSS/WILDFLY</h5>
<div class="paragraph">
<p>Edit the <em>profile.jboss.home</em> property to reflect the path JBoss or Wildfly installation directory.</p>
</div>
</div>
<div class="sect4">
<h5 id="_database_setup"><a class="anchor" href="#_database_setup"></a>DATABASE SETUP</h5>
<div class="paragraph">
<p>Each filter comes with sets of declarations for common databases. By default, all sets are commented out except for Derby.</p>
</div>
<div class="paragraph">
<p>To enable Entando to connect a different database, you must uncomment the appropriate database set and then comment out the Derby set. In addition, edit the following properties to fit your destination environment:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>profile.database.hostname=localhost
profile.database.port=1527
profile.database.username=agile
profile.database.password=agile</pre>
</div>
</div>
<div class="paragraph">
<p>Entando supports most common RDBMSes out-of-the-box. If your target database does not appear in the list (e.g., Oracle), your developers must create the properties in the filters.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configuring_swagger_optional_2"><a class="anchor" href="#_configuring_swagger_optional_2"></a>5.4.5. CONFIGURING SWAGGER (OPTIONAL)</h4>
<div class="paragraph">
<p>When generating an application, Entando automatically includes an instance of Swagger, a tool that lets you describe the structure of your APIs to make them easier for other machines to read. Configuring Swagger for use only takes a few steps.</p>
</div>
<div class="sect4">
<h5 id="_enabling_swagger_in_a_development_environment_2"><a class="anchor" href="#_enabling_swagger_in_a_development_environment_2"></a>ENABLING SWAGGER IN A DEVELOPMENT ENVIRONMENT</h5>
<div class="paragraph">
<p>To enable swagger in your development environment, you need to run your application with an enabled Swagger profile. There are two options. Run ONE of the following from the  root of your generated project&#8217;s directory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Start the container with a JVM parameter using the following command:<br>
<code>mvn clean jetty:run -Dspring.profiles.active=swagger</code></p>
</li>
<li>
<p>Add an environment variable by using the following commands:<br>
<code>export spring_profiles_active=swagger</code><br>
<code>mvn clean jetty:run</code></p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">To access the Swagger interface:</div>
<ol class="arabic">
<li>
<p>In a browser, navigate to your applicationâ€™s URL (e.g., <a href="http://localhost:8080/appname" class="bare">http://localhost:8080/appname</a>).</p>
</li>
<li>
<p>Append the URL with api/swagger-ui.html. Again, for example, <a href="http://localhost:8080/appname/api/swagger-ui.html" class="bare">http://localhost:8080/appname/api/swagger-ui.html</a></p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>For security purposes, you should only run this with the default credentials in a development environment. If enabling swagger in production for integration purposes be sure to change the clientId and secret.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_authentication_details_2"><a class="anchor" href="#_authentication_details_2"></a>AUTHENTICATION DETAILS</h5>
<div class="paragraph">
<p><strong>Default login details:</strong><br>
<strong>Username:</strong> admin<br>
<strong>Password:</strong> adminadmin</p>
</div>
<div class="paragraph">
<p><strong>Default Swagger OAuth details:</strong><br>
<strong>Type:</strong> Request Body<br>
<strong>clientId:</strong> swagger<br>
<strong>Secret:</strong> = swaggerswagger</p>
</div>
</div>
<div class="sect4">
<h5 id="_how_does_the_integration_work_2"><a class="anchor" href="#_how_does_the_integration_work_2"></a>HOW DOES THE INTEGRATION WORK?</h5>
<div class="paragraph">
<p>The Swagger integration is based on three components and is activated by a Spring profile. The components are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>SwaggerConfig</strong> - responsible for configuring most of the Swagger UI behavior (or the library Springfox that provides Swagger UI functionality). It configures which paths to scan, where to find the oAuth endpoints, and other essentials</p>
</li>
<li>
<p><strong>SwaggerMvcAdapter</strong> - makes the Swagger UI&#8217;s human-friendly HTML page and its resources available for the application</p>
</li>
<li>
<p><strong>SwaggerInitializer</strong> - assists the Swagger UI with talking to your new application. Swagger UI needs to talk to the application backend, which require oAuth authentication to communicate back to the Swagger UI. The backend uses standard oAuth authentication, requiring an oAuth client_id and secret, and also that any requested redirect matches a specific URL. SwaggerInitializer is also responsible for adding the oAuth consumer details for Swagger in the database. If Swagger is enabled when the application starts, SwaggerInitializer will check for an existing configuration for a Swagger consumer in the database and adds one if necessary</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <em>swagger</em> Spring profile is active, Spring will initialize and wire all three components during application startup. If inactive, Entando ignores the components.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_building_a_rest_api"><a class="anchor" href="#_building_a_rest_api"></a>5.4.6. BUILDING A REST API</h4>
<div class="paragraph">
<p>To extend the Entando REST API interfaces you can create new REST controllers in your application and utilize the existing Entando configuration for Swagger and security.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create your REST controller(s) in your application in a package of your choice</p>
</li>
<li>
<p>Create a Spring context file that scans the package where your controllers were created</p>
</li>
<li>
<p>Add the spring context file created in step 2 to a location scanned by the web.xml in your app. We recommend creating the context in <code>src/main/resouces/spring/aps/api</code> but any scanned package will work</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Ensure that the base-package path in the context-scan contains your controllers</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>An example context file to scan the package <code>com.my.app</code> for controllers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:context="http://www.springframework.org/schema/context"
xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"&gt;

	&lt;context:component-scan base-package="com.my.app" /&gt;

&lt;/beans&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once configured the endpoints will be enabled by Spring and the endpoint documentation will be available in Swagger if enabled. See <a href="#_configuring_swagger_optional">Configuring Swagger</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_oauth_2_0_on_entando"><a class="anchor" href="#_oauth_2_0_on_entando"></a>5.4.7. OAUTH 2.0 ON ENTANDO</h4>
<div class="paragraph">
<p>Entando uses the <a href="https://tools.ietf.org/html/rfc6749">OAuth 2.0 authorization framework</a> to determine the methods for granting client applications access tokens to authenticate a request to an API endpoint. Access tokens allow API providers to authenticate their systemâ€™s users.</p>
</div>
</div>
<div class="sect3">
<h4 id="_creating_an_api_consumer"><a class="anchor" href="#_creating_an_api_consumer"></a>5.4.8. CREATING AN API CONSUMER</h4>
<div class="paragraph">
<p>From the Entando dashboard, select Integrations &gt; API Management &gt; Consumers. This opens the Consumers screen with a search utility and a table of existing API Keys.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/oauth_consumers.png" alt="oauth consumers" width="50%">
</div>
</div>
<div class="olist arabic">
<div class="title">To create a new access token:</div>
<ol class="arabic">
<li>
<p>Click <strong>Add</strong>.</p>
</li>
<li>
<p>Provide values for each of the fields. Different grant types require values for different parameters.</p>
<div class="imageblock">
<div class="content">
<img src="images/oauth_paramters.png" alt="oauth paramters" width="50%">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Key</p>
</li>
<li>
<p>Secret</p>
</li>
<li>
<p>Name</p>
</li>
<li>
<p>Description</p>
</li>
<li>
<p>Callback URL - URL to open after the user successfully authenticates</p>
</li>
<li>
<p>Scope - Defines the level of access that this token grants</p>
</li>
<li>
<p>Expiration date</p>
</li>
</ul>
</div>
</li>
<li>
<p>Toggle all the grant types that your application will accept:</p>
<div class="ulist">
<ul>
<li>
<p>Authentication code: used by web and mobile apps and requires the app to launch a browser to begin the flow. Generally, the flow follows these steps:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The application opens a browser and connects the user with the OAuth server</p>
</li>
<li>
<p>The OAuth server prompts the user with an authorization and the user approves the appâ€™s request</p>
</li>
<li>
<p>The user is returned to the application with an authorization code in the query string where the application exchanges it for an access token.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Password: only involves a single step: the application prompts the user to enter a standard username and password into a login form to collect the userâ€™s credentials. The app then makes a POST request to the server to exchange the password for an access token.</p>
</li>
<li>
<p>Client credentials: suitable for machine-to-machine authentication to obtain an access token outside the context of a user. This is generally for clients that need information about themselves rather than about a user.</p>
</li>
<li>
<p>Refresh token: a token used to generate additional access tokens. This allows your application to deploy short-lived access tokens without having to collect credentials when one expires. The app requests this token along with the access and/or ID tokens as part of the userâ€™s initial authentication.</p>
</li>
<li>
<p>Implicit: represents a way for a single-page JavaScript app to get an access token without an intermediate code exchange step. Implicit grant types are most often used by public clients.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>Save</strong> to create the access token.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_imagemagick_setup"><a class="anchor" href="#_imagemagick_setup"></a>5.4.9. IMAGEMAGICK SETUP</h4>
<div class="paragraph">
<p>When you upload an image to Entando through the CMS plugin, it is automatically cropped into different formats to produce thumbnails ready to be used when presenting contents.</p>
</div>
<div class="paragraph">
<p>Entando uses a third party application called ImageMagick which is available for both Linux and Windows.</p>
</div>
<div class="paragraph">
<p>To crop the images properly, Entando requires that the ImageMagick library be present in the system. You can override this setting using steps for the relevant OS below.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Generally, only Windows systems require setup. You only need to set up a Linux system if you need to switch off thumbnail generation.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_linuxmac_setup"><a class="anchor" href="#_linuxmac_setup"></a>LINUX/MAC SETUP</h5>
<div class="paragraph">
<p>Open the file systemParams.properties in the directory ./src/main/config of the Entando project.</p>
</div>
<div class="sect5">
<h6 id="_toggling_thumbnail_creation_on_and_off"><a class="anchor" href="#_toggling_thumbnail_creation_on_and_off"></a>TOGGLING THUMBNAIL CREATION ON AND OFF</h6>
<div class="paragraph">
<p>Adjust the <em>imagemagick.enabled</em> property to either True or False.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># set this parameter to true if imagemagick is installed on the system and you need to use it
imagemagick.enabled=true</pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_windows_setup"><a class="anchor" href="#_windows_setup"></a>WINDOWS SETUP</h5>
<div class="paragraph">
<p>Configure the following properties to reflect the installation directory of ImageMagick on Windows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>imagemagick.windows=true
imagemagick.path=C:\\Program Files\\ImageMagick-6.6.3-Q16</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The CMS plugin will throw a 500 error if you upload an image with an improperly configured ImageMagick setup.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_creating_a_plugin_back_end"><a class="anchor" href="#_creating_a_plugin_back_end"></a>5.4.10. CREATING A PLUGIN - BACK END</h4>
<div class="sect4">
<h5 id="_introduction_5"><a class="anchor" href="#_introduction_5"></a>INTRODUCTION</h5>
<div class="paragraph">
<p>This section introduces how to create a plugin for Entando 5.x and how to integrate it with the App Builder. The following paragraphs explain how to create the back end of the plugin. <a href="#plugincyclesample_front-end">Click here</a> for steps on creating the front end of the plugin to integrate with the App Builder.</p>
</div>
</div>
<div class="sect4">
<h5 id="plugincyclesample_back-end"><a class="anchor" href="#plugincyclesample_back-end"></a>INITIALIZE THE ENVIRONMENT</h5>
<div class="paragraph">
<p>The first step is to create a root directory for your application.</p>
</div>
<div class="paragraph">
<p>Once you have a root directory, download and install the necessary projects from the <a href="https://github.com/entando/">Entando github repository</a> into your projectâ€™s root folder. There are three required projects: entando-core, entando-components, and entando-archetypes. Complete the following steps three times: once for each of the necessary projects.</p>
</div>
<div class="olist arabic">
<div class="title">Complete the following steps IN ORDER:</div>
<ol class="arabic">
<li>
<p>From your root directory, clone the project through the shell command:<br>
<code>git clone <a href="https://github.com/entando/entando-&lt;PROJECT_SUFFIX&gt;.git" class="bare">https://github.com/entando/entando-&lt;PROJECT_SUFFIX&gt;.git</a></code></p>
</li>
<li>
<p>Navigate to the newly created folder.</p>
</li>
<li>
<p>Open the <em>pom.xml</em> file and note the current project version. You will need this version number later. Example:<br>
<code>&lt;version&gt;5.1.0-SNAPSHOT&lt;/version&gt;</code></p>
</li>
<li>
<p>Run the following command:<br>
<code>mvn clean install -DskipTests</code></p>
</li>
<li>
<p>Return to your root directory and re-run the steps for the next Entando project.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_create_an_entando_project"><a class="anchor" href="#_create_an_entando_project"></a>CREATE AN ENTANDO PROJECT</h5>
<div class="paragraph">
<p>The following sections are for creating a new Entando project. If you already have the project set up, skip to the Add the Plugin to the Entando Project section.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the command line from your workspace folder.</p>
</li>
<li>
<p>Run the command:<br>
<code>mvn archetype:generate -Dfilter=entando</code></p>
</li>
<li>
<p>On the project type selection screen, choose the number corresponding to "org.entando.entando:entando-archetype-entando-sample".</p>
</li>
<li>
<p>Select the version that corresponds to the version number you noted in the Initialize the Environment section.</p>
<div class="ulist">
<ul>
<li>
<p>If that option is not available, take the following steps:<br></p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Navigate to your computerâ€™s home directory and open the folder titled <em>.m2</em>.</p>
</li>
<li>
<p>Copy the file named <em>archetype-catalog.xml</em> and paste it into your Entando project folder.</p>
</li>
<li>
<p>Restart the steps in this section.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>For "groupId" enter <code>org.entando</code> (or the groupId of your company) and press <strong>ENTER</strong>.</p>
</li>
<li>
<p>For "artifactId", enter the name of the project and press <strong>ENTER</strong>.</p>
</li>
<li>
<p>For "version" leave the selection blank and press <strong>ENTER</strong>.</p>
</li>
<li>
<p>For "package" leave the selection blank and press <strong>ENTER</strong></p>
</li>
<li>
<p>In the configuration confirmation interface, type <code>Y</code> and press <strong>ENTER</strong>. You have now created your Entando project.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_create_a_custom_component_project"><a class="anchor" href="#_create_a_custom_component_project"></a>CREATE A CUSTOM COMPONENT PROJECT</h5>
<div class="paragraph">
<p>Now, create an empty component project that reflects the entando-component structure present on GitHub. The project will serve as a container for the plugin that you are creating here.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clone and rename the project entando-components from <a href="https://github.com/entando/entando-components" class="bare">https://github.com/entando/entando-components</a>. Example of shell command:<br>
<code>git clone <a href="https://github.com/entando/entando-components.git" class="bare">https://github.com/entando/entando-components.git</a> [new-project-name]</code></p>
</li>
<li>
<p>Open the plugins folder and delete all folders except the <em>src</em> folder.</p>
</li>
<li>
<p>Open <em>plugins/pom.xml</em> and delete all module instances within the &lt;modules&gt; element.</p>
<div class="imageblock">
<div class="content">
<img src="images/pcbe_modules.png" alt="pcbe modules">
</div>
</div>
</li>
<li>
<p>Open the the <em>ui-bundles</em> folder and delete all the subfolders.</p>
<div class="imageblock">
<div class="content">
<img src="images/pcbe_uibundles.png" alt="pcbe uibundles">
</div>
</div>
</li>
<li>
<p>Open <em>ui-bundles/pom.xml</em> and delete all module instances within the &lt;modules&gt; element.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_create_a_prototype_plugin_called_phonebook"><a class="anchor" href="#_create_a_prototype_plugin_called_phonebook"></a>CREATE A PROTOTYPE PLUGIN CALLED "PHONEBOOK"</h5>
<div class="paragraph">
<p>This step creates the basic structure of the plugin, on which all the resources generated by EDO will subsequently be inserted.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the <em>entando-components/plugins</em> folder on your command line.</p>
</li>
<li>
<p>Run the command:<br>
<code>mvn archetype:generate -Dfilter=entando</code></p>
</li>
<li>
<p>In the project type selection screen, choose the number corresponding to "org.entando.entando: entando-archetype-plugin-generic".</p>
</li>
<li>
<p>Select the version number you noted in Initialize the Environment, Step 3.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If that option is not available, take the following steps:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Navigate to your computerâ€™s home directory and open the folder titled <em>.m2</em>.</p>
</li>
<li>
<p>Copy the file named <em>archetype-catalog.xml</em> and paste it into the <em>Repository</em> folder.</p>
</li>
<li>
<p>Restart the steps in this section.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>For "groupId" enter "org.entando.entando.plugins".</p>
</li>
<li>
<p>For "artifactId" enter "entando-plugin-jpphonebook" and press <strong>ENTER</strong>.</p>
</li>
<li>
<p>For "version" leave the selection blank and press <strong>ENTER</strong>.</p>
</li>
<li>
<p>For "package" leave the selection blank and press <strong>ENTER</strong>.</p>
</li>
<li>
<p>For the configuration confirmation interface, type 'N' and press <strong>ENTER</strong>.<br></p>
</li>
</ol>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The â€˜Nâ€™ response is necessary to enter the part of the workflow that allows you to input new parameters for pluginCode (pre-set to "jpchangeme") and pluginName (pre-set to "Please Change Me")
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="10">
<li>
<p>Repeat steps 5 through 8.</p>
</li>
<li>
<p>For "pluginCode" enter "jpphonebook" and press <strong>ENTER</strong>.</p>
</li>
<li>
<p>For "pluginName" enter "Phone Book Plugin - Full Lifecycle Sample" and press <strong>ENTER</strong>.</p>
</li>
<li>
<p>In the configuration confirmation interface, press <strong>ENTER</strong>. This creates the plugin skeleton in a new folder called <em>entando-components/plugins/entando-plugin-jpphonebook</em>.</p>
<div class="imageblock">
<div class="content">
<img src="images/pcbe_jpphonebook.png" alt="pcbe jpphonebook">
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_create_plugin_with_edo_component_generator"><a class="anchor" href="#_create_plugin_with_edo_component_generator"></a>CREATE PLUGIN WITH EDO (COMPONENT GENERATOR)</h5>
<div class="paragraph">
<p>EDO is the official code generator tool for Entando.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Follow the instructions at <a href="https://github.com/entando/component-generator" class="bare">https://github.com/entando/component-generator</a> to build the necessary EDO jar.</p>
</li>
<li>
<p>Clone the project to the root of your own workspace:<br>
<code>git clone <a href="https://github.com/entando/component-generator.git" class="bare">https://github.com/entando/component-generator.git</a></code></p>
</li>
<li>
<p>Open the new <em>component-generator</em> folder and run the following command from the command line:<br>
<code>ant build</code></p>
</li>
<li>
<p>Open the <em>target</em> folder and copy <em>edo-5.x.x-SNAPSHOT.jar</em> into the <em>entando-components-sample/plugins/entando-plugin-jpphonebook</em> that you created in Step 13 of the Create a Prototype Plugin Called â€œPhonebook" section.</p>
</li>
<li>
<p>Define the structure of the object that the plugin will manage. For example, the plugin has to manage the "Contact" object consisting of the follow fields:</p>
<div class="ulist">
<ul>
<li>
<p>"firstname" - type "String" - required - max length 50 characters</p>
</li>
<li>
<p>"surname" - type "String" - required - max length 50 characters</p>
</li>
<li>
<p>"birthDate" - type "Date" - not required</p>
</li>
<li>
<p>"description" - type "String" - not required</p>
</li>
<li>
<p>"phoneNumber" - type "String" - required</p>
</li>
<li>
<p>"priority" - type "Integer" - not required</p>
</li>
</ul>
</div>
</li>
<li>
<p>Save the following JSON string as a new file called <em>edo-full_lifecycle_sample.json</em>. This is the first step in creating a JSON file that EDO requires to create the resources.<br></p>
</li>
</ol>
</div>
<div class="literalblock">
<div class="content">
<pre>{
    "packageName" : "org.entando.entando.plugins.jpphonebook",
    "model" : {
    "name" : "Contact",
    "fields" : [ {
      "name" : "firstname",
      "type" : "string",
      "required" : true,
      "length" : 50,
      "primaryKey" : false
    }, {
      "name" : "surname",
      "type" : "string",
      "required" : true,
      "length" : 50,
      "primaryKey" : false
    }, {
      "name" : "bornDate",
      "type" : "date",
      "required" : false,
      "length" : null,
      "primaryKey" : false
    }, {
      "name" : "description",
      "type" : "string",
      "required" : false,
      "length" : null,
      "primaryKey" : false
    }, {
      "name" : "phoneNumber",
      "type" : "string",
      "required" : true,
      "length" : null,
      "primaryKey" : false
    }, {
      "name" : "priority",
      "type" : "int",
      "required" : false,
      "length" : null,
      "primaryKey" : false
    } ]
  },
  "assets" : {
    "rest" : true,
    "cxf" : true,
    "specialWidget" : true,
    "internalServlet" : true,
    "adminConsole" : true,
    "adminConsoleProducer" : null
  }
}</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Open the <em>entando-components-sample/plugins/entando-plugin-jpphonebook</em> folder from the command line and run the following command:<br>
<code>java -jar edo-5.1.0-SNAPSHOT.jar -f edo-full_lifecycle_sample.json</code></p>
</li>
<li>
<p>Address duplicate file warnings from the console by removing the empty files created by the archetype and replacing them with those created by EDO.</p>
<div class="ulist">
<ul>
<li>
<p>component.xml file</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Delete the file <em>src/main/resources/component/plugins/jpphonebook/component.xml</em></p>
</li>
<li>
<p>Rename the file <em>src/main/resources/component/plugins/jpphonebook/change_me-component.xml</em> to <em>src/main/resources/component/plugins/jpphonebook/component.xml</em></p>
</li>
<li>
<p>Open the <em>component.xml</em> file and rename the content of element "description" to <em>Phone Book Plugin - Full Lifecycle Sample</em></p>
</li>
<li>
<p>Fix the default resources (sql script) associated with the component descriptor (component.xml file) of the plugin <em>entando-plugin-jpphonebook</em></p>
</li>
</ol>
</div>
</li>
<li>
<p>Open the folder <em>src/main/resources/sql/plugins/jpphonebook/</em></p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Delete files the following files:</p>
<div class="ulist">
<ul>
<li>
<p><em>port_data_production.sql</em></p>
</li>
<li>
<p><em>serv_data_production.sql</em></p>
</li>
<li>
<p><em>port_uninstallation.sql</em></p>
</li>
<li>
<p><em>serv_uninstallation.sql</em></p>
</li>
</ul>
</div>
</li>
<li>
<p>Rename the following files:</p>
<div class="ulist">
<ul>
<li>
<p><em>change_me-port_data_production.sql</em> to <em>port_data_production.sql</em></p>
</li>
<li>
<p><em>change_me-serv_data_production.sql</em> to <em>serv_data_production.sql</em></p>
</li>
</ul>
</div>
</li>
<li>
<p>Adjust the default test resources (sql script) associated with the component descriptor (component.xml file) of the plugin <em>entando-plugin-jpphonebook</em>.</p>
<div class="ulist">
<ul>
<li>
<p>Open the folder <em>src/test/resources/sql/plugins/jpphonebook</em></p>
</li>
<li>
<p>Delete files <em>port_data_test.sql</em> and <em>serv_data_test.sql</em></p>
</li>
<li>
<p>Rename the following files:</p>
<div class="ulist">
<ul>
<li>
<p><em>change_me-port_data_test.sql</em> to <em>port_data_test.sql</em></p>
</li>
<li>
<p><em>change_me-serv_data_test.sql</em> to <em>serv_data_test.sql</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Adjust the definition of Struts2 actions associated with the component of the plugin <em>entando-plugin-jpphonebook</em>.</p>
<div class="ulist">
<ul>
<li>
<p>Open the folder <em>src/main/resources</em></p>
</li>
<li>
<p>Delete file <em>entando-struts-plugin.xml</em>.</p>
</li>
<li>
<p>Rename <em>change_me-jpphonebook-contact-struts-plugin.xml</em> to <em>entando-struts-plugin.xml</em>
Upon completion, the plugin is ready for you to install and insert into an Entando project.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
For best performance, the plugin version <strong>must</strong> match the version of the Entando project you add it to.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_install_the_new_plugin_component"><a class="anchor" href="#_install_the_new_plugin_component"></a>INSTALL THE NEW PLUGIN COMPONENT</h5>
<div class="paragraph">
<p>From the command line, open the <em>entando-components-sample</em> folder and run the following command:<br>
<code>mvn clean install -DskipTests</code></p>
</div>
<div class="paragraph">
<p>At the end of the process you should see the following message, indicating a successful install:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pcbe_successfulinstall.png" alt="pcbe successfulinstall">
</div>
</div>
</div>
<div class="sect4">
<h5 id="_add_the_plugin_to_an_entando_project"><a class="anchor" href="#_add_the_plugin_to_an_entando_project"></a>ADD THE PLUGIN TO AN ENTANDO PROJECT</h5>
<div class="paragraph">
<p>Open the pom.xml file of your project and insert the following snippet to the end inside the element:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;dependency&gt;
    &lt;groupId&gt;org.entando.entando.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;entando-plugin-jpphonebook&lt;/artifactId&gt;
    &lt;version&gt;${entando.version}&lt;/version&gt;
    &lt;type&gt;war&lt;/type&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_app_builder_component"><a class="anchor" href="#_app_builder_component"></a>APP BUILDER COMPONENT</h5>
<div class="paragraph">
<p>The App Builder provides a user interface for managing the admin functions of the plugin. Therefore, the MApp Engine needs to expose services for the functions that plugins require. In the case of the Phonebook plugin, the MApp Engine must expose:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>APIs for CRUD operations on the Contact object. These APIs are available at the following endpoints:</p>
<div class="ulist">
<ul>
<li>
<p>GET List of contacts - URI "&lt;APPLICATION_BASE_URL&gt;/api/jpphonebook/contacts" (GET)</p>
</li>
<li>
<p>get single contact - URI "&lt;APPLICATION_BASE_URL&gt;/api/jpphonebook/contacts/{contactId}" (GET)</p>
</li>
<li>
<p>add single contact - URI "&lt;APPLICATION_BASE_URL&gt;/api/jpphonebook/contacts" (POST)</p>
</li>
<li>
<p>update single contact - URI "&lt;APPLICATION_BASE_URL&gt;/api/jpphonebook/contacts/{contactId}" (PUT)</p>
</li>
<li>
<p>delete single contact - URI "&lt;APPLICATION_BASE_URL&gt;/api/jpphonebook/contacts/{contactId}" (DELETE)</p>
</li>
</ul>
</div>
</li>
<li>
<p>The API for configuring the <em>Publish Contact</em> widget, which is the only EDO-generated widget that needs configuration. EDO provides the APIs that you need to create this UI but you must first custom develop and add a component for the validation. The validator is a bean class that extends the <em>WidgetConfigurationValidator</em> class.</p>
<div class="paragraph">
<p>In the case of the Phonebook plugin, the following is the <em>ContactPublisherWidgetValidator</em> class to include in the <em>org.entando.entando.plugins.jpphonebook.aps.system.services.contact.widgettype.validators package</em>:</p>
</div>
</li>
</ul>
</div>
<div class="literalblock">
<div class="content">
<pre>package
org.entando.entando.plugins.jpphonebook.aps.system.services.contact.widgettype.validators;

import com.agiletec.aps.system.exception.ApsSystemException;
import com.agiletec.aps.system.services.page.IPage;
import java.util.Map;
import org.apache.commons.lang3.StringUtils;
import org.entando.entando.aps.system.exception.RestServerError;
import org.entando.entando.aps.system.services.widgettype.validators.WidgetConfigurationValidator;
import org.entando.entando.plugins.jpphonebook.aps.system.services.contact.IContactManager;
import org.entando.entando.web.page.model.WidgetConfigurationRequest;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.validation.BeanPropertyBindingResult;

public class ContactPublisherWidgetValidator implements WidgetConfigurationValidator {

    private final Logger logger = LoggerFactory.getLogger(this.getClass());

    public static final String WIDGET_CODE = "jpphonebookContact";
    public static final String WIDGET_CONFIG_KEY_CONTACT_ID = "id";

    public static final String ERRCODE_CONTACT_ID_NULL = "1";
    public static final String ERRCODE_CONTACT_ID_INVALID = "2";

    private IContactManager contactManager;

    @Override
    public boolean supports(String widgetCode) {
        return WIDGET_CODE.equals(widgetCode);
    }

    @Override
    public BeanPropertyBindingResult validate(WidgetConfigurationRequest widget, IPage page) {
        BeanPropertyBindingResult bindingResult = new BeanPropertyBindingResult(widget, widget.getClass().getSimpleName());
        Map&lt;String, Object&gt; properties = (Map&lt;String, Object&gt;) widget.getConfig();
        String contactIdString = (null != properties) ? properties.get(WIDGET_CONFIG_KEY_CONTACT_ID).toString() : null;
        try {
            logger.debug("validating widget {} for page {}", widget.getCode(), page.getCode());
            if (StringUtils.isBlank(contactIdString)) {
                bindingResult.reject(ERRCODE_CONTACT_ID_NULL, new String[]{}, "Contact id is required");
                return bindingResult;
            }
            Integer contactId = Integer.parseInt(contactIdString);
            if (null == this.getContactManager().getContact(contactId)) {
                bindingResult.reject(ERRCODE_CONTACT_ID_INVALID, new String[]{"Contact", contactIdString}, "NOT_FOUND");
                return bindingResult;
            }
        } catch (NumberFormatException e) {
            bindingResult.reject(ERRCODE_CONTACT_ID_INVALID, new String[]{}, "Contact id is required");
        } catch (ApsSystemException e) {
            logger.error("error in validate wiget {} in page {}", widget.getCode(), page.getCode());
            throw new RestServerError("error in widget config validation", e);
        }
        return bindingResult;
    }

    protected IContactManager getContactManager() {
        return contactManager;
    }

    public void setContactManager(IContactManager contactManager) {
        this.contactManager = contactManager;
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>Insert the following bean definition into the file <em>full-lifecycle-sample/entando-components-sample/plugins/entando-plugin-jpphonebook/src/main/resources/spring/plugins/jpphonebook/aps/managers/jpphonebookContactManagersConfig.xml</em>
<code>&lt;bean id="jpphonebookContactPublisherWidgetValidator" class="org.entando.entando.plugins.jpphonebook.aps.system.services.contact.widgettype.validators.ContactPublisherWidgetValidator"&gt;
&lt;property name="contactManager" ref="jpphonebookContactManager" /&gt;
&lt;/bean&gt;</code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="plugincyclesample_front-end"><a class="anchor" href="#plugincyclesample_front-end"></a>5.4.11. CREATING A PLUGIN - FRONT END</h4>
<div class="sect4">
<h5 id="_prerequisites_11"><a class="anchor" href="#_prerequisites_11"></a>PREREQUISITES</h5>
<div class="paragraph">
<p>Prior to beginning this tutorial, you must perform the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Install the <a href="#_creating_a_plugin_back_end">Plugin Cycle back end</a></p>
</li>
<li>
<p>Install node<br>
NOTE: Entando recommends using nvm to install and manage your node versions.</p>
</li>
<li>
<p>Install npm<br>
NOTE: you should use the latest LTS when working with Entando.</p>
</li>
<li>
<p>(OPTIONAL) Install <a href="https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd?hl=en">redux-devtools</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_installing_the_app_builder"><a class="anchor" href="#_installing_the_app_builder"></a>INSTALLING THE APP BUILDER</h5>
<div class="paragraph">
<p>Clone the App Builder project (<a href="https://github.com/entando/app-builder" class="bare">https://github.com/entando/app-builder</a>) to your local machine. Be sure to install the version that matches the MApp Engine version you have installed.</p>
</div>
<div class="paragraph">
<p>Once you have cloned the project, run <code>npm install</code> to install all your dependencies.</p>
</div>
<div class="sect5">
<h6 id="_configuring_your_env_file"><a class="anchor" href="#_configuring_your_env_file"></a>CONFIGURING YOUR .ENV FILE</h6>
<div class="paragraph">
<p>With the App Builder installed, navigate to the App Builderâ€™s root directory and create a file called <em>.env.development.local</em>. This file points the App Builder installation to the MApp Engine that you previously created.</p>
</div>
<div class="paragraph">
<p>If you are using the project sample that comes with this repo, the content of your .env file will be the following:<br>
<code>USE_MOCKS=false
DOMAIN=http://localhost:8080/project-sample</code></p>
</div>
<div class="paragraph">
<p>Save the file, then, while still in the root of the App Builder, run <code>npm start</code> to start the application server.</p>
</div>
</div>
<div class="sect5">
<h6 id="_checking_your_env_file_configuration"><a class="anchor" href="#_checking_your_env_file_configuration"></a>CHECKING YOUR .ENV FILE CONFIGURATION</h6>
<div class="paragraph">
<p>In the browser, you can use the redux devtools to see whether or not the state has  updated with the correct values. In Google Chrome, right-click and inspect or open the redux devtools directly.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/PCFE_rdevtools.png" alt="PCFE rdevtools">
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_adding_the_plugin_to_the_basic_app_builder_integration"><a class="anchor" href="#_adding_the_plugin_to_the_basic_app_builder_integration"></a>ADDING THE PLUGIN TO THE BASIC APP BUILDER INTEGRATION</h5>
<div class="paragraph">
<p>To integrate the plugin with the App Builder, you need to add to it the App Builder scaffolding. Create a subdirectory within your plugin directory named <em>app-builder</em>. Clone the ui-component-sample project (<a href="https://github.com/entando/ui-component-sample" class="bare">https://github.com/entando/ui-component-sample</a>) and copy the content into the
<em>plugin directory/app-builder</em> folder.</p>
</div>
<div class="paragraph">
<p>The resulting directory tree will be similar to:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/PCFE_directory.png" alt="PCFE directory">
</div>
</div>
<div class="olist arabic">
<div class="title">Then edit the <em>package.json</em> file:</div>
<ol class="arabic">
<li>
<p>Replace the application name with the plugin name.</p>
</li>
<li>
<p>Rename the directory inside public/plugin-assets to match the name of the plugin.</p>
</li>
<li>
<p>Run <code>npm install</code></p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_add_the_plugin_to_the_app_builder"><a class="anchor" href="#_add_the_plugin_to_the_app_builder"></a>ADD THE PLUGIN TO THE APP BUILDER</h5>
<div class="paragraph">
<p>In the App Builder directory, edit the <em>entando-plugins-config/plugins.json</em> file to add the new plugin.</p>
</div>
<div class="ulist">
<div class="title">You can build the array in one of two ways:</div>
<ul>
<li>
<p>It can contain only the name of the plugin provided the path to the App Builder directory matches the default, e.g.:<br>
<em>../entando-components/plugins/${pluginItem}/app-builder</em></p>
</li>
<li>
<p>Or you can specify it in an object, e.g.:<br></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>[
  {
    "name": "entando-plugin-jpphonebook",
    "path": "../entando-plugin-cycle-sample/entando-components-sample/plugins/entando-plugin-jpphonebook/app-builder"
  }
]</pre>
</div>
</div>
<div class="paragraph">
<p>Once finished, run the command <code>npm run import-plugins</code> to add the plugin to the App Builder.</p>
</div>
<div class="paragraph">
<p>You can now launch the App Builder and see the "Sample Plugin" label in the integration menu.</p>
</div>
</div>
<div class="sect4">
<h5 id="_customize_the_plugin"><a class="anchor" href="#_customize_the_plugin"></a>CUSTOMIZE THE PLUGIN</h5>
<div class="paragraph">
<p>The remainder of this tutorial deals with customizing the pages of the plugin within the App Builder. You can leave the App Builder instance running, but several steps require you to re-run the <code>npm run import-plugins</code> command to propagate new changes.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
All paths in the remainder of this document are relative to the pluginâ€™s App Builder directory.
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="_change_the_labels"><a class="anchor" href="#_change_the_labels"></a>CHANGE THE LABELS</h6>
<div class="paragraph">
<p>To change the labels applied to the project, open the <em>src/locales/en.js</em> file and apply the correct plugin name to the <em>menu.itemLabel</em>. This defines the name of the plugin in the Integrations menu.</p>
</div>
<div class="paragraph">
<p>You must also make the same changes to the fileâ€™s Italian language counterpart, <em>src/locales/it/js</em>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_set_up_a_router"><a class="anchor" href="#_set_up_a_router"></a>SET UP A ROUTER</h6>
<div class="paragraph">
<p>Set up a router for your new plugin by creating the action and selectors in the main state. The action changes the route, while the selector will be used to get the new route.</p>
</div>
<div class="paragraph">
<p>Once done, follow the existing structure to create the default router inside the new <em>src/ui/phone-book directory</em> and point to it in <em>src/index.js</em> as the uiComponent.</p>
</div>
</div>
<div class="sect5">
<h6 id="_install_any_necessary_components"><a class="anchor" href="#_install_any_necessary_components"></a>INSTALL ANY NECESSARY COMPONENTS</h6>
<div class="paragraph">
<p>If your plugin requires forms, validators, APIs, or patternfly, you can install them all with the following command:<br>
<code>npm i @entando/utils redux-form patternfly-react @entando/apimanager</code></p>
</div>
<div class="paragraph">
<p>===p BUILD YOUR FORMS TO HANDLE THE PLUGINâ€™S DATA
.Create the APIs, the state actions, and the forms following the samples in the following directories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>src/state/*</p>
</li>
<li>
<p>src/api/*</p>
</li>
<li>
<p>src/ui/phone-book/*</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_apply_widget_configuration_forms"><a class="anchor" href="#_apply_widget_configuration_forms"></a>APPLY WIDGET CONFIGURATION FORMS</h5>
<div class="paragraph">
<p>If any of your widgets require a configuration form, you must return the correct components for each widget in the <em>index.js</em> of the plugin. Each widget code in the widgetForms key must use the value from the React component that renders the form.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">const plugin = {
  id,
  menuItemLabelId: 'menu.itemLabel',
  uiComponent,
  reducer,
  locales: [
    enLocale,
    itLocale,
  ],
  // workaround to use apimanager (the plugins compilation has to be pulled out from webpack)
  apiManagerConfig: config,
  widgetForms: {
    jpphonebookContact: ContactSelectContainer,
  },
};</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>If your form does not need special props or actions</strong>, you can return the form component itself and the App Builder will wrap it in a container.</p>
</div>
<div class="paragraph">
<p><strong>If you do need to retrieve specific data such as in the phone book example</strong>, you need to return a container and make sure that you are cascading down the existing props that the container inside App Builder is passing through.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Your <code>onSubmit</code> function calls the parent <em>onSubmit</em> especially if you need to perform additional mapping before passing the data through.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See the <em>src/ui/widgets/*</em> for fuller context of these concepts.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_working_with_entando_widgets"><a class="anchor" href="#_working_with_entando_widgets"></a>5.5. WORKING WITH ENTANDO WIDGETS</h3>
<div id="widgets" class="paragraph">
<p>Widgets are how Entando interacts with users through the front end of a web application. CMS contents, input forms, and sign-in fields are examples of widgets. In short, everything in the front end of the webapp happens through widgets.</p>
</div>
<div class="paragraph">
<p><strong>Widgets have several defining characteristics:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>They do not contain business logic. The only logic present in a widget is relative to the presentation. The data a widget always comes from lower layers, either through a REST API or using a standard, custom tag.</p>
</li>
<li>
<p>They do not communicate. This is an Entando decision against using Portlets to make widgets leaner, more exportable, and easily modifiable. However, technologies are available on both the client and server sides to pass data between widgets, depending on the scenario.</p>
</li>
<li>
<p>They are technology agnostic, which is another Entando choice. We believe that developers must be free to create widgets using the technology they already know or are most proficient with.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_widget_catalog"><a class="anchor" href="#_widget_catalog"></a>5.5.1. WIDGET CATALOG</h4>
<div class="paragraph">
<p>Every widget has a single entry in the widgetcatalog table of the <em>*Port</em> database. Beginning with Entando 5, the widget table has the following schema:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Structure of the widgetcatalog table</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Column name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">code</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">character varying(40) NOT NULL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* Primary key<br></p>
<p class="tableblock">* unique ID (code) of the widget<br></p>
<p class="tableblock">* for simpler widgets, this is the name of the widgetâ€™s JSP file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">titles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text NOT NULL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XML containing the human readable name of the widget for each language of the admin console</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* For widgets requiring configuration<br>
XML containing the parameters necessary for configuring the widget, and the Struts2 name of custom action to call for persisting the configuration</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">plugincode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">character varying(30)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* For widgets bundled with a plugin<br></p>
<p class="tableblock">* unique code of the plugin belonging to this widget</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">parenttypecode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">character varying(40)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* For widgets that are a specialization of an existing widget<br></p>
<p class="tableblock">* the id of the original widget used as a base for the current entry</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">defaultconfig</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For widgets that are a modification of an existing widget<br></p>
<p class="tableblock">* XML containing the permanent configuration of the current entry</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">locked</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">smallint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Express the ability to delete the widget. A value of 1 means the widget cannot be deleted, even by an administrator. A value of 0 means you can delete the widget.<br></p>
<p class="tableblock">* Possible values [0,1]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maingroup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Group ID of the widgetâ€™s owner</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_widget_catalog_examples"><a class="anchor" href="#_widget_catalog_examples"></a>5.5.2. WIDGET CATALOG EXAMPLES</h4>
<div class="paragraph">
<p>The table below presents example values for each column, and their related meanings. The example values are unrelated to each other unless otherwise noted.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Example values for the widgetcalaog table</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Column name</th>
<th class="tableblock halign-left valign-top">value / notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">code</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">content_viewer<br>
<em>Note: this is the unique name of the widget. The system looks for:</em><br></p>
<p class="tableblock">* a FreeMarker script associated with this widget in the <em>guiframent.widgettypecode</em> table<br></p>
<p class="tableblock">* if the FreeMarker script is not found, then it looks for <em>webapp/WEB-INF/plugins/aps/jsp/content_viewer.jsp</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">titles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br>
 &lt;properties&gt;</strong><br>
 <strong>&lt;property key="en"&gt;Contents - Publish a List of Contents&lt;/property&gt;</strong><br>
 <strong>&lt;property key="it"&gt;Contenuti - Pubblica una Lista di Contenuti&lt;/property&gt;</strong><br>
<strong>&lt;/properties&gt;</strong><br></p>
<p class="tableblock"><em>Note: this XML contains the human readable names of the widgets available in the languages of the admin console</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br>
&lt;config&gt;<br>
&lt;parameter name="contentId"&gt;Content ID&lt;/parameter&gt;
   &lt;parameter name="modelId"&gt;Content Model ID&lt;/parameter&gt;<br>
   *&lt;action name="viewerConfig" /&gt;<br>
&lt;/config&gt;</strong></p>
<p class="tableblock"><em>Note: when configuring a widget on a page, the system will ask for the values of contentId and modelId; it will use the action viewerConfig to manage the configuration logic</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">plugincode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>jacms</strong></p>
<p class="tableblock"><em>Note: this is the code (unique ID) of the plugin this widget belongs to. This information determines the path of the underlying widget JSP (if any)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">parenttypecode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>entando-widget-navigation_bar</strong></p>
<p class="tableblock"><em>Note: this example shows that the current entry is a specialization of the entando-widget-navigation_bar widget. This widgetâ€™s configuration file is found in the following (defaultconfig) column</em></p>
<p class="tableblock">Widgets based on the Struts2 framework use the value <strong>formAction</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">defaultconfig</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br>
  &lt;properties&gt;<br>
   &lt;property key="navSpec"&gt;code(homepage)&lt;/property&gt;<br>
&lt;/properties&gt;</strong></p>
<p class="tableblock"><em>Note: this widget uses the setup above and is not configurable</em></p>
<p class="tableblock">Widgets based on the Struts2 framework have here the declaration of the action called when the widget is rendered in a page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">locked</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>1</strong></p>
<p class="tableblock">A value of 1 indicates that the widget is locked and cannot be deleted. A value of 0 allows administrators to delete the widget.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maingroup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>free</strong></p>
<p class="tableblock"><em>Note: this widget is freely accessible but must be placed on an accessible page to be used</em></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_basic_widgets"><a class="anchor" href="#_basic_widgets"></a>5.5.3. BASIC WIDGETS</h4>
<div class="paragraph">
<p>Basic widgets in Entando are composed of two objects: a JSP file and a record in the widgetcatalog table.</p>
</div>
<div class="paragraph">
<p>In basic widgets, JSTL custom tags interact directly with the Entando core to generate dynamic data. Widgets that publish content (e.g., the â€œPublish a Contentâ€ widget (code: content_viewer)) or publish lists of content (e.g., â€œPublish a List of Contentsâ€ widget (code: content_viewer_list)) as well as the <a href="https://github.com/entando/entando-components/blob/v5.0.0/ui-bundles/widgets/entando-widget-language_choose/src/main/webapp/WEB-INF/aps/jsp/widgets/entando-widget-language_choose.jsp">language selector</a> and the <a href="https://github.com/entando/entando-components/blob/v5.0.0/ui-bundles/widgets/entando-widget-login_form/src/main/webapp/WEB-INF/aps/jsp/widgets/entando-widget-login_form.jsp">login widget</a> fall under this category.</p>
</div>
<div class="sect4">
<h5 id="_example_19"><a class="anchor" href="#_example_19"></a>EXAMPLE</h5>
<div class="paragraph">
<p><strong>To create a basic widget:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create the following file in your project:<br>
<em>src/main/webapp/WEB-INF/aps/jsp/widgets/hello_world.jsp</em></p>
</li>
<li>
<p>Copy the following HTML into the file you just created:<br>
<code>&lt;h3&gt;Hello world&lt;/h3&gt;</code></p>
</li>
<li>
<p>Execute the following query in the *Port database:<br>
<code>INSERT INTO widgetcatalog (code, titles, parameters, plugincode, parenttypecode, defaultconfig, locked, maingroup) VALUES ('hello_world', '&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;properties&gt;
&lt;property key="en"&gt;Hello World Widget&lt;/property&gt;
&lt;property key="it"&gt;Widget Ciao Mondo&lt;/property&gt;
&lt;/properties&gt;', NULL, NULL , NULL, NULL, 1, 'free');</code></p>
</li>
<li>
<p>Restart the Entando application. After restarting, the â€œHello World" widget appears in the list of the available system widgets.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configuring_widgets"><a class="anchor" href="#_configuring_widgets"></a>5.5.4. CONFIGURING WIDGETS</h4>
<div class="paragraph">
<p>Configurable basic widgets contain XML with a list of the parameters that needs to be configured and the action that handles the process of configuration. The action for the configuration varies by widget, but each has an abstraction layer that makes developing such actions easier.</p>
</div>
<div class="paragraph">
<p>The <em>widgetcatalog.parameters</em> column in the *Port database lists all basic widgets with configurable fields and what those fields are.</p>
</div>
<div class="paragraph">
<p>You can also retrieve configured parameters using the tag:<br>
<code>&lt;wp:currentWidget param=â€configâ€ configParan=â€NAME_OF_THE_PARAMETERâ€ /&gt;</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_struts2_based_widgets"><a class="anchor" href="#_struts2_based_widgets"></a>5.5.5. STRUTS2-BASED WIDGETS</h4>
<div class="paragraph">
<p>Entando leverages the Struts2 framework to implement actions within certain widgets. These actions transfer data and help determine which result to render in the view. For more information about Struts2 widgets, see the Entando Developer Primer.</p>
</div>
<div class="paragraph">
<p>Struts2-based widgets require additional set up, so Entando recommends having the Entando Component Generator (formerly known as EDO) generate all the files. You can access the Component Generator here:
<a href="https://github.com/entando/component-generator/tree/v5.0.0-release" class="bare">https://github.com/entando/component-generator/tree/v5.0.0-release</a></p>
</div>
<div class="paragraph">
<p><strong>When working with Struts2-based widgets, Entando applications follow two steps:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The system detects that a Struts2-based widget needs to be rendered so it executes
the action specified in the record of the widget in the <em>widgetcatalog</em> table.</p>
</li>
<li>
<p>The application executes the action and renders a JSP as a result.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>One important difference between Basic and Struts2-based widgets is that Struts2 widgets are generally composed of multiple JSP files.</p>
</div>
<div class="paragraph">
<p>The exact details of how to build an action for a widget are in the Entando Developer Primer, but the key points are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Action paths are declared in the file:<br>
<em>./src/main/resources/entando-struts-plugin</em></p>
</li>
<li>
<p>The java class(es) implementing the action, the XML declaring the action itself, and the optional XML used for validation are found in the following path:<br>
<em>./src/main/java/&lt;reverse_domain_package&gt;/aps/internalservlet/</em></p>
</li>
<li>
<p>The XML declaring the actions references the JSP files in:<br>
<em>src/main/webapp/WEB-INF/aps/jsp/internalservlet/</em></p>
</li>
<li>
<p>The Spring bean underlying the action Java class is declared in:<br>
<em>src/main/resources/spring/apsadmin</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Struts2 makes available all properties and public methods declared in the Java class that implements the action. Mixing JSTL and Struts2 tags is also possible. Entando uses OGNL expression language to get and set properties of Java objects.</p>
</div>
<div class="sect4">
<h5 id="_example_of_database_definition"><a class="anchor" href="#_example_of_database_definition"></a>EXAMPLE OF DATABASE DEFINITION</h5>
<div class="paragraph">
<p><strong>Struts2-based widgets use the following configuration:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">column</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">parenttypecode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">formAction</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">defaultconfig</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br>
&lt;properties&gt;<br>
   &lt;property key="actionPath"&gt;/ExtStr2/do/FrontEnd/jpzoo/Animal/list.action&lt;/property&gt;<br>
&lt;/properties&gt;</strong></p>
<p class="tableblock"><em>Note: the action path always starts with /ExtStr2/, but /ExtStr2/ is not used in the action declaration</em></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_widget_configuration"><a class="anchor" href="#_widget_configuration"></a>WIDGET CONFIGURATION</h5>
<div class="paragraph">
<p>Configuration for a Struts2-based widget configuration is different from that of basic widgets. <em>In this case the XML containing the configuration parameters does not work as expected.</em></p>
</div>
<div class="paragraph">
<p><strong>You can overcome this by doing the following:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creating a basic widget with a standard configuration</p>
</li>
<li>
<p>Using a Struts2 tag to trigger a standard action, e.g.,<br>
<code>&lt;wp:internalServlet actionPath=â€/ExtStr2/do/ACTION_NAMESPACE/MY_ACTIONâ€ /&gt;</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using this method, the JSP created for the basic widget is a trigger for the next action that renders the proper JSP.</p>
</div>
<div class="paragraph">
<p>In this scenario, you can retrieve the configuration parameters inside the action class.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_list_of_entando_widgets"><a class="anchor" href="#_list_of_entando_widgets"></a>5.6. LIST OF ENTANDO WIDGETS</h3>
<div class="sect3">
<h4 id="widgetlist"><a class="anchor" href="#widgetlist"></a>5.6.1. CREATING A LOGIN PAGE</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From the App Builder, go to UX Patterns &gt; Widgets.</p>
</li>
<li>
<p>Scroll down to the Stock section and select the Login Form widget.</p>
</li>
<li>
<p>Customize the redirect logic for the form in the Custom UI template to redirect to your desired landing page by page code. See the bold text in the example code below.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This redirect depends on your landing page having a unique widget to identify the correct landing page.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Set up your landing page to have an Owner and Join Group that are not protected.</p>
</li>
<li>
<p>Create your new page and add the Login Form widget. You can use the pre-defined Login page for this.</p>
</li>
<li>
<p>Set your Home Page to the login page.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_example_login_form"><a class="anchor" href="#_example_login_form"></a>Example login form</h5>
<div class="paragraph">
<p>This example setup displays a login to all users. Configuring a generic landing page with some pages requiring authentication will follow roughly the same pattern with different permissions.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;#assign wp=JspTaglibs["/aps-core"]&gt;
&lt;h1&gt;&lt;@wp.i18n key="RESERVED_AREA" /&gt;&lt;/h1&gt;
&lt;#if (Session.currentUser.username != "guest") &gt;
	&lt;p&gt;&lt;@wp.i18n key="WELCOME" /&gt;, &lt;em&gt;${Session.currentUser}&lt;/em&gt;!&lt;/p&gt;
	&lt;#if (Session.currentUser.entandoUser) &gt;
	&lt;table class="table table-condensed"&gt;
		&lt;tr&gt;
			&lt;th&gt;&lt;@wp.i18n key="USER_DATE_CREATION" /&gt;&lt;/th&gt;
			&lt;th&gt;&lt;@wp.i18n key="USER_DATE_ACCESS_LAST" /&gt;&lt;/th&gt;
			&lt;th&gt;&lt;@wp.i18n key="USER_DATE_PASSWORD_CHANGE_LAST" /&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td&gt;${Session.currentUser.creationDate?default("-")}&lt;/td&gt;
			&lt;td&gt;${Session.currentUser.lastAccess?default("-")}&lt;/td&gt;
			&lt;td&gt;${Session.currentUser.lastPasswordChange?default("-")}&lt;/td&gt;

&lt;script&gt;
localStorage.setItem("accessToken", "${Session.currentUser.accessToken}");
console.log("${Session.currentUser.accessToken}");
&lt;/script&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
		&lt;#if (!Session.currentUser.credentialsNotExpired) &gt;
		&lt;div class="alert alert-block"&gt;
			&lt;p&gt;&lt;@wp.i18n key="USER_STATUS_EXPIRED_PASSWORD" /&gt;: &lt;a href="&lt;@wp.info key="systemParam" paramName="applicationBaseURL" /&gt;do/editPassword.action"&gt;&lt;@wp.i18n key="USER_STATUS_EXPIRED_PASSWORD_CHANGE" /&gt;&lt;/a&gt;&lt;/p&gt;
		&lt;/div&gt;
		&lt;/#if&gt;
	&lt;/#if&gt;
	&lt;@wp.ifauthorized permission="enterBackend"&gt;
	&lt;div class="btn-group"&gt;
		&lt;a href="&lt;@wp.info key="systemParam" paramName="applicationBaseURL" /&gt;do/main.action?request_locale=&lt;@wp.info key="currentLang" /&gt;" class="btn"&gt;&lt;@wp.i18n key="ADMINISTRATION" /&gt;&lt;/a&gt;
	&lt;/div&gt;
	&lt;/@wp.ifauthorized&gt;
	&lt;p class="pull-right"&gt;&lt;a href="&lt;@wp.info key="systemParam" paramName="applicationBaseURL" /&gt;do/logout.action" class="btn"&gt;&lt;@wp.i18n key="LOGOUT" /&gt;&lt;/a&gt;&lt;/p&gt;
	&lt;@wp.pageWithWidget widgetTypeCode="userprofile_editCurrentUser" var="userprofileEditingPageVar" listResult=false /&gt;
	&lt;#if (userprofileEditingPageVar??) &gt;
	&lt;p&gt;&lt;a href="&lt;@wp.url page="${userprofileEditingPageVar.code}" /&gt;" &gt;&lt;@wp.i18n key="userprofile_CONFIGURATION" /&gt;&lt;/a&gt;&lt;/p&gt;
	&lt;/#if&gt;
&lt;#else&gt;
	&lt;#if (accountExpired?? &amp;&amp; accountExpired == true) &gt;
	&lt;div class="alert alert-block alert-error"&gt;
		&lt;p&gt;&lt;@wp.i18n key="USER_STATUS_EXPIRED" /&gt;&lt;/p&gt;
	&lt;/div&gt;
	&lt;/#if&gt;
	&lt;#if (wrongAccountCredential?? &amp;&amp; wrongAccountCredential == true) &gt;
	&lt;div class="alert alert-block alert-error"&gt;
		&lt;p&gt;&lt;@wp.i18n key="USER_STATUS_CREDENTIALS_INVALID" /&gt;&lt;/p&gt;
	&lt;/div&gt;
	&lt;/#if&gt;
	&lt;form action="&lt;@wp.url/&gt;" method="post" class="form-horizontal margin-medium-top"&gt;
		&lt;#if (RequestParameters.returnUrl??) &gt;
		&lt;input type="hidden" name="returnUrl" value="${RequestParameters.returnUrl}" /&gt;

                 <strong>&lt;#else&gt;
                   &lt;@wp.pageWithWidget widgetTypeCode="home_page_cards" var="homePageCards" listResult=false /&gt;
                &lt;#if (homePageCards??) &gt;
		&lt;input type="hidden" name="returnUrl" value="&lt;@wp.url page="${homePageCards.code}" /&gt;" /&gt;
                &lt;/#if&gt;</strong>
		&lt;/#if&gt;



		&lt;div class="control-group"&gt;
			&lt;label for="username" class="control-label"&gt;&lt;@wp.i18n key="USERNAME" /&gt;&lt;/label&gt;
			&lt;div class="controls"&gt;
				&lt;input id="username" type="text" name="username" class="input-xlarge" /&gt;
			&lt;/div&gt;
		&lt;/div&gt;
		&lt;div class="control-group"&gt;
			&lt;label for="password" class="control-label"&gt;&lt;@wp.i18n key="PASSWORD" /&gt;&lt;/label&gt;
			&lt;div class="controls"&gt;
				&lt;input id="password" type="password" name="password" class="input-xlarge" /&gt;
			&lt;/div&gt;
		&lt;/div&gt;
		&lt;div class="form-actions"&gt;
			&lt;input type="submit" value="&lt;@wp.i18n key="SIGNIN" /&gt;" class="btn btn-primary" /&gt;
		&lt;/div&gt;
	&lt;/form&gt;
&lt;/#if&gt;</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_digital_exchange"><a class="anchor" href="#_digital_exchange"></a>5.7. DIGITAL EXCHANGE</h3>
<div class="paragraph">
<p>Entando Digital Exchange is a marketplace from which users can install different Widgets, Components, Fragments, Page Models, Content Models and Content Types.</p>
</div>
<div class="paragraph">
<p>A Digital Exchange (DE) is a special Entando instance able to provide components that can be installed in other Entando instances via the App Builder.</p>
</div>
<div class="sect3">
<h4 id="_using_a_digital_exchange"><a class="anchor" href="#_using_a_digital_exchange"></a>5.7.1. USING A DIGITAL EXCHANGE</h4>
<div class="paragraph">
<p>In order to use a DE it is necessary to add the DE plugin to your Entando application adding the following dependency in the pom.xml file:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;dependency&gt;
    &lt;groupId&gt;org.entando.entando.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;entando-plugin-jpdigital-exchange&lt;/artifactId&gt;
    &lt;version&gt;${entando.version}&lt;/version&gt;
    &lt;type&gt;war&lt;/type&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Then in the App Builder edit the .env file for enabling the DE</p>
</div>
<div class="literalblock">
<div class="content">
<pre>DIGITAL_EXCHANGE_UI_ENABLED=true</pre>
</div>
</div>
<div class="paragraph">
<p>Start you Entando instance and from the App Builder go to the Digital Exchange page (from top menu) and open the configuration panel (gear icon).</p>
</div>
<div class="paragraph">
<p>Click on "Add Digital Exchange" and configure the DE you want to use. You can also use multiple DE instances. Key and secret fields are used to connecting to the DE using OAuth2.
The DE administrator has to provide you this credentials.</p>
</div>
<div class="paragraph">
<p>You should now be able to see components provided by the DE and install them.</p>
</div>
<div class="sect4">
<h5 id="_loggingauditing_information"><a class="anchor" href="#_loggingauditing_information"></a>LOGGING/AUDITING INFORMATION</h5>
<div class="paragraph">
<p>When an user starts an installation/uninstallation, the process is handled by an asynchronous job. Job information, including also start/end time, status and the user who triggered the job, is stored into the <code>digital_exchange_jobs</code> table (serv database).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_setup_your_digital_exchange"><a class="anchor" href="#_setup_your_digital_exchange"></a>5.7.2. SETUP YOUR DIGITAL EXCHANGE</h4>
<div class="paragraph">
<p>Clone or download the DE project: <a href="https://github.com/entando/digital-exchange" class="bare">https://github.com/entando/digital-exchange</a> and start it in the same way of other Entando instances.</p>
</div>
<div class="sect4">
<h5 id="_create_credentials_for_digital_exchange_clients"><a class="anchor" href="#_create_credentials_for_digital_exchange_clients"></a>CREATE CREDENTIALS FOR DIGITAL EXCHANGE CLIENTS</h5>
<div class="paragraph">
<p>From the Admin Console go to Integrations &gt; API Management &gt; <strong>Consumers</strong></p>
</div>
<div class="paragraph">
<p>Add a new Consumer:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>fill the required fields</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Callback URL is blank</p>
</li>
<li>
<p>scope is "read,write,trust"</p>
</li>
</ol>
</div>
</li>
<li>
<p>in "Authorized Grant Types" section, set to ON the <code>client_credentials</code> toggle button.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This credentials have to be put by DE clients inside their DE configuration (see above).</p>
</div>
</div>
<div class="sect4">
<h5 id="_create_a_component"><a class="anchor" href="#_create_a_component"></a>CREATE A COMPONENT</h5>
<div class="paragraph">
<p>A component consists in a folder containing a set of files that are used to insert new data into an Entando instance.
Component providers need to create these files carefully respecting the constraints listed below. To generate the structure of simple components like a page model we suggest using the dedicated command of the command line tool (see section "custom local components").</p>
</div>
<div class="paragraph">
<p>A component has a name, a version and an id. The id must be unique between all the exchanges, so it can be a composition of a DE unique identifier, the component name and the component version.</p>
</div>
<div class="paragraph">
<p>Inside the component folder it is mandatory to have a file named <strong>component.xml</strong> (the component descriptor), describing the component installation/uninstallation needs.
The component descriptor can reference other files using a relative path, so all the paths must be prefixed by the component id (e.g. <code>&lt;component_id&gt;/relative/path</code>).</p>
</div>
<div class="paragraph">
<p>Other files must be put in the following sub-directories:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>data</strong>: used for files needed only during the installation/uninstallation process;</p>
</li>
<li>
<p><strong>resources</strong>: used for public resources (like images, CSS and JavaScript files).</p>
</li>
</ol>
</div>
<div class="sect5">
<h6 id="_define_installationuninstallation_operations"><a class="anchor" href="#_define_installationuninstallation_operations"></a>DEFINE INSTALLATION/UNINSTALLATION OPERATIONS</h6>
<div class="paragraph">
<p>The component descriptor can contain a sequence of operations defined using Spring SpEL: this allows the execution of bean methods.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;component&gt;
    &lt;!-- ... --&gt;
    &lt;installation&gt;
        &lt;execution&gt;
            &lt;op&gt;@myBean.myMethod()&lt;/op&gt;
            &lt;op&gt;...&lt;/op&gt;
        &lt;/execution&gt;
    &lt;/installation&gt;
&lt;/component&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>The most common use case is to call a controller method, which usually needs a model passed as parameter. The model can be parsed from a JSON or XML file.
It is possible to use a simple bean called <code>ModelParser</code> to do this inside a SpEL expression, e.g.:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>@modelParser.parse('&lt;component_id&gt;/data/my_model.json', T(org.entando.entando.web.MyModelClass))</pre>
</div>
</div>
<div class="paragraph">
<p>The system provides also some <strong>utility functions</strong> in order to simplify the writing of the most common operations:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>the <code>#bindingResult()</code> custom SpEL function provides an instance of a <code>BindingResult</code> class, used in a lot of controllers for handling validation error messages;</p>
</li>
<li>
<p>the <code>#call()</code> custom SpEL function can be used for the most common operations, like creating a label or a contentModel. It accepts an operation name as the first parameter and the path of a file containing the model for that operation as the second parameter. So, for example, for creating a label it is possible to use the following expression: <code>#call('createLabel', '&lt;component_id&gt;/data/label.json')</code></p>
<div class="ulist">
<ul>
<li>
<p>Supported operations are:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>createPageModel</code>/<code>deletePageModel</code></p>
</li>
<li>
<p><code>createWidget</code>/<code>deleteWidget</code></p>
</li>
<li>
<p><code>createGroup</code>/<code>deleteGroup</code></p>
</li>
<li>
<p><code>createRole</code>/<code>deleteRole</code></p>
</li>
<li>
<p><code>createLabel</code>/<code>deleteLabel</code></p>
</li>
<li>
<p><code>createContentType</code>/<code>deleteContentType</code> (CMS plugin must be installed)</p>
</li>
<li>
<p><code>createContentModel</code>/<code>deleteContentModel</code> (CMS plugin must be installed)</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_use_static_resources_in_a_page_model"><a class="anchor" href="#_use_static_resources_in_a_page_model"></a>USE STATIC RESOURCES IN A PAGE MODEL</h6>
<div class="paragraph">
<p>If you put a static resource in the resources folder, after the installation it will be available at the following URL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;resources_url&gt;/components/&lt;component_id&gt;/&lt;resource_name&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>So you can reference it from a FreeMarker template using the dedicated tag:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;#assign wp=JspTaglibs["/aps-core"]&gt;
    &lt;!-- ... -&gt;
    &lt;@wp.resourceURL /&gt;components/my_component_id/style.css" /&gt;</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_sql_execution"><a class="anchor" href="#_sql_execution"></a>SQL EXECUTION</h6>
<div class="paragraph">
<p>Even if it is discouraged (because it ignores validation logic), it is possible to execute SQL statements during the installation/uninstallation process.</p>
</div>
<div class="paragraph">
<p>Put your SQL file into the data directory and reference it in the component.xml, specifying if its target is the port or the serv database, as in the following example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;component&gt;
    &lt;!-- ... --&gt;
    &lt;installation&gt;
        &lt;environment code="production"&gt;
            &lt;defaultSqlResources&gt;
                &lt;datasource name="portDataSource"&gt;
                    my_component_id/data/scriptPort.sql
                &lt;/datasource&gt;
                &lt;datasource name="servDataSource"&gt;
                    my_component_id/data/scriptServ.sql
                &lt;/datasource&gt;
            &lt;/defaultSqlResources&gt;
        &lt;/environment&gt;
    &lt;/installation&gt;
&lt;/component&gt;</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_examples"><a class="anchor" href="#_examples"></a>EXAMPLES</h6>
<div class="paragraph">
<p>Some complete examples can be found here: <a href="https://github.com/entando/de-cli/tree/master/demo_components/data" class="bare">https://github.com/entando/de-cli/tree/master/demo_components/data</a></p>
</div>
<div class="paragraph">
<p>You can upload these demo components on your DE using the DE command line tool (see section below).</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_configure_the_de_to_provide_a_component"><a class="anchor" href="#_configure_the_de_to_provide_a_component"></a>CONFIGURE THE DE TO PROVIDE A COMPONENT</h5>
<div class="paragraph">
<p>Put your component folder on a git repository and then configure the DE to retrieve component data from that repository. A graphical interface for doing this has not been implemented yet, but we have implemented a command line tool that calls directly the DE API.</p>
</div>
<div class="paragraph">
<p>You can get the tool at this repository: <a href="https://github.com/entando/de-cli" class="bare">https://github.com/entando/de-cli</a></p>
</div>
<div class="paragraph">
<p>Follow the instructions provided in the README for installing the tool (npm and node are required).</p>
</div>
<div class="paragraph">
<p>Type <code>./de-cli.js --help</code> to see the list of the supported components.</p>
</div>
<div class="sect5">
<h6 id="_setup_the_keypair"><a class="anchor" href="#_setup_the_keypair"></a>SETUP THE KEYPAIR</h6>
<div class="paragraph">
<p>Each component package is signed after its creation using asymmetric cryptography, in order to prevent clients to install tampered packages.</p>
</div>
<div class="paragraph">
<p>So, before adding any component metadata, it is necessary to create a keypair. This can be done using the following command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js create-keypair</pre>
</div>
</div>
<div class="paragraph">
<p>The private key is stored on disk and it is encrypted using the password set in the .env file (see <code>DE_COMPONENT_PASSWORD</code> property).</p>
</div>
<div class="paragraph">
<p>If you want to verify the keypair existence you can obtain the public key using the following command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js print-public-key</pre>
</div>
</div>
<div class="paragraph">
<p>If you need to delete the keypair you can use the following command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js delete-keypair</pre>
</div>
</div>
<div class="paragraph">
<p>When a keypair is deleted all the component package signatures are set to null (so it is not possible to install the components). Signatures are generated again when a new keypair is created. <strong>WARNING</strong>: If you generate a new keypair you have to notify all your clients that the keypair is changed. A DE client retrieves the public key from the DE when its configuration is added, so clients need to delete their DE configuration and add it again in order to retrieve the updated public key.</p>
</div>
</div>
<div class="sect5">
<h6 id="_add_repository_information"><a class="anchor" href="#_add_repository_information"></a>ADD REPOSITORY INFORMATION</h6>
<div class="paragraph">
<p>DE components are retrieved from one or more git repositories. Add the repository configuration using the <code>add-repository</code> command and typing the asked information:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js add-repository
Repository name: demo_repo
Repository URL: https://github.com/entando/de-cli.git</pre>
</div>
</div>
<div class="paragraph">
<p>An unique identifier is generated for each repository and it is used for referencing the repository in other commands. Currently only public repositories are supported.</p>
</div>
<div class="paragraph">
<p>To obtain the list of all configured repositories you can use:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js list-repositories</pre>
</div>
</div>
<div class="paragraph">
<p>To delete a repository you can use:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js delete-repository &lt;repo-id&gt;</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_add_component_metadata"><a class="anchor" href="#_add_component_metadata"></a>ADD COMPONENT METADATA</h6>
<div class="paragraph">
<p>After you have added a repository you can add component metadata in order to create a package.</p>
</div>
<div class="paragraph">
<p>There are 2 ways to add component metadata: interactively and from a JSON file.</p>
</div>
<div class="paragraph">
<p>The interactive mode asks you the component metadata (a list of available repository identifiers is provided):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js add-component
Component name: hello_widget
Component version: 5.2.0-V1
Component id (hello_widget_5.2.0-V1): hello_widget_v1
Component description: Hello Widget Description
Component type: widget
Repository id
[Available 503 (demo_repo)]: 503
Repository directory: demo_components/data/hello_widget
Commit id (empty for last commit):
Component hello_widget_v1 added</pre>
</div>
</div>
<div class="paragraph">
<p>The metadata can contain also a commit id (useful for supporting multiple versions of the same component) and a repository subdirectory (useful for providing multiple components using a single repository).</p>
</div>
<div class="paragraph">
<p>Alternatively you can create a JSON file containing this information and pass it to the command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
    "id": "hello_widget_v1",
    "name": "hello_widget",
    "description": "Hello Widget Description",
    "type": "widget",
    "version": "5.2.0-V1",
    "repoId": 503,
    "repoDirectory": "demo_components/data/hello_widget"
}

./de-cli.js add-component hello_widget.json</pre>
</div>
</div>
<div class="paragraph">
<p>The insertion of a component metadata triggers the retrieval of the component data from the configured git repository. The data is packed as a zip file and the signature of this package is generated. This process happens asynchronously, so it could take some time before the signature is initialized. You can use the command <code>list-components</code> to check the existence of the signature (a component without a signature can&#8217;t be installed):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js list-components
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ (index) â”‚        id         â”‚   type   â”‚ signature â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    0    â”‚ 'hello_widget_v1' â”‚ 'widget' â”‚   'YES'   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</pre>
</div>
</div>
<div class="paragraph">
<p>To delete a component use:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js delete-component &lt;component_id&gt;</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_upload_component_image"><a class="anchor" href="#_upload_component_image"></a>UPLOAD COMPONENT IMAGE</h6>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js add-component-image &lt;component_id&gt; &lt;file&gt;</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_demo_components"><a class="anchor" href="#_demo_components"></a>DEMO COMPONENTS</h6>
<div class="paragraph">
<p>The DE command line tool repository provides also a folder containing a set of demo components.
To add all these components and their icons use:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js add-demo-components</pre>
</div>
</div>
<div class="paragraph">
<p>Keypair and demo repository are automatically added if they are missing.</p>
</div>
<div class="paragraph">
<p>To delete the demo components and the demo repository use:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js cleanup-demo-components</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_custom_local_components"><a class="anchor" href="#_custom_local_components"></a>CUSTOM LOCAL COMPONENTS</h6>
<div class="paragraph">
<p>If you want to create your first custom components and test them locally you can use the dedicated command that guides you in the creation using some templates.
The command line tools will generate a folder for the component inside the directory specified in the .env file using the property <code>LOCAL_REPO_URL</code>. This folder must be outside the de-cli repository because it is versioned using git too.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js create-local-component
Select component type:
1. contentModel
2. contentType
3. pageModel
4. widget
Component type: 1
Component name: my_content_model
Component version: 1.0
Component id (my_content_model_1.0):
Component description: My description</pre>
</div>
</div>
<div class="paragraph">
<p>This will generate a basic component in your local repository directory. Changes are automatically committed to the git repository after the component generation. If you want to customize the generated component remember to commit your additional changes.</p>
</div>
<div class="paragraph">
<p>You can add the generated component to the DE using the <code>add-component</code> command, but for the local components we provide also a simplified version that needs only the component id:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js add-local-component &lt;component-id&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>If you want to delete a component both from the DE and the local repository you can use the following command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js delete-local-component &lt;component-id&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>We suggest using this command instead of a manual removal because it automatically commits the removed directory and cleanups the component metadata on the DE.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_customize_component_rating"><a class="anchor" href="#_customize_component_rating"></a>CUSTOMIZE COMPONENT RATING</h5>
<div class="paragraph">
<p>Component rating functionality can be customized editing the file src/main/resources/digital-exchange.properties:</p>
</div>
<div class="paragraph">
<p>To completely disable the rating service use:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>enable-rating=false</pre>
</div>
</div>
<div class="paragraph">
<p>If you need to change the range of the stored rating values you can update the limits using the following properties:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>rate-min=0
rate-max=10</pre>
</div>
</div>
<div class="paragraph">
<p>This can be useful in order to provide compatibility with other rating system. Notice that the range is adapted only inside the database, while the API will always work using the 1-5 range to adopt a standardized range between all the DE instances. This corresponds to the stars on the UI.</p>
</div>
<div class="paragraph">
<p>So, using the range provided in the example the conversion will be:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 50%;">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">API value</th>
<th class="tableblock halign-left valign-top">DB value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_troubleshooting_2"><a class="anchor" href="#_troubleshooting_2"></a>5.7.3. TROUBLESHOOTING</h4>
<div class="sect4">
<h5 id="_client_issues"><a class="anchor" href="#_client_issues"></a>Client issues</h5>
<div class="sect5">
<h6 id="_invalid_signature"><a class="anchor" href="#_invalid_signature"></a>Invalid signature</h6>
<div class="paragraph">
<p>As a security measure all the component packages are signed. If, installing a component, the installation job fails with the error "<em>SignatureMatchingException: Component signature not matching public key</em>", it means that signature verification has failed. This can have 2 different causes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>the package has been tampered, so the system avoided you to install a broken/malicious package;</p>
</li>
<li>
<p>the DE administrator regenerated the keypair used in the signature.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>So, ask to the DE administrator if he/she has just regenerated the keypair and in that case delete the DE configuration and add it again. This will trigger the retrieval of the new public key from the DE.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_jboss_eap_deployment"><a class="anchor" href="#_jboss_eap_deployment"></a>5.8. JBOSS EAP DEPLOYMENT</h3>
<div class="sect3">
<h4 id="jboss_eap_deployment"><a class="anchor" href="#jboss_eap_deployment"></a>5.8.1. PREREQUISITES</h4>
<div class="ulist">
<ul>
<li>
<p>JDK 1.8 (Oracle version)</p>
</li>
<li>
<p>Maven (for packaging the application WAR file)</p>
</li>
<li>
<p>Ant (for database schema generation)</p>
</li>
<li>
<p>JBoss EAP instance installed</p>
</li>
<li>
<p>Access to an external database (Postgres or MySQL). If you need to create the databases, install the following tools:</p>
<div class="ulist">
<ul>
<li>
<p>Postgres: <a href="https://www.postgresql.org/docs/9.6/static/app-psql.html" class="bare">https://www.postgresql.org/docs/9.6/static/app-psql.html</a></p>
</li>
<li>
<p>MySQL: <a href="https://dev.mysql.com/doc/refman/8.0/en/programs-client.html" class="bare">https://dev.mysql.com/doc/refman/8.0/en/programs-client.html</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_introduction_6"><a class="anchor" href="#_introduction_6"></a>5.8.2. INTRODUCTION</h4>
<div class="paragraph">
<p>This tutorial walks you through how to package and deploy an Entando application to JBoss Enterprise Application Platform (EAP). It assumes you will use an external database.</p>
</div>
<div class="paragraph">
<p>You can create a new Entando application by taking ONE of the following actions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download a <a href="https://central.entando.com/en/downloads.page">started application</a> and modify as needed OR</p>
</li>
<li>
<p>Create a new empty project using a Maven archetype</p>
<div class="ulist">
<ul>
<li>
<p>See the <a href="https://central.entando.com/en/documentation.page#_creating_a_new_entando_project">getting started guide</a> for more details</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The common structure of the project is as follows:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/RHJED_common_structure.png" alt="346" width="435">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_procedure"><a class="anchor" href="#_procedure"></a>5.8.3. PROCEDURE</h4>
<div class="sect4">
<h5 id="_prepare_the_database"><a class="anchor" href="#_prepare_the_database"></a>PREPARE THE DATABASE</h5>
<div class="paragraph">
<p>The information in Entando is stored in a pair of database schemas: one named â€œportâ€ in the code base and properties, and the other named â€œserv.â€</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Port schema stores dynamic content of the site (e.g., pages, UI fragments)</p>
</li>
<li>
<p>The Serv schema stores administrative content (e.g., authorization, API configuration, user actions)</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>There is no table name collision between the two schemas, but you should keep them separate so that the content remains separate from the administrative data.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For any external database, you must first generate the table structure (schema) and then preload the initial data which includes basic content and an admin user to log in with and begin customization. Entando supports Postgres and MySQL databases and can support many other database vendors. Contact your Entando representative for assistance.</p>
</div>
<div class="paragraph">
<p>The sections below outline using Ant tasks to generate the schemas with initial datasets. Additional Ant tasks are available to assist with backup and migration. See the buildTasks.xml file in the root of an Entando project directory for more details.</p>
</div>
<div class="sect5">
<h6 id="_if_using_a_postgres_database"><a class="anchor" href="#_if_using_a_postgres_database"></a>IF USING A POSTGRES DATABASE</h6>
<div class="paragraph">
<p>From the root of your project directory, open the <em>buildProperties.xml</em> file. If necessary, adjust the <em>value</em> arguments in the following section of the file to match your database values:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;property name="postgres.hostname" value="localhost" /&gt;
&lt;property name="postgres.port" value="5432" /&gt;
&lt;property name="postgres.username" value="agile" /&gt;
&lt;property name="postgres.password" value="agile" /&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Then specify the path of the PostgreSQL binaries, e.g.,:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;property name=postgres.bin.path" location="C:\Program Files\PostgreSQL\8.3\bin" /&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>From your terminal in the root of your project directory, run the following Ant task:</p>
</div>
<div class="paragraph">
<p><code>ant PG-db-create</code></p>
</div>
</div>
<div class="sect5">
<h6 id="_if_using_a_mysql_database"><a class="anchor" href="#_if_using_a_mysql_database"></a>IF USING A MYSQL DATABASE</h6>
<div class="paragraph">
<p>From the root of your project directory, open the <em>buildProperties.xml</em> file. If necessary, make changes to the value arguments in the following section of the file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;property name="mysql.hostname" value="localhost" /&gt;
&lt;property name="mysql.port" value="3306" /&gt;
&lt;property name="mysql.username" value="agile" /&gt;
&lt;property name="mysql.password" value="agile" /&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Then specify the path of the MySQL binaries e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;property name="mysql.bin.path" value="C:\Program Files\MySQL\5\bin" /&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>From your terminal in the root of your project directory, run the following ant task:</p>
</div>
<div class="paragraph">
<p><code>ant MySQL-db-create</code></p>
</div>
<div class="paragraph">
<p>For more information about first-time Entando project setups, see the First Developers' Guide.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_jboss_configuration"><a class="anchor" href="#_jboss_configuration"></a>JBOSS CONFIGURATION</h5>
<div class="paragraph">
<p>The next step is to configure JBoss to provide connectivity to the two database schemas through a Java Naming and Directory Interface (JNDI) lookup address.  This is a typical configuration step for an enterprise Java application and allows Entando to abstract the actual database configuration from the code, allowing it to make a connection to the database by looking it up by a general name.</p>
</div>
<div class="paragraph">
<p>The following steps contain instructions for completing a basic JBoss configuration. Refer to the official JBoss EAP documentation for more information.</p>
</div>
<div class="sect5">
<h6 id="_install_the_jdbc_driver_for_the_database_vendor"><a class="anchor" href="#_install_the_jdbc_driver_for_the_database_vendor"></a>INSTALL THE JDBC DRIVER FOR THE DATABASE VENDOR</h6>
<div class="paragraph">
<p>Each vendor has a specific JDBC driver used to make the low level connections to their database instances, which get distributed as a JAR file. You need to add this driver to the JBoss module directory before configuring a datasource.  It is important to download the specific vendor and version to match your installed database.</p>
</div>
<div class="paragraph">
<p><strong>For example:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>MySQL: <a href="https://dev.mysql.com/downloads/connector/j/5.1.html">https://dev.mysql.com/downloads/connector/j/5.1.html</a></p>
</li>
<li>
<p>Postgres: <a href="https://jdbc.postgresql.org/">https://jdbc.postgresql.org/</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Install the driver to a JBoss standalone instance using the JBoss command line interface. You may need to adjust the <strong>bolded</strong> items:</p>
</div>
<div class="paragraph">
<p>MySQL</p>
</div>
<div class="literalblock">
<div class="content">
<pre>module add --name=<strong>mysql</strong> --resources=<strong>mysql-connector-java-6.0.6.jar</strong> --dependencies=javax.api,javax.transaction.api</pre>
</div>
</div>
<div class="paragraph">
<p>Postgres</p>
</div>
<div class="literalblock">
<div class="content">
<pre>module add --name=<strong>postgres</strong> --resources=<strong>postgres-9.1.jdbc4.jar</strong> --dependencies=javax.api,javax.transaction.api</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_register_the_driver_in_the_jobss_configuration"><a class="anchor" href="#_register_the_driver_in_the_jobss_configuration"></a>REGISTER THE DRIVER IN THE JOBSS CONFIGURATION</h6>
<div class="paragraph">
<p>Next, make JBoss aware of the database driver:</p>
</div>
<div class="paragraph">
<p>MySQL</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/subsystem=datasources/jdbc-driver=<strong>mysql</strong>:add(driver-module-name=<strong>mysql</strong>, driver-name=<strong>mysql</strong>, driver-class-name=<strong>com.mysql.jdbc.Driver</strong>)</pre>
</div>
</div>
<div class="paragraph">
<p>Postgres</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/subsystem=datasources/jdbc-driver=<strong>postgres</strong>:add(driver-module-name=<strong>postgres</strong>, driver-name=<strong>postgres</strong>, driver-class-name=<strong>org.postgresql.Driver</strong>)</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_configure_the_datasources"><a class="anchor" href="#_configure_the_datasources"></a>CONFIGURE THE DATASOURCES</h6>
<div class="paragraph">
<p>Lastly, configure and expose data sources with the JNDI name that the application will use to establish a connection. The specific JNDI names are used in the following section to tie everything together (i.e., java:jboss/datasources/EntandoPortDS and java:jboss/datasources/EntandoServPS). Replace <strong>bolded</strong> items with the specifics of each database connection.</p>
</div>
<div class="paragraph">
<p>MySQL</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/subsystem=datasources/data-source=EntandoPortDS:add(jndi-name=java:jboss/datasources/EntandoPortDS, driver-name=mysql, connection-url=jdbc:mysql://<strong>host:3306/dbname</strong>,user-name=<strong>user</strong>,password=<strong>password</strong>)

/subsystem=datasources/data-source=EntandoServDS:add(jndi-name=java:jboss/datasources/EntandoServDS, driver-name=mysql, connection-url=jdbc:mysql://<strong>host:3306/dbname</strong>,user-name=<strong>user</strong>,password=<strong>password</strong>)</pre>
</div>
</div>
<div class="paragraph">
<p>Postgres</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/subsystem=datasources/data-source=EntandoPortDS:add(jndi-name=java:jboss/datasources/EntandoPortDS, driver-name=postgres, connection-url=jdbc:postgresql://<strong>host:5432/dbname</strong>,user-name=<strong>user</strong>,password=<strong>password</strong>)

/subsystem=datasources/data-source=EntandoServDS:add(jndi-name=java:jboss/datasources/EntandoServDS, driver-name=postgres, connection-url=jdbc:postgresql://<strong>host:5432/dbname</strong>,user-name=<strong>user</strong>,password=<strong>password</strong>)</pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_entando_application_configuration"><a class="anchor" href="#_entando_application_configuration"></a>ENTANDO APPLICATION CONFIGURATION</h5>
<div class="paragraph">
<p>Update necessary properties files before packaging the Entando application for deployment to JBoss EAP.</p>
</div>
<div class="sect5">
<h6 id="_configure_the_jndi_name"><a class="anchor" href="#_configure_the_jndi_name"></a>CONFIGURE THE JNDI NAME</h6>
<div class="paragraph">
<p>Open the <em>src/config/jboss/jbossBaseSystemConfig.xml</em> file, and make sure that the lookup names match the values in the JBoss datasource configuration:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans&gt;
    &lt;jee:jndi-lookup id="portDataSource" jndi-name="<strong>java:jboss/datasources/EntandoPortDS</strong>"/&gt;
    &lt;jee:jndi-lookup id="servDataSource" jndi-name="<strong>java:jboss/datasources/EntandoServDS</strong>"/&gt;
&lt;/beans&gt;</pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_filter_configuration"><a class="anchor" href="#_filter_configuration"></a>FILTER CONFIGURATION</h5>
<div class="paragraph">
<p>The filter file is what Entando uses to generate the war file to be deployed on JBoss. Navigate to /src/main/filters. The file to configure is <em>filter-production-jboss.properties</em>.</p>
</div>
<div class="paragraph">
<p>From the image below, adapt any values after the "=" so that they conform to your end environment. The two most essential values are in <em>profile.application.baseurl.hostname=www.mydomain.com</em> and <em>profile.jboss.home=/opt/jboss</em>. These values declare the fully qualified domain of the web application and specify the path of the JBOSS_HOME variable in the file system, respectively.</p>
</div>
<div class="paragraph">
<p>To make the web server serve static resources, adapt <em>profile.resources.path</em> as well. The <em>resource.path</em> serves static resources (e.g., an http server) while the <em>resource.path.protected</em> points to a path that is outside a publicly accessible resource like a webserver because it is the path for the protected resources. Finally the <em>index.path</em> variable stores the cache files and therefore should point to an internal system path.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/RHJED_filter_config.png" alt="RHJED filter config">
</div>
</div>
<div class="sect5">
<h6 id="_jboss_configuration_2"><a class="anchor" href="#_jboss_configuration_2"></a>JBOSS CONFIGURATION</h6>
<div class="paragraph">
<p>Adjust the JBoss configuration file by inserting a new handler dedicated to the welcome-content directory. This ensures that the static resources path works correctly, assuming that you are using Undertow instead of an external web server. The handler points to the path acting as an external volume that will contain all of your static resources.</p>
</div>
<div class="paragraph">
<p>In the example below, the handler cmscontent points to <em>/entando-resources/welcome-content/cmsresources</em>. Doing so separates the CMS resources from the applicationâ€™s internal static resources and serves them directly with Undertow.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/RHJED_JBoss_config.png" alt="RHJED JBoss config">
</div>
</div>
<div class="paragraph">
<p>In the JBoss filter, update the value of the <em>profile.resources.path</em> to point to your mounted external volume: <em>/entando-resources/welcome-content/cmsresources</em>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_entando_configuration"><a class="anchor" href="#_entando_configuration"></a>ENTANDO CONFIGURATION</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create the file resourceTypesDef.xml if it does not already exist in src/main/resources/spring/[application-context]/aps. This file lets you overwrite the behavior of the StorageManager.</p>
<div class="paragraph">
<p>Populate <em>resourceTypesDef.xml</em> with the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:jee="http://www.springframework.org/schema/jee"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.0.xsd
			http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd
			http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-4.0.xsd"&gt;
&lt;bean id="[your app context in camel case]StorageManager" class="org.entando.entando.aps.system.services.storage.LocalStorageManager"
          init-method="init" &gt;
        &lt;property name="baseURL" &gt;
            &lt;jee:jndi-lookup jndi-name="java:comp/env/cmsResourceRootURL" /&gt;
        &lt;/property&gt;
        &lt;property name="baseDiskRoot" &gt;
            &lt;jee:jndi-lookup jndi-name="java:comp/env/resourceDiskRootFolder" /&gt;
        &lt;/property&gt;
        &lt;property name="protectedBaseDiskRoot" &gt;
            &lt;jee:jndi-lookup jndi-name="java:comp/env/protectedResourceDiskRootFolder" /&gt;
        &lt;/property&gt;
        &lt;property name="protectedBaseURL" &gt;
            &lt;jee:jndi-lookup jndi-name="java:comp/env/protectedResourceRootURL" /&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
    &lt;bean id="[your app context in camel case]JacmsAbstractResource" abstract="true"
          class="com.agiletec.plugins.jacms.aps.system.services.resource.model.AbstractResource" &gt;
        &lt;property name="storageManager" ref="[your app context in camel case]Manager" /&gt;
        &lt;property name="protectedBaseURL" &gt;
            &lt;jee:jndi-lookup jndi-name="java:comp/env/protectedResourceRootURL" /&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
    &lt;bean id="jacmsAttachResource" class="com.agiletec.plugins.jacms.aps.system.services.resource.model.AttachResource" parent="[your app context in camel case]JacmsAbstractResource" &gt;
        &lt;property name="type" value="Attach" /&gt;
        &lt;property name="folder" value="cms/documents" /&gt;
        &lt;property name="allowedExtensions"&gt;
            &lt;value&gt;${jacms.attachResource.allowedExtensions}&lt;/value&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
    &lt;bean id="jacmsImageResource" class="com.agiletec.plugins.jacms.aps.system.services.resource.model.ImageResource" parent="[your app context in camel case]JacmsAbstractResource" &gt;
        &lt;property name="type" value="Image" /&gt;
        &lt;property name="folder" value="cms/images" /&gt;
        &lt;property name="allowedExtensions"&gt;
            &lt;value&gt;${jacms.imageResource.allowedExtensions}&lt;/value&gt;
        &lt;/property&gt;
        &lt;property name="imageDimensionReader" ref="jacmsImageDimensionReader" /&gt;
        &lt;property name="imageResizerClasses"&gt;
            &lt;map&gt;
                &lt;entry key="DEFAULT_RESIZER"&gt;
                    &lt;value&gt;com.agiletec.plugins.jacms.aps.system.services.resource.model.imageresizer.DefaultImageResizer&lt;/value&gt;
                &lt;/entry&gt;
                &lt;entry key="png"&gt;
                    &lt;value&gt;com.agiletec.plugins.jacms.aps.system.services.resource.model.imageresizer.PNGImageResizer&lt;/value&gt;
                &lt;/entry&gt;
            &lt;/map&gt;
        &lt;/property&gt;
        &lt;property name="imageMagickEnabled"&gt;
            &lt;value&gt;${imagemagick.enabled}&lt;/value&gt;
        &lt;/property&gt;
        &lt;property name="imageMagickWindows"&gt;
            &lt;value&gt;${imagemagick.windows}&lt;/value&gt;
        &lt;/property&gt;
        &lt;property name="imageMagickPath"&gt;
            &lt;value&gt;${imagemagick.path}&lt;/value&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Add the classpath definition for the <em>resourceTypeDef.xml</em> file defined below to the following two files:</p>
<div class="ulist">
<ul>
<li>
<p><em>src/main/config/jboss/web.xml</em></p>
</li>
<li>
<p><em>src/main/config/web.xml</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Classpath definition:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;param-value&gt;
            classpath:spring/propertyPlaceholder.xml
            classpath:spring/restServerConfig.xml
            classpath:spring/baseSystemConfig.xml
            classpath:spring/jbossBaseSystemConfig.xml
            classpath*:spring/aps/**/**.xml
            classpath*:spring/apsadmin/**/**.xml
            classpath*:spring/plugins/**/aps/**/**.xml
            classpath*:spring/plugins/**/apsadmin/**/**.xml
            classpath*:spring/[your app context]/aps/**/**.xml
        &lt;/param-value&gt;</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Add the environment variable declaration to the <em>src/main/config/context.xml</em> file:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;Environment name="applicationBaseURL" value="${profile.application.baseurl.protocol}://${profile.application.baseurl.hostname}${profile.application.baseurl.port.separator}${profile.application.baseurl.port}/${profile.application.name}/" type="java.lang.String" override="false" /&gt;
    &lt;Environment name="resourceRootURL" value="/resources/" type="java.lang.String" override="false" /&gt;
    &lt;Environment name="cmsResourceRootURL" value="/cmsresources/" type="java.lang.String" override="false" /&gt;
    &lt;Environment name="protectedResourceRootURL" value="/${profile.application.name}/protected/" type="java.lang.String" override="false" /&gt;</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_building_the_war_file"><a class="anchor" href="#_building_the_war_file"></a>BUILDING THE WAR FILE</h5>
<div class="paragraph">
<p><strong>To build the WAR file:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configure the platform-specific filter (<em>filter-development-unix</em> or <em>filter-development-windows</em>) and add your the database connection parameters.</p>
</li>
<li>
<p>Run <code>mvn clean jetty:run</code> to start the Entando application.</p>
</li>
<li>
<p>Verify in the Entando logs that your database schemas have been created and populated correctly.</p>
</li>
<li>
<p>Run <code>ant WAR-build-jboss</code> and deploy the generated artifact on JBoss.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_migrating_entando_applictions"><a class="anchor" href="#_migrating_entando_applictions"></a>5.9. MIGRATING ENTANDO APPLICTIONS</h3>
<div class="sect3">
<h4 id="_porting_from_entando_5_0_0_to_5_0_1"><a class="anchor" href="#_porting_from_entando_5_0_0_to_5_0_1"></a>5.9.1. PORTING FROM ENTANDO 5.0.0 TO 5.0.1</h4>
<div class="paragraph">
<p>Upgrading to Entando 5.0.1 requires you to complete two sets of steps.</p>
</div>
<div class="sect4">
<h5 id="_upgrade_your_database"><a class="anchor" href="#_upgrade_your_database"></a>UPGRADE YOUR DATABASE</h5>
<div class="sect5">
<h6 id="_upgrade_to_spring_security_and_remove_oltu"><a class="anchor" href="#_upgrade_to_spring_security_and_remove_oltu"></a>UPGRADE TO SPRING SECURITY AND REMOVE OLTU</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Execute the following query:<br>
<code><mark># DB *Serv </mark>#</code></p>
</li>
<li>
<p>Copy and past the following into your database client:<br></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>INSERT INTO api_oauth_consumers (consumerkey, consumersecret, name, description, callbackurl, scope, authorizedgranttypes, expirationdate, issueddate) VALUES ('appbuilder', '{bcrypt}$2a$10$axXuJXKHzgdmwQzBR3wvh.oSiiJp6On1pHxJgaBmwkRXnXqYqjhkK', 'Entando AppBuiler', 'Default Entando AppBuiler Consumer', NULL, 'read,write,trust', 'password,authorization_code,refresh_token,implicit', '2028-10-10 00:00:00', '2008-01-01 00:00:00');</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_upgrade_the_database_for_bpmpam_plugin"><a class="anchor" href="#_upgrade_the_database_for_bpmpam_plugin"></a>UPGRADE THE DATABASE FOR BPM/PAM PLUGIN</h6>
<div class="paragraph">
<p>If you are using the <em>entando-plugin-jpkiebpm</em>, you must add three columns to the <em>jpkiebpm_kieformoverride</em> table (in db *serv), to accommodate version changes.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the Integrations &gt; Components &gt; Red Hat PAM Config, click <strong>Overrides List</strong> to open the Entando Error Page.</p>
</li>
<li>
<p>Delete the old rows in the table or fill in appropriate values for the following columns:<br></p>
<div class="ulist">
<ul>
<li>
<p>ALTER TABLE jpkiebpm_kieformoverride ADD COLUMN sourceid text;<br></p>
</li>
<li>
<p>ALTER TABLE jpkiebpm_kieformoverride ADD COLUMN widgetinfoid integer;<br></p>
</li>
<li>
<p>ALTER TABLE jpkiebpm_kieformoverride ADD COLUMN active boolean;</p>
<div class="ulist">
<ul>
<li>
<p>widgetinfoid must be an ID of the table <em>jpkiebpm_widgetinfo</em></p>
</li>
<li>
<p>sourceid must be an ID of a configured BPM instance, defined inside the <em>sysconfig</em> table</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_upgrade_project_configuration"><a class="anchor" href="#_upgrade_project_configuration"></a>UPGRADE PROJECT CONFIGURATION</h5>
<div class="sect5">
<h6 id="_upgrade_to_struts_2_5_17"><a class="anchor" href="#_upgrade_to_struts_2_5_17"></a>UPGRADE TO STRUTS 2.5.17</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the <em>src/main/conf</em> and <em>src/main/conf/jboss</em> directories. From each directory, open the <em>web.xml</em> file and remove the listener class:<br>
<em>org.entando.entando.apsadmin.system.resource.EntandoPluginLabelListener</em></p>
</li>
<li>
<p>Open <em>pom.xml</em> and update the version of Struts2 in the Properties section from "2.5.10.1" to "2.5.17"</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_upgrade_to_spring_security_and_remove_oltu_2"><a class="anchor" href="#_upgrade_to_spring_security_and_remove_oltu_2"></a>UPGRADE TO SPRING SECURITY AND REMOVE OLTU</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the <em>src/main/conf</em> and <em>src/main/conf/jboss</em> directories. From each directory, open the <em>web.xml</em> file and remove the following:</p>
<div class="ulist">
<ul>
<li>
<p>definition of "cors" filter and its filter-mapping</p>
</li>
<li>
<p>definition of "AuthorizationServlet" and its servlet-mapping</p>
</li>
<li>
<p>definition of "AccessTokenServlet" and its servlet-mapping</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_porting_from_entando_5_0_0_to_5_1_0"><a class="anchor" href="#_porting_from_entando_5_0_0_to_5_1_0"></a>5.9.2. PORTING FROM ENTANDO 5.0.0 TO 5.1.0</h4>
<div class="paragraph">
<p>Upgrading to Entando 5.1 requires you to complete two sets of steps.</p>
</div>
<div class="sect4">
<h5 id="_upgrade_your_database_2"><a class="anchor" href="#_upgrade_your_database_2"></a>UPGRADE YOUR DATABASE</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To allow porting to 5.1.0 version from versions 4.3.3, 4.3.4, and 5.0.0, you need to run several update scripts (see below). These scripts create new columns and delete old ones, and also copy the values from the <em>groupcode</em> column of the Pages table to the <em>groupcode</em> column in the pages_metadata_online and pages_metadata_draft tables.</p>
</li>
<li>
<p>Execute the following queries:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>** -- ### DB *Port ###

-- copy/paste
ALTER TABLE pages_metadata_draft ADD COLUMN groupcode character varying(30);
ALTER TABLE pages_metadata_online ADD COLUMN groupcode character varying(30);
UPDATE pages_metadata_online SET groupcode = (SELECT pages.groupcode FROM pages WHERE pages_metadata_online.code = pages.code);
UPDATE pages_metadata_draft SET groupcode = (SELECT pages.groupcode FROM pages WHERE pages_metadata_draft.code = pages.code);
ALTER TABLE pages DROP groupcode;


INSERT INTO sysconfig (version, item, descr, config) VALUES ('production', 'jacms_resourceMetadataMapping', 'Mapping between resource Metadata and resource attribute fields', '&lt;mapping&gt;
    &lt;field key="alt"&gt;&lt;/field&gt;
    &lt;field key="description"&gt;&lt;/field&gt;
    &lt;field key="legend"&gt;&lt;/field&gt;
    &lt;field key="title"&gt;&lt;/field&gt;
&lt;/mapping&gt;');

-- ### DB *Serv ###


INSERT INTO _api_oauth_consumers_ (consumerkey, consumersecret, name, description, callbackurl, scope, authorizedgranttypes, expirationdate, issueddate) VALUES ('appbuilder', '{bcrypt}$2a$10$axXuJXKHzgdmwQzBR3wvh.oSiiJp6On1pHxJgaBmwkRXnXqYqjhkK', 'Entando AppBuiler', 'Default Entando AppBuiler Consumer', NULL, 'read,write,trust', 'password,authorization_code,refresh_token,implicit', '2028-10-10 00:00:00', '2008-01-01 00:00:00');</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_upgrade_your_project_configuration"><a class="anchor" href="#_upgrade_your_project_configuration"></a>UPGRADE YOUR PROJECT CONFIGURATION</h5>
<div class="sect5">
<h6 id="_upgrade_to_struts_2_5_17_2"><a class="anchor" href="#_upgrade_to_struts_2_5_17_2"></a>UPGRADE TO STRUTS 2.5.17</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the <em>src/main/conf</em> and <em>src/main/conf/jboss</em> directories. From each directory, open the <em>web.xml</em> files and remove the listener class:  <em>org.entando.entando.apsadmin.system.resource.EntandoPluginLabelListener</em></p>
</li>
<li>
<p>Open the <em>pom.xml</em> and update the version of Struts2 into the properties section; from "2.5.10.1" to "2.5.17"</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_upgrade_to_spring_security_and_remove_oltu_3"><a class="anchor" href="#_upgrade_to_spring_security_and_remove_oltu_3"></a>UPGRADE TO SPRING SECURITY AND REMOVE OLTU</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the <em>web.xml</em> file from both the <em>src/main/config</em> and <em>src/main/config/jboss</em> directories.</p>
</li>
<li>
<p>Remove the following from each <em>web.xml</em> file:</p>
<div class="ulist">
<ul>
<li>
<p>definition of "cors" filter and its filter-mapping</p>
</li>
<li>
<p>definition of "AuthorizationServlet" and its servlet-mapping</p>
</li>
<li>
<p>definition of "AccessTokenServlet" and its servlet-mapping</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. Consult the â€œList of Content Typesâ€ document for more details.
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. More details about pages and page models will be provide in a dedicated document.
</div>
<div class="footnote" id="_footnotedef_3">
<a href="#_footnoteref_3">3</a>. The Attachments name will be updated to the Documents name; the same for the Files label.
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-04-17 17:49:02 +0200
</div>
</div>
</body>
</html>