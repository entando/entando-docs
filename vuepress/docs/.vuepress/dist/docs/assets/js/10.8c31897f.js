(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{358:function(e,t,n){e.exports=n.p+"assets/img/openshift-routes-panel.b4956e8d.png"},359:function(e,t,n){e.exports=n.p+"assets/img/openshift-ingress-resources-panel.56f5bd81.png"},412:function(e,t,n){"use strict";n.r(t);var s=n(33),a=Object(s.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"ingressing"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ingressing"}},[e._v("#")]),e._v(" Ingressing")]),e._v(" "),s("h2",{attrs:{id:"what-is-an-ingress"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#what-is-an-ingress"}},[e._v("#")]),e._v(" What is an ingress")]),e._v(" "),s("p",[e._v("An Ingress is a Kuberntes resource which purpose is to expose HTTP and HTTPS routes from outside the cluster to services within the cluster. Traffic routing is controlled by rules defined on the Ingress resource.")]),e._v(" "),s("h2",{attrs:{id:"how-ingresses-are-used-in-an-entando-cluster"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#how-ingresses-are-used-in-an-entando-cluster"}},[e._v("#")]),e._v(" How ingresses are used in an Entando Cluster")]),e._v(" "),s("p",[e._v("When deploying an Entando Cluster, ingresses are generated for the resources that requires to be exposed to the outside world. The process of creating an ingress, setup the correct routes and the certificates is done by the via the Entando Operator and the entando custom resource controllers.")]),e._v(" "),s("h3",{attrs:{id:"keycloak-ingress"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#keycloak-ingress"}},[e._v("#")]),e._v(" Keycloak ingress")]),e._v(" "),s("p",[e._v("An dedicated ingress is created for keycloak to expose the authentication and authorization functionalities. Having a dedicated ingress is required to guarantee that both token issuing and token validation work correctly, even when the services using the keycloak instance are on different namespaces.")]),e._v(" "),s("h3",{attrs:{id:"cluster-infrastructure-ingress"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cluster-infrastructure-ingress"}},[e._v("#")]),e._v(" Cluster infrastructure ingress")]),e._v(" "),s("p",[e._v("Another ingress is created for the cluster infrastructure services in order to expose the api endpoint to interact with the cluster correctly")]),e._v(" "),s("h3",{attrs:{id:"entando-app-ingress"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#entando-app-ingress"}},[e._v("#")]),e._v(" Entando App ingress")]),e._v(" "),s("p",[e._v("Another ingress is automatically created to expose App builder, App engine and the Entando component manager, a service part of the ECR.\nThe three containers are served under the same domain, and this is beneficial as they are able to interact without cross-origin issues.")]),e._v(" "),s("p",[e._v("The Entando App ingress is also used when linking an Entando Plugin with and Entando App, operation that usually happens when a bundle containing an Entando Plugin is installed via the ECR in an Entando App. Check out the dedicated section for details.")]),e._v(" "),s("h3",{attrs:{id:"entando-plugin-ingress"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#entando-plugin-ingress"}},[e._v("#")]),e._v(" Entando Plugin ingress")]),e._v(" "),s("p",[e._v("Also Entando Plugins are automatically exposed via an ingress when deployed in an Entando Cluster.")]),e._v(" "),s("h2",{attrs:{id:"default-ingress-http-routes"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#default-ingress-http-routes"}},[e._v("#")]),e._v(" Default Ingress HTTP Routes")]),e._v(" "),s("p",[e._v("In this table you can see what are the default routes that are exposed for each ingress\n"),s("table",[s("colgroup",[s("col",{attrs:{width:"50%"}}),e._v(" "),s("col",{attrs:{width:"50%"}})]),e._v(" "),s("thead",[s("tr",{staticClass:"header"},[s("th",{attrs:{align:"left"}},[e._v("Ingress")]),e._v(" "),s("th",{attrs:{align:"left"}},[e._v("Ingress Http route")]),e._v(" "),s("th",{attrs:{align:"left"}},[e._v("Application")])])]),e._v(" "),s("tbody",[s("tr",{staticClass:"odd"},[s("td",{attrs:{align:"left"}},[s("p",[e._v("Keycloak ingress")])]),e._v(" "),s("td",{attrs:{align:"left"}},[s("p",[s("code",[e._v("/auth")])])]),e._v(" "),s("td",{attrs:{align:"left"}},[s("p",[e._v("Keycloak")])])]),e._v(" "),s("tr",{staticClass:"even"},[s("td",{attrs:{align:"left"}},[s("p",[e._v("Entando cluster infrastructure ingress")])]),e._v(" "),s("td",{attrs:{align:"left"}},[s("p",[s("code",[e._v("/k8s")])])]),e._v(" "),s("td",{attrs:{align:"left"}},[s("p",[e._v("Entando K8S service")])])]),e._v(" "),s("tr",{staticClass:"odd"},[s("td",{attrs:{align:"left",rowspan:"4"}},[s("p",[e._v("Entando App ingress")])]),e._v(" "),s("td",{attrs:{align:"left"}},[s("p",[s("code",[e._v("/entando-de-app")])])]),e._v(" "),s("td",{attrs:{align:"left"}},[s("p",[e._v("App engine")])])]),e._v(" "),s("tr",{staticClass:"even"},[s("td",{attrs:{align:"left"}},[s("p",[s("code",[e._v("/app-builder/")])])]),e._v(" "),s("td",{attrs:{align:"left"}},[s("p",[e._v("App builder")])])]),e._v(" "),s("tr",{staticClass:"odd"},[s("td",{attrs:{align:"left"}},[s("p",[s("code",[e._v("/digital-exchange")])])]),e._v(" "),s("td",{attrs:{align:"left"}},[s("p",[e._v("Entando component manager")])])]),e._v(" "),s("tr",{staticClass:"even"},[s("td",{attrs:{align:"left"}},[s("p",[s("code",[e._v("/<plugin-ingressPath>")])])]),e._v(" "),s("td",{attrs:{align:"left"}},[s("p",[e._v("Entando plugin linked to the app")])])]),e._v(" "),s("tr",{staticClass:"odd"},[s("td",{attrs:{align:"left"}},[s("p",[e._v("Entando plugin ingress")])]),e._v(" "),s("td",{attrs:{align:"left"}},[s("p",[s("code",[e._v("/<plugin-ingressPath>")])])]),e._v(" "),s("td",{attrs:{align:"left"}},[s("p",[e._v("Entando plugin")])])])])])]),e._v(" "),s("p",[s("strong",[e._v("Note")]),e._v(": The Entando plugin "),s("code",[e._v("ingressPath")]),e._v(" variable is defined in the Entando Plugin custom resource under the "),s("code",[e._v("spec")]),e._v(" element. The plugin ingress path is also used to expose the plugin under the Entando App domain")]),e._v(" "),s("h2",{attrs:{id:"exposing-plugins-in-the-entandoapp-domain"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#exposing-plugins-in-the-entandoapp-domain"}},[e._v("#")]),e._v(" Exposing plugins in the EntandoApp domain")]),e._v(" "),s("p",[e._v("The process of exposing an Entando Plugin under the same domain (ingress) of the Entando App is made possible from the creation of an "),s("code",[e._v("EntandoAppPluginLink")]),e._v(" custom resource and the corresponding controller.")]),e._v(" "),s("p",[e._v("Once the link between the Entando App and the Entando Plugin is created, the controller reads the specification of such link and automatically creates the HTTP routes in the Entando App so that the plugin is exposed on the same domain as the App builder, App engine and Component manager.")]),e._v(" "),s("p",[e._v("This allows the Microfrontend developers that need to access the plugin to not worry about CORS policy or knowing what is the full path where the plugin is exposed. The plugin is referencable using relative urls.")]),e._v(" "),s("h2",{attrs:{id:"how-to-check-ingresses-in-my-cluster"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#how-to-check-ingresses-in-my-cluster"}},[e._v("#")]),e._v(" How to check ingresses in my cluster")]),e._v(" "),s("h3",{attrs:{id:"using-the-openshift-dashboard"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-the-openshift-dashboard"}},[e._v("#")]),e._v(" Using the Openshift dashboard")]),e._v(" "),s("p",[e._v("On the Openshift dashboard, Ingresses are not exposed directly as pods and deployments. The dashbaord provides direct access to the Ingress Routes (or simply routes) under the "),s("code",[e._v("Applications > Routes")]),e._v(" menu.")]),e._v(" "),s("p",[s("img",{attrs:{src:n(358),alt:"Routes panel"}})]),e._v(" "),s("p",[e._v("To see the ingress resources, you need to access them from the "),s("code",[e._v("Resources > Other resources")]),e._v(" menu. From the dropdown you should select the "),s("code",[e._v("Ingress")]),e._v(" resource and therefore you should be able to see the ingress available on that specific project/namespace")]),e._v(" "),s("p",[s("img",{attrs:{src:n(359),alt:"Ingress panel"}})]),e._v(" "),s("h3",{attrs:{id:"using-kubectl-from-the-command-line"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-kubectl-from-the-command-line"}},[e._v("#")]),e._v(" Using kubectl from the command line")]),e._v(" "),s("p",[e._v("From the command line, getting the ingress is very easy. Once you know the namespace(s) where your Entando Cluster is deployed, you simply need to use the")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("kubect get ingresses.extensions -n <namespace>\n")])])]),s("p",[e._v("Here an example of the result in a test namespace")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("> kubectl get ingresses.extensions -n local\n\nNAME               CLASS    HOSTS                               ADDRESS     PORTS   AGE\nqst-eci-ingress   <none>   qst-eci-local.192.168.1.9.nip.io   127.0.0.1   80      2d1h\nqst-ingress       <none>   qst-local.192.168.1.9.nip.io       127.0.0.1   80      2d1h\nqst-kc-ingress    <none>   qst-kc-local.192.168.1.9.nip.io    127.0.0.1   80      2d1h\n")])])]),s("p",[e._v("To get more details about a specific ingress, you can use the "),s("code",[e._v("get")]),e._v(" command specifing the ingress name you want to check and the "),s("code",[e._v("yaml")]),e._v(" output format")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('> kubectl get ingresses.extensions -n local qst-ingress -o yaml\n\napiVersion: extensions/v1beta1\nkind: Ingress\nmetadata:\n  creationTimestamp: "2020-05-13T15:27:08Z"\n  generation: 1\n  labels:\n    EntandoApp: qst\n  managedFields:\n  - apiVersion: extensions/v1beta1\n    fieldsType: FieldsV1\n    fieldsV1:\n      f:status:\n        f:loadBalancer:\n          f:ingress: {}\n    manager: nginx-ingress-controller\n    operation: Update\n    time: "2020-05-13T15:27:08Z"\n  name: qst-ingress\n  namespace: local\n  ownerReferences:\n  - apiVersion: entando.org/v1\n    blockOwnerDeletion: true\n    controller: true\n    kind: EntandoApp\n    name: qst\n    uid: aa7053e1-fd8b-419f-bdee-df3018c013fa\n  resourceVersion: "16802097"\n  selfLink: /apis/extensions/v1beta1/namespaces/local/ingresses/qst-ingress\n  uid: e9b6f027-369a-4b84-b4b1-736a6e49f180\nspec:\n  rules:\n  - host: qst-local.192.168.1.9.nip.io\n    http:\n      paths:\n      - backend:\n          serviceName: qst-server-service\n          servicePort: 8080\n        path: /entando-de-app\n        pathType: ImplementationSpecific\n      - backend:\n          serviceName: qst-server-service\n          servicePort: 8083\n        path: /digital-exchange\n        pathType: ImplementationSpecific\n      - backend:\n          serviceName: qst-server-service\n          servicePort: 8081\n        path: /app-builder/\n        pathType: ImplementationSpecific\nstatus:\n  loadBalancer:\n    ingress:\n    - ip: 127.0.0.1\n')])])]),s("h2",{attrs:{id:"learn-more"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#learn-more"}},[e._v("#")]),e._v(" Learn more")]),e._v(" "),s("p",[e._v("For more details about ingress concept in Kubernetes please refer to the official documentation:")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/services-networking/ingress/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Kubernetes Ingress documentation"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://docs.openshift.com/container-platform/3.11/architecture/networking/routes.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Openshift Routes documentation"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=a.exports}}]);