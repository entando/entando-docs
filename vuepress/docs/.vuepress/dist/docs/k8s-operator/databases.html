<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Managing Entando 6 Databases</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="Entando Tutorials">
    <link rel="preload" href="/docs/assets/css/0.styles.4ae98744.css" as="style"><link rel="preload" href="/docs/assets/js/app.ac2606e0.js" as="script"><link rel="preload" href="/docs/assets/js/2.2b69620a.js" as="script"><link rel="preload" href="/docs/assets/js/35.0254db92.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.8dc8f3bf.js"><link rel="prefetch" href="/docs/assets/js/11.e004b62f.js"><link rel="prefetch" href="/docs/assets/js/12.bb9a08de.js"><link rel="prefetch" href="/docs/assets/js/13.cae62e3b.js"><link rel="prefetch" href="/docs/assets/js/14.2b5cc2d2.js"><link rel="prefetch" href="/docs/assets/js/15.02ad98b7.js"><link rel="prefetch" href="/docs/assets/js/16.46ac37a5.js"><link rel="prefetch" href="/docs/assets/js/17.428fe847.js"><link rel="prefetch" href="/docs/assets/js/18.ea0cd3a9.js"><link rel="prefetch" href="/docs/assets/js/19.409eeea8.js"><link rel="prefetch" href="/docs/assets/js/20.2bc20242.js"><link rel="prefetch" href="/docs/assets/js/21.3b80a102.js"><link rel="prefetch" href="/docs/assets/js/22.cd4f7af7.js"><link rel="prefetch" href="/docs/assets/js/23.10ec089c.js"><link rel="prefetch" href="/docs/assets/js/24.5a44fbee.js"><link rel="prefetch" href="/docs/assets/js/25.7c23e591.js"><link rel="prefetch" href="/docs/assets/js/26.8bb62150.js"><link rel="prefetch" href="/docs/assets/js/27.8bed9c1c.js"><link rel="prefetch" href="/docs/assets/js/28.c63a9aea.js"><link rel="prefetch" href="/docs/assets/js/29.12e3649d.js"><link rel="prefetch" href="/docs/assets/js/3.89dec58e.js"><link rel="prefetch" href="/docs/assets/js/30.2179a668.js"><link rel="prefetch" href="/docs/assets/js/31.2c4d4680.js"><link rel="prefetch" href="/docs/assets/js/32.5eadfbf6.js"><link rel="prefetch" href="/docs/assets/js/33.79d6a5b3.js"><link rel="prefetch" href="/docs/assets/js/34.42c85203.js"><link rel="prefetch" href="/docs/assets/js/36.74812f8b.js"><link rel="prefetch" href="/docs/assets/js/37.90a1952b.js"><link rel="prefetch" href="/docs/assets/js/38.b73b14da.js"><link rel="prefetch" href="/docs/assets/js/39.b67ce936.js"><link rel="prefetch" href="/docs/assets/js/4.b2bc02cb.js"><link rel="prefetch" href="/docs/assets/js/40.a5bf1d86.js"><link rel="prefetch" href="/docs/assets/js/41.6649141c.js"><link rel="prefetch" href="/docs/assets/js/42.1f69836a.js"><link rel="prefetch" href="/docs/assets/js/43.6c0527ba.js"><link rel="prefetch" href="/docs/assets/js/44.3bbd73a8.js"><link rel="prefetch" href="/docs/assets/js/45.5ae9d47f.js"><link rel="prefetch" href="/docs/assets/js/46.5ed0be82.js"><link rel="prefetch" href="/docs/assets/js/5.78a559b5.js"><link rel="prefetch" href="/docs/assets/js/6.7faebc8a.js"><link rel="prefetch" href="/docs/assets/js/7.e9ba50de.js"><link rel="prefetch" href="/docs/assets/js/8.0673201b.js"><link rel="prefetch" href="/docs/assets/js/9.5d0c1414.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.4ae98744.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><img src="/docs/entando-labs.svg" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="http://docs.entando.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Docs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://forum.entando.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Forum
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://www.entando.com/page/en/modern_applications_blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://www.entando.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Entando.com
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/entando" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/entando/entando-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="http://docs.entando.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Docs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://forum.entando.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Forum
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://www.entando.com/page/en/modern_applications_blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://www.entando.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Entando.com
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/entando" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/entando/entando-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/docs/" class="sidebar-heading clickable router-link-active"><span>Getting Started</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Platform Capabilities</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Concepts</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/docs/micro-frontends/" class="sidebar-heading clickable"><span>Micro Frontends</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Kubernetes</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/k8s-operator/entando6-cluster-citizens.html" class="sidebar-link">Entando 6 cluster citizens</a></li><li><a href="/docs/k8s-operator/tutorials/how-to-connect-to-external-keycloak.html" class="sidebar-link">Tutorial: How to connect Entando 6 to an external Keycloak instance</a></li><li><a href="/docs/k8s-operator/databases.html" class="active sidebar-link">Managing Entando 6 Databases</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/k8s-operator/databases.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/docs/k8s-operator/databases.html#lightweight-low-config-databases-with-postgresql-and-mysql" class="sidebar-link">Lightweight, low-config Databases with PostgreSQL and MySQL</a></li><li class="sidebar-sub-header"><a href="/docs/k8s-operator/databases.html#existing-external-databases" class="sidebar-link">Existing External Databases</a></li><li class="sidebar-sub-header"><a href="/docs/k8s-operator/databases.html#vendor-specific-notes" class="sidebar-link">Vendor specific notes</a></li></ul></li><li><a href="/docs/k8s-operator/connecting-external-db.html" class="sidebar-link">Tutorial: Connecting to an External Database</a></li><li><a href="/docs/k8s-operator/add_datasource_to_eap_image.html" class="sidebar-link">Steps to include a new datasource in EAP Server image</a></li></ul></section></li></ul></section></li><li><a href="/docs/release-notes/" class="sidebar-link">Release Notes</a></li><li><a href="/docs/old-versions/" class="sidebar-link">Old Versions</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="managing-entando-6-databases"><a href="#managing-entando-6-databases" class="header-anchor">#</a> Managing Entando 6 Databases</h1> <h2 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h2> <p>Entando’s Docker images currently support three different relational
database management systems: PostgreSQL, MySQL and Oracle. With
PostgreSQL and MySQL, by default, Entando’s will automatically create a
Kubernetes Deployment hosting the database management systems. However,
for Oracle, and also for other scenarios that may require it, Entando
supports connectivity to existing external databases. This document
provides the user with the necessary information to decide how to manage
Entando’s databases.</p> <h2 id="lightweight-low-config-databases-with-postgresql-and-mysql"><a href="#lightweight-low-config-databases-with-postgresql-and-mysql" class="header-anchor">#</a> Lightweight, low-config Databases with PostgreSQL and MySQL</h2> <p>When deploying Entando Custom Resources that require databases to a new
Namespace, the default behavior for Entando is to create a Kubernetes
Deployment. It uses the standard Openshift compliant images:</p> <ul><li><p>centos/mysql-57-centos7 and</p></li> <li><p>centos/postgresql-96-centos7)</p></li></ul> <p>This is a fairly low-configuration approach, as Entando will create and
initialize the databases transparently. Persistent data is stored on any
Persistent Volume that meets our Persistent Volume Claim requirements.
When an Entando Custom Resource is redeployed, the Persistent Volumes
remain in tact. Since the subsequent data initialization is idempotent,
the supporting Deployments will scale up and behave as expected.</p> <p>Generally our services encapsulate the database they use entirely, and
provide facilities to import and export the data without needing any
knowledge of the internal workings of the underlying data store. For
most simple Entando Apps the database doesn’t grow too large and is
fairly easy to manage. This state of affairs allowed us to keep our
databases isolated from each other, thus allowing for isolated
deployments without needing complex coordination of database migration
for the different deployment pipelines.</p> <p>It is worth noting that these database Deployments are not clustered.
The customer is therefore strongly advised to provide redundancy and
clustering in the form of clustered storage. These database deployments
do specify a restartPolicy of 'Always', so in the event of a
non-corrupting failure, the database Pod should therefore restart in
about 30 seconds. This by no means offers the features of a full
database cluster, but may suffice for many scenarios.</p> <p>However, in more advanced use cases, such as the use of our CMS
functionality, this simplistic approach may not scale. And where there
is a a centralized database admin team, or where there is a requirement
to comply to strict organizational governance w.r.t. databases, this
approach does result in a multitude of databases that may be difficult
for the database admin team to manage.</p> <h2 id="existing-external-databases"><a href="#existing-external-databases" class="header-anchor">#</a> Existing External Databases</h2> <p>For this reason, Entando can also be configured to use an existing
database service provided by the customer. In these scenarios, the
customer is expected to take responbility for the lower level database
operations such as tablespace creation, permissions and clustering.
Entando will however still be responsible for creating and populating
the tables, indices and foreing keys. Entando will also create all of
these in the appropriate table 'container' for the DBMS in question such
as a schema (Oracle/PostgreSQL) or a database (MySQL). In order to
achieve this, Entando installs a dedicated CustomResourceDefinition in
Kubernetes, called an 'EntandoDatabaseService'</p> <p>The idea is for EntandoDatabaseService custom resources to be created in
the namespace the EntandoApps and EntandoPlugin that should use them
will be created. The EntandoDatabaseService is usually created along
with a secret that carries admin credentials to the database in
question.</p> <h3 id="structure"><a href="#structure" class="header-anchor">#</a> Structure</h3> <p>The EntandoDatabaseService custom resource looks like this:</p> <div class="language- extra-class"><pre><code> EntandoDatabaseService
metadata:
  name: string, any K8S compliant name
  namespace: string, the namespace this will be created in
spec:
  dbms: string, one of oracle, postgresql or mysql
  host: string, either an ip address or hostname where the database service is hosted
  port: integer, the port on which the database service is hosted
  databaseName: string, the name of the database, only required for PostgreSQL and Oracle
  secretName: the name of the Secret in the same namespace carrying admin credentials to the database service
  tablespace: (Oracle only)  the tablespace to use to create the required schemas in
  jdbcParameters: a map containing name-value pairs for any additional parameters required for the JDBC driver to connect to the database.
</code></pre></div><p>The Secret that will provide the admin credentials, identified by the
above <code>secretName</code> should look like this:</p> <div class="language- extra-class"><pre><code>Secret:
  name: string, any K8S compliant name
  namespace: string, the namespace this will be created in
  stringData:
    username: string, name of an admin user that can create schemas and other users
    password: string, password of the above user
</code></pre></div><h3 id="how-it-works"><a href="#how-it-works" class="header-anchor">#</a> How it works</h3> <p>In order for the EntandoApp and EntandoPlugin deployer to pick up the
correct database service, the EntandoDatabaseService needs to be created
BEFORE the EntandoApps and EntandoPlugins are created. There can be
multiple EntandoDatabaseServices in the namespace, but they need to
point to database services of different vendors, i.e. PostgreSQL, Oracle
and MySQL. Entando currently cannot enforce any validation but if there
are two EntandoDatabaseServices that have the same DBMS vendor, it will
simply pick the first one and continue. Please ensure that only one
EntandoDatabaseService exists for each DBMS vendor you need to use.</p> <p>Once the appropriate EntandoDatabaseServices have been created, any
EntandoApp or EntandoPlugin that is created will have to specify the
appropriate DBMS vendor in their <code>spec.dbms</code> property. If the
EntandoOperator detects an EntandoDatabaseService with a matching DBMS
vendor, it will continue to create the necessary schemas on the specific
database. If the EntandoOperator does not detect an
EntandoDatabaseService with a matching DBMS vendor, it will fall back
onto its default behaviour which is to create a matching Deployment and
spin up a database service from the same namespace. If the <code>spec.dbms</code>
property is not specified on an EntandoApp, the EntandoOperator will
default to PostgreSQL. If the <code>spec.dbms</code> property is not specified on
an EntandoPlugin, the EntandoOperator will assume that the EntandoPlugin
in question does not require a database and hence bypass any database
and schema creation.</p> <p>When the EntandoOperator processes your Entandoapp or EntandoPlugin with
an appropriate <code>spec.dbms</code> specified, it will create a Schema/User pair
for each datasource required. A typical EntandoApp deployment requires 3
datasources (portdb,servdb and dedb). Plugins generally only require one
datasource (plugindb).</p> <p>The database schema and user created will have the same name. The name
is derived from the name of the EntandoPlugin or EntandoApp by replacing
all characters that are not ANSI-SQL compliant with an underscore. The
datasource name is then suffixed to the schema name. When defining the
name of your app or plugin, please keep in mind that some DBMS vendors
do not support long schema names. Future versions of Entando will allow
you to override the schema prefix for an app or plugin, but for now this
is a limitation one has to keep in mind.</p> <h3 id="keeping-track-of-credentials"><a href="#keeping-track-of-credentials" class="header-anchor">#</a> Keeping track of credentials</h3> <p>The EntandoOperator generates a Kubernetes Secret for each schema/user
combination it creates. The name of this secret is the concatenation of
the name of the EntandoApp or EntandoPlugin, the datasource qualifier
and then the suffix &quot;-secret&quot;. For instance, for an EntandoApp called
&quot;my-app&quot; the &quot;portdb&quot; datasource will have a corresponding Kubernetes
Secret called &quot;my-app-portdb-secret&quot;. The EntandoOperator will never
overwrite or update an existing database secret. We generate a random
string for the password which is generally considered the safest
approach. If you do however wish to change the password in for the
resulting user, please remember to update the password on the Kubernetes
Secret too. Such an operation is however error prone and could result in
subsequent deployments failing.</p> <p>The EntandoOperator’s schema creation logic is idempotent. If it
therefore finds that the generated schema/user combination found in the
associated Kuberentes Secret already exists, it won’t do anything.
However, it will attempt to log in, and if it fails to log in, it will
attempt to create the user. If the user already exists, but with a
different password than the one in the Kubernetes Secret, all subsequent
deployment operations will fail.</p> <h2 id="vendor-specific-notes"><a href="#vendor-specific-notes" class="header-anchor">#</a> Vendor specific notes</h2> <h3 id="oracle"><a href="#oracle" class="header-anchor">#</a> Oracle</h3> <h4 id="example"><a href="#example" class="header-anchor">#</a> Example</h4> <div class="language- extra-class"><pre><code>  EntandoDatabaseService
    metadata:
      name:oracle-service
    spec:
      dbms: oracle
      host: 10.0.0.13
      port: 1521
      databaseName: ORCLPDB1.localdomain
      secretName: oracle-secret
      tablespace: entando_ts
      jdbcParameters: {}
  Secret:
    metadata:
      name: oracle-secret
    stringData:
      username: admin
      password: admin123
</code></pre></div><h4 id="resulting-connection-string"><a href="#resulting-connection-string" class="header-anchor">#</a> Resulting connection string:</h4> <p>jdbc:oracle:thin:@//10.0.0.13:1521/ORCLPDB1.localdomain</p> <h3 id="notes"><a href="#notes" class="header-anchor">#</a> Notes</h3> <p>Oracle has some rather complicated rules in building the correct
connection string. Please note that for the sake of portability and
lightweight image we are limited to the thin driver. The <code>databaseName</code>
could also be an Oracle service as opposed to an Oracle <code>SID</code>. Please
coordinate with your Oracle DB Admin to determine exactly what value to
use here. We strongly recommend testing your settings with some code or
a tool that constructs JDBC connection.</p> <p>When the EntandoOperator prepares the schemas for your EntandoApp or
EntandoPlugin, it will create a user for every datasource required, and
as is standard behaviour for Oracle, that user will have its own schema
with the same name. Permissions are set up to ensure that one user
cannot access tables from another user’s schema. Please note that Oracle
limits schema names to 30 characters. If you intend to use Oracle,
please keep the name of your apps and plugins short enough. The suffixes
that we append to the app or plugin name to ensure the resulting schema
name is unique are usually shorter than 8 characters, so names of about
20 characters should be safe.</p> <p>You can specify which tablespace Entando should use to create the
schemas in using the <code>spec.tablespace</code> property</p> <h4 id="ora-01704-string-literal-too-long"><a href="#ora-01704-string-literal-too-long" class="header-anchor">#</a> ORA-01704: string literal too long</h4> <p>Entando requires extended datatypes to be activated in Oracle 12c and
higher
(<a href="https://oracle-base.com/articles/12c/extended-data-types-12cR1" target="_blank" rel="noopener noreferrer">https://oracle-base.com/articles/12c/extended-data-types-12cR1<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>)</p> <h3 id="mysql"><a href="#mysql" class="header-anchor">#</a> MySQL</h3> <h4 id="example-2"><a href="#example-2" class="header-anchor">#</a> Example</h4> <div class="language- extra-class"><pre><code>EntandoDatabaseService
  metadata:
    name:mysql-service
  spec:
    dbms: mysql
    host: 10.0.0.13
    port: 3306
    databaseName:
    secretName: mysql-secret
    jdbcParameters:
       useSSL: &quot;true&quot;
Secret:
  metadata:
    name: mysql-secret
  stringData:
    username: admin
    password: admin123
</code></pre></div><h3 id="resulting-connection-string-2"><a href="#resulting-connection-string-2" class="header-anchor">#</a> Resulting Connection String</h3> <p>jdbc:mysql://10.0.0.13:3306</p> <h3 id="notes-2"><a href="#notes-2" class="header-anchor">#</a> Notes</h3> <p>MySQL doesn’t really support schemas, or more accurately, it doesn’t
distinguish between schemas and databases. For this reason, no
databaseName is required. The EntandoOperator will therefore create an
entirely new database for each datasource your EntandoApp or
EntandoPlugin requires. It will also create a user with the same name as
the database with permission set up to ensure one user cannot access the
database of another user. Please note that MySQL limits database names
to 63 characters. Keep this in mind when defining the names of your
EntandoApps and EntandoPlugins</p> <h3 id="postgresql"><a href="#postgresql" class="header-anchor">#</a> PostgreSQL</h3> <h4 id="example-3"><a href="#example-3" class="header-anchor">#</a> Example</h4> <div class="language- extra-class"><pre><code>  EntandoDatabaseService
    metadata:
      name:postgresql-service
    spec:
      dbms: postgresql
      host: 10.0.0.13
      port: 5432
      databaseName: my_db
      secretName: postgresql-secret
      jdbcParameters: {}

  Secret:
    metadata:
      name: postgresql-secret
    stringData:
      username: admin
      password: admin123
</code></pre></div><h4 id="resulting-connection-string-3"><a href="#resulting-connection-string-3" class="header-anchor">#</a> Resulting Connection String</h4> <p>jdbc:postgresql://10.0.0.13:5432/my_db</p> <h4 id="notes-3"><a href="#notes-3" class="header-anchor">#</a> Notes</h4> <p>PostgreSQL behaves very similar to Oracle when it comes to how it
associates a user with its own schema. The current username is used as a
default schema/prefix to resolve tables. As with Oracle, Entando ensures
that two users don’t have access to each other’s schemas.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/entando/entando-docs/edit/master/vuepress/docs/k8s-operator/databases.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/27/2020, 8:31:29 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/k8s-operator/tutorials/how-to-connect-to-external-keycloak.html" class="prev">
        Tutorial: How to connect Entando 6 to an external Keycloak instance
      </a></span> <span class="next"><a href="/docs/k8s-operator/connecting-external-db.html">
        Tutorial: Connecting to an External Database
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.ac2606e0.js" defer></script><script src="/docs/assets/js/2.2b69620a.js" defer></script><script src="/docs/assets/js/35.0254db92.js" defer></script>
  </body>
</html>
