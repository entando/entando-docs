<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Entando&#39;s Custom Resources for Kubernetes</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="Entando Docs">
    <link rel="preload" href="/docs/assets/css/0.styles.45470058.css" as="style"><link rel="preload" href="/docs/assets/js/app.e2723373.js" as="script"><link rel="preload" href="/docs/assets/js/2.e917390b.js" as="script"><link rel="preload" href="/docs/assets/js/31.cad899bc.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.a3d45e06.js"><link rel="prefetch" href="/docs/assets/js/11.cd86610c.js"><link rel="prefetch" href="/docs/assets/js/12.bf2d0d4f.js"><link rel="prefetch" href="/docs/assets/js/13.f7546f17.js"><link rel="prefetch" href="/docs/assets/js/14.af98f362.js"><link rel="prefetch" href="/docs/assets/js/15.40ee8c0b.js"><link rel="prefetch" href="/docs/assets/js/16.3fa49bf9.js"><link rel="prefetch" href="/docs/assets/js/17.da7cde27.js"><link rel="prefetch" href="/docs/assets/js/18.415c91c5.js"><link rel="prefetch" href="/docs/assets/js/19.ccf1b8c2.js"><link rel="prefetch" href="/docs/assets/js/20.4ca898a0.js"><link rel="prefetch" href="/docs/assets/js/21.b0811fd3.js"><link rel="prefetch" href="/docs/assets/js/22.df59894c.js"><link rel="prefetch" href="/docs/assets/js/23.639b95c5.js"><link rel="prefetch" href="/docs/assets/js/24.b3314d56.js"><link rel="prefetch" href="/docs/assets/js/25.236cc076.js"><link rel="prefetch" href="/docs/assets/js/26.33d1514e.js"><link rel="prefetch" href="/docs/assets/js/27.ce685cf4.js"><link rel="prefetch" href="/docs/assets/js/28.a6bbfcc8.js"><link rel="prefetch" href="/docs/assets/js/29.33c21fd8.js"><link rel="prefetch" href="/docs/assets/js/3.c5aed261.js"><link rel="prefetch" href="/docs/assets/js/30.367c4cb6.js"><link rel="prefetch" href="/docs/assets/js/32.fd8f5bf9.js"><link rel="prefetch" href="/docs/assets/js/33.1e91390e.js"><link rel="prefetch" href="/docs/assets/js/34.f8e8a3e9.js"><link rel="prefetch" href="/docs/assets/js/35.2d9e98f9.js"><link rel="prefetch" href="/docs/assets/js/36.3c620450.js"><link rel="prefetch" href="/docs/assets/js/37.265590f1.js"><link rel="prefetch" href="/docs/assets/js/38.2f44a9e0.js"><link rel="prefetch" href="/docs/assets/js/39.c7f331ae.js"><link rel="prefetch" href="/docs/assets/js/4.2b26f0e4.js"><link rel="prefetch" href="/docs/assets/js/40.91f8bfcb.js"><link rel="prefetch" href="/docs/assets/js/41.be8e53ca.js"><link rel="prefetch" href="/docs/assets/js/42.237ac420.js"><link rel="prefetch" href="/docs/assets/js/43.6fde5cc8.js"><link rel="prefetch" href="/docs/assets/js/44.f101d1ce.js"><link rel="prefetch" href="/docs/assets/js/45.1c50f1eb.js"><link rel="prefetch" href="/docs/assets/js/46.027db281.js"><link rel="prefetch" href="/docs/assets/js/47.7f5176a2.js"><link rel="prefetch" href="/docs/assets/js/48.04e41c98.js"><link rel="prefetch" href="/docs/assets/js/49.89ea7acb.js"><link rel="prefetch" href="/docs/assets/js/5.2cb12f0b.js"><link rel="prefetch" href="/docs/assets/js/50.889a81cd.js"><link rel="prefetch" href="/docs/assets/js/51.c89e704e.js"><link rel="prefetch" href="/docs/assets/js/52.c616829f.js"><link rel="prefetch" href="/docs/assets/js/53.30e09b2c.js"><link rel="prefetch" href="/docs/assets/js/54.cc7528cf.js"><link rel="prefetch" href="/docs/assets/js/55.4eb4f4e9.js"><link rel="prefetch" href="/docs/assets/js/6.5b44d506.js"><link rel="prefetch" href="/docs/assets/js/7.6a1320f6.js"><link rel="prefetch" href="/docs/assets/js/8.af418605.js"><link rel="prefetch" href="/docs/assets/js/9.f0abdb17.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.45470058.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><img src="/docs/Entando_Logo_White.svg" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="http://docs.entando.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Docs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://forum.entando.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Forum
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://www.entando.com/page/en/modern_applications_blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://www.entando.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Entando.com
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/entando" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/entando/entando-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="http://docs.entando.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Docs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://forum.entando.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Forum
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://www.entando.com/page/en/modern_applications_blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://www.entando.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Entando.com
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/entando" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/entando/entando-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/docs/" class="sidebar-link">Overview</a></li><li><a href="/docs/getting-started/" class="sidebar-link">Getting Started</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Platform Capabilities</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Concepts</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/docs/release-notes/" class="sidebar-link">Release Notes</a></li><li><a href="/docs/old-versions/" class="sidebar-link">Old Versions</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="entando-s-custom-resources-for-kubernetes"><a href="#entando-s-custom-resources-for-kubernetes" class="header-anchor">#</a> Entando's Custom Resources for Kubernetes</h1> <h2 id="objective"><a href="#objective" class="header-anchor">#</a> Objective</h2> <p>This document provides an overview of the Entando Kubernetes Custom Resources and their semantics in Entando 6.</p> <h2 id="prequesites"><a href="#prequesites" class="header-anchor">#</a> Prequesites</h2> <ul><li>Basic knowledge of Kubernetes and how to deploy Docker images to it</li> <li>Basic knowledge of Helm and how Helm Charts use YAML templates for parameterized deployments to Kubernetes</li></ul> <h2 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h2> <p>Amongst the many features it offers, Kubernetes also comes with a REST API that for dozens of different resources types.
Generally these API off full Create/Retrieve/Update/Delete (CRUD) access to each of the resource types. We
typically format these resources in YAML or JSON and use commandline tools such as
<code>kubectl</code> or <code>oc</code> to manage them. Each of these resources has a clearly defined structure
that is well documented in the <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/" target="_blank" rel="noopener noreferrer">Kubernetes API<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> .
Kubernetes  also allows clients to subscribe to events generated as these resources get updated. These subscriptions
are called 'watches' and allow clients to be notified whenever the state of a resource changes. Kubernetes also
enforces very strong role based access control (RBAC) support on all resources, with permissions down to the level
of granularity of operation (Create/Retrieve/Update/Delete/Watch) per resource.</p> <p>The basic architecture for Kubernetes worked so well for the developers of Kubernetes that they decided to also make it
available to third  party developers. Kubernetes now offers a mechanism to allow 3rd parties to provide its own custom
resource types that still leverage the CRUD support, event subscriptions and RBAC provided by Kubernetes out of the box.
This mechanism is referred to as Custom Resources.</p> <p>Custom Resources are very commonly used with Kubernetes Operators. Operators are Docker images that have been
deployed to Kubernetes Deployments. The generally observe a set of custom resources and perform some operations against
the Kubernetes API to reflect the state changes in the Custom Resource. We can say that the Custom Resources are associated
with specific semantics in how they are translated to</p> <p>One can introduce a new Custom Resource into Kubernetes by registering a Custom Resource Definition (CRD). This is really
just another yaml or json resource that defines the structure of the Custom Resource to be installed using the OpenAPI
JSON Schema format. When talking about Custom Resources, it is very important to distinguish between Custom Resource
Definitions and Custom Resources. CRD's are static type definitions provided by an Operator
provider such as Entando. For those familiar with programming languages, CRD's are like class definitions, whereas
Custom Resources are actual instances of that class.</p> <p>Entando introduces two groups of Custom Resources. On the one hand, there are the core Entando Custom Resources required
for a basic installation of Entando in a Kubernetes cluster. These Custom Resources directly result in other
Kubernetes resources being deployed in the cluster. On the other hand, there are the Custom Resources specific
to the Entando Component Repository that serve primarily as metadata for other Entando components.</p> <h2 id="the-core-entando-custom-resources"><a href="#the-core-entando-custom-resources" class="header-anchor">#</a> The Core Entando Custom Resources</h2> <p>The Entando Operator observes all the Core Entando Custom Resources in one or more namespaces. This means that if a Core
Entando Custom Resource is created, updated or deleted, the Entando Operator will trigger a new run-to-completion Pod
that will translate that state change into a state change in the actual Kubernetes Cluster. Often, this will
result in the Deployment of one or more Docker images, but also one or more Services and sometimes and Ingress
too. We refer to the Docker Images that implement these run-to-completion Pods as Entando Kubernetes Controllers.</p> <p>The Entando Operator itself is also implemented as a Docker Image. You can have a closer look at how it works in the
<a href="https://github.com/entando-k8s/entando-k8s-controller-coordinator" target="_blank" rel="noopener noreferrer">entando-k8s-controller-coordinator<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> project on Github.
Apart from the normal Maven, Java and Docker files one would expect, you will also notice the
<a href="https://github.com/entando-k8s/entando-k8s-controller-coordinator/tree/master/charts/entando-k8s-controller-coordinator" target="_blank" rel="noopener noreferrer">entando-k8s-controller-coordinator Helm Chart<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.
This Helm Chart is basically the entrypoint for installations of Entando 6 on Kubernetes. More detailed instructions
on how to install the Entando 6 Operator are available in our
<a href="/docs/local-install.html">installation instructions</a></p> <h2 id="entandokeycloakserver"><a href="#entandokeycloakserver" class="header-anchor">#</a> EntandoKeycloakServer</h2> <p>The EntandoKeycloakServer Custom Resource is used to deploy and configure a Red Hat Keycloak Server instance on the
cluster. After deploying this Keycloak instance, the Entando Operator will create a Kubernetes Secret that provides
the necessary information for subsequent deployment operations to access the Keycloak instance as the Admin user. This
allows the rest of the Entando Kubernetes Controllers to create a Keycloak OIDC client for every HTTP service that
gets deployed. If you already have a Keycloak instance that you would use, you can skip this custom resource entirely
and simply create the `keycloak-admin-secret' in the operator's namespace as specified in
<a href="/docs/k8s-operator/tutorials/how-to-connect-to-external-keycloak.html">this tutorial</a></p> <h3 id="overview-2"><a href="#overview-2" class="header-anchor">#</a> Overview</h3> <ul><li>Entando Cluster Citizen: <a href="/docs/k8s-operator/entando6-cluster-citizens.html#keycloak">Keycloak</a></li> <li>Custom Resource Definition: <a href="https://github.com/entando-k8s/entando-k8s-custom-model/blob/master/src/main/resources/crd/EntandoKeycloakServerCRD.yaml" target="_blank" rel="noopener noreferrer">EntandoKeycloakServer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Kubernetes Controller Details:
<ul><li>Docker image: <a href="https://hub.docker.com/r/entando/entando-k8s-keycloak-controller" target="_blank" rel="noopener noreferrer">entando/entando-k8s-keycloak-controller<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Github Repo: <a href="https://github.com/entando-k8s/entando-k8s-keycloak-controller" target="_blank" rel="noopener noreferrer">entando-k8s/entando-k8s-keycloak-controller<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li> <li>Deployment Details:
<ul><li>Docker image: <a href="https://hub.docker.com/r/entando/entando-keycloak" target="_blank" rel="noopener noreferrer">entando/entando-keycloak<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Github Repo: <a href="https://github.com/entando/entando-keycloak" target="_blank" rel="noopener noreferrer">entando/entando-keycloak<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li> <li>Possible Database Images:
<ul><li>MySQL: <a href="https://hub.docker.com/r/centos/mysql-57-centos7" target="_blank" rel="noopener noreferrer">docker.io/centos/mysql-57-centos7<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>PostgreSQL: <a href="https://hub.docker.com/r/centos/postgresql-96-centos7" target="_blank" rel="noopener noreferrer">docker.io/centos/postgresql-96-centos7<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul> <h3 id="example"><a href="#example" class="header-anchor">#</a> Example</h3> <div class="language- extra-class"><pre class="language-text"><code>---
kind: &quot;EntandoKeycloakServer&quot;
apiVersion: &quot;entando.org/v1&quot;
metadata:
  name: &quot;test-keycloak&quot;
  namespace: &quot;keycloak-namespace&quot;
spec:
  dbms: &quot;postgresql&quot;
  imageName: &quot;entando/entando-keycloak&quot;
  ingressHostName: &quot;test-keycloak.ampie.dynu.net&quot;
  isDefault: true
  parameters: 
    KEYCLOAK_WELCOME_THEME: my-custom-theme
  tlsSecretName: my-tls-secret
  replicas: 1
  
</code></pre></div><p>###Explanation of properties</p> <ul><li><code>spec.dbms</code> is used to select the database management of choice. If this value matches up to the <code>spec.dbms</code> property
of a previously  configured <a href="/docs/k8s-operator/connecting-external-db.html">EntandoDatabaseService</a>,
the Keycloak image will be configured to use this service.
Alternatively, the Entando Operator will use this value to deploy a dedicated Database instance in this namespace
for Keycloak to use. If left empty, or given value of 'none', Keycloak will be deployed using its own internal
H2 database.</li> <li><code>spec.imageName</code> is used to provide a customized image. By default, the operator will use the <code>entando/entando-keycloak</code>
discussed above. When using the default image, please refer to the
<a href="https://github.com/entando-k8s/entando-k8s-controller-coordinator/blob/master/charts/entando-k8s-controller-coordinator/README.md#how-it-resolves-docker-images" target="_blank" rel="noopener noreferrer">relevant section<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
in the README of the Entando Operator to determine how the Docker registry and version of this image will be calculated.
When you need to customize the theme or add extensions to Keycloak, you can create your own custom image and provide
the value in this property. In this custom image, make sure you use the default image (<code>entando/entando-keycloak</code>)
as a base image. You can then add your customizations and build your own image. Please use a fully qualified
Docker image name here.</li> <li><code>spec.ingressHostName</code> is the hostname of the Kubernetes Ingress to be created for Keycloak. Please ensure that this is
accessible using the default routing suffix of your Entando Operator Deployment, or a DNS name previously
registered with your DNS provider.</li> <li><code>spec.isDefault</code> is 'true' by default and this should suffice for most conditions. This will result in the standard
<code>keycloak-admin-secret</code> being replaced by a Secret connecting you to this newly created Keycloak instance.
Theoretically one could use multiple Keycloak instances in a cluster, in which case this property should be false.</li> <li><code>spec.parameters</code> is a Map of environment variables to pass to the Keycloak Docker image. For example, this could
be used to select a specific theme for Keycloak to use using the variable KEYCLOAK_WELCOME_THEME. These parameters
are applied to the container's environment variables after all variables have been calculated. It can therefore
also be used as a mechanism to override any of the default environment variables that need customization.</li> <li><code>spec.tlsSecretName</code> is the name of a standard Kubernetes
<a href="https://kubernetes.io/docs/concepts/services-networking/ingress/#tls" target="_blank" rel="noopener noreferrer">TLS Secret<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> that will be used for the
resulting Ingress. This is only required if the
<a href="https://github.com/entando-k8s/entando-k8s-controller-coordinator/blob/master/charts/entando-k8s-controller-coordinator/README.md#tls" target="_blank" rel="noopener noreferrer">globally configured TLS Secret<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
for the Operator is absent or has not been created with a wildcard hostname that supports this Keycloak instance's hostname.</li> <li><code>spec.replicas</code> - the number of replicas to be made available on the Deployment of this Keycloak Server</li></ul> <h2 id="entandoclusterinfrastructure"><a href="#entandoclusterinfrastructure" class="header-anchor">#</a> EntandoClusterInfrastructure</h2> <p>The EntandoClusterInfrastructure custom resource can be used to create the shared services that Entando requires in a cluster.
At the time of the writing of this document, there is really only one service, which is the Entando K8S Service, but this
may change in future. Deployments resulting from this custom resources are configured to use the default Keycloak
Server specified in the <code>keycloak-admin-secret</code> using the <code>entando</code> realm. An Ingress will also be created as part of this
deployment. At this point, there is no way to customize the image in question.</p> <h3 id="overview-3"><a href="#overview-3" class="header-anchor">#</a> Overview</h3> <ul><li>Entando Cluster Citizen: <a href="/docs/k8s-operator/entando6-cluster-citizens.html#entando-kubernetes-service">Entando Kubernetes Service</a></li> <li>Custom Resource Definition: <a href="https://github.com/entando-k8s/entando-k8s-custom-model/blob/master/src/main/resources/crd/EntandoClusterInfrastructureCRD.yaml" target="_blank" rel="noopener noreferrer">EntandoClusterInfrastructure<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Kubernetes Controller Details:
<ul><li>Docker image: <a href="https://hub.docker.com/r/entando/entando-k8s-cluster-infrastructure-controller" target="_blank" rel="noopener noreferrer">entando/entando-k8s-cluster-infrastructure-controller<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Github Repo: <a href="https://github.com/entando-k8s/entando-k8s-cluster-infrastructure-controller" target="_blank" rel="noopener noreferrer">entando-k8s/entando-k8s-keycloak-controller<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li> <li>Deployment Details:
<ul><li>Docker image: <a href="https://hub.docker.com/r/entando/entando-k8s-service" target="_blank" rel="noopener noreferrer">entando/entando-k8s-service<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Github Repo: <a href="https://github.com/entando-k8s/entando-k8s-service" target="_blank" rel="noopener noreferrer">entando-k8s/entando-k8s-service<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li> <li>Possible Database Images: none</li></ul> <h3 id="example-2"><a href="#example-2" class="header-anchor">#</a> Example</h3> <div class="language- extra-class"><pre class="language-text"><code>---
kind: &quot;EntandoClusterInfrastructure&quot;
apiVersion: &quot;entando.org/v1&quot;
metadata:
  name: &quot;test-eci&quot;
  namespace: &quot;eci-namespace&quot;
spec:
  keycloakSecretToUse: some-keycloak-secret
  ingressHostName: &quot;test-keycloak.ampie.dynu.net&quot;
  isDefault: true
  parameters: 
    KEYCLOAK_WELCOME_THEME: my-custom-theme
  tlsSecretName: my-tls-secret
  replicas: 1
  
</code></pre></div><p>###Explanation of properties</p> <ul><li><code>spec.keycloakSecretToUse</code> is used to determine which Kubernetes Secret to use to connect to the correct
Keycloak instance. If not specified, the default Secret <code>keycloak-admin-secret</code> will be used. Only useful
if you have more than one Keycloak server in your cluster.</li> <li><code>spec.ingressHostName</code> is the hostname of the Kubernetes Ingress to be created for the Entando K8S Service. Please
ensure that this is accessible using the default routing suffix of your Entando Operator Deployment, or a DNS
name previously registered with your DNS provider.</li> <li><code>spec.isDefault</code> is 'true' by default and this should suffice for most conditions. This will result in the standard
<code>entando-cluster-infrastructure-secret</code> being replaced by a Secret connecting you to this newly created
Entando K8S Service.  Theoretically one could use multiple Entando K8S Services in a cluster, in which
case this property should be false for new Entando K8S Services that should not override the default Secret.</li> <li><code>spec.parameters</code> is a Map of environment variables to pass to the Entando K8S Service Docker image. For example, this could
be used to override the ENTANDO_NAMESPACES_TO_OBSERVE variable that configures the set of Kubernetes namespaces
this service should read EntandoDeBundles from. Also note that all of the
<a href="https://github.com/entando-k8s/entando-k8s-service/blob/master/src/main/resources/application.properties" target="_blank" rel="noopener noreferrer">Spring variables in entando-k8s-service project<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
can also be overridden here by specifying the equivalent SNAKE_CASE names of the dot-delimited Spring properties.
These parameters are applied to the container's environment variables after all variables have been calculated.
It can therefore also be used as a mechanism to override any of the default environment variables that need customization.</li> <li><code>spec.tlsSecretName</code> is the name of a standard Kubernetes
<a href="https://kubernetes.io/docs/concepts/services-networking/ingress/#tls" target="_blank" rel="noopener noreferrer">TLS Secret<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> that will be used for the
resulting Ingress. This is only required if the
<a href="https://github.com/entando-k8s/entando-k8s-controller-coordinator/blob/master/charts/entando-k8s-controller-coordinator/README.md#tls" target="_blank" rel="noopener noreferrer">globally configured TLS Secret<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
for the Operator is absent or has not been created with a wildcard hostname that supports this Keycloak instance's hostname.</li> <li><code>spec.replicas</code> - the number of replicas to be made available on the Deployment of this Entando K8S Service</li></ul> <h2 id="entandoapp"><a href="#entandoapp" class="header-anchor">#</a> EntandoApp</h2> <p>An EntandoApp is a Deployment of a Docker image that hosts an Entando and Java based web application. Entando offers two
standard images that can be used, but generally we expect our customers to provide their own images here. An EntandoApp
Deployment packages three images into a single Pod: the Entando App Image in question, AppBuilder and Component Manager.</p> <h3 id="overview-4"><a href="#overview-4" class="header-anchor">#</a> Overview</h3> <ul><li>Custom Resource Definition: <a href="https://github.com/entando-k8s/entando-k8s-custom-model/blob/master/src/main/resources/crd/EntandoAppCRD.yaml" target="_blank" rel="noopener noreferrer">EntandoApp<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Kubernetes Controller Details:
<ul><li>Docker image: <a href="https://hub.docker.com/r/entando/entando-k8s-app-controller" target="_blank" rel="noopener noreferrer">entando/entando-k8s-app-controller<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Github Repo: <a href="https://github.com/entando-k8s/entando-k8s-app-controller" target="_blank" rel="noopener noreferrer">entando/entando-k8s-app-controller<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li> <li>Deployment Details - Entando App:
<ul><li>Docker image: <a href="https://hub.docker.com/r/entando/entando-de-app-wildfly" target="_blank" rel="noopener noreferrer">entando/entando-de-app-wildfly<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <strong>or</strong> <a href="https://hub.docker.com/r/entando/entando-de-app-eap" target="_blank" rel="noopener noreferrer">entando/entando-de-app-eap<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Github Repo: <a href="https://github.com/entando-k8s/entando-de-app" target="_blank" rel="noopener noreferrer">entando-k8s/entando-de-app<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Entando Cluster Citizen: <a href="/docs/k8s-operator/entando6-cluster-citizens.html#entando-app">Entando App</a></li></ul></li> <li>Deployment Details - AppBuilder:
<ul><li>Docker image: <a href="https://hub.docker.com/r/entando/app-builder" target="_blank" rel="noopener noreferrer">entando/app-builder<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Github Repo: <a href="https://github.com/entando/app-builder" target="_blank" rel="noopener noreferrer">entando/app-builder<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li> <li>Deployment Details - ComponentManager:
<ul><li>Docker image: <a href="https://hub.docker.com/r/entando/entando-component-manager" target="_blank" rel="noopener noreferrer">entando/entando-component-manager<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Github Repo: <a href="https://github.com/entando-k8s/entando-component-manager" target="_blank" rel="noopener noreferrer">entando-k8s/entando-component-manager<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Entando Cluster Citizen: <a href="/docs/k8s-operator/entando6-cluster-citizens.html#entando-component-manager">Component Manager</a></li></ul></li> <li>Possible Database Images:
<ul><li>MySQL: <a href="https://hub.docker.com/r/centos/mysql-57-centos7" target="_blank" rel="noopener noreferrer">docker.io/centos/mysql-57-centos7<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>PostgreSQL: <a href="https://hub.docker.com/r/centos/postgresql-96-centos7" target="_blank" rel="noopener noreferrer">docker.io/centos/postgresql-96-centos7<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul> <h3 id="example-3"><a href="#example-3" class="header-anchor">#</a> Example</h3> <div class="language- extra-class"><pre class="language-text"><code>---
kind: &quot;EntandoApp&quot;
apiVersion: &quot;entando.org/v1&quot;
metadata:
  name: &quot;test-app&quot;
  namespace: &quot;my-namespace&quot;
spec:
  standardServerImage: wildfly
  customServerImage: your-org/your-image:4.3.2
  dbms: &quot;postgresql&quot;
  ingressPath: my-app
  keycloakSecretToUse: some-kc-secret
  clusterInfrastructureToUse: some-eci-secret  
  ingressHostName: &quot;test-app.my-routing-suffix.com&quot;
  parameters: 
    ENTANDO_VAR1: my-var1
  tlsSecretName: my-tls-secret
  replicas: 1
  
</code></pre></div><p>###Explanation of properties</p> <ul><li><code>spec.standardServerImage</code> can be either<code>wildfly</code> or <code>eap</code>. This instructs the Entando Operator to use one of the
two standard Entando App images.
<ul><li>For <code>wildfly</code> it will deploy the <code>entando/entando-de-app-wildfly</code> image</li> <li>For <code>eap</code> it will deploy the <code>entando/entando-de-app-eap</code> image
This property and the <code>spec.customServerImage</code> are  assumed to be mutually exclusive. Only provide a value to
one of the two. Please refer to the
<a href="https://github.com/entando-k8s/entando-k8s-controller-coordinator/blob/master/charts/entando-k8s-controller-coordinator/README.md#how-it-resolves-docker-images" target="_blank" rel="noopener noreferrer">relevant section<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
in the README of the Entando Operator to determine how the Docker registry and version of these images will be calculated.</li></ul></li> <li><code>spec.customServerImage</code> can be used to deploy the Docker image containing your own custom Entando App. Please
follow the instructions on how to <a href="/docs/app-engine/building-prepackaged-image.html">build your own image</a>.<br>
This property and the <code>spec.standardServerImage</code> are  assumed to be mutually exclusive. Only provide a
value to one of the two.</li> <li><code>spec.dbms</code> is used to select the database management of choice. If left empty, a default value of <code>postgresql</code>
is assumed. The value <code>none</code> is not supported. If this value matches up to the <code>spec.dbms</code> property
of a previously  configured <a href="/docs/k8s-operator/connecting-external-db.html">EntandoDatabaseService</a>,
the Entando App will be configured to use this service.
Alternatively, the Entando Operator will use this value to deploy a dedicated Database instance in this namespace
for the EntandoApp to use.</li> <li><code>spec.ingressPath</code> specifies the web context of the Entando App to be deployed. This is required to create a single
path entry in the Ingress that is used to expose the Entando App. The default behaviour of Wildfly and
JBoss EAP is to use the name of the WAR file that is deployed, but it is possible to override this in the EntandoApp
project itself using a <a href="https://docs.jboss.org/jbossas/guides/webguide/r2/en/html/ch06.html" target="_blank" rel="noopener noreferrer"><code>jboss-web.xml</code> file<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.
In the absence of the <code>jboss-web/xml</code> file, the web context  would be the the
Maven artifactId of the Entando Opp project. It is also possible to modify this by changing the <code>&lt;finalName&gt;</code> element
in the Maven <code>pom.xml</code></li> <li><code>spec.clusterInfrastructureToUse</code> is the name of the Kubernetes Secret that provides the connection details to the
EntandoClusterInfrastructure containining the Entando Component Repository for this App to use. This is only
required if more than one EntandoClusterInfrastructure is available and this value can be omitted entirely under
most conditions.</li> <li><code>spec.keycloakSecretToUse</code> is used to determine which Kubernetes Secret to use to connect to the correct
Keycloak instance. If not specified, the default Secret <code>keycloak-admin-secret</code> will be used. Only useful
if you have more than one Keycloak server in your cluster.</li> <li><code>spec.ingressHostName</code> is the hostname of the Kubernetes Ingress to be created for the Entando App. Please
ensure that this is accessible using the default routing suffix of your Entando Operator Deployment, or a DNS
name previously registered with your DNS provider. Keep in mind that EntandoPlugins linked to this app will
also be made available on this host.</li> <li><code>spec.parameters</code> is a Map of environment variables to pass to the EntandoApp Docker image. For example, this could
be used to provide connection details for custom datasources or message queues as discussed in the
<a href="/docs/k8s-operator/tutorials/how-to-configure-custom-datasource.html">custom datasources tutorial</a>. Also note that all of the
<a href="https://github.com/entando-k8s/entando-de-app/blob/master/src/main/conf/systemParams.properties" target="_blank" rel="noopener noreferrer">Spring variables in an Entndo project<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
can also be overridden here by specifying the equivalent SNAKE_CASE names of the dot-delimited Spring properties.
These parameters are applied to the container's environment variables after all variables have been calculated.
It can therefore also be used as a mechanism to override any of the default environment variables that need customization.
Keep in mind that these parameters will be passed to each of the three containers in this Pod as environment
variables, and that care needs to be taken to avoid conflicting variable names.</li> <li><code>spec.tlsSecretName</code> is the name of a standard Kubernetes
<a href="https://kubernetes.io/docs/concepts/services-networking/ingress/#tls" target="_blank" rel="noopener noreferrer">TLS Secret<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> that will be used for the
resulting Ingress. This is only required if the
<a href="https://github.com/entando-k8s/entando-k8s-controller-coordinator/blob/master/charts/entando-k8s-controller-coordinator/README.md#tls" target="_blank" rel="noopener noreferrer">globally configured TLS Secret<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
for the Operator is absent or has not been created with a wildcard hostname that supports this Keycloak instance's hostname.</li> <li><code>spec.replicas</code> - the number of replicas to be made available on the Deployment of this Entando App</li></ul> <h2 id="entandoplugin"><a href="#entandoplugin" class="header-anchor">#</a> EntandoPlugin</h2> <p>An Entando Plugin is a microservice that can be made available to one or more EntandoApps in the cluster. Please follow
our instructions on using our blueprint to <a href="/docs/ecr/tutorials/from-blueprint-to-de.html">build your own EntandoPlugin</a>. The
Deployment resulting from an EntandoPlugin is also a multi-container Pod deployment, and will include both the
plugin Docker image specified and the EntandoPluginSidecar Docker Image</p> <h3 id="overview-5"><a href="#overview-5" class="header-anchor">#</a> Overview</h3> <ul><li>Custom Resource Definition: <a href="https://github.com/entando-k8s/entando-k8s-custom-model/blob/master/src/main/resources/crd/EntandoPluginCRD.yaml" target="_blank" rel="noopener noreferrer">EntandoPlugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Kubernetes Controller Details:
<ul><li>Docker image: <a href="https://hub.docker.com/r/entando/entando-k8s-plugin-controller" target="_blank" rel="noopener noreferrer">entando/entando-k8s-plugin-controller<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Github Repo: <a href="https://github.com/entando-k8s/entando-k8s-plugin-controller" target="_blank" rel="noopener noreferrer">entando/entando-k8s-plugin-controller<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li> <li>Deployment Details - plugin:
<ul><li>Docker image: as provided by user</li> <li>Entando Cluster Citizen: <a href="/docs/k8s-operator/entando6-cluster-citizens.html#entando-plugin">Plugin</a></li></ul></li> <li>Deployment Details - EntandoPluginSidecar:
<ul><li>Docker image: <a href="https://hub.docker.com/r/entando/entando-plugin-sidecar" target="_blank" rel="noopener noreferrer">entando/entando-plugin-sidecar<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Github Repo: <a href="https://github.com/entando/entando-plugin-sidecar" target="_blank" rel="noopener noreferrer">entando/entando-plugin-sidecar<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li> <li>Possible Database Images:
<ul><li>MySQL: <a href="https://hub.docker.com/r/centos/mysql-57-centos7" target="_blank" rel="noopener noreferrer">docker.io/centos/mysql-57-centos7<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>PostgreSQL: <a href="https://hub.docker.com/r/centos/postgresql-96-centos7" target="_blank" rel="noopener noreferrer">docker.io/centos/postgresql-96-centos7<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul> <h3 id="example-4"><a href="#example-4" class="header-anchor">#</a> Example</h3> <div class="language- extra-class"><pre class="language-text"><code>---
kind: &quot;EntandoPlugin&quot;
apiVersion: &quot;entando.org/v1&quot;
metadata:
  name: &quot;test-plugin&quot;
  namespace: &quot;my-namespace&quot;
spec:
  image: your-org/your-image:4.3.2
  securityLevel: lenient
  ingressPath: /my-plugin
  healthCheckPath: /actuator/health
  dbms: &quot;postgresql&quot;
  keycloakSecretToUse: some-kc-secret
  clusterInfrastructureToUse: some-eci-secret  
  ingressHostName: &quot;test-app.my-routing-suffix.com&quot;
  roles:
    - code: admin
      name: Administrators
    - code: user
      name: Users
  permissions: 
    - clientId: some-keycloak-client 
      role: some-admin
    - clientId: another-keycloak-client 
      role: another-admin
  parameters: 
    ENTANDO_VAR1: my-var1
  tlsSecretName: my-tls-secret
  replicas: 1
</code></pre></div><p>###Explanation of properties</p> <ul><li><code>spec.image</code> is the Docker image you can provide for the plugin you want to deploy. Please follow
our instructions on using our blueprint to <a href="/docs/ecr/tutorials/from-blueprint-to-de.html">build your own EntandoPlugin</a>
Currently only Docker images hosting Spring Boot applications are supported. It is therefore of  utmost
importance to start off with our blueprint and ensure that the resulting Spring Boot application respects
the Spring variables to be set from the Entando Operator.</li> <li><code>spec.dbms</code> is used to select the database management of choice. If left empty, or if the value is <code>none</code>, it
is assumed that the plugin in question does not required a database. If this value matches up to
the <code>spec.dbms</code> property  of a previously  configured
<a href="/docs/k8s-operator/connecting-external-db.html">EntandoDatabaseService</a>,
the Entando Plugin will be configured to use this service.
Alternatively, the Entando Operator will use this value to deploy a dedicated Database instance in this namespace
for the Entando Plugin to use.</li> <li><code>spec.ingressPath</code> specifies the web context where the Entando Plugin will be made available when linked to EntandoApps.
Please ensure this is in sync with the <code>server.servlet.context-path</code> property set on your Spring Boot application.</li> <li><code>spec.clusterInfrastructureToUse</code> is the name of the Kubernetes Secret that provides the connection details to the
EntandoClusterInfrastructure this Plugin will use. This is only
required if more than one EntandoClusterInfrastructure is available and this value can be omitted entirely under
most conditions.</li> <li><code>spec.keycloakSecretToUse</code> is used to determine which Kubernetes Secret to use to connect to the correct
Keycloak instance. If not specified, the default Secret <code>keycloak-admin-secret</code> will be used. Only useful
if you have more than one Keycloak server in your cluster.</li> <li><code>spec.ingressHostName</code> is the hostname of the Kubernetes Ingress to be created for the Entando Plugin. Please
ensure that this is accessible using the default routing suffix of your Entando Operator Deployment, or a DNS
name previously registered with your DNS provider. This hostname will not be used from your Widgets that you
have implemented for this plugin as these widgets will use the hostname of the EntandoApp they are being used from.
This hostname is useful for embedded web user interfaces used only on this plugin, such as admin user interfaces
or diagnostic user interface.</li> <li><code>spec.roles</code> specifies the set of roles that this plugin expects. At deployment time, the Entando Operator ensures
that each of these roles are created on Keycloak for the Keycloak client representing this EntandoPlugin. It is
up to the Plugin provider to ensure that Spring Security has been set up to enforce the access rules implied
by the individual roles. Each role has a unique <code>code</code> and a more human readable  <code>name</code> as property.</li> <li><code>spec.permissions</code> specifies the set of permissions this plugin requires on other services with known Keycloak Clients.
At deployment time, the Entando Operator will use the service account user of this EntandoPlugin's Keycloak Client
and create the necessary role bindings on the specified client id of the service to be used.
Each permission specifies the <code>clientId</code> in Keycloak of the target service, and the <code>role</code> that this EntandoPlugin
should be bound to in that Keycloak client.</li> <li><code>spec.parameters</code> is a Map of environment variables to pass to the EntandoPlugin Docker image.
It is entirely up to the plugin provider to determine the semantics of each variable. We strongly suggest for
plugin provider  to use  the standard Spring Property Resolver syntax for Spring variables, as this would allow
any of these variables to be overridden here by specifying the equivalent SNAKE_CASE names of the dot-delimited
Spring properties.
These parameters are applied to the container's environment variables after all variables have been calculated.
It can therefore also be used as a mechanism to override any of the default environment variables that need customization.
Keep in mind that these parameters will be passed to both containers in this Pod as environment
variables, and that care needs to be taken to avoid conflicting variable names.</li> <li><code>spec.tlsSecretName</code> is the name of a standard Kubernetes
<a href="https://kubernetes.io/docs/concepts/services-networking/ingress/#tls" target="_blank" rel="noopener noreferrer">TLS Secret<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> that will be used for the
resulting Ingress. This is only required if the
<a href="https://github.com/entando-k8s/entando-k8s-controller-coordinator/blob/master/charts/entando-k8s-controller-coordinator/README.md#tls" target="_blank" rel="noopener noreferrer">globally configured TLS Secret<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
for the Operator is absent or has not been created with a wildcard hostname that supports this Keycloak instance's hostname.</li> <li><code>spec.replicas</code> - the number of replicas to be made available on the Deployment of this Entando Plugin</li></ul> <h2 id="entandoapppluginlink"><a href="#entandoapppluginlink" class="header-anchor">#</a> EntandoAppPluginLink</h2> <p>The EntandoAppPluginLink custom resource is created when an AppBuilder user links an EntandoPlugin to the current
EntandoApp, or deploys an EntandoPlugin for use in the current EntandoApp. The Entando Operator processes the resulting
EntandoAppPluginLink and creates a path for the Plugin on the Ingress that exposes the EntandoApp in question. This path
is determined by the <code>spec.ingressPath</code> property on the EntandoPlugin custom resource itself. If the EntandoPlugin
resides in a namespace other than the namespace of the EntandoApp, the EntandoOperator creates a Kubernetes
Service in the namespace of the EntandoApp that simply delegates to the Service in the namespace of the EntandoPlugin.</p> <h3 id="overview-6"><a href="#overview-6" class="header-anchor">#</a> Overview</h3> <ul><li>Custom Resource Definition: <a href="https://github.com/entando-k8s/entando-k8s-custom-model/blob/master/src/main/resources/crd/EntandoAppPluginLinkCRD.yaml" target="_blank" rel="noopener noreferrer">EntandoAppPluginLink<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Kubernetes Controller Details:
<ul><li>Docker image: <a href="https://hub.docker.com/r/entando/entando-k8s-app-plugin-link-controller" target="_blank" rel="noopener noreferrer">entando/entando-k8s-app-plugin-link-controller<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Github Repo: <a href="https://github.com/entando-k8s/entando-k8s-app-plugin-link-controller" target="_blank" rel="noopener noreferrer">entando/entando-k8s-app-plugin-link-controller<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul> <h3 id="example-5"><a href="#example-5" class="header-anchor">#</a> Example</h3> <div class="language- extra-class"><pre class="language-text"><code>---
kind: &quot;EntandoAppPluginLink&quot;
apiVersion: &quot;entando.org/v1&quot;
metadata:
  name: &quot;test-link&quot;
  namespace: &quot;my-namespace&quot;
spec:
  entandoAppName: my-app
  entandoAppNamespace: my-app
  entandoPluginName: my-app
  entandoPluginNamespace: my-app
  
</code></pre></div><p>###Explanation of properties</p> <ul><li><code>spec.entandoAppName</code> specifies the name of the EntandoApp that requires the plugin, found in <code>EntandoApp.metadata.name</code></li> <li><code>spec.entandoAppNamespace</code> specifies the namespace of the EntandoApp that requires the plugin, found in <code>EntandoApp.metadata.namespace</code></li> <li><code>spec.entandoPluginName</code> specifies the name of the EntandoApp that requires the plugin, found in <code>EntandoPlugin.metadata.name</code></li> <li><code>spec.entandoPluginNamespace</code> specifies the namespace of the EntandoApp that requires the plugin, found in <code>EntandoPlugin.metadata.namespace</code></li></ul> <h2 id="entandodatabaseservice"><a href="#entandodatabaseservice" class="header-anchor">#</a> EntandoDatabaseService</h2> <p>By default, the Entando Operator deploys one of either the MySQL or PostgreSQL database Docker images for every custom
resource that requires a database. Many customers may however have existing infrastructure for their databases which
they may want to leverage. The EntandoDatabaseService custom resource allows customers to deploy a Service that points
to an external database. When deploying one of the Entando custom resources that require a database, the Entando
Operator will look for EntandoDatabases in the same namespace, and if it finds one with the same <code>spec.dbms</code> setting
as the database required by the custom resource , it will create a dedicated schema/username/password combination
for the custom resource and point the deployment emanating from custom resource to this external database.</p> <ul><li>Custom Resource Definition: <a href="https://github.com/entando-k8s/entando-k8s-custom-model/blob/master/src/main/resources/crd/EntandoDatabaseServiceCRD.yaml" target="_blank" rel="noopener noreferrer">EntandoDatabaseService<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="example-6"><a href="#example-6" class="header-anchor">#</a> Example</h3> <div class="language- extra-class"><pre class="language-text"><code>---
kind: &quot;EntandoDatabaseService&quot;
apiVersion: &quot;entando.org/v1&quot;
metadata:
  name: &quot;test-database-service&quot;
  namespace: &quot;my-namespace&quot;
spec:
  dbms: &quot;osracle&quot;
  host: 10.0.12.41
  port: 1521
  databaseName: mydb 
  tablespace: 
  secretName: some-secret
  jdbcParameters:
    maxStatements: 300 
    loginTimeout: 180
</code></pre></div><p>###Explanation of properties</p> <ul><li><code>spec.dbms</code> is used to select the database management of choice. If this value matches up to the <code>spec.dbms</code> property
of the Entando custom resource that will use it. Valid values are <code>oracle</code>, <code>postgresql</code> and <code>mysql</code>.</li> <li><code>spec.host</code> can either be a valid IPv4 address, or a hostname. Where an IP address is provided, the Entando Operator
will create a Kubernetes Service with an associated EndPoints resource to allow for routing to this address. Where
a hostname is provided, the Entando Operator will simply create a Kubernetes Service of type <code>cname</code></li> <li><code>spec.port</code> is the port that the external database service is running on. This value is optional in which case we will
use the default port for the DBMS vendor in question</li> <li><code>spec.databaseName</code> is the name of the database that the Entando Operator should be creating schemas in. This property
is only for use with PostgreSQL and Oracle, as MySQL doesn't distinguish between schemas and databases.</li> <li><code>spec.tablespace</code> is only required for Oracle so that Schemas can be created in different tablespaces.</li> <li><code>spec.secretName</code> should be the name (<code>Secret.metadata.name</code>) of a Kubernetes Secret in the same namespace that has
a <code>username</code> key and a <code>password</code> key that will provide the Entando Operator with the necessary access and permissions
to create Schemas and users on the database in question.</li> <li><code>spec.jdbcParameters</code> is a map of name/value pairs that will be appended to the JDBC connection string to allow for
further customization of the actual connection to the database.</li></ul> <h2 id="entandocompositeapp"><a href="#entandocompositeapp" class="header-anchor">#</a> EntandoCompositeApp</h2> <p>The EntandoCompositeApp custom resource can be used to package a collection of Entando Core Custom Resources in a
single YAML file for sequential deployment. Keep in mind that one can already use standard YAML syntax to package
a set of Kubernetes resources in a single file, separating each resource with a triple dash (<code>---</code>). The purpose
of this custom resource is therefor specifically to ensure that the deployment of the previous 'component' has
completed, and that  the resulting Pod is up and running before commencing deploying on the 'component'.</p> <p>The primary use case of this custom resource is to package a full Entando App and all its supporting service and
plugins for easy installation as is often required for demos and POCs. Creating this kind of dependency for typical
production deployments is not advised, as it will inevitably result in a violation of pipeline isolation. The
more commonly recommended approach is for your Entando Apps and Plugins to be fully deployable in isolation. Use this
custom resource with care.</p> <h3 id="overview-7"><a href="#overview-7" class="header-anchor">#</a> Overview</h3> <ul><li>Custom Resource Definition: <a href="https://github.com/entando-k8s/entando-k8s-custom-model/blob/master/src/main/resources/crd/EntandoCompositeAppCRD.yaml" target="_blank" rel="noopener noreferrer">EntandoCompositeApp<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Kubernetes Controller Details:
<ul><li>Docker image: <a href="https://hub.docker.com/r/entando/entando-k8s-composite-app-controller" target="_blank" rel="noopener noreferrer">entando/entando-k8s-composite-app-controller<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Github Repo: <a href="https://github.com/entando-k8s/entando-k8s-composite-app-controller" target="_blank" rel="noopener noreferrer">entando/entando-k8s-composite-app-controller<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul> <h3 id="example-7"><a href="#example-7" class="header-anchor">#</a> Example</h3> <div class="language- extra-class"><pre class="language-text"><code>---
kind: &quot;EntandoCompositeApp&quot;
apiVersion: &quot;entando.org/v1&quot;
metadata:
  name: &quot;test-composite-app&quot;
  namespace: &quot;my-namespace&quot;
spec:
  components:
    - kind: &quot;EntandoKeycloakServer&quot;
         metadata:
           name: &quot;my-kc&quot;
         spec:
           dbms: postgresql
           isDefault: true
           replicas: 1
       - kind: &quot;EntandoClusterInfrastructure&quot;
         metadata:
           name: &quot;my-eci&quot;
         spec:
           dbms: postgresql
           replicas: 1
           isDefault: true
       - kind: &quot;EntandoApp&quot;
         metadata:
           name: &quot;my-app&quot;
         spec:
           dbms: postgresql
           replicas: 1
           standardServerImage: wildfly
           ingressPath: /entando-de-app
       - kind: &quot;EntandoPlugin&quot;
         metadata:
           name: &quot;my-pda&quot;
         spec:
           image: &quot;docker.io/entando/entando-process-driven-plugin:latest&quot;
           replicas: 1
           dbms: &quot;mysql&quot;
</code></pre></div><p>###Explanation of properties</p> <ul><li><code>spec.components</code> specifies the list of Entando Core Custom Resources to be deployed <strong>in sequence</strong>. Please note
that only the Entando Custom Resources discussed in this section can be used in this list. Custom resources
related to the Entando Component Repository never result in actual deployments on the Kubernetes cluster and
therefore do not need to be specified in any sequence. You can use the normal triple dash YAML notation to
include them in the same YAML file</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/entando/entando-docs/edit/master/vuepress/docs/custom-resources/custom-resources.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/20/2020, 4:15:27 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.e2723373.js" defer></script><script src="/docs/assets/js/2.e917390b.js" defer></script><script src="/docs/assets/js/31.cad899bc.js" defer></script>
  </body>
</html>
