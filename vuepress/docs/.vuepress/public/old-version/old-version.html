<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.8">
<title>Welcome to Entando</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="./stylesheets/menuoverride.css">
<link rel="stylesheet" href="./stylesheets/fontawesome5-3-1.css">
<link rel="icon" type="image/png" href="./../theme/favicon.png">

<script src="./js/jquery.js"></script>
<script src="./js/fontawesome.min.js"></script>
<script src="./js/menu.js"></script>
<script src="./js/headScript.js"></script>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Welcome to Entando</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#e5.3.0">1. ENTANDO 5.3.0</a>
<ul class="sectlevel2">
<li><a href="#current-release-notes">1.1. ENTANDO RELEASE NOTES</a>
<ul class="sectlevel3">
<li><a href="#entando-5-3-0-release-notes">1.1.1. ENTANDO 5.3.0 RELEASE NOTES</a>
<ul class="sectlevel4">
<li><a href="#new-capabilities-and-features">NEW CAPABILITIES AND FEATURES</a></li>
<li><a href="#documentation-and-deployment">DOCUMENTATION AND DEPLOYMENT</a></li>
<li><a href="#content-management">CONTENT MANAGEMENT</a></li>
<li><a href="#digital-exchange">DIGITAL EXCHANGE</a></li>
<li><a href="#apis-and-endpoints">APIs AND ENDPOINTS</a></li>
<li><a href="#fixes-and-updates">FIXES AND UPDATES</a></li>
<li><a href="#new-capabilities-in-integration-with-red-hat-pam">NEW CAPABILITIES IN INTEGRATION WITH RED HAT PAM</a></li>
<li><a href="#changes-and-updates-in-5-1-0-in-integration-with-red-hat-pam">CHANGES AND UPDATES IN 5.1.0 IN INTEGRATION WITH RED HAT PAM</a></li>
<li><a href="#known-issues">KNOWN ISSUES</a></li>
<li><a href="#software-requirements">SOFTWARE REQUIREMENTS</a></li>
<li><a href="#legal-notice">LEGAL NOTICE</a></li>
<li><a href="#links-and-resources">LINKS AND RESOURCES</a></li>
</ul>
</li>
<li><a href="#entando-5-0-2-release-notes">1.1.2. ENTANDO 5.0.2 RELEASE NOTES</a></li>
<li><a href="#abstract">1.1.3. ABSTRACT</a></li>
<li><a href="#changes-in-5-0-2">1.1.4. CHANGES IN 5.0.2</a>
<ul class="sectlevel4">
<li><a href="#known-issues-2">KNOWN ISSUES</a></li>
<li><a href="#versioning-information">VERSIONING INFORMATION</a></li>
<li><a href="#software-requirements-2">SOFTWARE REQUIREMENTS</a></li>
<li><a href="#legal-notice-2">LEGAL NOTICE</a></li>
<li><a href="#links-and-resources-2">LINKS AND RESOURCES</a></li>
</ul>
</li>
<li><a href="#entando-5-0-1-release-notes">1.1.5. ENTANDO 5.0.1 RELEASE NOTES</a>
<ul class="sectlevel4">
<li><a href="#abstract-2">ABSTRACT</a></li>
<li><a href="#changes-in-5-0-1">CHANGES IN 5.0.1</a></li>
<li><a href="#defect-resolution-and-general-updates">Defect Resolution and General Updates</a></li>
<li><a href="#known-issues-3">Known Issues</a></li>
<li><a href="#software-requirements-3">Software Requirements</a></li>
<li><a href="#legal-notice-3">Legal Notice</a></li>
<li><a href="#links-and-resources-3">Links and Resources</a></li>
</ul>
</li>
<li><a href="#entando-5-0-0-release-notes">1.1.6. ENTANDO 5.0.0 RELEASE NOTES</a>
<ul class="sectlevel4">
<li><a href="#abstract-3">ABSTRACT</a></li>
<li><a href="#preface">PREFACE</a></li>
<li><a href="#goal-of-entando-5">GOAL OF ENTANDO 5</a></li>
<li><a href="#about-entando-5">ABOUT ENTANDO 5</a></li>
<li><a href="#whats-new-with-entando-5">WHAT&#8217;S NEW WITH ENTANDO 5</a></li>
<li><a href="#versioning-information-2">VERSIONING INFORMATION</a></li>
<li><a href="#software-requirements-4">SOFTWARE REQUIREMENTS</a></li>
<li><a href="#legal-notice-4">LEGAL NOTICE</a></li>
<li><a href="#links-and-resources-4">LINKS AND RESOURCES</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#installation">1.2. INSTALLING ENTANDO APP BUILDER 5.0</a>
<ul class="sectlevel3">
<li><a href="#prerequisites">1.2.1. PREREQUISITES</a>
<ul class="sectlevel4">
<li><a href="#space-and-hardware-requirements">SPACE AND HARDWARE REQUIREMENTS</a></li>
<li><a href="#installed-prerequisites">INSTALLED PREREQUISITES:</a></li>
</ul>
</li>
<li><a href="#launching-the-app-builder">1.2.2. LAUNCHING THE APP BUILDER</a>
<ul class="sectlevel4">
<li><a href="#building-from-source">BUILDING FROM SOURCE</a></li>
<li><a href="#additional-commands">Additional Commands</a></li>
</ul>
</li>
<li><a href="#running-the-mapp-engine-instance">1.2.3. RUNNING THE MAPP ENGINE INSTANCE</a>
<ul class="sectlevel4">
<li><a href="#creating-a-new-entando-project">CREATING A NEW ENTANDO PROJECT</a></li>
<li><a href="#launching-the-mapp-engine">LAUNCHING THE MAPP ENGINE</a></li>
</ul>
</li>
<li><a href="#building-the-mapp-engine-from-source-code">1.2.4. BUILDING THE MAPP ENGINE FROM SOURCE CODE</a></li>
<li><a href="#setting-up-a-database-optional">1.2.5. SETTING UP A DATABASE (OPTIONAL)</a>
<ul class="sectlevel4">
<li><a href="#using-docker">USING DOCKER</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#app-building-with-entando">1.3. APP BUILDING WITH ENTANDO</a>
<ul class="sectlevel3">
<li><a href="#introducing-the-entando-app-builder">1.3.1. INTRODUCING THE ENTANDO APP BUILDER</a>
<ul class="sectlevel4">
<li><a href="#entando-admin-console-version-5-0">ENTANDO ADMIN CONSOLE VERSION 5.0</a></li>
</ul>
</li>
<li><a href="#app-builder-overview">1.3.2. APP BUILDER OVERVIEW</a></li>
<li><a href="#dashboard">1.3.3. DASHBOARD</a></li>
<li><a href="#creating-and-managing-pages-with-page-designer">1.3.4. CREATING AND MANAGING PAGES WITH PAGE DESIGNER</a>
<ul class="sectlevel4">
<li><a href="#using-the-page-tree">USING THE PAGE TREE</a></li>
<li><a href="#configuring-page">CONFIGURING A PAGE</a></li>
</ul>
</li>
<li><a href="#ux-patterns-managing-widgets-page-models-and-fragments">1.3.5. UX PATTERNS: MANAGING WIDGETS, PAGE MODELS, AND FRAGMENTS</a>
<ul class="sectlevel4">
<li><a href="#using-widgets">USING WIDGETS</a></li>
<li><a href="#using-fragments">USING FRAGMENTS</a></li>
<li><a href="#page-models">USING PAGE MODELS</a></li>
</ul>
</li>
<li><a href="#integrating-with-red-hat-process-automation-manager-pam">1.3.6. INTEGRATING WITH RED HAT PROCESS AUTOMATION MANAGER (PAM)</a></li>
<li><a href="#managing-users">1.3.7. MANAGING USERS</a>
<ul class="sectlevel4">
<li><a href="#working-with-users">WORKING WITH USERS</a></li>
<li><a href="#restricting-access">RESTRICTING ACCESS</a></li>
</ul>
</li>
<li><a href="#presenting-data">1.3.8. PRESENTING DATA</a>
<ul class="sectlevel4">
<li><a href="#structuring-with-data-types">STRUCTURING WITH DATA TYPES</a></li>
</ul>
</li>
<li><a href="#configuring-entando">1.3.9. CONFIGURING ENTANDO</a>
<ul class="sectlevel4">
<li><a href="#categories">CATEGORIES</a></li>
<li><a href="#labels-and-languages">LABELS AND LANGUAGES</a></li>
<li><a href="#database">DATABASE</a></li>
<li><a href="#file-browser">FILE BROWSER</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#getting-started-app-builder">1.4. GETTING STARTED WITH ENTANDO</a>
<ul class="sectlevel3">
<li><a href="#sample-mortgage-application">1.4.1. SAMPLE MORTGAGE APPLICATION</a>
<ul class="sectlevel4">
<li><a href="#preface-2">PREFACE</a></li>
<li><a href="#configuring-the-applicant-page">CONFIGURING THE APPLICANT PAGE</a></li>
</ul>
</li>
<li><a href="#rh-getting-started">1.4.2. GETTING STARTED WITH ENTANDO AND PAM</a>
<ul class="sectlevel4">
<li><a href="#overview">Overview</a></li>
<li><a href="#update-the-home-screen-of-your-application">Update the Home Screen of your Application</a></li>
<li><a href="#view-your-application">View your Application</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#content-management-system">1.5. CONTENT MANAGEMENT SYSTEM</a>
<ul class="sectlevel3">
<li><a href="#introduction">1.5.1. INTRODUCTION</a>
<ul class="sectlevel4">
<li><a href="#defining-content-management-sections">DEFINING CONTENT MANAGEMENT SECTIONS</a></li>
</ul>
</li>
<li><a href="#contents-section">1.5.2. CONTENTS SECTION</a>
<ul class="sectlevel4">
<li><a href="#adding-images-and-tags">ADDING IMAGES AND TAGS</a></li>
</ul>
</li>
<li><a href="#digital-assets">1.5.3. DIGITAL ASSETS</a>
<ul class="sectlevel4">
<li><a href="#editing-assets">EDITING ASSETS</a></li>
<li><a href="#working-with-an-assets-metadata">WORKING WITH AN ASSET&#8217;S METADATA</a></li>
<li><a href="#cropping-images">CROPPING IMAGES</a></li>
</ul>
</li>
<li><a href="#content-types">1.5.4. CONTENT TYPES</a></li>
<li><a href="#content-models">1.5.5. CONTENT MODELS</a></li>
<li><a href="#content-settings">1.5.6. CONTENT SETTINGS</a>
<ul class="sectlevel4">
<li><a href="#autopopulating-image-tags">AUTOPOPULATING IMAGE TAGS</a></li>
<li><a href="#excluding-metadata">EXCLUDING METADATA</a></li>
<li><a href="#adding-and-removing-metadata-fields">ADDING AND REMOVING METADATA FIELDS</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#entando-pwa">1.6. ENTANDO PWA</a>
<ul class="sectlevel3">
<li><a href="#defining-the-structure">1.6.1. DEFINING THE STRUCTURE</a></li>
<li><a href="#installation-2">1.6.2. INSTALLATION</a>
<ul class="sectlevel4">
<li><a href="#prerequisites-2">PREREQUISITES</a></li>
<li><a href="#git-clone">GIT CLONE</a></li>
<li><a href="#provider-instance-setup">PROVIDER INSTANCE SETUP</a></li>
<li><a href="#pwa-instance-setup">PWA INSTANCE SETUP</a></li>
</ul>
</li>
<li><a href="#keycloak-authentication-feature">1.6.3. KEYCLOAK AUTHENTICATION FEATURE</a>
<ul class="sectlevel4">
<li><a href="#prerequisites-3">PREREQUISITES</a></li>
<li><a href="#keycloak-setup-in-pwa-provider">KEYCLOAK SETUP IN PWA PROVIDER</a></li>
<li><a href="#configure-pwa-provider-instance-with-keycloak">CONFIGURE PWA PROVIDER INSTANCE WITH KEYCLOAK</a></li>
<li><a href="#configure-pwa-app-pwa-shell-with-keycloak">CONFIGURE PWA APP (PWA-SHELL) WITH KEYCLOAK</a></li>
</ul>
</li>
<li><a href="#styling-rebranding">1.6.4. STYLING / REBRANDING</a>
<ul class="sectlevel4">
<li><a href="#app-naming">APP NAMING</a></li>
<li><a href="#icons-splash-screens">ICONS &amp; SPLASH SCREENS</a></li>
<li><a href="#logos-icons-other-image-assets">LOGOS, ICONS &amp; OTHER IMAGE ASSETS</a></li>
<li><a href="#color-themes">COLOR THEMES</a></li>
</ul>
</li>
<li><a href="#the-pwa-shell-code-structure">1.6.5. THE PWA SHELL CODE STRUCTURE</a>
<ul class="sectlevel4">
<li><a href="#layout-components">LAYOUT COMPONENTS</a></li>
<li><a href="#api-methods">API METHODS</a></li>
<li><a href="#i18n">I18N</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#entandos-custom-jsp-tags">1.7. ENTANDO&#8217;S CUSTOM JSP TAGS</a></li>
<li><a href="#entando-faqs">1.8. ENTANDO FAQs</a>
<ul class="sectlevel3">
<li><a href="#error-messages">1.8.1. ERROR MESSAGES</a></li>
<li><a href="#how-tos">1.8.2. HOW TOs</a></li>
<li><a href="#widgets">1.8.3. WIDGETS</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#entando-5-2-0">2. ENTANDO 5.2.0</a>
<ul class="sectlevel2">
<li><a href="#see-5-2-0">2.1. See 5.2.0</a></li>
</ul>
</li>
<li><a href="#entando-5-1-0">3. ENTANDO 5.1.0</a>
<ul class="sectlevel2">
<li><a href="#see-5-2-0-2">3.1. See 5.2.0</a></li>
</ul>
</li>
<li><a href="#entando-5-0-0">4. ENTANDO 5.0.0</a>
<ul class="sectlevel2">
<li><a href="#installation-e5">4.1. INSTALLING ENTANDO APP BUILDER 5.0</a>
<ul class="sectlevel3">
<li><a href="#prerequisites-4">4.1.1. PREREQUISITES</a>
<ul class="sectlevel4">
<li><a href="#space-and-hardware-requirements-2">SPACE AND HARDWARE REQUIREMENTS</a></li>
<li><a href="#installed-prerequisites-2">INSTALLED PREREQUISITES:</a></li>
</ul>
</li>
<li><a href="#running-the-mapp-engine-instance-2">4.1.2. RUNNING THE MAPP ENGINE INSTANCE</a>
<ul class="sectlevel4">
<li><a href="#creating-a-new-entando-project-2">CREATING A NEW ENTANDO PROJECT</a></li>
<li><a href="#launching-the-mapp-engine-2">LAUNCHING THE MAPP ENGINE</a></li>
</ul>
</li>
<li><a href="#launching-the-app-builder-2">4.1.3. LAUNCHING THE APP BUILDER</a>
<ul class="sectlevel4">
<li><a href="#clone-and-setup-2">CLONE AND SETUP</a></li>
<li><a href="#configuration-2">CONFIGURATION</a></li>
<li><a href="#additional-commands-2">ADDITIONAL COMMANDS</a></li>
</ul>
</li>
<li><a href="#setting-up-a-database-optional-2">4.1.4. SETTING UP A DATABASE (OPTIONAL)</a></li>
<li><a href="#configuring-swagger-optional">4.1.5. CONFIGURING SWAGGER (OPTIONAL)</a>
<ul class="sectlevel4">
<li><a href="#enabling-swagger-in-a-development-environment">ENABLING SWAGGER IN A DEVELOPMENT ENVIRONMENT</a></li>
<li><a href="#authentication-details">AUTHENTICATION DETAILS</a></li>
<li><a href="#how-does-the-integration-work">HOW DOES THE INTEGRATION WORK?</a></li>
</ul>
</li>
<li><a href="#building-the-mapp-engine-from-source-code-optional">4.1.6. BUILDING THE MAPP ENGINE FROM SOURCE CODE (OPTIONAL)</a></li>
</ul>
</li>
<li><a href="#deployment-on-docker-and-openshift">4.2. DEPLOYMENT ON DOCKER AND OPENSHIFT</a>
<ul class="sectlevel3">
<li><a href="#containers">4.2.1. Overview</a>
<ul class="sectlevel4">
<li><a href="#a-word-on-docker-tooling">A word on Docker tooling.</a></li>
</ul>
</li>
<li><a href="#getting-started">4.2.2. Getting Started</a></li>
<li><a href="#getting-started-with-docker-compose">4.2.3. Docker Compose in a 'vanilla' Docker environment</a></li>
<li><a href="#maven-docker-quickstart">4.2.4. Getting started on Maven and Docker</a></li>
<li><a href="#openshift-quickstart">4.2.5. Openshift Quick Start</a></li>
<li><a href="#common-variables">4.2.6. Common Variables on Docker</a>
<ul class="sectlevel4">
<li><a href="#environment-variables-for-images-hosting-the-entando-database">Environment Variables for images hosting the Entando database</a></li>
<li><a href="#environment-variables-for-images-hosting-the-entando-engine">Environment Variables for images hosting the Entando Engine</a></li>
<li><a href="#environment-variables-for-images-hosting-the-appbuilder-and-other-javascript-apps">Environment Variables for images hosting the AppBuilder (and other JavaScript apps)</a></li>
</ul>
</li>
<li><a href="#common-ports">4.2.7. Common Ports</a></li>
<li><a href="#common-volumes">4.2.8. Common Volumes</a></li>
<li><a href="#demos-on-docker">4.2.9. Demos on Docker</a>
<ul class="sectlevel4">
<li><a href="#entando-ful-stack-demo">Default Entando Full Stack demo</a></li>
<li><a href="#entando-full-stack-on-postgresql">Entando Full Stack on Postgresql</a></li>
<li><a href="#fsi-credit-card-dispute-demo">FSI Credit Card Dispute Demo</a></li>
</ul>
</li>
<li><a href="#designing-your-pipeline-for-entando">4.2.10. Designing your pipeline for Entando.</a>
<ul class="sectlevel4">
<li><a href="#entando-app-granularity">Entando App Granularity</a></li>
</ul>
</li>
<li><a href="#your-existing-build-infrastructure">4.2.11. Your existing build infrastructure.</a>
<ul class="sectlevel4">
<li><a href="#pure-openshift-environment">Pure Openshift Environment</a></li>
<li><a href="#hybrid-docker-environment">Hybrid Docker Environment</a></li>
</ul>
</li>
<li><a href="#maven-and-docker">4.2.12. Maven and Docker</a>
<ul class="sectlevel4">
<li><a href="#the-pom-xml">The pom.xml</a></li>
</ul>
</li>
<li><a href="#using-mvn-jettyrun-locally-with-appbuilder-and-postgresql-images">4.2.13. Using mvn jetty:run locally with AppBuilder and PostgreSQL images</a></li>
<li><a href="#volumes">4.2.14. Volumes</a></li>
<li><a href="#docker-host-ip-complexities">4.2.15. Docker Host IP Complexities</a></li>
<li><a href="#verifying-and-pushing-your-images">4.2.16. Verifying and Pushing your images</a></li>
<li><a href="#entando-on-openshift">4.2.17. Entando on Openshift</a>
<ul class="sectlevel4">
<li><a href="#from-docker-compose-to-openshift">From Docker Compose to Openshift</a></li>
<li><a href="#entando-standard-openshift-template-parameters">Entando Standard Openshift Template Parameters</a></li>
<li><a href="#deploying-the-entando-pre-built-images">Deploying the Entando pre-built images</a></li>
<li><a href="#building-your-own-entando-images">Building your own Entando images</a></li>
<li><a href="#entando-imagick-s2i-image">Entando Imagick S2I Image</a></li>
</ul>
</li>
<li><a href="#jenkins-pipelines">4.2.18. Jenkins Pipelines</a>
<ul class="sectlevel4">
<li><a href="#entando-reference-pipeline">Entando Reference Pipeline</a></li>
<li><a href="#installing-the-pipeline">Installing the pipeline</a></li>
<li><a href="#example-openshift-only-pipeline">Example Openshift Only Pipeline</a></li>
<li><a href="#example-hybrid-pipeline">Example Hybrid Pipeline</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#cloud-deployments-on-aws-azure-and-gce">4.3. Cloud deployments on AWS, Azure and GCE</a>
<ul class="sectlevel3">
<li><a href="#cloud-deployments">4.3.1. Overview</a></li>
<li><a href="#assumptions">4.3.2. Assumptions</a></li>
<li><a href="#getting-started-k8s">4.3.3. Getting started</a>
<ul class="sectlevel4">
<li><a href="#simplest-example">The Simplest example</a></li>
<li><a href="#n-tier-example">An n-tier example</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#developers-guide">4.4. DEVELOPERS' GUIDE</a>
<ul class="sectlevel3">
<li><a href="#firstdevelopers">4.4.1. INITIAL SETUP</a></li>
<li><a href="#configuring-ant">4.4.2. CONFIGURING ANT</a>
<ul class="sectlevel4">
<li><a href="#additional-settings-for-windows">ADDITIONAL SETTINGS FOR WINDOWS</a></li>
<li><a href="#windows-10">WINDOWS 10</a></li>
<li><a href="#other-windows-versions">OTHER WINDOWS VERSIONS</a></li>
<li><a href="#ant-tasks">ANT TASKS</a></li>
</ul>
</li>
<li><a href="#troubleshooting">4.4.3. TROUBLESHOOTING</a></li>
<li><a href="#filter-management">4.4.4. FILTER MANAGEMENT</a>
<ul class="sectlevel4">
<li><a href="#development-filters">DEVELOPMENT FILTERS</a></li>
<li><a href="#production-filters">PRODUCTION FILTERS</a></li>
<li><a href="#filter-setup">FILTER SETUP</a></li>
<li><a href="#network-setup">NETWORK SETUP</a></li>
<li><a href="#servlet-container-setup-tomcat">SERVLET CONTAINER SETUP - TOMCAT</a></li>
<li><a href="#application-server-setup-jbosswildfly">APPLICATION SERVER SETUP - JBOSS/WILDFLY</a></li>
<li><a href="#database-setup">DATABASE SETUP</a></li>
</ul>
</li>
<li><a href="#configuring-swagger-optional-2">4.4.5. CONFIGURING SWAGGER (OPTIONAL)</a>
<ul class="sectlevel4">
<li><a href="#enabling-swagger-in-a-development-environment-2">ENABLING SWAGGER IN A DEVELOPMENT ENVIRONMENT</a></li>
<li><a href="#authentication-details-2">AUTHENTICATION DETAILS</a></li>
<li><a href="#how-does-the-integration-work-2">HOW DOES THE INTEGRATION WORK?</a></li>
</ul>
</li>
<li><a href="#building-a-rest-api">4.4.6. BUILDING A REST API</a></li>
<li><a href="#oauth-2-0-on-entando">4.4.7. OAUTH 2.0 ON ENTANDO</a></li>
<li><a href="#creating-an-api-consumer">4.4.8. CREATING AN API CONSUMER</a></li>
<li><a href="#imagemagick-setup">4.4.9. IMAGEMAGICK SETUP</a>
<ul class="sectlevel4">
<li><a href="#linuxmac-setup">LINUX/MAC SETUP</a></li>
<li><a href="#windows-setup">WINDOWS SETUP</a></li>
</ul>
</li>
<li><a href="#creating-a-plugin-back-end">4.4.10. CREATING A PLUGIN - BACK END</a>
<ul class="sectlevel4">
<li><a href="#introduction-2">INTRODUCTION</a></li>
<li><a href="#plugincyclesample_back-end">INITIALIZE THE ENVIRONMENT</a></li>
<li><a href="#create-an-entando-project">CREATE AN ENTANDO PROJECT</a></li>
<li><a href="#create-a-custom-component-project">CREATE A CUSTOM COMPONENT PROJECT</a></li>
<li><a href="#create-a-prototype-plugin-called-phonebook">CREATE A PROTOTYPE PLUGIN CALLED "PHONEBOOK"</a></li>
<li><a href="#create-plugin-with-edo-component-generator">CREATE PLUGIN WITH EDO (COMPONENT GENERATOR)</a></li>
<li><a href="#install-the-new-plugin-component">INSTALL THE NEW PLUGIN COMPONENT</a></li>
<li><a href="#add-the-plugin-to-an-entando-project">ADD THE PLUGIN TO AN ENTANDO PROJECT</a></li>
<li><a href="#app-builder-component">APP BUILDER COMPONENT</a></li>
</ul>
</li>
<li><a href="#plugincyclesample_front-end">4.4.11. CREATING A PLUGIN - FRONT END</a>
<ul class="sectlevel4">
<li><a href="#prerequisites-5">PREREQUISITES</a></li>
<li><a href="#installing-the-app-builder">INSTALLING THE APP BUILDER</a></li>
<li><a href="#adding-the-plugin-to-the-basic-app-builder-integration">ADDING THE PLUGIN TO THE BASIC APP BUILDER INTEGRATION</a></li>
<li><a href="#add-the-plugin-to-the-app-builder">ADD THE PLUGIN TO THE APP BUILDER</a></li>
<li><a href="#customize-the-plugin">CUSTOMIZE THE PLUGIN</a></li>
<li><a href="#apply-widget-configuration-forms">APPLY WIDGET CONFIGURATION FORMS</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#working-with-entando-widgets">4.5. WORKING WITH ENTANDO WIDGETS</a>
<ul class="sectlevel3">
<li><a href="#widget-catalog">4.5.1. WIDGET CATALOG</a></li>
<li><a href="#widget-catalog-examples">4.5.2. WIDGET CATALOG EXAMPLES</a></li>
<li><a href="#basic-widgets">4.5.3. BASIC WIDGETS</a>
<ul class="sectlevel4">
<li><a href="#example">EXAMPLE</a></li>
</ul>
</li>
<li><a href="#configuring-widgets">4.5.4. CONFIGURING WIDGETS</a></li>
<li><a href="#struts2-based-widgets">4.5.5. STRUTS2-BASED WIDGETS</a>
<ul class="sectlevel4">
<li><a href="#example-of-database-definition">EXAMPLE OF DATABASE DEFINITION</a></li>
<li><a href="#widget-configuration">WIDGET CONFIGURATION</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#list-of-entando-widgets">4.6. LIST OF ENTANDO WIDGETS</a>
<ul class="sectlevel3">
<li><a href="#widgetlist">4.6.1. CREATING A LOGIN PAGE</a>
<ul class="sectlevel4">
<li><a href="#example-login-form">Example login form</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#digital-exchange-2">4.7. DIGITAL EXCHANGE</a>
<ul class="sectlevel3">
<li><a href="#using-a-digital-exchange">4.7.1. USING A DIGITAL EXCHANGE</a>
<ul class="sectlevel4">
<li><a href="#loggingauditing-information">LOGGING/AUDITING INFORMATION</a></li>
</ul>
</li>
<li><a href="#setup-your-digital-exchange">4.7.2. SETUP YOUR DIGITAL EXCHANGE</a>
<ul class="sectlevel4">
<li><a href="#create-credentials-for-digital-exchange-clients">CREATE CREDENTIALS FOR DIGITAL EXCHANGE CLIENTS</a></li>
<li><a href="#create-a-component">CREATE A COMPONENT</a></li>
<li><a href="#configure-the-de-to-provide-a-component">CONFIGURE THE DE TO PROVIDE A COMPONENT</a></li>
<li><a href="#customize-component-rating">CUSTOMIZE COMPONENT RATING</a></li>
</ul>
</li>
<li><a href="#troubleshooting-2">4.7.3. TROUBLESHOOTING</a>
<ul class="sectlevel4">
<li><a href="#client-issues">Client issues</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#jboss-eap-deployment">4.8. JBOSS EAP DEPLOYMENT</a>
<ul class="sectlevel3">
<li><a href="#jboss_eap_deployment">4.8.1. PREREQUISITES</a></li>
<li><a href="#introduction-3">4.8.2. INTRODUCTION</a></li>
<li><a href="#procedure">4.8.3. PROCEDURE</a>
<ul class="sectlevel4">
<li><a href="#prepare-the-database">PREPARE THE DATABASE</a></li>
<li><a href="#jboss-configuration">JBOSS CONFIGURATION</a></li>
<li><a href="#entando-application-configuration">ENTANDO APPLICATION CONFIGURATION</a></li>
<li><a href="#filter-configuration">FILTER CONFIGURATION</a></li>
<li><a href="#building-the-war-file">BUILDING THE WAR FILE</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#migrating-entando-applictions">4.9. MIGRATING ENTANDO APPLICTIONS</a>
<ul class="sectlevel3">
<li><a href="#porting-from-entando-5-0-0-to-5-0-1">4.9.1. PORTING FROM ENTANDO 5.0.0 TO 5.0.1</a>
<ul class="sectlevel4">
<li><a href="#upgrade-your-database">UPGRADE YOUR DATABASE</a></li>
<li><a href="#upgrade-project-configuration">UPGRADE PROJECT CONFIGURATION</a></li>
</ul>
</li>
<li><a href="#porting-from-entando-5-0-0-to-5-1-0">4.9.2. PORTING FROM ENTANDO 5.0.0 TO 5.1.0</a>
<ul class="sectlevel4">
<li><a href="#upgrade-your-database-2">UPGRADE YOUR DATABASE</a></li>
<li><a href="#upgrade-your-project-configuration">UPGRADE YOUR PROJECT CONFIGURATION</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="e5.3.0"><a class="anchor" href="#e5.3.0"></a>1. ENTANDO 5.3.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="current-release-notes"><a class="anchor" href="#current-release-notes"></a>1.1. ENTANDO RELEASE NOTES</h3>
<div class="sect3">
<h4 id="entando-5-3-0-release-notes"><a class="anchor" href="#entando-5-3-0-release-notes"></a>1.1.1. ENTANDO 5.3.0 RELEASE NOTES</h4>
<div class="sect4">
<h5 id="new-capabilities-and-features"><a class="anchor" href="#new-capabilities-and-features"></a>NEW CAPABILITIES AND FEATURES</h5>

</div>
<div class="sect4">
<h5 id="documentation-and-deployment"><a class="anchor" href="#documentation-and-deployment"></a>DOCUMENTATION AND DEPLOYMENT</h5>
<div class="ulist">
<ul>
<li>
<p>New OpenShift templates and documentation including a new getting started experience to deploy Entando applications on OpenShift</p>
<div class="ulist">
<ul>
<li>
<p>See: <a href="http://developer.entando.com/#entando-on-openshift" class="bare">http://developer.entando.com/#entando-on-openshift</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>New examples, documentation, and templates to deploy Entando applications and AWS, Azure, and Google Cloud Engine using Kubernetes</p>
<div class="ulist">
<ul>
<li>
<p>See: <a href="http://developer.entando.com/#_cloud_deployments_on_aws_azure_and_gce" class="bare">http://developer.entando.com/#_cloud_deployments_on_aws_azure_and_gce</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Added documentation and examples for deploying using an Oracle database</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="content-management"><a class="anchor" href="#content-management"></a>CONTENT MANAGEMENT</h5>
<div class="ulist">
<ul>
<li>
<p>The Entando CMS now gives the content editor the ability to crop, flip, and generally interact with an image uploaded to the application. This includes the ability to define pre-built crop ratios that are available to image editors</p>
</li>
<li>
<p>The digital assets section of the CMS now allows for multiple images or attachments to be uploaded concurrently</p>
</li>
<li>
<p>Metadata attached to images can now be stored attached to an image and that metadata can be used to
automatically populate attributes defined in content types. For example, a description metadata tag on an image can be used to
populate a caption or text in the content</p>
</li>
<li>
<p>The Entando CMS now supports the manual upload of very large files via digital
assets. The files are loaded in chunks using base 64</p>
</li>
<li>
<p>The Entando CMS now allows for configuration to exclude content by id and
by type from versioning plugin. Generally useful when high volume content
delivered by API is generating large numbers of history records.</p>
</li>
<li>
<p>For updated CMS documentation and how to use the new features see:</p>
<div class="ulist">
<ul>
<li>
<p><a href="http://developer.entando.com/#_content_management_system" class="bare">http://developer.entando.com/#_content_management_system</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="digital-exchange"><a class="anchor" href="#digital-exchange"></a>DIGITAL EXCHANGE</h5>
<div class="literalblock">
<div class="content">
<pre>The release of Entando 5.1.0 includes the tech preview release of the Entando Digital Exchange which is a new model for distributing and installing Entando components. This release includes the ability to install and manage all of the UI elements of an Entando application. Follow our blog and YouTube channels for more to come on the Digital Exchange.
For documentation and getting started see:
http://developer.entando.com/#_digital_exchange</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="apis-and-endpoints"><a class="anchor" href="#apis-and-endpoints"></a>APIs AND ENDPOINTS</h5>
<div class="ulist">
<ul>
<li>
<p>Added new PATCH API capability to merge changes to page settings endpoints and established the framework for applying a PATCH in a custom API</p>
</li>
<li>
<p>Added the refresh token flow for OAuth and implemented token refresh in the App Builder</p>
</li>
<li>
<p>Added JSON REST APIs for content models and content types</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="fixes-and-updates"><a class="anchor" href="#fixes-and-updates"></a>FIXES AND UPDATES</h5>
<div class="ulist">
<ul>
<li>
<p>Resolved an issue where joinGroups weren’t updating on PUT calls</p>
</li>
<li>
<p>Resolved an issue in App Builder where in some cases the locale of the App
Builder was lost on a refresh</p>
</li>
<li>
<p>Updated processing around category creation when creating a new category
during the content creation workflow</p>
</li>
<li>
<p>Updated errors in the Inspinia and PAM page models included in the PAM
template</p>
</li>
<li>
<p>Resolved an issue where datatype date attributes were not returned correctly
in the app builder and updated data type actions in app builder</p>
</li>
<li>
<p>Resolved an issue where page model titles were not displayed correctly in some
cases</p>
</li>
<li>
<p>Resolved an issue in the CMS where the action button could become replicated</p>
</li>
<li>
<p>Resolved issues related to moving page nodes in the App Builder</p>
</li>
<li>
<p>General locale and translation updates for App Builder in Italian</p>
</li>
<li>
<p>Resolved CMS image category and search issues related to category join groups</p>
</li>
<li>
<p>Updated file download flow in the CMS to correctly download files on all
browsers</p>
</li>
<li>
<p>Updated scripts and builds to resolve issues in Windows</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="new-capabilities-in-integration-with-red-hat-pam"><a class="anchor" href="#new-capabilities-in-integration-with-red-hat-pam"></a>NEW CAPABILITIES IN INTEGRATION WITH RED HAT PAM</h5>
<div class="ulist">
<ul>
<li>
<p>Added a new widget to display task details related to a selected task in Red Hat PAM. See PAM Process Task Detail widget in the app</p>
</li>
<li>
<p>Added a new widget to allow a task form to be displayed independently on a page (the modal dialog functionality is unchanged.) See PAM-Task Form by DataType</p>
</li>
<li>
<p>Added significant new configuration options to the PAM Datatable task list widget including</p>
<div class="ulist">
<ul>
<li>
<p>Added configurable ability to claim a task directly from the task list</p>
</li>
<li>
<p>Added configurable ability to open a new page with task details when clicking on a row in the task list</p>
</li>
<li>
<p>Added the ability to include task variables as columns in the task list
Added the ability to disable the complete button in the task list</p>
</li>
</ul>
</div>
</li>
<li>
<p>Added process diagram widget to Inspinia BPM default widgets</p>
</li>
<li>
<p>Updated case comment</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="changes-and-updates-in-5-1-0-in-integration-with-red-hat-pam"><a class="anchor" href="#changes-and-updates-in-5-1-0-in-integration-with-red-hat-pam"></a>CHANGES AND UPDATES IN 5.1.0 IN INTEGRATION WITH RED HAT PAM</h5>
<div class="ulist">
<ul>
<li>
<p>Resolved an issue viewing the SVG for the process diagram based on browser updates</p>
</li>
<li>
<p>Resolved an issue where task details wouldn’t populate in some forms</p>
</li>
<li>
<p>Updated integration with PAM based on integration with additional process and task configurations in customer test cases</p>
</li>
<li>
<p>Updated task buttons to be fixed on the left hand side of task table</p>
</li>
<li>
<p>Resolved an issue rendering and selecting checkbox values in forms</p>
</li>
<li>
<p>Updated and resolved issues in form submission process for complex forms</p>
</li>
<li>
<p>Various updates to task list to support integration with additional PAM field types</p>
</li>
<li>
<p>Fixed round tripping for null values in forms and checkboxes</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="known-issues"><a class="anchor" href="#known-issues"></a>KNOWN ISSUES</h5>
<div class="ulist">
<ul>
<li>
<p>There is a known issue rendering the case comments widget independently. A patch will be provided to resolve this issue.</p>
</li>
<li>
<p>On AWS and Azure there is a library missing to run the demo on Wildfly. A patch will be provided to resolve this issue.</p>
</li>
<li>
<p>The process list widget will not render against PAM in some process definitions. To be patched in 5.1.1</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="software-requirements"><a class="anchor" href="#software-requirements"></a>SOFTWARE REQUIREMENTS</h5>
<div class="ulist">
<ul>
<li>
<p>Java 1.8</p>
</li>
<li>
<p>npm 5.6.0+ (for ReactJS front ends)</p>
</li>
<li>
<p>Maven 3.0.5+</p>
</li>
<li>
<p>Ant 1.8.0+</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="legal-notice"><a class="anchor" href="#legal-notice"></a>LEGAL NOTICE</h5>
<div class="ulist">
<ul>
<li>
<p>LGPL v2.1 License for the Core</p>
</li>
<li>
<p>MIT License for the components</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="links-and-resources"><a class="anchor" href="#links-and-resources"></a>LINKS AND RESOURCES</h5>
<div class="ulist">
<ul>
<li>
<p>Explore the code on GitHub: <a href="https://github.com/entando" class="bare">https://github.com/entando</a></p>
</li>
<li>
<p>See our Getting Started guide: <a href="http://developer.entando.com/#getting-started" class="bare">http://developer.entando.com/#getting-started</a></p>
</li>
<li>
<p>See our Custom App Building guide: <a href="http://developer.entando.com/#_custom_app_building_with_entando" class="bare">http://developer.entando.com/#_custom_app_building_with_entando</a></p>
</li>
<li>
<p>Contribute to the software: <a href="https://central.entando.com/en/community.page" class="bare">https://central.entando.com/en/community.page</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="entando-5-0-2-release-notes"><a class="anchor" href="#entando-5-0-2-release-notes"></a>1.1.2. ENTANDO 5.0.2 RELEASE NOTES</h4>

</div>
<div class="sect3">
<h4 id="abstract"><a class="anchor" href="#abstract"></a>1.1.3. ABSTRACT</h4>
<div class="paragraph">
<p>This document contains release notes for Entando 5.0.2. See <a href="#prior-release-notes">previous Entando release notes</a> for notes on earlier versions.</p>
</div>
</div>
<div class="sect3">
<h4 id="changes-in-5-0-2"><a class="anchor" href="#changes-in-5-0-2"></a>1.1.4. CHANGES IN 5.0.2</h4>
<div class="paragraph">
<p>Resolved an incorrect dependency version in entando-core and entando-components that reference a SNAPSHOT rather than a released library.</p>
</div>
<div class="sect4">
<h5 id="known-issues-2"><a class="anchor" href="#known-issues-2"></a>KNOWN ISSUES</h5>
<div class="paragraph">
<p>None</p>
</div>
</div>
<div class="sect4">
<h5 id="versioning-information"><a class="anchor" href="#versioning-information"></a>VERSIONING INFORMATION</h5>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Jars and artifacts included in this release:</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Artifact</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Version</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-core</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-archetypes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-ux-packages</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-components</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">app-builder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.2</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="software-requirements-2"><a class="anchor" href="#software-requirements-2"></a>SOFTWARE REQUIREMENTS</h5>
<div class="ulist">
<ul>
<li>
<p>Java 1.8+</p>
</li>
<li>
<p>npm 5.6.0+ (for ReactJS front ends)</p>
</li>
<li>
<p>Maven 3.0.5+</p>
</li>
<li>
<p>Ant 1.8.0+</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="legal-notice-2"><a class="anchor" href="#legal-notice-2"></a>LEGAL NOTICE</h5>
<div class="ulist">
<ul>
<li>
<p>LGPL v2.1 License for the Entando Core</p>
</li>
<li>
<p>MIT License for the components</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="links-and-resources-2"><a class="anchor" href="#links-and-resources-2"></a>LINKS AND RESOURCES</h5>
<div class="ulist">
<ul>
<li>
<p>Explore the code on GitHub: <a href="https://github.com/entando" class="bare">https://github.com/entando</a></p>
</li>
<li>
<p>See our Getting Started guide: <a href="http://developer.entando.com/#getting-started" class="bare">http://developer.entando.com/#getting-started</a></p>
</li>
<li>
<p>See our Custom App Building guide: <a href="http://developer.entando.com/#_custom_app_building_with_entando" class="bare">http://developer.entando.com/#_custom_app_building_with_entando</a></p>
</li>
<li>
<p>Contribute to the software: <a href="https://central.apps.entando.com/en/community.page" class="bare">https://central.apps.entando.com/en/community.page</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="entando-5-0-1-release-notes"><a class="anchor" href="#entando-5-0-1-release-notes"></a>1.1.5. ENTANDO 5.0.1 RELEASE NOTES</h4>
<div class="sect4">
<h5 id="abstract-2"><a class="anchor" href="#abstract-2"></a>ABSTRACT</h5>
<div class="paragraph">
<p>This document contains release notes for Entando 5.0.1.</p>
</div>
</div>
<div class="sect4">
<h5 id="changes-in-5-0-1"><a class="anchor" href="#changes-in-5-0-1"></a>CHANGES IN 5.0.1</h5>
<div class="paragraph">
<p><strong>Library and dependency updates</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>We have updated the following as part of a general review of dependencies and updates based on Sonar scans:<br></p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Dependency</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Updated to</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apache taglibs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.2.3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">commons-bean-utils</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.9.2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">commons-io</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CXF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.1.16</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Freemarker</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.3.36-incubating</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Junit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.8.2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">log4j</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.10.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.8.RELEASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring Security (new)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.7.RELEASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Struts2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.5.17</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Struts2-jquery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.0.3</p></td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Security updates</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>The dependency version updates above include changes based on Sonar OWASP dependency scans</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Swagger</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>This release includes the addition of Swagger API documentation on top of the existing Entando REST endpoints</p>
</li>
<li>
<p>Entando applications can extend Entando APIs and configure endpoints to be exposed via Swagger</p>
</li>
<li>
<p>Learn more here: <a href="http://developer.entando.com/#_configuring_swagger_optional" class="bare">http://developer.entando.com/#_configuring_swagger_optional</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>REST API Definition</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Resolved a bug that prevented custom package scans from exposing endpoints in Entando REST endpoints</p>
</li>
<li>
<p>Learn more about exposing REST endpoints in an Entando application: <a href="http://developer.entando.com/#_building_a_rest_api" class="bare">http://developer.entando.com/#_building_a_rest_api</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Red Hat Process Automation Manager (PAM) plugin</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Added a new page model to integrate and display all of the Entando case management widgets on a single page</p>
</li>
<li>
<p>Added support for new field types:</p>
<div class="ulist">
<ul>
<li>
<p>Check boxes</p>
</li>
<li>
<p>Radio buttons</p>
</li>
<li>
<p>List boxes</p>
</li>
<li>
<p>Text areas</p>
</li>
<li>
<p>Dates</p>
</li>
</ul>
</div>
</li>
<li>
<p>Available to be added to projects as a Maven dependency</p>
</li>
<li>
<p>Resolved error condition when connecting to PAM 7.1 instances</p>
</li>
<li>
<p>Updated <em>Form by Datatype</em> widget to support additional fields and resolved issues related to rendering forms for different models</p>
</li>
<li>
<p>Resolved issues related to rendering PAM widgets and pages</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Authentication and Authorization Model</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>The release in Entando 5.0.1 includes a change in authentication models from OLTU to Spring Security</p>
</li>
<li>
<p>Entando endpoints and user management are all now integrated with Spring security</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="defect-resolution-and-general-updates"><a class="anchor" href="#defect-resolution-and-general-updates"></a>Defect Resolution and General Updates</h5>
<div class="paragraph">
<p><strong>App Builder</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Resolved issue displaying and selecting join groups</p>
</li>
<li>
<p>Resolved page title display</p>
</li>
<li>
<p>Resolved label issue in data type and data model</p>
</li>
<li>
<p>Resolved issue related to the display of groups for widget types, content, and resources</p>
</li>
<li>
<p>Resolved username and email display issue in User Management</p>
</li>
<li>
<p>Resolved issue moving nodes in page tree</p>
</li>
<li>
<p>Added the ability to save an empty user profile</p>
</li>
<li>
<p>Added warning about deleting locked Fragments</p>
</li>
<li>
<p>Updated display of file and folder size in File Browser</p>
</li>
<li>
<p>Updated validation rules for username and password to match API requirements</p>
</li>
<li>
<p>Updated validation rules for page model and page naming to match API requirements</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>CMS</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Resolved issue with duplicated column names</p>
</li>
<li>
<p>Resolved issues editing content after adding a join group</p>
</li>
<li>
<p>Resolved breadcrumb display issue</p>
</li>
<li>
<p>Resolved edge condition in content preview actions</p>
</li>
<li>
<p>Resolved various issues surrounding the addition of attachments to content</p>
</li>
<li>
<p>Resolved issues in the addition and management of categories</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="known-issues-3"><a class="anchor" href="#known-issues-3"></a>Known Issues</h5>
<div class="paragraph">
<p>Some dependencies in 5.0.1 still reference snapshot versions of components and other related products. This will be resolved in 5.0.2.</p>
</div>
<div class="paragraph">
<p><strong>Versioning Information</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Jars and artifacts included in this release:</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Artifact</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Version</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-core</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-archetypes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-ux-packages</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-components</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">app-builder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.1</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="software-requirements-3"><a class="anchor" href="#software-requirements-3"></a>Software Requirements</h5>
<div class="ulist">
<ul>
<li>
<p>Java 1.8+</p>
</li>
<li>
<p>npm 5.6.0+ (for ReactJS front ends)</p>
</li>
<li>
<p>Maven 3.0.5+</p>
</li>
<li>
<p>Ant 1.8.0+</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="legal-notice-3"><a class="anchor" href="#legal-notice-3"></a>Legal Notice</h5>
<div class="ulist">
<ul>
<li>
<p>LGPL v2.1 license for the Entando core</p>
</li>
<li>
<p>MIT license for the components</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="links-and-resources-3"><a class="anchor" href="#links-and-resources-3"></a>Links and Resources</h5>
<div class="ulist">
<ul>
<li>
<p>Explore the code on GitHub: <a href="https://github.com/entando" class="bare">https://github.com/entando</a></p>
</li>
<li>
<p>See our Getting Started guide: <a href="http://developer.entando.com/#getting-started" class="bare">http://developer.entando.com/#getting-started</a></p>
</li>
<li>
<p>See our Custom App Building guide: <a href="http://developer.entando.com/#_custom_app_building_with_entando" class="bare">http://developer.entando.com/#_custom_app_building_with_entando</a></p>
</li>
<li>
<p>Contribute to the software: <a href="https://central.apps.entando.com/en/community.page" class="bare">https://central.apps.entando.com/en/community.page</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="entando-5-0-0-release-notes"><a class="anchor" href="#entando-5-0-0-release-notes"></a>1.1.6. ENTANDO 5.0.0 RELEASE NOTES</h4>
<div class="sect4">
<h5 id="abstract-3"><a class="anchor" href="#abstract-3"></a>ABSTRACT</h5>
<div class="paragraph">
<p>This document contains release notes for Entando 5.0.</p>
</div>
</div>
<div class="sect4">
<h5 id="preface"><a class="anchor" href="#preface"></a>PREFACE</h5>
<div class="paragraph">
<p>These release notes highlight new features in Entando 5.0, list features that are in technical preview, and include any known issues.</p>
</div>
</div>
<div class="sect4">
<h5 id="goal-of-entando-5"><a class="anchor" href="#goal-of-entando-5"></a>GOAL OF ENTANDO 5</h5>
<div class="paragraph">
<p>The goal of Entando 5.0 is to fully engage our platform with the Modern Applications revolution by designing for a cloud-based infrastructure, adapting our architecture to be more distributed, and fully supporting DevOps methodologies.</p>
</div>
</div>
<div class="sect4">
<h5 id="about-entando-5"><a class="anchor" href="#about-entando-5"></a>ABOUT ENTANDO 5</h5>
<div class="paragraph">
<p>Entando 5 represents a fundamental update to the Entando infrastructure to support modern application development processes including: new options for clustering, cloud native deployment, out of the box support for deploying apps in OpenShift, new UI technologies, and an updated widget development process.</p>
</div>
<div class="paragraph">
<p>These release notes provide a technical introduction to the changes included in Entando 5. Check out our Installation guide, Getting Started guide, or our blog for examples and more on putting Entando 5 to work.</p>
</div>
</div>
<div class="sect4">
<h5 id="whats-new-with-entando-5"><a class="anchor" href="#whats-new-with-entando-5"></a>WHAT&#8217;S NEW WITH ENTANDO 5</h5>
<div class="ulist">
<ul>
<li>
<p>Infrastructure/Platform</p>
<div class="ulist">
<ul>
<li>
<p>Hybrid hosting environment</p>
<div class="ulist">
<ul>
<li>
<p>Entando 5 supports deployment in both public and private cloud configurations including deployment using Docker and OpenShift</p>
</li>
</ul>
</div>
</li>
<li>
<p>Cloud native clustering using a JSR 107 compliant cache for scaling in the cloud</p>
<div class="ulist">
<ul>
<li>
<p>Entando 5 introduces the ability to back an installation of the MApp Engine-engine with a JSR 107 cache for multinode high availability (HA) configuration</p>
</li>
<li>
<p>A reference implementation using Infinispan is provided in the entando-components project</p>
</li>
</ul>
</div>
</li>
<li>
<p>Container deployment</p>
<div class="ulist">
<ul>
<li>
<p>Deploy directly to OpenShift using images published to the Red Hat catalog</p>
</li>
<li>
<p>Deploy using Docker images provided on DockerHub</p>
</li>
<li>
<p>Install an Entando project using provided Source to Image (S2I) Docker images</p>
</li>
</ul>
</div>
</li>
<li>
<p>New public facing REST APIs</p>
<div class="ulist">
<ul>
<li>
<p>Entando 5 exposes a new set of REST APIs for interacting with App Builder assets</p>
</li>
</ul>
</div>
</li>
<li>
<p>Decoupled application builder and micro engine for updated deployment options</p>
<div class="ulist">
<ul>
<li>
<p>This release decouples the application builder&#8217;s front end from the Entando engine allowing the engine and App Builder to be deployed separately. The updated application builder is a ReactJS based application that uses REST APIs and can be deployed and managed separately from the MApp Engine</p>
</li>
</ul>
</div>
</li>
<li>
<p>Upgrade to Spring 5</p>
</li>
<li>
<p>Security updates
We have performed security scans as part of the Entando 5 software release to ensure that we are using secure libraries and practicing secure coding practices within our application. We continue to use automated tools and manual security reviews to monitor and evaluate the security of the Entando platform. Notable updates include:</p>
<div class="ulist">
<ul>
<li>
<p>Various library version upgrades to match OWASP security scan results at time of release</p>
</li>
<li>
<p>Software updates to support SonarQube security scans and improve software security</p>
</li>
<li>
<p>The Entando core has been updated to Spring 5.0.5</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Processes</p>
<div class="ulist">
<ul>
<li>
<p>Supports DevOps processes</p>
<div class="ulist">
<ul>
<li>
<p>First class support for deploying Entando projects on Docker and OpenShift</p>
</li>
<li>
<p>New archetypes to deploy to OpenShift and Docker using Fabric8</p>
</li>
<li>
<p>Created Docker base images for quick extension and deployment</p>
</li>
</ul>
</div>
</li>
<li>
<p>Manage full CI/CD life cycle</p>
<div class="ulist">
<ul>
<li>
<p>Created reference implementation of Entando Docker images in Jenkins to create, deploy, and manage an application built using Entando in a CI/CD environment</p>
</li>
</ul>
</div>
</li>
<li>
<p>Decoupled CMS from MApp Engine</p>
<div class="ulist">
<ul>
<li>
<p>The CMS capability available in Entando 4.3.2 has been decoupled from the core MApp Engine implementation and will be available as a plugin to Entando 5 in a future release</p>
</li>
</ul>
</div>
</li>
<li>
<p>New component development experience</p>
<div class="ulist">
<ul>
<li>
<p>The Entando Component Generator (formerly edo) has been updated to use a configuration file to more easily select different types of components to generate</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="known-issues-4"><a class="anchor" href="#known-issues-4"></a>KNOWN ISSUES</h6>
<div class="ulist">
<ul>
<li>
<p>The ability to associate attributes with User Profiles is not implemented in the decoupled App Builder</p>
<div class="ulist">
<ul>
<li>
<p>Workaround: use the legacy application screens to add attributes to user profiles</p>
</li>
<li>
<p>Anticipated fix in first patch release</p>
</li>
</ul>
</div>
</li>
<li>
<p>Manually editing and saving Data Types and Data Models in the decoupled App Builder has errors</p>
<div class="ulist">
<ul>
<li>
<p>Workaround: use the legacy application screens to edit Data Types</p>
</li>
<li>
<p>Anticipated fix in future patch release</p>
</li>
</ul>
</div>
</li>
<li>
<p>If you move the homepage to a child of itself in the page tree it can result in browser and application stability problems</p>
</li>
<li>
<p>Anticipated fix in future patch release</p>
<div class="ulist">
<ul>
<li>
<p>The PAM Datatable and Task List widgets only function in the legacy App Builder</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="versioning-information-2"><a class="anchor" href="#versioning-information-2"></a>VERSIONING INFORMATION</h5>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Jars and artifacts included in this release:</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Artifact</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-core</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-archetypes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-ux-packages</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entando-vfs-manager</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">app-builder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MApp-Engine-admin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0.0</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="software-requirements-4"><a class="anchor" href="#software-requirements-4"></a>SOFTWARE REQUIREMENTS</h5>
<div class="ulist">
<ul>
<li>
<p>Java 1.8+</p>
</li>
<li>
<p>npm 5.6.0+ (for ReactJS front ends)</p>
</li>
<li>
<p>Maven 3.0.5+</p>
</li>
<li>
<p>Ant 1.8.0+</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="legal-notice-4"><a class="anchor" href="#legal-notice-4"></a>LEGAL NOTICE</h5>
<div class="ulist">
<ul>
<li>
<p>LGPL v2.1 License for the Core</p>
</li>
<li>
<p>MIT License for the components</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="links-and-resources-4"><a class="anchor" href="#links-and-resources-4"></a>LINKS AND RESOURCES</h5>
<div class="ulist">
<ul>
<li>
<p>Explore the code on GitHub: <a href="https://github.com/entando" class="bare">https://github.com/entando</a></p>
</li>
<li>
<p>See our Getting Started guide: <a href="http://developer.entando.com/#getting-started" class="bare">http://developer.entando.com/#getting-started</a></p>
</li>
<li>
<p>See our Custom App Building guide: <a href="http://developer.entando.com/#_custom_app_building_with_entando" class="bare">http://developer.entando.com/#_custom_app_building_with_entando</a></p>
</li>
<li>
<p>Contribute to the software: <a href="https://central.entando.com/en/community.page" class="bare">https://central.entando.com/en/community.page</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="installation"><a class="anchor" href="#installation"></a>1.2. INSTALLING ENTANDO APP BUILDER 5.0</h3>
<div class="sect3">
<h4 id="prerequisites"><a class="anchor" href="#prerequisites"></a>1.2.1. PREREQUISITES</h4>
<div class="sect4">
<h5 id="space-and-hardware-requirements"><a class="anchor" href="#space-and-hardware-requirements"></a>SPACE AND HARDWARE REQUIREMENTS</h5>
<div class="paragraph">
<p>Entando is a built to be a very light framework requiring limited runtime resources. When extending Entando in a development setting, sizing for development environments that add to an Entando install is up to individual user requirements.</p>
</div>
</div>
<div class="sect4">
<h5 id="installed-prerequisites"><a class="anchor" href="#installed-prerequisites"></a>INSTALLED PREREQUISITES:</h5>
<div class="ulist">
<ul>
<li>
<p>Java 1.8+</p>
</li>
<li>
<p>npm 5.6.0+ (for ReactJS front ends)</p>
</li>
<li>
<p>Maven 3.0.5+</p>
</li>
<li>
<p>Ant 1.8.0+</p>
</li>
<li>
<p>Git (to build from source)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="launching-the-app-builder"><a class="anchor" href="#launching-the-app-builder"></a>1.2.2. LAUNCHING THE APP BUILDER</h4>
<div class="paragraph">
<p>This section provides several options for launching the App Builder which is used to manage a separately running Mapp Engine instance.  The App Builder is completely stateless and relies on the Engine to store the application configuration.  If no Mapp engine is specified, the App Builder will default to providing mock data so that the functionality can be demonstrated.</p>
</div>
<div class="sect4">
<h5 id="building-from-source"><a class="anchor" href="#building-from-source"></a>BUILDING FROM SOURCE</h5>
<div class="paragraph">
<p><strong>Prerequisites:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>git</p>
</li>
<li>
<p>npm</p>
</li>
<li>
<p>node</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="clone-and-setup"><a class="anchor" href="#clone-and-setup"></a>CLONE AND SETUP</h6>
<div class="paragraph">
<p><strong>Enter the following commands in your command line:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>git clone https://github.com/entando/app-builder.git</code></p>
</li>
<li>
<p><code>cd app-builder</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>It is recommended to checkout the release branch corresponding to the version of the Mapp Engine</p>
</li>
<li>
<p>e.g., <code>git checkout v5.0.0-release</code></p>
</li>
<li>
<p>Available release branches can be listed with: <code>git branch -a</code></p>
</li>
</ol>
</div>
</li>
<li>
<p><code>npm install</code><br></p>
</li>
<li>
<p><code>npm start</code>&#8201;&#8212;&#8201;Starts the application in dev mode (local web server).</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The npm install command installs npm dependencies inside the node_modules folder</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This will give you a running app-builder instance using mock data. The Configuration section below covers connecting your App Builder to a running MApp engine.</p>
</div>
</div>
<div class="sect5">
<h6 id="configuration"><a class="anchor" href="#configuration"></a>CONFIGURATION</h6>
<div class="paragraph">
<p>There are two methods for using the App Builder, depending on whether the API calls will be to the live Entando Core or if they will use mock data. <strong><strong></strong><strong></strong></strong>You have to join with the configurable properties.<strong><strong></strong><strong></strong></strong>**</p>
</div>
<div class="olist arabic">
<div class="title">Configurable properties</div>
<ol class="arabic">
<li>
<p><strong>USE_MOCKS (boolean):</strong> a Boolean setting that determines if the App Builder uses a live connection to the Entando Core or uses mock data. A value of "true" instructs the App Builder to use mock data. A value of "false" allows the App Builder&#8217;s APIs to make live data calls to the Entando Core.</p>
</li>
<li>
<p><strong>DOMAIN (string):</strong> a string representing the domain name of the Entando Core instance. The protocol is optional and you can specify a subdirectory of the domain. Trailing slashes are invalid and it only validates up to third-level domains.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you set USE_MOCKS to "false," you must run an Entando Core (MApp Engine) instance and
then to connect the App Builder to the MApp Engine using the following steps:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Run the MApp Engine instance. See Running the MApp Engine section for more information.</p>
</li>
<li>
<p>Connect the MApp Engine.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you set USE_MOCKS to "true," you do not need to run the App Builder instance because you are only using mock data.</p>
</div>
<div class="paragraph">
<p><strong>To connect the MApp Engine</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a file at the root of the app-builder called <em>.env.development.local</em>.</p>
</li>
<li>
<p>Add 'USE_MOCKS=false'</p>
</li>
<li>
<p>Add DOMAIN=&lt;url of running MApp Engine&gt;</p>
</li>
<li>
<p>Run <code>npm start</code> in your App Builder.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="additional-commands"><a class="anchor" href="#additional-commands"></a>Additional Commands</h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>npm run lint</code></dt>
<dd>
<p>Runs the linter to check code style. It fails if linting rules are not matched.</p>
</dd>
<dt class="hdlist1"><code>npm run coverage</code></dt>
<dd>
<p>Runs unit tests. It fails if a unit test fails, or if the minimum coverage threshold is not met.</p>
</dd>
<dt class="hdlist1"><code>npm run import-plugins</code></dt>
<dd>
<p>Compiles and imports Entando plugins.</p>
</dd>
<dt class="hdlist1"><code>npm run build</code></dt>
<dd>
<p>Compiles the project and creates the a production build</p>
</dd>
<dt class="hdlist1"><code>npm run build-full</code></dt>
<dd>
<p>Runs npm run lint, npm run coverage, npm run import-plugins and npm run build</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;ADD CONFIGURING BPM HERE FOR RH VERSION&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="running-the-mapp-engine-instance"><a class="anchor" href="#running-the-mapp-engine-instance"></a>1.2.3. RUNNING THE MAPP ENGINE INSTANCE</h4>
<div class="sect4">
<h5 id="creating-a-new-entando-project"><a class="anchor" href="#creating-a-new-entando-project"></a>CREATING A NEW ENTANDO PROJECT</h5>
<div class="paragraph">
<p>Set up an Entando application via a Maven archetype. The archetype creates the project and structure needed to develop and add to an application.</p>
</div>
<div class="paragraph">
<p><strong>Steps:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open your command line and navigate to the directory that will house your new project.</p>
</li>
<li>
<p>Run the following command:<br>
<code>mvn archetype:generate -Dfilter=entando-archetype-webapp-generic</code></p>
</li>
<li>
<p>Select Option 1, displayed as follows:<br>
<code>1: remote &gt; org.entando.entando:entando-archetype-webapp-generic (Generic web app Archetype for Entando: an agile, modern and user-centric open source web app like platform.)</code></p>
</li>
<li>
<p>If prompted for a version, select 5.0.0.</p>
</li>
<li>
<p>Enter values for groupId, artifactId, version, and package. These values go into the Maven setup in the new project. See the Maven documentation for more information on these values. <a href="https://maven.apache.org/guides/mini/guide-naming-conventions.html" class="bare">https://maven.apache.org/guides/mini/guide-naming-conventions.html</a></p>
</li>
<li>
<p>Open the directory created by the Maven archetype in Step 2. The directory will have the same name as the value you entered for artifactId in Step 5. This directory contains all of the structure necessary to start the Entando MApp-Engine and execute the application. See Launching the Application section below for instructions on starting the newly created project.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="launching-the-mapp-engine"><a class="anchor" href="#launching-the-mapp-engine"></a>LAUNCHING THE MAPP ENGINE</h5>
<div class="sect5">
<h6 id="quick-start-using-derby-and-jetty"><a class="anchor" href="#quick-start-using-derby-and-jetty"></a>QUICK START USING DERBY AND JETTY</h6>
<div class="paragraph">
<p>Once you have created an Entando application, you can launch it using Jetty and an embedded Derby database.</p>
</div>
<div class="paragraph">
<p>To do so, run the following command inside your project:<br>
<code>mvn clean jetty:run</code></p>
</div>
<div class="paragraph">
<p><strong>Once started the logs will print the following messages:</strong><br>
  [INFO] Started SelectChannelConnector@0.0.0.0:8080<br>
  [INFO] Started Jetty Server<br>
  [INFO] Starting scanner at interval of 5 seconds</p>
</div>
<div class="paragraph">
<p>The logs will indicate that your application is running. To launch your application, point your browser to <a href="http://localhost:8080/">your app name</a></p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="building-the-mapp-engine-from-source-code"><a class="anchor" href="#building-the-mapp-engine-from-source-code"></a>1.2.4. BUILDING THE MAPP ENGINE FROM SOURCE CODE</h4>
<div class="paragraph">
<p><strong>To download the latest source code:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open your terminal and create an empty directory for your project:<br>
<code>mkdir ~/my_new_project</code></p>
</li>
<li>
<p>Move to the new directory:<br>
<em>cd ~/my_new_project</em></p>
</li>
<li>
<p>Clone the following repositories IN ORDER: entando-core, entando-components, entando-archetypes, entando-ux-packages projects:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Entando-core:<br>
<code>git clone https://github.com/entando/entando-core</code></p>
</li>
<li>
<p>Entando-components:<br>
<code>git clone https://github.com/entando/entando-components</code></p>
</li>
<li>
<p>Entando-archetypes:<br>
<code>git clone https://github.com/entando/entando-archetypes</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>Install, IN ORDER, the entando-core, entando-components, entando-archetypes projects:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>cd entando-core<br>
<code>mvn clean install -DskipTests</code></p>
</li>
<li>
<p>cd entando-components<br>
<code>mvn clean install -DskipTests</code></p>
</li>
<li>
<p>cd entando-archetypes<br>
<code>mvn clean install -DskipTests</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>Complete the download by following the steps from the Creating a New Entando Project section.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>At this point you have installed all of the dependencies required to build a new MApp Engine instance.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The command to use the artifacts you have installed locally with an additional switch on the archetype command to use local values only is:<br>
<code>mvn archetype:generate -Dfilter=entando-archetype-webapp-generic -DarchetypeCatalog=local</code></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="setting-up-a-database-optional"><a class="anchor" href="#setting-up-a-database-optional"></a>1.2.5. SETTING UP A DATABASE (OPTIONAL)</h4>
<div class="paragraph">
<p>You can configure a newly created Entando application to connect to a database as its backing store. Derby is the default configuration in archetype-created applications, but you can change the default to a different value. Open the Filter Properties file in src/main/filters and enter the appropriate environment and database configuration.</p>
</div>
<div class="paragraph">
<p>Create two databases in your dbms.</p>
</div>
<div class="paragraph">
<p><strong>To connect the MApp Engine to a database server:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In your database server, create a user for the application.</p>
</li>
<li>
<p>Create two databases. Give the user from Step 1 permission to create, read, and write. For the quickstart, you should name the databases as follows:</p>
<div class="literalblock">
<div class="content">
<pre>&lt;your-project-name&gt;Port
&lt;your-project-name&gt;Serv</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>These are the default names included in the default properties files.
You can adjust the names and then change the connection information in the project&#8217;s configuration filters in src/main/filters.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>You also need to uncomment the maven dependency for the database that your are using from the <em>pom.xml</em> file. For example for MySQL you would uncomment:</p>
<div class="literalblock">
<div class="content">
<pre>&lt;dependency&gt;
        &lt;groupId&gt;mysql&lt;/groupId&gt;
        &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
        &lt;version&gt;5.1.18&lt;/version&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</li>
<li>
<p>Update the appropriate Filter Properties file in src/main/filters to use the configuration for the database properties. For example, on a MacOS, you would update  <em>filter-development-unix.properties</em>.</p>
</li>
<li>
<p>Set the user, database, and password for the values created in Steps 1 and 2.</p>
</li>
<li>
<p>Launch the application with <code>mvn jetty:run</code></p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When launching with the <code>mvn jetty:run command</code>, Jetty will automatically create the table structure required
to run the application if the tables aren&#8217;t already present. This can be used to instantiate an empty database
for future use when the target deployment is an app server such as JBoss or Tomcat.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To use the Docker S2I images, you must have already set up a database. See the Setting up a Database section for details.</p>
</div>
<div class="paragraph">
<p>By default, the app deployed in Docker will connect to a Postgres database to persist resources created using the App Builder and by the MApp Engine. In the app created from the archetype, update the properties in:
<strong>&lt;your application&gt;/.s2i/environment</strong> to point to the user and databases created in the Setting up a Database section.</p>
</div>
<div class="paragraph">
<p><strong>After configuring the database:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Pull in the Docker image using the following command:<br>
<code>docker pull entando/builder-s2i</code></p>
</li>
<li>
<p>Build the image using S2I using the command to build and deploy a Docker app in Docker:<br>
<code>s2i build &lt;path or URL of your project&gt; entando/builder-s2i &lt;your  image name&gt;</code><br>
Where:<br></p>
<div class="ulist">
<ul>
<li>
<p><strong>&lt;path or URL of your project&gt;</strong> is the path to your project or a URL to access the code. The build for this project will be invoked and the resulting war file deployed to the app server in the image</p>
</li>
<li>
<p><strong>entando/builder-s2i</strong> is the name of the base S2I docker image provided by Entando</p>
</li>
<li>
<p><strong>&lt;your image name&gt;</strong> is the name for this docker image</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Run the Image</strong>:</p>
</div>
<div class="paragraph">
<p>To start running the image, run the following command:<br>
<code>docker run -d -p 8080:8080 &lt;your image name&gt;</code></p>
</div>
<div class="paragraph">
<p>The app may take some time to start. It is downloading maven dependencies at startup.  Your app will be available on <a href="http://localhost:8080/your_project_name" class="bare">http://localhost:8080/your_project_name</a> after startup is complete.</p>
</div>
<div class="sect4">
<h5 id="using-docker"><a class="anchor" href="#using-docker"></a>USING DOCKER</h5>
<div class="paragraph">
<p><strong>Full Stack Example Images</strong></p>
</div>
<div class="paragraph">
<p>The project below includes scripts and example images that will boot up a full stack of Entando apps in Docker.
<a href="https://github.com/entando/entando-ops/tree/master/Docker/Production/entando-full-stack" class="bare">https://github.com/entando/entando-ops/tree/master/Docker/Production/entando-full-stack</a></p>
</div>
<div class="paragraph">
<p>These projects are useful to quickly boot up an Entando environment in Docker.
Can be forked/cloned for extension and updates as needed as well. Scripts and image names
can be seen in the repository</p>
</div>
<div class="paragraph">
<p><strong>Base Image</strong></p>
</div>
<div class="paragraph">
<p>This base image provides a base Dockerfile that can be extended to create and manage an Entando application.
The base image downloads all of the maven dependencies required for an application to run so the initial run can take some time however
after that edits to a child Dockerfile will run fast. The base example in the Readme uses a jetty/derby combination for execution</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/entando/entando-ops/tree/master/Docker/Production/builder-images/docker-builder-5" class="bare">https://github.com/entando/entando-ops/tree/master/Docker/Production/builder-images/docker-builder-5</a></p>
</div>
<div class="paragraph">
<p><strong>Using S2I to Build Docker Images</strong></p>
</div>
<div class="paragraph">
<p>To use the Docker S2I images, you must have already set up a database. See the Setting up a Database section for details.</p>
</div>
<div class="paragraph">
<p>By default, the app deployed in Docker will connect to a Postgres database to persist resources created using the App Builder and by the MApp Engine.
In the app created from the archetype, update the properties in:
<strong>&lt;your application&gt;/.s2i/environment</strong> to point to the user and databases created in the Setting up a Database section.</p>
</div>
<div class="paragraph">
<p><strong>After configuring the database:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Pull in the Docker image using the following command:<br>
<code>docker pull entando/builder-s2i</code> (Demo image using Jetty)</p>
</li>
<li>
<p>Build the image using S2I using the command to build and deploy a Docker app in Docker:<br>
<code>s2i build &lt;path or URL of your project&gt; entando/builder-s2i &lt;your  image name&gt;</code><br>
<strong>Where:</strong><br></p>
<div class="ulist">
<ul>
<li>
<p><strong>&lt;path or URL of your project&gt;</strong> is the path to your project or a URL to access the code. The build for this project will be invoked and the resulting war file deployed to the app server in the image</p>
</li>
<li>
<p><strong>entando/builder-s2i</strong> is the name of the base S2I docker image provided by Entando</p>
</li>
<li>
<p><strong>&lt;your image name&gt;</strong> is the name for this docker image</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Run the Image</strong></p>
</div>
<div class="paragraph">
<p><code>docker run -d -p 8080:8080 &lt;your image name&gt;</code></p>
</div>
<div class="paragraph">
<p>The app may take some time to start. It is downloading maven dependencies at startup.
Your app will be available on <a href="http://localhost:8080/&lt;your_project_name&gt" class="bare">http://localhost:8080/&lt;your_project_name&gt</a>; after startup is complete.</p>
</div>
<div class="paragraph">
<p>By default the image exposes port 8080 however you can change the local port mapped to that value
by editing the first instance of 8080 in the docker run command above.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="app-building-with-entando"><a class="anchor" href="#app-building-with-entando"></a>1.3. APP BUILDING WITH ENTANDO</h3>
<div class="sect3">
<h4 id="introducing-the-entando-app-builder"><a class="anchor" href="#introducing-the-entando-app-builder"></a>1.3.1. INTRODUCING THE ENTANDO APP BUILDER</h4>
<div class="paragraph">
<p>The App Builder is Entando’s application to help you integrate, configure and customize any kind of modern web application, regardless of your programming proficiency. The App Builder provides an Admin Console, a visual environment, that collects elements for configuring your web application and managing your activities.</p>
</div>
<div class="paragraph">
<p>The App Builder is a ReactJS-based application that uses REST APIs to communicate with the Entando Core.</p>
</div>
<div class="paragraph">
<p>This document describes the elements and functionalities of the Admin Console.</p>
</div>
<div class="sect4">
<h5 id="entando-admin-console-version-5-0"><a class="anchor" href="#entando-admin-console-version-5-0"></a>ENTANDO ADMIN CONSOLE VERSION 5.0</h5>
<div class="paragraph">
<p>With Entando version 5.0 the Admin Console has been redesigned and renewed with the adoption of the PatternFly framework and guidelines. PatternFly is built on top of Bootstrap3 and provides an enterprise grade UX look and feel based on research and UX best practices.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="app-builder-overview"><a class="anchor" href="#app-builder-overview"></a>1.3.2. APP BUILDER OVERVIEW</h4>
<div class="paragraph">
<p>The Entando main view is the entry point for every administration activity. On the up side of the screen there is an horizontal menu, which gives access to all Entando’s functionalities, while on the down-side of the screen, the Dashboard provides an overview of Entando status and a quick access to some functionalities.</p>
</div>
</div>
<div class="sect3">
<h4 id="dashboard"><a class="anchor" href="#dashboard"></a>1.3.3. DASHBOARD</h4>
<div class="paragraph">
<p>The dashboard is divided into distinct areas.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/custom_dashboard.png" alt="custom dashboard">
</div>
</div>
<div class="olist arabic">
<div class="title">Dashboard areas:</div>
<ol class="arabic">
<li>
<p>Page Status (gives an overview of the status of the pages: Online, Online /= Draft and Draft)</p>
</li>
<li>
<p>List of Pages (gives an overview of the list of all Pages: Name, configured Page Model, Number of configured Widgets, Status, Last Modified)</p>
</li>
<li>
<p>Add Page (possibility to add a new Page)</p>
</li>
<li>
<p>User Management (quick access to Users list and Group list)</p>
</li>
<li>
<p>Add User (possibility to add a new User)</p>
</li>
<li>
<p>UX Patterns (gives an overview of the number of configured Widgets and Page Models)</p>
</li>
<li>
<p>Add Widget (possibility to add a new Widget)</p>
</li>
<li>
<p>Integrations (gives an overview of the number of integrated components and APIs)</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="creating-and-managing-pages-with-page-designer"><a class="anchor" href="#creating-and-managing-pages-with-page-designer"></a>1.3.4. CREATING AND MANAGING PAGES WITH PAGE DESIGNER</h4>
<div class="paragraph">
<p>The Page Designer section deals with all page management-related activities.</p>
</div>
<div class="olist arabic">
<div class="title">The Page Designer section offers the following subsections:</div>
<ol class="arabic">
<li>
<p>Page Tree</p>
</li>
<li>
<p>Page Configuration</p>
</li>
<li>
<p>Page Settings</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="using-the-page-tree"><a class="anchor" href="#using-the-page-tree"></a>USING THE PAGE TREE</h5>
<div class="paragraph">
<p>The Page Tree subsection shows the hierarchical structure of the pages and their statuses, and lets you perform all page management actions.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/custom_page_tree.png" alt="custom page tree">
</div>
</div>
<div class="sect5">
<h6 id="creating-a-new-page"><a class="anchor" href="#creating-a-new-page"></a>CREATING A NEW PAGE</h6>
<div class="olist arabic">
<div class="title">To add a new page:</div>
<ol class="arabic">
<li>
<p>From the tabs along the time, choose the Page Designer &gt; Page Tree &gt; <strong>Add</strong>.</p>
</li>
<li>
<p>Enter a name in both the English and Italian fields.</p>
</li>
<li>
<p>(Optional) Enter a code. By default, Entando generates a code similar to the page title, but you can manually enter a different code. The field accepts alphanumeric characters and underscores, with a character limit of 30.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Once you save the page, you will no longer be able to edit the page&#8217;s Code field.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p><a id="ownjoingroups"></a>Select an Owner Group and a Join Group from the drop-down menus in the Page groups section. Owner Group members can administer the page. Join Group members can view the page.</p>
</li>
<li>
<p>Select from the Page Tree section the page or folder that will be the parent of the new page.</p>
</li>
<li>
<p>Select a Page Model from the Page Model drop-down menu. The Page Model determines the layout of your new page. See the <a href="#page-models">Using Page Models</a> section below.</p>
</li>
<li>
<p>Set additional options from the Settings section as needed.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Displayed in menu:</strong> toggles the page&#8217;s presence in the menu on or off.</p>
</li>
<li>
<p><strong>SEO:</strong> sets toggles on or off optimization of the page for Search Engine Optimization (SEO)</p>
</li>
<li>
<p><strong>Charset:</strong> specifies the character encoding to use. Selectable between utf8 and iso-88591</p>
</li>
<li>
<p><strong>Mime Type:</strong> identifies the type of content on the page</p>
</li>
</ul>
</div>
</li>
<li>
<p>After you have made your selections, click <strong>Save and Configure</strong> to open the Configuration section. Learn more in the <a href="#configuring-page">Configuring a Page</a> section below.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/custom_newpage.png" alt="custom newpage">
</div>
</div>
<div class="olist arabic">
<div class="title">To edit an existing page:</div>
<ol class="arabic">
<li>
<p>Open the Page Tree and find the page to edit.</p>
</li>
<li>
<p>Click the <strong>Actions</strong> (three vertical dots) button in line with the page and select "Edit."</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="configuring-page"><a class="anchor" href="#configuring-page"></a>CONFIGURING A PAGE</h5>
<div class="paragraph">
<p>The Page Configuration section is where you assign widgets to the frames defined by the Page Model you applied to your page. The available widgets are in the right pane. Apply widgets by dragging and dropping them to a frame of your choice.</p>
</div>
<div class="paragraph">
<p>This is also where you publish or unpublish the page or preview the layout prior to publishing.</p>
</div>
<div class="paragraph">
<p>Click the <strong>Info</strong> button for a summary of options you assigned when creating the page, e.g., Title and Owner Group.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/custom_configure.png" alt="custom configure">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ux-patterns-managing-widgets-page-models-and-fragments"><a class="anchor" href="#ux-patterns-managing-widgets-page-models-and-fragments"></a>1.3.5. UX PATTERNS: MANAGING WIDGETS, PAGE MODELS, AND FRAGMENTS</h4>
<div class="paragraph">
<p>The UX Patterns section provides settings options for your general UX Patterns.</p>
</div>
<div class="sect4">
<h5 id="using-widgets"><a class="anchor" href="#using-widgets"></a>USING WIDGETS</h5>
<div class="paragraph">
<p>A Widget is an independent software component configured and executed within your application’s page. Widgets provide UX/UI blocks that deliver a specific function.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/custom_widgets.png" alt="custom widgets">
</div>
</div>
<div class="ulist">
<div class="title">The following are the categories of widgets:</div>
<ul>
<li>
<p><strong>User Widgets:</strong> user-generated widgets created via the Admin Console</p>
</li>
<li>
<p><strong>Custom Widgets:</strong> widgets designed to meet specific applications needs such as Red Hat PAM widgets</p>
</li>
<li>
<p><strong>Stock Widgets:</strong> default widgets provided by the App Builder to perform common tasks</p>
</li>
<li>
<p><strong>Specific Application Widgets:</strong> widgets that apply only to a specific tool in Entando, e.g., the installation of CMS module provides Content Management related widgets</p>
</li>
<li>
<p><strong>Plugins Widgets:</strong> widgets provided by the installed plugins</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Each widget&#8217;s Action menu differs depending on the type, including no available actions at all.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="using-fragments"><a class="anchor" href="#using-fragments"></a>USING FRAGMENTS</h5>
<div class="paragraph">
<p>Fragments are single portions of front-end interface used in widgets (including plugins) and Page Models. They are are HTML blocks that include Freemarker instructions by using specific tags that you replace with appropriate values each time you use the fragment. Entando then renders the widgets using the fragments. The FRAGMENTS section lets you manage existing fragments or add new ones.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/custom_fragments.png" alt="custom fragments">
</div>
</div>
<div class="sect5">
<h6 id="adding-a-new-fragment"><a class="anchor" href="#adding-a-new-fragment"></a>ADDING A NEW FRAGMENT</h6>
<div class="olist arabic">
<div class="title">To add a new fragment:</div>
<ol class="arabic">
<li>
<p>From the tabs along the top, choose the UX Patters tab &gt; Fragments &gt; <strong>New</strong>.</p>
</li>
<li>
<p>Enter a Code value. This value represents the fragment&#8217;s unique identifier and appears in the Name column of the Fragments table.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Once you save the fragment, you will no longer be able to edit its Code field.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="page-models"><a class="anchor" href="#page-models"></a>USING PAGE MODELS</h5>
<div class="paragraph">
<p>The Page Model is the look and feel of an application&#8217;s page. It defines the structure of the page using frames or areas of the page that contain widgets.</p>
</div>
<div class="ulist">
<div class="title">Page models have two configuration elements:</div>
<ul>
<li>
<p><strong>JSON Configuration:</strong> formatted text that defines the frame structure of the page.</p>
</li>
<li>
<p><strong>Template:</strong> the look and feel and the real layout of the page. In other words, the template defines where to show a frame and how it will be rendered. Templates use Velocity Template Language (VTL) to provide an simple and clean way to incorporate dynamic content into a web page. It supports statements and directives, references and comments, access to exposed java objects, and methods.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="creating-a-page-model"><a class="anchor" href="#creating-a-page-model"></a>CREATING A PAGE MODEL</h6>
<div class="olist arabic">
<div class="title">To create a new page model:</div>
<ol class="arabic">
<li>
<p>From the tabs along the top, select UX Patterns &gt; Page Models &gt; <strong>Add</strong>.</p>
</li>
<li>
<p>Assign the page model a code and a name. Codes represent the page model’s unique identifier. The name can be more human readable. For example:<br>
<strong>Code:</strong> <em>entando_page_purple</em><br>
<strong>Name:</strong> <em>Purple - BPM</em></p>
</li>
<li>
<p>In the JSON Configuration field, enter JSON content to structure the page. For example:</p>
<div class="listingblock">
<div class="content">
<pre>{
  "frames": [
    {
      "pos": 0,
      "descr": "Top bar 1",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 0,
        "y1": 0,
        "x2": 2,
        "y2": 0
      }
    }
  ]
}</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The JSON content must be a single object defining "frames." In other words, the content you enter must go within the <code>frames: []</code> object.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See the Getting Started with Entando App Builder document for a complete example.</p>
</div>
</li>
<li>
<p>In the Template field, enter XML formatting to determine where each defined frame belongs and how to render it. See for a complete example.</p>
</li>
<li>
<p>When finished, click <strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/custom_pagemodel.png" alt="custom pagemodel">
</div>
</div>
</div>
<div class="sect5">
<h6 id="using-the-inspinia-bpm-case-management-widgets-page-model"><a class="anchor" href="#using-the-inspinia-bpm-case-management-widgets-page-model"></a>USING THE "INSPINIA - BPM CASE MANAGEMENT WIDGETS" PAGE MODEL</h6>
<div class="paragraph">
<p>The <em>Inspinia - BPM Case Management Widgets</em> page model is a pre-designed model that displays all Process Application Management (PAM) case management widgets on a single page. The list of widgets that this page model deploys is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Case selector</p>
</li>
<li>
<p>Case details</p>
</li>
<li>
<p>Case progress status</p>
</li>
<li>
<p>Case roles</p>
</li>
<li>
<p>Case comments</p>
</li>
<li>
<p>Case instance diagram</p>
</li>
<li>
<p>BPM case charts</p>
</li>
<li>
<p>Case instance file</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">To use the BPM Case Management Widgets page model:</div>
<ol class="arabic">
<li>
<p>Select <em>Inspinia - BPM Case Management widgets</em> when declaring the page model for your page.</p>
</li>
<li>
<p>Click <strong>Save and Configure</strong> when you have set all options for your page.</p>
</li>
<li>
<p>On the resulting screen, click <strong>Apply the default widget</strong>.</p>
<div class="imageblock">
<div class="content">
<img src="./images/custom_app_inspinia1.png" alt="custom app inspinia1">
</div>
</div>
</li>
<li>
<p>After the page model loads, select the <strong>Actions</strong> menu from the top frame titled "PAM - Case instance selector" and select "Settings."</p>
<div class="imageblock">
<div class="content">
<img src="./images/custom_app_inspinia2.png" alt="custom app inspinia2">
</div>
</div>
</li>
<li>
<p>Select the relevant Knowledge Source and Deployment Unit and click the orange button if you changed any options.</p>
</li>
<li>
<p>Click <strong>Save</strong> and view the page.</p>
</li>
<li>
<p>Select a case from the list of cases and click <strong>Select</strong> to populate all widgets with data from your selected case.</p>
<div class="imageblock">
<div class="content">
<img src="./images/custom_app_inspinia3.png" alt="custom app inspinia3">
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For more information on PAM integrations, see the Integrating with a Process Application Manager section.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="integrating-with-red-hat-process-automation-manager-pam"><a class="anchor" href="#integrating-with-red-hat-process-automation-manager-pam"></a>1.3.6. INTEGRATING WITH RED HAT PROCESS AUTOMATION MANAGER (PAM)</h4>
<div class="paragraph">
<p>Entando integrates with Red Hat&#8217;s Process Automation Manager (formerly Red Hat JBoss BPM Suite), a middleware platform for creating cloud-native business automation applications and microservices. It enables enterprise business and IT users to document, simulate, manage, automate and monitor business processes and policies. It is designed to empower business and IT users to collaborate more effectively, so business applications can be changed more easily and quickly.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/custom_integrations.png" alt="custom integrations">
</div>
</div>
<div class="olist arabic">
<div class="title">To integrate with Red Hat PAM:</div>
<ol class="arabic">
<li>
<p>From the tabs along the top, choose Integrations &gt; Red Hat BPM Config &gt; <strong>Add Integration</strong>.</p>
</li>
<li>
<p>In the Connection section, add all server information. For example:<br></p>
<div class="ulist">
<ul>
<li>
<p>General Settings section:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Active:</strong> On</p>
</li>
<li>
<p>(Optional) <strong>Debug:</strong> On</p>
</li>
</ul>
</div>
</li>
<li>
<p>Connection section:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name:</strong> Ansible Server</p>
</li>
<li>
<p><strong>Host name:</strong> ansible.serv.run</p>
</li>
<li>
<p><strong>Schema:</strong> http</p>
</li>
<li>
<p><strong>Port:</strong> 8080</p>
</li>
<li>
<p><strong>Webapp name:</strong> kie-server</p>
</li>
<li>
<p><strong>Username:</strong> username for the process server administrator</p>
</li>
<li>
<p><strong>Password:</strong> password for the process server administrator</p>
</li>
<li>
<p><strong>Conn. Timeout (in millis):</strong> 500</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>Test Connection</strong> to verify a valid the configuration, then click <strong>Save</strong>.</p>
</li>
<li>
<p>Open the Page Tree by choosing the Page Designer tab &gt; Page Tree.</p>
</li>
<li>
<p>Find your new page in the Page Tree and click its <strong>More Options</strong> button &gt; Configure.</p>
</li>
<li>
<p>In the right pane, search for the “BPM-form by Data Type” widget and drag it to a frame established by your page model.</p>
</li>
<li>
<p>Click the <strong>Preview</strong> button to verify the correct appearance.</p>
</li>
<li>
<p>Click <strong>Publish</strong> once your page is complete.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="managing-users"><a class="anchor" href="#managing-users"></a>1.3.7. MANAGING USERS</h4>
<div class="paragraph">
<p>The Entando App Builder assigns access rights using combinations of roles and groups. You can manage all activities and privileges for roles and groups through the User Management tab.</p>
</div>
<div class="ulist">
<div class="title">User management definitions:</div>
<ul>
<li>
<p><strong>Users:</strong> perform operations and access information. Users are characterized by a Profile Type that identifies the individual, such as name and email address. The actions that a user can take in an Entando program derive from combinations of Roles and Groups.</p>
</li>
<li>
<p><strong>Roles:</strong> assigned sets of permissions, e.g., content editing rights, or user profile editing rights. Roles are mutually independent, meaning one user can be associated with multiple roles.</p>
</li>
<li>
<p><strong>Groups:</strong> assigned sets of users, with each user given a role within the group. One user can belong to multiple groups. For example, Lynne is a member of the Content Editing group and has the role of Administrator, giving her the ability to perform any task on pages that the Content Editing group is assigned to. She’s also a member of the Newsletter group with the role of Editor, meaning she can edit content, but does not have full access to the pages the Newsletter group is assigned to.</p>
</li>
<li>
<p><strong>User Restrictions:</strong> perform access restrictions on the users, e.g., months availability since the last access, or months validity of the user password, etc.</p>
</li>
<li>
<p><strong>Profiles Types:</strong> perform different user’s profile types and  creation of the new profile types.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For first time projects, consider creating profiles from largest to smallest. For example:<br></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Groups:</strong> are containers of users. Groups grant or restrict access to information and services independently from the Roles of the single Users. For example, all members of the Page Editors group would have access to pages assigned to Page Editors<br></p>
</li>
<li>
<p><strong>Roles:</strong> assign responsibilities within the group, e.g., group Administrators of the Page Editors group have full administrative access to the page, while Newsletter Managers in the Page Editors group can only manage newsletter functions<br></p>
</li>
<li>
<p><strong>Users:</strong> represent an entity with the ability to perform operations and access information. The actions allowed for a certain user are given by the combination of the Roles and Groups.</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="working-with-users"><a class="anchor" href="#working-with-users"></a>WORKING WITH USERS</h5>
<div class="sect5">
<h6 id="creating-a-role"><a class="anchor" href="#creating-a-role"></a>CREATING A ROLE</h6>
<div class="olist arabic">
<div class="title">To create a new role:</div>
<ol class="arabic">
<li>
<p>From the tabs along the top, select User Management &gt; Roles &gt; <strong>Add</strong>.</p>
</li>
<li>
<p>Enter a name.</p>
</li>
<li>
<p>(Optional) Enter a code. The code is the Role&#8217;s unique identifier. By default, Entando generates a code similar to the page title, but you can manually enter a different code. The field accepts alphanumeric characters and underscores, with a character limit of 30.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Once you save the role, you will no longer be able to edit the page&#8217;s Code field.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>In the Permissions section, toggle to "On" the access rights all users assigned to this role will possess. For example, public users may have no options toggled while power users may have the "All Permissions" option toggled to On.</p>
</li>
<li>
<p>Click <strong>Save</strong>.
To edit a Role after saving, return to the Roles screen. In the Roles table, select the Actions menu (three vertical dots) for the role to change and select "Edit."</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/custom_roles.png" alt="custom roles">
</div>
</div>
</div>
<div class="sect5">
<h6 id="creating-a-group"><a class="anchor" href="#creating-a-group"></a>CREATING A GROUP</h6>
<div class="olist arabic">
<div class="title">To create a new group:</div>
<ol class="arabic">
<li>
<p>From the tabs along the top, select User Management &gt; Groups &gt; <strong>Add</strong>.</p>
</li>
<li>
<p>Enter a name.</p>
</li>
<li>
<p>(Optional) Enter a code. The code is the Group&#8217;s unique identifier. By default, Entando generates a code similar to the page title, but you can manually enter a different code. The field accepts alphanumeric characters and underscores, with a character limit of 30.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Once you save the group, you will no longer be able to edit the group&#8217;s Code field.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To edit a Group after saving, return to the Groups screen. In the Groups table, select the Actions menu (three vertical dots) for the group to change and select "Edit."</p>
</div>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/custom_groups.png" alt="custom groups">
</div>
</div>
</div>
<div class="sect5">
<h6 id="creating-a-user"><a class="anchor" href="#creating-a-user"></a>CREATING A USER</h6>
<div class="olist arabic">
<div class="title">To create a new user:</div>
<ol class="arabic">
<li>
<p>From the tabs along the top, choose User Management &gt; Users &gt; <strong>Add</strong>.</p>
</li>
<li>
<p>In the Username field, enter</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The username must be between 8-20 characters. You can use numbers, underscores, special characters, and upper or lowercase letters.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Enter a password.</p>
</li>
<li>
<p>From the Profile Type drop-down menu, select “Default User Profile.”</p>
</li>
<li>
<p>Toggle the Status to “On” to ensure that individuals can sign in with this user&#8217;s credentials.</p>
</li>
<li>
<p>Click <strong>Save</strong> to create the user and return to the Users screen.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/custom_users.png" alt="custom users">
</div>
</div>
</div>
<div class="sect5">
<h6 id="setting-a-users-authorizations"><a class="anchor" href="#setting-a-users-authorizations"></a>SETTING A USER&#8217;S AUTHORIZATIONS</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From the table on the Users screen, find your new user profile and click <strong>More Options</strong> &gt; Manage authorizations for: <em>your profile name</em>. Set the following options:</p>
<div class="ulist">
<ul>
<li>
<p><strong>User Group:</strong> select a group to assign this user to. You can assign a user to as many groups as you want.</p>
</li>
<li>
<p><strong>User Role:</strong> select the role this user should have in the group. You can only assign a user to one role per user group.<br></p>
<div class="paragraph">
<p>The User Group/Role pairing will appear in the Authorizations table at the top of the screen.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>Add</strong> and then click <strong>Save</strong>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="restricting-access"><a class="anchor" href="#restricting-access"></a>RESTRICTING ACCESS</h5>
<div class="paragraph">
<p>Entando lets you set restrictions on users (see Figure below), specifically a shelf life for passwords and a maximum time between log ins before the password expires.</p>
</div>
<div class="olist arabic">
<div class="title">Setting user restrictions:</div>
<ol class="arabic">
<li>
<p>From the tabs along the top, choose User Management &gt; User Restrictions.</p>
</li>
<li>
<p>Toggle the Password Always Active option.</p>
<div class="ulist">
<ul>
<li>
<p>On - the password never expires and users have unlimited time between logins</p>
</li>
<li>
<p>Off - activates the password limitation fields, allowing you to set expirations</p>
</li>
</ul>
</div>
</li>
<li>
<p>Toggle the Enable Gravatar integration (Avatar of users) option.</p>
<div class="ulist">
<ul>
<li>
<p>On - enables management of the user’s avatar</p>
</li>
<li>
<p>Off - disables Gravatar integration</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/custom_userrestrictions.png" alt="custom userrestrictions">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="presenting-data"><a class="anchor" href="#presenting-data"></a>1.3.8. PRESENTING DATA</h4>
<div class="paragraph">
<p>Data Types are collections of attributes. They are used to gather and manage data coming from external sources, like APIs or the IoT. This abstraction layer allows Entando to perform core features like searching on external data.</p>
</div>
<div class="paragraph">
<p>Data Models are used to agnostically render data coming from data types, ensuring that the same data can be represented differently, such as with forms, tables, or graphs. By separating the definition and presentation of data, the Entando App Builder gives you the ability to display the same data in a context- and user-aware way without requiring a data source or integration.</p>
</div>
<div class="olist arabic">
<div class="title">To manage Data Types:</div>
<ol class="arabic">
<li>
<p>Create a Data Type.</p>
</li>
<li>
<p>Create one or more Data Models per Data Type.</p>
</li>
<li>
<p>Publish the data on web pages with one or more widgets.
The Data section allows you to manage the Data.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="structuring-with-data-types"><a class="anchor" href="#structuring-with-data-types"></a>STRUCTURING WITH DATA TYPES</h5>
<div class="paragraph">
<p>The Data Types section lists all available Data Types, their attributes, and is where you can create a new data structure.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/custom_datatype.png" alt="custom datatype">
</div>
</div>
<div class="olist arabic">
<div class="title">To create a new data type:</div>
<ol class="arabic">
<li>
<p>From the tabs along the top, choose Data &gt; Data Type &gt; <strong>New</strong>.</p>
</li>
<li>
<p>Enter a Code. The code must be three letters.</p>
</li>
<li>
<p>Enter a Name.</p>
</li>
<li>
<p>Click <strong>Save</strong>. This opens the Attributes section where you specify OGNL validation.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configuring-entando"><a class="anchor" href="#configuring-entando"></a>1.3.9. CONFIGURING ENTANDO</h4>
<div class="paragraph">
<p>The Configuration section (far right of the toolbar, gives you access to Entando general duty functionalities, such as configuring Categories, Labels, Configuration Reload, Database backup, file browsing and groups management.</p>
</div>
<div class="sect4">
<h5 id="categories"><a class="anchor" href="#categories"></a>CATEGORIES</h5>
<div class="paragraph">
<p>Categories are dividers and parent folders for pages in your Entando page tree. Add a new category by clicking the <strong>Add</strong> button.</p>
</div>
</div>
<div class="sect4">
<h5 id="labels-and-languages"><a class="anchor" href="#labels-and-languages"></a>LABELS AND LANGUAGES</h5>
<div class="paragraph">
<p>The Languages tab displays a list of all configured languages in the system. You can add as many different languages to the system as you need by selecting a language from the Select Language drop down menu and clicking <strong>Add</strong>. You can then include the appropriate vocabulary for any term in the System Labels section.</p>
</div>
<div class="paragraph">
<p>The System Labels tab displays system labels that apply to the entire Entando application. By default, system labels are available in English and Italian. If you add additional languages in the Languages tab, you can enter the appropriate word for a label in your choice language.</p>
</div>
</div>
<div class="sect4">
<h5 id="database"><a class="anchor" href="#database"></a>DATABASE</h5>
<div class="paragraph">
<p>The Database section lets you back up your entire Entando’s database by clicking the <strong>Create Backup</strong> button. The backed up files become available from the Protected folder of the File Browser section once the backup process completes.</p>
</div>
</div>
<div class="sect4">
<h5 id="file-browser"><a class="anchor" href="#file-browser"></a>FILE BROWSER</h5>
<div class="paragraph">
<p>The File Browser section lets you browse files, upload, create text files and folders, and access database backups from two distinct areas of the file-system:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Public:</strong> /project_name/src/main/webapp/resources</p>
</li>
<li>
<p><strong>Protected:</strong> /project_name/src/main/webapp/protected</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Backed up database files are in the Protected section by default.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="getting-started-app-builder"><a class="anchor" href="#getting-started-app-builder"></a>1.4. GETTING STARTED WITH ENTANDO</h3>
<div class="sect3">
<h4 id="sample-mortgage-application"><a class="anchor" href="#sample-mortgage-application"></a>1.4.1. SAMPLE MORTGAGE APPLICATION</h4>
<div class="sect4">
<h5 id="preface-2"><a class="anchor" href="#preface-2"></a>PREFACE</h5>
<div class="paragraph">
<p>The Entando App Builder helps you create a variety of applications and integrate them with Red Hat BPM. It uses an intuitive UI, reusable templates, and drag-and-drop functionality that allows you to participate in every stage of the application design process regardless of your level of coding knowledge.</p>
</div>
<div class="paragraph">
<p>This demonstration walks through creating an applicant page for a mortgage application, and then integrates with Red Hat PAM.</p>
</div>
<div class="paragraph">
<p><strong>Prerequisites:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entando MApp Engine and App Builder installed</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="configuring-the-applicant-page"><a class="anchor" href="#configuring-the-applicant-page"></a>CONFIGURING THE APPLICANT PAGE</h5>
<div class="paragraph">
<p>The Applicant page is a public-facing webpage.</p>
</div>
<div class="sect5">
<h6 id="creating-a-new-page-model"><a class="anchor" href="#creating-a-new-page-model"></a>CREATING A NEW PAGE MODEL</h6>
<div class="paragraph">
<p>Page models are reusable templates. They determine the page layout via frames into which you can then drag and drop content and widgets.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/custom_pagemodel.png" alt="custom pagemodel">
</div>
</div>
<div class="olist arabic">
<div class="title">To create a new page model:</div>
<ol class="arabic">
<li>
<p>Open the Entando App Builder.</p>
</li>
<li>
<p>From the tabs along the top, select UX Patterns &gt; Page Models &gt; <strong>Add</strong>.</p>
</li>
<li>
<p>Assign the page model a code and a name. Codes represent the page model’s unique identifier. The name can be more human readable. For example:<br>
<strong>Code:</strong> <em>entando_page_purple</em><br>
<strong>Name:</strong> <em>Purple - BPM</em></p>
</li>
<li>
<p>In the JSON Configuration field, enter JSON content to structure the page. See the following text for an example.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">{
  "frames": [
    {
      "pos": 0,
      "descr": "Top bar 1",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 0,
        "y1": 0,
        "x2": 2,
        "y2": 0
      }
    },
    {
      "pos": 1,
      "descr": "Top Bar 2",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 3,
        "y1": 0,
        "x2": 5,
        "y2": 0
      }
    },
    {
      "pos": 2,
      "descr": "Top Bar 3",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 6,
        "y1": 0,
        "x2": 8,
        "y2": 0
      }
    },
    {
      "pos": 3,
      "descr": "Top Bar 4",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 9,
        "y1": 0,
        "x2": 11,
        "y2": 0
      }
    },
    {
      "pos": 4,
      "descr": "Central Bar 1",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 0,
        "y1": 1,
        "x2": 11,
        "y2": 1
      }
    },
    {
      "pos": 5,
      "descr": "Central Bar mortgage 2",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 2,
        "y1": 2,
        "x2": 9,
        "y2": 2
      }
    },
    {
      "pos": 6,
      "descr": "Central Bar left",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 2,
        "y1": 3,
        "x2": 4,
        "y2": 3
      }
    },
    {
      "pos": 7,
      "descr": "Central Bar Center",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 5,
        "y1": 3,
        "x2": 7,
        "y2": 3
      }
    },
    {
      "pos": 8,
      "descr": "Central Bar right",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 8,
        "y1": 3,
        "x2": 9,
        "y2": 3
      }
    },
    {
      "pos": 9,
      "descr": "Banner Advisor",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 0,
        "y1": 4,
        "x2": 11,
        "y2": 4
      }
    },
    {
      "pos": 10,
      "descr": "Full",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 0,
        "y1": 5,
        "x2": 11,
        "y2": 5
      }
    },
    {
      "pos": 11,
      "descr": "Footer Left",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 0,
        "y1": 6,
        "x2": 5,
        "y2": 6
      }
    },
    {
      "pos": 12,
      "descr": "Footer right",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 6,
        "y1": 6,
        "x2": 11,
        "y2": 6
      }
    },
    {
      "pos": 13,
      "descr": "Footer 2 Left",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 0,
        "y1": 7,
        "x2": 5,
        "y2": 7
      }
    },
    {
      "pos": 14,
      "descr": "Footer 2 right",
      "mainFrame": false,
      "defaultWidget": null,
      "sketch": {
        "x1": 6,
        "y1": 7,
        "x2": 11,
        "y2": 7
      }
    }
  ]
}</code></pre>
</div>
</div>
</li>
<li>
<p>In the Template field, enter XML formatting to determine where each defined frame belongs and how to render it. See the example content below:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;#assign wp=JspTaglibs["/aps-core"]&gt;
&lt;#assign c=JspTaglibs["http://java.sun.com/jsp/jstl/core"]&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
    &lt;head&gt;
        &lt;meta charset="utf-8" /&gt;
        &lt;title&gt;
            &lt;@wp.currentPage param="title" /&gt; - &lt;@wp.i18n key="PORTAL_TITLE" /&gt;
        &lt;/title&gt;
        &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;
        &lt;meta name="description" content="" /&gt;
        &lt;meta name="author" content="" /&gt;
        &lt;link rel="icon" href="&lt;@wp.info key="systemParam" paramName="applicationBaseURL" /&gt;
              favicon.png" type="image/png" /&gt;
              &lt;!-- Le HTML5 shim, for IE6-8 support of HTML5 elements --&gt;
              &lt;!--[if lt IE 9]&gt;
              &lt;script src="&lt;@wp.resourceURL /&gt;static/js/entando-misc-html5-essentials/html5shiv.js"&gt;&lt;/script&gt;
              &lt;![endif]--&gt;
              &lt;@c.import url="/WEB-INF/aps/jsp/models/inc/content_inline_editing.jsp" /&gt;
              &lt;@c.import url="/WEB-INF/aps/jsp/models/inc/header-inclusions_light.jsp" /&gt;

              &lt;style&gt;
              .editableform .control-group {
               margin-bottom: 0;
                white-space: nowrap;
               line-height: 28px;
               }
              &lt;/style&gt;
    &lt;/head&gt;
     &lt;body class="purple" data-spy="scroll" data-target="#navbar-menu"&gt;
        &lt;!-- Navbar --&gt;
        &lt;div class="navbar navbar-custom navbar-fixed-top sticky" role="navigation" id="sticky-nav"&gt;
            &lt;div class="container"&gt;
                &lt;!-- Navbar-header --&gt;
                &lt;div class="navbar-header"&gt;
                    &lt;!-- Responsive menu button --&gt;
                    &lt;button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"&gt;
                        &lt;span class="sr-only"&gt;Toggle navigation&lt;/span&gt;
                        &lt;span class="icon-bar"&gt;&lt;/span&gt;
                        &lt;span class="icon-bar"&gt;&lt;/span&gt;
                        &lt;span class="icon-bar"&gt;&lt;/span&gt;
                    &lt;/button&gt;
                    &lt;!-- LOGO --&gt;
                    &lt;a class="navbar-brand logo" href="#"&gt;
                        &lt;img alt="acme-logo"  class="logo-img" src="&lt;@wp.imgURL /&gt;Logo_Acme_Bank.png"&gt;
                    &lt;/a&gt;
                &lt;/div&gt;
                &lt;!-- end navbar-header --&gt;
                &lt;!-- menu --&gt;
                &lt;div class="navbar-collapse collapse" id="navbar-menu"&gt;
                    &lt;!--Navbar left--&gt;
                    &lt;ul class="nav navbar-nav nav-custom-left"&gt;
                        &lt;!--frame 0 1--&gt;
                        &lt;@wp.show frame=0 /&gt;
                        &lt;@wp.show frame=1 /&gt;
                    &lt;/ul&gt;
                    &lt;!-- Navbar right --&gt;
                    &lt;ul class="nav navbar-nav navbar-right"&gt;
                        &lt;!--frame 2 3--&gt;
                        &lt;@wp.show frame=2 /&gt;
                        &lt;@wp.show frame=3 /&gt;
                    &lt;/ul&gt;
                &lt;/div&gt;
                &lt;!--/Menu --&gt;
            &lt;/div&gt;
            &lt;!-- end container --&gt;
        &lt;/div&gt;
        &lt;!-- End navbar-custom --&gt;

        &lt;!-- HOME --&gt;
        &lt;section&gt;
               &lt;!--frame 4--&gt;
                 &lt;@wp.show frame=4 /&gt;
               &lt;!--frame 4--&gt;
        &lt;/section&gt;
        &lt;!-- END HOME --&gt;

        &lt;!-- Features Alt --&gt;
        &lt;section class="section" id="mortgage"&gt;
            &lt;div class="container"&gt;
                &lt;div class="row"&gt;
                    &lt;div class="col-sm-12"&gt;
                        &lt;!--frame 5--&gt;
                        &lt;@wp.show frame=5 /&gt;
                        &lt;!--frame 5--&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/section&gt;

        &lt;section class="section"&gt;
            &lt;div class="container"&gt;
                &lt;div class="col-sm-4"&gt;
                        &lt;!--frame 6--&gt;
                        &lt;@wp.show frame=6 /&gt;
                        &lt;!--frame 5--&gt;
                    &lt;/div&gt;
                    &lt;div class="col-sm-4"&gt;
                        &lt;!--frame 7 frame bpm --&gt;
                        &lt;@wp.show frame=7 /&gt;
                        &lt;!--frame 7--&gt;
                    &lt;/div&gt;
                     &lt;div class="col-sm-4"&gt;
                        &lt;!--frame 8 frame bpm --&gt;
                        &lt;@wp.show frame=8 /&gt;
                        &lt;!--frame 8--&gt;
                    &lt;/div&gt;
            &lt;/div&gt;
        &lt;/section&gt;

        &lt;section&gt;
            &lt;!--frame 9--&gt;
            &lt;@wp.show frame=9 /&gt;
            &lt;!--frame 9--&gt;
        &lt;/section&gt;
        &lt;section class=""&gt;
                &lt;!--frame 10--&gt;
                &lt;@wp.show frame=10 /&gt;
                &lt;!--frame 10--&gt;
        &lt;/section&gt;

        &lt;section class=""&gt;
            &lt;div class="container"&gt;
                &lt;div class="col-md-12"&gt;
                    &lt;div class="text-center"&gt;
                        &lt;!--frame 11--&gt;
                        &lt;@wp.show frame=11 /&gt;
                    &lt;/div&gt;
                    &lt;!--frame 11--&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/section&gt;

        &lt;!-- FOOTER --&gt;
        &lt;footer class=" "&gt;
            &lt;div class="container text-center"&gt;
                &lt;div class="row"&gt;
                    &lt;div class="col-md-12"&gt;
                        &lt;!--frame 12--&gt;
                        &lt;@wp.show frame=12 /&gt;
                        &lt;!--frame 12--&gt;
                    &lt;/div&gt;
                &lt;/div&gt; &lt;!-- end row --&gt;

                &lt;div class="row"&gt;
                    &lt;div class="col-sm-6"&gt;
                        &lt;!--frame 13--&gt;
                        &lt;@wp.show frame=13 /&gt;
                        &lt;!--frame 13--&gt;
                    &lt;/div&gt;
                    &lt;div class="col-sm-6"&gt;
                        &lt;!--frame 14--&gt;
                        &lt;@wp.show frame=14 /&gt;
                        &lt;!--frame 14--&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/footer&gt;
        &lt;!-- END FOOTER --&gt;

        &lt;script src="&lt;@wp.resourceURL /&gt;static/js/jquery.ajaxchimp.js"&gt;&lt;/script&gt;
        &lt;script src="&lt;@wp.resourceURL /&gt;static/js/jquery.sticky.js"&gt;&lt;/script&gt;
        &lt;script src="&lt;@wp.resourceURL /&gt;static/js/jquery.app.js"&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>When finished, click <strong>Save</strong>.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="create-the-applicant-page"><a class="anchor" href="#create-the-applicant-page"></a>CREATE THE APPLICANT PAGE</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From the tabs along the top, select Page Designer &gt; Page Tree &gt; <strong>Add</strong>.</p>
</li>
<li>
<p>Enter a page title and a code. The Code field will auto-populate with a value similar to the Title and acts as the page’s unique identifier. For example:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Title:</strong> <em>Application Home</em></p>
</li>
<li>
<p><strong>Code:</strong> <em>application_home</em></p>
</li>
</ul>
</div>
</li>
<li>
<p>From the Select Page Placement drop-down menu, select the page to act as this page’s hierarchical parent.</p>
</li>
<li>
<p>In the Page Groups section, select an Owner Group and a Join Group.</p>
<div class="ulist">
<ul>
<li>
<p>Owner Group members have administrative access to this page</p>
</li>
<li>
<p>Join Group members are able to see the page</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the Settings section, select the page model you just created from the Page Model drop-down menu. Once selected, set the options for the remaining options in the Settings section.</p>
</li>
<li>
<p>Click <strong>Save and Configure</strong>. This opens the Page Configuration screen.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="add-widgets"><a class="anchor" href="#add-widgets"></a>ADD WIDGETS</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>On the Page Configuration screen, locate the Widgets section on the right side of the screen.</p>
<div class="imageblock">
<div class="content">
<img src="./images/custom_configure.png" alt="custom configure">
</div>
</div>
</li>
<li>
<p>Search for the following widgets and drag them into the specified frame:</p>
<div class="ulist">
<ul>
<li>
<p>Choose a language purple/light and drag to Top Bar 4</p>
</li>
<li>
<p>Main banner purple and drag to Central Bar 1</p>
</li>
<li>
<p>Left 3 steps purple and drag to Central Bar Left</p>
</li>
<li>
<p>Right col help purple and drag to Central Bar Right</p>
</li>
<li>
<p>Banner advisor purple/light and drag to Banner Advisor</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Click the <strong>Preview</strong> button to verify the appearance of the page before publishing.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>When the widgets are in place and you are satisfied with the preview, click <strong>Publish</strong>.</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Only click <strong>Publish</strong> after confirming that each widget has been configured properly.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="integrate-the-bpm-form"><a class="anchor" href="#integrate-the-bpm-form"></a>INTEGRATE THE BPM FORM</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From the tabs along the top, choose Integrations &gt; Red Hat PAM Config &gt; Add Integration.</p>
<div class="imageblock">
<div class="content">
<img src="./images/custom_integrations.png" alt="custom integrations">
</div>
</div>
</li>
<li>
<p>In the Connection section, add all server information. For example:<br></p>
<div class="ulist">
<ul>
<li>
<p>General Settings section:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Active:</strong> On</p>
</li>
<li>
<p>(Optional) <strong>Debug:</strong> On</p>
</li>
</ul>
</div>
</li>
<li>
<p>Connection section:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name:</strong> My Application</p>
</li>
<li>
<p><strong>Host name:</strong> &lt;my.redhat.pamInstance.com&gt;</p>
</li>
<li>
<p><strong>Schema:</strong> http</p>
</li>
<li>
<p><strong>Port:</strong> 8080</p>
</li>
<li>
<p><strong>Webapp name:</strong> kie-server</p>
</li>
<li>
<p><strong>Username:</strong> username for the process server administrator</p>
</li>
<li>
<p><strong>Password:</strong> password for the process server administrator</p>
</li>
<li>
<p><strong>Conn. Timeout (in millis):</strong> 500</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>Test Connection</strong> to verify a valid the configuration, then click <strong>Save</strong>.</p>
</li>
<li>
<p>Open the Page Tree by choosing the Page Designer tab &gt; Page Tree.</p>
</li>
<li>
<p>Find your new page in the Page Tree and click its <strong>More Options</strong> button &gt; Configure.</p>
</li>
<li>
<p>Search for the “BPM-form by Data Type” widget and drag it to the Central Bar Center frame.</p>
</li>
<li>
<p>Click the <strong>Preview</strong> button to verify the correct appearance.</p>
</li>
<li>
<p>Click <strong>Publish</strong>.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rh-getting-started"><a class="anchor" href="#rh-getting-started"></a>1.4.2. GETTING STARTED WITH ENTANDO AND PAM</h4>
<div class="sect4">
<h5 id="overview"><a class="anchor" href="#overview"></a>Overview</h5>
<div class="paragraph">
<p>This document provides an introduction to using the Entando App Builder integrated with Red Hat Process Application Manager. This template application provides a page with a task list, task details, case comments (optional), and case management widgets (optional). The provided application can then be extended and customized using the App Builder functionality.</p>
</div>
<div class="sect5">
<h6 id="launch-the-template-application"><a class="anchor" href="#launch-the-template-application"></a>Launch the Template Application</h6>
<div class="paragraph">
<p>Unzip the provided project (entando-pam-app-5.0.3.zip)</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>On a command line cd into the application (for example cd entando-pam-demo-app)</p>
</li>
<li>
<p>Start the project with this command:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><code>mvn jetty:run -Djetty.reload=manual -Djetty.port=8083 -Dspring.profiles.active=swagger</code></p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Notes on this command and the environment</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><strong>mvn jetty:run</strong>&#8201;&#8212;&#8201; Run in jetty for quick start and development</p>
</li>
<li>
<p><strong>jetty.reload=manual</strong>&#8201;&#8212;&#8201;to prevent jetty from reloading changes in your project</p>
</li>
<li>
<p><strong>-Djetty.port=8083</strong> &#8201;&#8212;&#8201;Change the default port to 8083. Without this jetty will start on 8080 and usually conflict with something else in the environment</p>
</li>
<li>
<p><strong>-Dspring.profiles.active=swagger</strong>&#8201;&#8212;&#8201;Enable swagger on the project so we can look at the APIs and API documentation. Disabled by default. This can also be exported as an environment variable: export spring_profiles_active=swagger</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Wait for the project to start. Look for: Started Jetty Server.  Console Reloading is Enabled</p>
</li>
<li>
<p>In a browser navigate to: <a href="http://localhost:8083/entando-pam-app-5.0.3" class="bare">http://localhost:8083/entando-pam-app-5.0.3</a></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="add-the-kie-server-configuration"><a class="anchor" href="#add-the-kie-server-configuration"></a>Add the KIE server configuration</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to  <a href="http://localhost:8083/entando-pam-app-5.0.3/do/login" class="bare">http://localhost:8083/entando-pam-app-5.0.3/do/login</a></p>
</li>
<li>
<p>Login with</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>User: admin</p>
</li>
<li>
<p>Password: adminadmin</p>
</li>
</ol>
</div>
</li>
<li>
<p>On the left pane select Integrations → Components → Red Hat PAM Config</p>
</li>
<li>
<p>In the upper right select Add Configuration</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Name - Enter the name of your choice for the configuration</p>
</li>
<li>
<p>Hostname - The host where your KIE server is running. For example (localhost). Do not include http:// or ports</p>
</li>
<li>
<p>Schema: One of http or https depending on where your KIE server is running</p>
</li>
<li>
<p>Port - Enter the port of the http interface of your KIE server. If any. Can be left blank. For example 8080 is common if KIE is running locally</p>
</li>
<li>
<p>WebApp Name - The value that comes after the port in your KIE URL. If any. Can be left blank. A common value is kie-server when running KIE locally</p>
</li>
<li>
<p>Username - PAM Admin username. Common value is pamAdmin</p>
</li>
<li>
<p>Password - The password for the KIE user</p>
</li>
<li>
<p>Conn. Timeout (in millis) - Millisecond timeout for connecting to KIE. Can be blank</p>
</li>
</ol>
</div>
</li>
<li>
<p>Hit Test connection and you’ll get a green banner if the connection is valid</p>
</li>
<li>
<p>Select Save <em>(don’t forget this)</em></p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="configure-the-widgets-to-use-your-pam-connection"><a class="anchor" href="#configure-the-widgets-to-use-your-pam-connection"></a>- Configure the Widgets to Use your PAM Connection</h6>
<div class="paragraph">
<p>The demo app comes with a collection of widgets pre-applied in the pages but they need to be configured to use the new KIE configuration created in Part 2 above.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the left nave select Page Designer → Page Tree</p>
</li>
<li>
<p>In the page tree in the kebab menu on the right select the menu for the page named Task List</p>
</li>
<li>
<p>Select Configure</p>
</li>
<li>
<p>On this page the widget in the middle of the screen called PAM-Datatable Task List holds the task list for our application. Select the kebab menu on the right and select settings</p>
</li>
<li>
<p>On this page fill out the configuration for you new PAM instance</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Knowledge Source - this will be the name of the PAM integration you selected and configured above</p>
</li>
<li>
<p>Process - The process you want to fetch tasks for</p>
</li>
<li>
<p>Open new page on table row click - Select ON</p>
</li>
<li>
<p>Show Claim button - Select ON</p>
</li>
<li>
<p>Show Complete Button  - Select ON</p>
</li>
<li>
<p>Under BPM Groups - Select ON for all of the provided groups</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Note: If modeling a process with different groups you need to add those groups to Entando under the left menu Setting → Groups and enter the names to match exactly the groups used in PAM</p>
</li>
</ol>
</div>
</li>
<li>
<p>Override Fields</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>These are the columns that will show up in your table. They are fetched from Task and Process variables. You can provide a different column header under Override fields and remove columns using the check boxes</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Select Save at the bottom of the screen</p>
</li>
<li>
<p>Hit the green Publish button at the top of the page</p>
</li>
<li>
<p>In the upper right select Pages</p>
</li>
<li>
<p>On the row that says task-details click on the row and then on the right and select the kebab button</p>
</li>
<li>
<p>Select configure</p>
</li>
<li>
<p>Select the kebab button on the widget labeled PAM-Task Form by Data Type</p>
</li>
<li>
<p>Select settings</p>
</li>
<li>
<p>Select the Knowledge Source and Process</p>
</li>
<li>
<p>Click Save</p>
</li>
<li>
<p>Click the green publish button</p>
</li>
<li>
<p>Optional step</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If the application you are building is using Case Management functionality you can also add the PAM Case Comments widget to the box labeled Widget 4 by searching for the widget on the right and dragging it to the page. Then configure that widget with the Knowledge Source and Process</p>
</li>
<li>
<p>Click Save and Publish</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="update-the-home-screen-of-your-application"><a class="anchor" href="#update-the-home-screen-of-your-application"></a>Update the Home Screen of your Application</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>On the left menu select Page Designer → Page Settings</p>
</li>
<li>
<p>In the top dropdown labeled Home page* select ../Task List</p>
</li>
<li>
<p>Select Save</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="view-your-application"><a class="anchor" href="#view-your-application"></a>View your Application</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the upper right of the application select Go to Homepage</p>
</li>
<li>
<p>If there are human tasks available in your PAM process for the roles assigned to your PAM user they will show up in the table</p>
</li>
<li>
<p>Clicking on a row in the table will take you to the task details page in a new tab</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="content-management-system"><a class="anchor" href="#content-management-system"></a>1.5. CONTENT MANAGEMENT SYSTEM</h3>
<div class="sect3">
<h4 id="introduction"><a class="anchor" href="#introduction"></a>1.5.1. INTRODUCTION</h4>
<div class="paragraph">
<p>Access Entando&#8217;s Content Management System features from the left pane by selecting APPS &gt; CMS. The CMS modules contain functions that let you manage contents, their type, model, and digital assets. This section provides an overview of the tasks associated with each of the CMS subsections, which are not necessarily arranged sequentially for a first-time setup.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Contents</p>
</li>
<li>
<p>Digital Assets</p>
</li>
<li>
<p>Content Types</p>
</li>
<li>
<p>Content Models</p>
</li>
<li>
<p>Content Settings</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Generally speaking, the flow for creating content is:
Create a Content Type &gt; Create a Content Model for the newly created Type &gt; Create Contents and Digital Assets &gt; Publish the contents</p>
</div>
<div class="sect4">
<h5 id="defining-content-management-sections"><a class="anchor" href="#defining-content-management-sections"></a>DEFINING CONTENT MANAGEMENT SECTIONS</h5>
<div class="dlist">
<dl>
<dt class="hdlist1">Contents</dt>
<dd>
<p>Contents are the human consumable pieces of information presented in your applications. Newspaper articles, blog posts, press releases, and their associated images and attachments. The Contents section is where the management of your content happens as well as a search utility for quickly accessing your assets.</p>
</dd>
<dt class="hdlist1">Digital Assets</dt>
<dd>
<p>Digital Assets are the rich media files you can use to provide a more robust experience in your application, including photos, audio and video files, and documentation. By using the Digital Assets section, you create a repository from which you can access any asset with minimal effort, can repurpose it in multiple locations, and specify user and management rights to that asset.</p>
<div class="paragraph">
<p>The Entando platform divides Digital Assets into two broad categories: Images (jpg/jpeg and png files) and Attachments (all other file formats).</p>
</div>
</dd>
<dt class="hdlist1">Content Types</dt>
<dd>
<p>Entando&#8217;s Content Types define the different content elements in your repository and enable you to manage settings for each category in centralized, reusable way. Each type defines the unique attributes associated with that given type through a series of attributes.</p>
</dd>
<dt class="hdlist1">Content Models</dt>
<dd>
<p>Content Models are templates for your information. They determine a structure for how the content is organized, similar to file templates in Microsoft Word or PowerPoint.</p>
</dd>
<dt class="hdlist1">Content Settings</dt>
<dd>
<p>Content Settings provide a method for managing aspects of your Digital Assets such as metadata as well as activating or deactivating Entando&#8217;s WYSIWYG editor called CKEditor.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="contents-section"><a class="anchor" href="#contents-section"></a>1.5.2. CONTENTS SECTION</h4>
<div class="olist arabic">
<div class="title">To add new content:</div>
<ol class="arabic">
<li>
<p>Click the <strong>Add</strong> button and select the <a href="#bookmark-contenttypes">Content Type</a> to create.</p>
<div class="imageblock">
<div class="content">
<img src="./images/cms_add_content.png" alt="cms add content" width="50%">
</div>
</div>
</li>
<li>
<p>Populate each field with the requisite information. See <a href="#ownjoingroups">Creating a New Page</a> for specifics on Owner Groups and Join Groups. When each field is complete, click <strong>Save</strong>.</p>
</li>
<li>
<p>Once created, you content appears in the table of results at the bottom of the Content List page. You can edit or copy and paste the content through the menu under the <em>Actions</em> column.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Publishing and unpublishing content:</div>
<p>You must publish your content in the CMS before you can display it in an application, and you can unpublish it to remove it from display. To publish or unpublish content:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select the checkbox next to the requisite content item. You may select multiple content items at once.</p>
</li>
<li>
<p>Above the content table, click either the <strong>Approve the content</strong> or <strong>Unpublish</strong> button.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="adding-images-and-tags"><a class="anchor" href="#adding-images-and-tags"></a>ADDING IMAGES AND TAGS</h5>
<div class="paragraph">
<p>You can add images from the <a href="#bookmark-digitalassets">Digital Assets</a> repository to content. When you do, the image comes with five image tags:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Text</p>
</li>
<li>
<p>Alt</p>
</li>
<li>
<p>Description</p>
</li>
<li>
<p>Legend</p>
</li>
<li>
<p>Title</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You have the option to manually assign values to these tags or automatically populate them with metadata values.</p>
</div>
<div class="olist arabic">
<div class="title"><a id="bookmark-manual_metadata"></a>To manually assign values:</div>
<ol class="arabic">
<li>
<p>Add a new content or select a content from the table and click <strong>Actions</strong> &gt; Edit.</p>
</li>
<li>
<p>Click the <strong>Picture</strong> button and select the Digital Asset to include.</p>
</li>
<li>
<p>Populate the image tags with values and then click <strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">To autopopulate image tags with metadata:</div>
<ol class="arabic">
<li>
<p>Select Apps &gt; CMS &gt; Content Settings.</p>
</li>
<li>
<p>In the Resource Metadata Mapping section, populate any of the fields with the value in the Name column of the Metadata table. You can add multiple values by separating them with commas.</p>
<div class="paragraph">
<p>For example, enter “Detected File Type,Compression Type” in the Alt field to instruct Entando to use those values in the image’s Alt tag.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/cms_resource_metadata_mappings.png" alt="cms resource metadata mappings" width="50%">
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="digital-assets"><a class="anchor" href="#digital-assets"></a>1.5.3. DIGITAL ASSETS</h4>
<div class="paragraph">
<p>The Digital Assets section separates content into Images and Attachments via tabs along the top of the Digital Assets home screen.</p>
</div>
<div class="olist arabic">
<div class="title">To add digital assets:</div>
<ol class="arabic">
<li>
<p>Choose the <em>Images</em> or <em>Attachments</em> tab at the top of the screen, depending on the asset to upload, and click <strong>Add</strong>.</p>
<div class="imageblock">
<div class="content">
<img src="./images/cms_digital_assets.png" alt="cms digital assets" width="40%">
</div>
</div>
</li>
<li>
<p>Select a Group and home category, and name the asset.</p>
</li>
<li>
<p>Click the <strong>Choose File</strong> button to select the file to add to the CMS.</p>
</li>
<li>
<p>Click <strong>Done</strong>. The asset appears in the asset list at the bottom of the List of Images or Attachments screen.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="editing-assets"><a class="anchor" href="#editing-assets"></a>EDITING ASSETS</h5>
<div class="paragraph">
<p>Once you have a digital asset in place, you have several editing and viewing options. Click the asset&#8217;s <strong>More Actions</strong> button and select "Edit" to update the asset&#8217;s name, location, and the file represented.</p>
</div>
</div>
<div class="sect4">
<h5 id="working-with-an-assets-metadata"><a class="anchor" href="#working-with-an-assets-metadata"></a>WORKING WITH AN ASSET&#8217;S METADATA</h5>
<div class="paragraph">
<p>Starting with Entando 4.3.4, the platform has captured metadata for every image you have uploaded. View the metadata from the Images tab of the Digital Assets screen by clicking an asset&#8217;s <strong>Actions</strong> menu &gt; Edit. The metadata appears in a table at the bottom of the screen.</p>
</div>
<div class="paragraph">
<p>See the <a href="#bookmark-content_metadata">Adding Images and Tags</a> section for details on using image metadata in contents.</p>
</div>
</div>
<div class="sect4">
<h5 id="cropping-images"><a class="anchor" href="#cropping-images"></a>CROPPING IMAGES</h5>
<div class="paragraph">
<p>Beginning with Entando 4.3.5, you can crop images newly uploaded via Digital Assets. You can either crop the image dynamically or by using pre-configured crop ratios.</p>
</div>
<div class="olist arabic">
<div class="title">To set pre-configured crop ratios:</div>
<ol class="arabic">
<li>
<p>Select Apps &gt; CMS &gt; Content Settings.</p>
</li>
<li>
<p>Under “Settings Image Crop Dimensions,” click <strong>Add</strong>.</p>
</li>
<li>
<p>Enter a crop ratio, using numeric values separated by a colon. See the screenshot below for an example.</p>
</li>
<li>
<p>Click <strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">To dynamically crop an image:</div>
<ol class="arabic">
<li>
<p>Uploading an image to digital assets opens the Edit Image screen with tools to crop the image.</p>
<div class="ulist">
<ul>
<li>
<p>Buttons representing your pre-defined crop ratios are below the image. Clicking any of those buttons changes the selected crop area based on the chosen ratio.</p>
</li>
<li>
<p>You can create multiple crops of a single image as part of the upload process. The right side of the screen displays the list of crops created during the current session.</p>
<div class="imageblock">
<div class="content">
<img src="./images/cms_more_cropping.png" alt="cms more cropping">
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Use your mouse or the buttons below the image to move or change the crop area, then click <strong>Save</strong> to crop the selected area. Repeat the process as many times as needed. Each new crop of the image appears under the List of Images to the right of the screen.</p>
<div class="ulist">
<ul>
<li>
<p>Click <strong>Close</strong> to return to the Add Digital Assets screen. Notice that each individual crop of the image now has its own row in the list of resources, as well as a <strong>More Actions</strong> button you can use to edit or delete the image.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Click <strong>Done</strong> to exit the Edit screen.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="content-types"><a class="anchor" href="#content-types"></a>1.5.4. CONTENT TYPES</h4>
<div class="paragraph">
<p>Content Types determine the fields that differentiate one piece of content, such as a blog post, from another, like an employee profile.</p>
</div>
<div class="olist arabic">
<div class="title">To create a content type:</div>
<ol class="arabic">
<li>
<p>Navigate to APPS &gt; CMS &gt; Content Types and click the <strong>Add</strong> button.</p>
</li>
<li>
<p>Assign a Code for the type and then a Name, again, such as blog post or employee profile.</p>
</li>
<li>
<p>In the Attributes section, select from the Type drop-down menu an attribute that is necessary to include with this type of content. For example, a blog post would require fields such as Author, Title (text), Timestamp, and Picture (Image). Click the <strong>Add</strong> button to add the attribute to your content type.</p>
</li>
<li>
<p>In the Add Attribute screen, enter code and name values for this attribute. The remaining fields on the screen are optional. When finished, click <strong>Continue</strong> to return to the Add screen.</p>
</li>
<li>
<p>Add as many additional attributes as necessary and then click <strong>Save</strong>. The content type will appear in the table at the top of the Content Types screen.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To edit a content type, click the <strong>Actions</strong> menu in-line with a content type and select "Edit."</p>
</div>
</div>
<div class="sect3">
<h4 id="content-models"><a class="anchor" href="#content-models"></a>1.5.5. CONTENT MODELS</h4>
<div class="paragraph">
<p>Content models determine how the CMS arranges your content. The Model section defines the structural layout while any stylesheet that you attach handles the design elements like font, color, and link styles.</p>
</div>
<div class="olist arabic">
<div class="title">To create a content model:</div>
<ol class="arabic">
<li>
<p>Navigate to APPS &gt; CMS &gt; Content Models and click the <strong>Add</strong> button.</p>
</li>
<li>
<p>Select the Content Type that this model applies to, then enter identifiers in the Name and Code fields. Selecting the Content Type helps the Inline Editing feature suggest attributes that are available to arrange. For example, if your Blog Post content type contains attributes for Title, Picture, and Caption, the Inline Editor will be able to suggest those attributes as you enter code into the Model field.</p>
</li>
<li>
<p>Enter code into the Model field. Entando uses Apache Velocity as its template engine to reference objects in Java code. If you&#8217;ve selected a Content Type, the Inline Editing Assist will format the code for easier reading.<br></p>
</li>
</ol>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Hint: Press <strong>CTRL + SPACE</strong> to open Content Assist.<br></p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="content-settings"><a class="anchor" href="#content-settings"></a>1.5.6. CONTENT SETTINGS</h4>
<div class="paragraph">
<p>The Content Settings section is for fine tuning contents that you have added from the Digital Assets section. You can perform tasks such as autopopulating or excluding metadata for images, or adding and removing metadata fields in the Content Settings section.</p>
</div>
<div class="sect4">
<h5 id="autopopulating-image-tags"><a class="anchor" href="#autopopulating-image-tags"></a>AUTOPOPULATING IMAGE TAGS</h5>
<div class="paragraph">
<p>You can also <a href="#bookmark-manual_metadata">manually adjust metadata</a> for an image in the Contents section.</p>
</div>
<div class="olist arabic">
<div class="title">To autopopulate image tags:</div>
<ol class="arabic">
<li>
<p>Select Apps &gt; CMS &gt; Content Settings.</p>
</li>
<li>
<p>In the Resource Metadata Mapping section, populate any of the fields with the value in the Name column of the Metadata table. You can add multiple values by separating them with commas.<br></p>
<div class="paragraph">
<p>For example, enter “Detected File Type,Compression Type” in the Alt field to instruct Entando to use those values in the image’s alt tag.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="excluding-metadata"><a class="anchor" href="#excluding-metadata"></a>EXCLUDING METADATA</h5>
<div class="paragraph">
<p>You can exclude metadata fields by name by setting the following property in systemParams.properties:
<code>jacms.imgMetadata.ignoreKeys</code></p>
</div>
<div class="paragraph">
<p>For example:<br>
<code>jacms.imgMetadata.ignoreKeys=Blue TRC,Red TRC,Green TRC</code></p>
</div>
</div>
<div class="sect4">
<h5 id="adding-and-removing-metadata-fields"><a class="anchor" href="#adding-and-removing-metadata-fields"></a>ADDING AND REMOVING METADATA FIELDS</h5>
<div class="paragraph">
<p>You can customize the metadata fields displayed in the Resource Metadata Mapping section. By default, the values are Alt, Description, Legend, and Title, but you can add and remove fields.</p>
</div>
<div class="olist arabic">
<div class="title">To add new metadata fields:</div>
<ol class="arabic">
<li>
<p>Enter values in the Key and Mapping fields in line with the “Add metadata” field. The Key field represents the metadata’s name (e.g., Alt or Title). The Mapping field defines the value that populates the field.</p>
</li>
<li>
<p>Click <strong>Add</strong>. You can add as many new metadata fields as necessary.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">To remove a metadata field:</div>
<ol class="arabic">
<li>
<p>Click the <strong>Delete</strong> button in line with the field to remove.<br></p>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
You do not receive a warning before deleting the field and it is not recoverable.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="entando-pwa"><a class="anchor" href="#entando-pwa"></a>1.6. ENTANDO PWA</h3>
<div class="paragraph">
<p><strong>Progressive Web Apps (<em>PWA</em>)</strong> is the new way to deploy your apps into different platforms without any hassle. Whether you use it as web or even a native-feel app, PWA is one of the great, efficient solution that you can deploy your app in no time.</p>
</div>
<div class="paragraph">
<p>So we took this technology as an advantage to bring you <strong>Entando PWA</strong> which provides you content-driven solutions and deploy in less time.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pwa_shell.png" alt="pwa shell" width="25%">
</div>
</div>
<div class="sect3">
<h4 id="defining-the-structure"><a class="anchor" href="#defining-the-structure"></a>1.6.1. DEFINING THE STRUCTURE</h4>
<div class="paragraph">
<p>The system has two main instances,</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>PWA Provider</strong> - Entando core instance that basically manages your content with the use of <a href="#_content_management_system"><strong>CMS (Content Management System)</strong></a>.</p>
</li>
<li>
<p><strong>PWA Shell</strong> - This is the interface-level instance when you can deploy and view your contents from your PWA Provider.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="installation-2"><a class="anchor" href="#installation-2"></a>1.6.2. INSTALLATION</h4>
<div class="paragraph">
<p>This will provide step-by-step installation on launching your very first Entando PWA using your local machine.</p>
</div>
<div class="sect4">
<h5 id="prerequisites-2"><a class="anchor" href="#prerequisites-2"></a>PREREQUISITES</h5>
<div class="paragraph">
<p>Ensure that you have installed (<em>mvn install</em>) both Entando Core and Entando Components.</p>
</div>
<div class="paragraph">
<p>For database requirements, you need to make sure that you have a running DBMS (Postgres or MySQL) ready for installation.</p>
</div>
</div>
<div class="sect4">
<h5 id="git-clone"><a class="anchor" href="#git-clone"></a>GIT CLONE</h5>
<div class="paragraph">
<p>Enter this in your command line: <code>git clone <a href="https://github.com/entando/entando-pwa.git" class="bare">https://github.com/entando/entando-pwa.git</a></code></p>
</div>
<div class="paragraph">
<p>After cloning, you will notice that there are two folders inside <em>entando-pwa</em> which are "<em>pwa-provider</em>" and "<em>pwa-shell</em>". Go inside "<em>pwa-provider</em>" and follow the next steps.</p>
</div>
</div>
<div class="sect4">
<h5 id="provider-instance-setup"><a class="anchor" href="#provider-instance-setup"></a>PROVIDER INSTANCE SETUP</h5>
<div class="paragraph">
<p>This section will give you a quick guide on installation and running the provider instance.</p>
</div>
<div class="paragraph">
<p><strong>1. CREATING DATABASE</strong></p>
</div>
<div class="paragraph">
<p>PWA provider includes Ant tasks for you to use first-hand without the need to setup database manually. Refer to the <a href="#_developers_guide">Developers' guide</a> on configuring Ant and executing afterwards. In default, this system is being setup on a Postgres database environment, so make sure you indicated your preferred database by modifying it in "<em>pwa-provider/buildproperties.xml</em>".</p>
</div>
<div class="paragraph">
<p>For the sake of this procedure (and a possibility that you may have installed PostgreSQL), you can try running <code>ant PG-db-create</code> under "<em>pwa-provider</em>" to install the postgres database.</p>
</div>
<div class="paragraph">
<p><strong>2. SETUP PWA PROVIDER SYSTEM PARAMETERS</strong></p>
</div>
<div class="paragraph">
<p>This has been configured to use Keycloak Authentication, but in this guide, we will be using the default Entando authentication included in the provider instance. So to make sure you have configured the authentication type properly, you need to check on "<em>pwa-provider/src/main/config/systemParams.properties</em>" and see at the end of the line configuration that the keycloak mode is not enabled. Check the line with <strong><em>keycloak.enabled</em></strong> has been set to <strong><em>false</em></strong>.</p>
</div>
<div class="paragraph">
<p><strong>3. RUNNING THE INSTANCE</strong></p>
</div>
<div class="paragraph">
<p>Using the console, and still under "<em>pwa-provider</em>" folder, just simply enter this command line: <code>mvn jetty:run</code> to launch the PWA Provider instance. First time launching the instance can take a little more time because of dependency installations.</p>
</div>
<div class="paragraph">
<p>When you see these lines in the console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>[INFO] Started ServerConnector@23746f63{HTTP/1.1,[http/1.1]}{0.0.0.0:8080}
[INFO] Started @80840ms
[INFO] Started Jetty Server</code></pre>
</div>
</div>
<div class="paragraph">
<p>This means your provider instance is ready. You can access this with the URL <a href="http://localhost:8080/pwa-provider" class="bare">http://localhost:8080/pwa-provider</a> using your web browser. This is basically the same interface from your Entando Core Instance. <a href="#_content_management_system">Please refer to CMS</a> on setting up and publishing your content.</p>
</div>
<div class="paragraph">
<p>Now this guarantees that your provider is up and running, it&#8217;s now time to setup your PWA-powered web app!</p>
</div>
</div>
<div class="sect4">
<h5 id="pwa-instance-setup"><a class="anchor" href="#pwa-instance-setup"></a>PWA INSTANCE SETUP</h5>
<div class="paragraph">
<p>This section will provide you quick steps on installing your Entando-powered Progressive Web App.</p>
</div>
<div class="paragraph">
<p><strong>1. INSTALL NPM DEPENDENCIES</strong></p>
</div>
<div class="paragraph">
<p>The very first thing you need to do is install the app&#8217;s module dependencies by going into <em>pwa-shell</em> folder and running <code>npm install</code> (or <code>npm i</code>). This may take a while, so maybe grab a coffee or you can proceed on configuring your environment variables.</p>
</div>
<div class="paragraph">
<p><strong>2. CONFIGURE .ENV VARIABLES</strong></p>
</div>
<div class="paragraph">
<p>Before launching the app, you need to ensure that the environment variables are correct. When you open "<em>.env</em>" file under "<em>pwa-shell</em>" folder, you will see variables being preconfigured. For local environment, you should create a file named "<em>.env.local</em>" and enter the following variables:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>REACT_APP_DOMAIN=http://localhost:8080/pwa-provider
REACT_APP_AUTH_TYPE=default
REACT_APP_USE_MOCKS=false
REACT_APP_CLIENT_ID=appbuilder
REACT_APP_CLIENT_SECRET=appbuilder_secret</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><em>REACT_APP_DOMAIN</em></strong> represents your PWA provider instance - the one you launch as a provider in your local environment.</p>
</li>
<li>
<p><strong><em>REACT_APP_AUTH_TYPE</em></strong> will be set as <em>default</em> to tell your app to use the Entando authentication in the provider instance.</p>
</li>
<li>
<p><strong><em>REACT_APP_USE_MOCKS</em></strong> is whether the app will use mock data that exist within the app for testing purposes. In this example, we should use the data provided from PWA provider, so you must set this variable to <em>false</em></p>
</li>
<li>
<p><strong><em>REACT_APP_CLIENT_ID</em></strong> and <strong><em>REACT_APP_CLIENT_SECRET</em></strong> are the required ID&#8217;s to ensure validity of connection between the provider and the app.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>3. LAUNCH THE APP</strong></p>
</div>
<div class="paragraph">
<p>Run the command <code>npm start</code> in <em>pwa-shell</em> folder to launch your app in development mode and you should see the app opened in your web browser as <a href="http://localhost:3000" class="bare">http://localhost:3000</a>. Perfect!</p>
</div>
<div class="paragraph">
<p><strong>4. APP DEPLOYMENT</strong></p>
</div>
<div class="paragraph">
<p>Run command <code>npm run build</code> to build production-level files that will reside under "<em>build</em>" folder after the build process. There are different server platforms to choose to host your app. Visit <a href="https://facebook.github.io/create-react-app/docs/deployment" class="bare">https://facebook.github.io/create-react-app/docs/deployment</a> for more information on deployment.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="keycloak-authentication-feature"><a class="anchor" href="#keycloak-authentication-feature"></a>1.6.3. KEYCLOAK AUTHENTICATION FEATURE</h4>
<div class="paragraph">
<p>Entando PWA also features Keycloak as the type of authentication for your app. Keycloak is an open source identity and access management solution. This is the good choice if you want extra security for user access. Follow the steps below on how to use the feature.</p>
</div>
<div class="sect4">
<h5 id="prerequisites-3"><a class="anchor" href="#prerequisites-3"></a>PREREQUISITES</h5>
<div class="paragraph">
<p>For this feature, you will need to install and launch <strong>Docker</strong> (<a href="https://www.docker.com/" class="bare">https://www.docker.com/</a>). Make sure that your PWA provider and PWA shell are not running as of this point.</p>
</div>
</div>
<div class="sect4">
<h5 id="keycloak-setup-in-pwa-provider"><a class="anchor" href="#keycloak-setup-in-pwa-provider"></a>KEYCLOAK SETUP IN PWA PROVIDER</h5>
<div class="paragraph">
<p>This section will provide you extra steps on activating Keycloak authentication feature.</p>
</div>
<div class="paragraph">
<p><strong>1. INSTALL ENTANDO KEYCLOAK PLUGIN</strong></p>
</div>
<div class="paragraph">
<p>Run <code>git clone <a href="https://github.com/entando/entando-keycloak-plugin.git" class="bare">https://github.com/entando/entando-keycloak-plugin.git</a></code> on your terminal console to grab our plugin that is needed in PWA Provider later on. After downloading using git, go in by running <code>cd entando-keycloak-plugin</code> and then run <code>mvn install -DskipTests</code> to maven install Entando Keycloak plugin. It won&#8217;t take long to finish the process.</p>
</div>
<div class="paragraph">
<p><strong>2. LAUNCH DOCKER INSTANCE</strong></p>
</div>
<div class="paragraph">
<p>Going back to the <em>pwa-provider</em> folder, you should see <strong><em>docker-compose.yml</em></strong> file. This will be used to create and launch the keycloak instance. Make sure your Docker is ready, go to console (and <em>pwa-provider</em> folder, of course), run <code>docker-compose up</code> and this will begin launching the instance. For first time, this will take time because of downloading dependencies. You might see these similar lines in your launch console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>keycloak_1  | 03:06:52,998 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0060: Http management interface listening on http://127.0.0.1:9990/management
keycloak_1  | 03:06:52,998 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0051: Admin console listening on http://127.0.0.1:9990
keycloak_1  | 03:06:52,999 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0025: Keycloak 5.0.0 (WildFly Core 7.0.0.Final) started in 22717ms - Started 671 of 931 services (649 services are lazy, passive or on-demand)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This means your keycloak instance is ready. Open <a href="http://localhost:8081" class="bare">http://localhost:8081</a> into your web browser and you should see this screen:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pwa_keycloak_1.png" alt="pwa keycloak 1" width="60%">
</div>
</div>
<div class="paragraph">
<p><strong>3. CONFIGURE KEYCLOAK</strong></p>
</div>
<div class="paragraph">
<p>This section will give you a walkthrough on how you should setup your realm, client ID and other configurables.</p>
</div>
<div class="paragraph">
<p>To begin with the last screen shown, click "<em>Administration Console</em>" and you will be brought to a login screen. Provide our usual login credentials:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>username: admin
password: adminadmin</code></pre>
</div>
</div>
<div class="paragraph">
<p>And now you should be inside the Keycloak admin console.</p>
</div>
<div class="paragraph">
<div class="title">CREATE A REALM:</div>
<p>Navigate to the top left of the screen, under the Keycloak logo, you should see a dropdown with the default realm name <em>master</em>. Below the dropdown, there&#8217;s a button labeled <strong>Add realm</strong>. Click that button.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pwa_keycloak_2_add_realm.png" alt="pwa keycloak 2 add realm" width="40%">
</div>
</div>
<div class="paragraph">
<p>This will only ask for the name of the realm. For this guide, we shall name this as "<em>entando-development</em>". Click <strong>Create</strong> to proceed.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pwa_keycloak_3_realm_form.png" alt="pwa keycloak 3 realm form" width="50%">
</div>
</div>
<div class="paragraph">
<p>Afterwards, this will prompt you to fill more details on your new realm. You don&#8217;t need to touch those. Moving on to next.</p>
</div>
<div class="paragraph">
<div class="title">CLIENTS SETTINGS:</div>
<p>When you look at the navigation again, you should be seeing "<em>Clients</em>" menu.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pwa_keycloak_4_clients_nav.png" alt="pwa keycloak 4 clients nav" width="20%">
</div>
</div>
<div class="paragraph">
<p>Click on that then this will bring you to list of Clients for your realm. With this, we need to create two clients named "<em>entando-app</em>" and "<em>entando-pwa</em>".</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pwa_keycloak_5_clients_list.png" alt="pwa keycloak 5 clients list" width="70%">
</div>
</div>
<div class="paragraph">
<p>Click "<strong>Create</strong>" button on top right of the list to begin.</p>
</div>
<div class="paragraph">
<p>For the first entry, give the client an ID with <em>entando-app</em>. Then click <strong>Save</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pwa_keycloak_6_create_client.png" alt="pwa keycloak 6 create client" width="40%">
</div>
</div>
<div class="paragraph">
<p>Now on the Client details form and under <strong>Settings</strong> tab,</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Give it a name "<em>entandoApp</em>".</p>
</li>
<li>
<p>Make the <strong>Access Type</strong> "<em>confidential</em>".</p>
</li>
<li>
<p>Turn on <strong>Implicit Flow Enabled</strong>.</p>
</li>
<li>
<p>Turn on <strong>Service Accounts Enabled</strong>.</p>
</li>
<li>
<p>on the <strong>Valid Redirect URIs</strong> field, place "<em><a href="http://localhost:8080/*" class="bare">http://localhost:8080/*</a></em>" and press the + button.</p>
</li>
<li>
<p>click <strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pwa_keycloak_7_entando_app_client_detail.png" alt="pwa keycloak 7 entando app client detail" width="40%">
</div>
</div>
<div class="paragraph">
<p>After saving, go to the <strong>Credentials</strong> tab and should see the secret key. Take note of the secret key because we&#8217;re going to use this later on under the PWA shell configuration.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pwa_keycloak_8_entando_app_client_credentials.png" alt="pwa keycloak 8 entando app client credentials" width="40%">
</div>
</div>
<div class="paragraph">
<p>Now go to <strong>Roles</strong> tab, then it should show that there are no client roles available. You must add the roles into the list. Click the <strong>Add Role</strong> button on top right to start adding the following roles (with patience):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>manageCategories</strong></p>
</li>
<li>
<p><strong>manageResources</strong></p>
</li>
<li>
<p><strong>editContents</strong></p>
</li>
<li>
<p><strong>editUserProfile</strong></p>
</li>
<li>
<p><strong>viewUsers</strong></p>
</li>
<li>
<p><strong>validateContents</strong></p>
</li>
<li>
<p><strong>managePages</strong></p>
</li>
<li>
<p><strong>enterBackend</strong></p>
</li>
<li>
<p><strong>superuser</strong></p>
</li>
<li>
<p><strong>editUsers</strong></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pwa_keycloak_9_entando_app_client_roles.png" alt="pwa keycloak 9 entando app client roles" width="70%">
</div>
</div>
<div class="paragraph">
<p>After that, go to <strong>Service Account Roles</strong> tab and go to the lower right where you can see the <strong>Client Roles</strong> dropdown and select "<em>realm-management</em>". On right you should see a menu list that you can add to the <strong>Assigned Roles</strong> list. Choose "<em>realm-admin</em>" and press <strong>Add selected</strong> to add <em>realm-admin</em> to the <strong>Assigned Roles</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pwa_keycloak_10_entando_app_client_service_accounts.png" alt="pwa keycloak 10 entando app client service accounts" width="35%">
</div>
</div>
<div class="paragraph">
<p>Now you&#8217;re done with <strong><em>entando-app</em></strong> client. But you need to add one more, which is "<em>entando-pwa</em>". On the left nav, click <strong>Clients</strong> again and go to the rightmost side and click <strong>Create</strong>.</p>
</div>
<div class="paragraph">
<p>For the second entry, give the client an ID with <em>entando-pwa</em>. Then click <strong>Save</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pwa_keycloak_11_entando_pwa_client.png" alt="pwa keycloak 11 entando pwa client" width="50%">
</div>
</div>
<div class="paragraph">
<p>Now for the details form and under <strong>Settings</strong> tab, do the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Give it a name "<em>entandoPwa</em>".</p>
</li>
<li>
<p>Change the <strong>Login Theme</strong> to "<em>entando</em>".</p>
</li>
<li>
<p><strong>Direct Access Grants Enabled</strong> should be <strong><em>off</em></strong></p>
</li>
<li>
<p>on the <strong>Valid Redirect URIs</strong> field, add "<em><a href="http://localhost:8080/*" class="bare">http://localhost:8080/*</a></em>" and "<em><a href="http://localhost:3000/*" class="bare">http://localhost:3000/*</a></em>".</p>
</li>
<li>
<p>under <strong>Web Origins</strong> field, add "<em><a href="http://localhost:8080" class="bare">http://localhost:8080</a></em>" and "<em><a href="http://localhost:3000" class="bare">http://localhost:3000</a></em>".</p>
</li>
<li>
<p>click <strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pwa_keycloak_12_entando_pwa_client_detail.png" alt="pwa keycloak 12 entando pwa client detail" width="40%">
</div>
</div>
<div class="paragraph">
<p>And that should be it for the <strong>Clients</strong> section.</p>
</div>
<div class="paragraph">
<div class="title">AUTHENTICATION SETTINGS:</div>
<p>This should be pretty quick for this section. This is for demo purposes only since we don&#8217;t want to use OTP in the local environment, we should disable it. So going to the <strong>Authentication</strong> settings on the left nav, under <strong>Flows</strong> tab, open the dropdown (with <strong>HTTP Challenge</strong> in it) and change it to <strong>Browser</strong>. At the bottomost part of the table, you should see a field <strong>OTP Form</strong>. Choose "<em>Disabled</em>" and you&#8217;re done.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pwa_keycloak_13_authentication_browser.png" alt="pwa keycloak 13 authentication browser" width="70%">
</div>
</div>
<div class="paragraph">
<div class="title">CREATE A USER:</div>
<p>If you wanted to test its user access capability, we need to create a user. On the left nav, go to <strong>Users</strong> and on the (supposedly empty) user list, press <strong>Add User</strong> at the right side of it.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pwa_keycloak_14_users.png" alt="pwa keycloak 14 users" width="50%">
</div>
</div>
<div class="paragraph">
<p>Give it a username, and some basic information. For this guide, We&#8217;ll use "<em>admin</em>" as the username and other basic information you see on the screenshot below, then hit <strong>Save</strong> button.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pwa_keycloak_15_add_user.png" alt="pwa keycloak 15 add user" width="40%">
</div>
</div>
<div class="paragraph">
<p>Lastly, you need to set its password. Go to <strong>Credentials</strong> tab and fill out its new password and make sure to switch <strong>Temporary</strong> field to "<em>off</em>". Then press <strong>Reset Password</strong> button to set the password.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pwa_keycloak_16_user_credentials.png" alt="pwa keycloak 16 user credentials" width="40%">
</div>
</div>
<div class="paragraph">
<p>Now you have finally finished configuring your Keycloak instance. Time for us to go back to your PWA Provider and configure it with Keycloak!</p>
</div>
</div>
<div class="sect4">
<h5 id="configure-pwa-provider-instance-with-keycloak"><a class="anchor" href="#configure-pwa-provider-instance-with-keycloak"></a>CONFIGURE PWA PROVIDER INSTANCE WITH KEYCLOAK</h5>
<div class="paragraph">
<p>You should be in your <em>pwa-provider</em> in your terminal console. Locate again <em>pwa-provider/src/main/config/systemParams.properties</em> and open it. We need to reconfigure the Keycloak settings. See again at the end part of the file and change the ff:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>keycloak.enabled=true</strong> - enabling keycloak auth</p>
</li>
<li>
<p><strong>keycloak.authUrl=${KEYCLOAK_AUTH_URL:http://localhost:8081/auth}</strong> - your keycloak console url, this usually ends with "<em>auth</em>".</p>
</li>
<li>
<p><strong>keycloak.realm=${KEYCLOAK_REALM:entando-development}</strong> - your realm name</p>
</li>
<li>
<p><strong>keycloak.clientId=${KEYCLOAK_CLIENT_ID:entando-app}</strong> - from your client in realm</p>
</li>
<li>
<p><strong>keycloak.clientSecret=${KEYCLOAK_CLIENT_SECRET:&lt;YOUR CLIENT SECRET KEY&gt;}</strong> - The secret key (remember about the secret key that you took note earlier in Keycloak setup)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Save it. and then run <code>mvn jetty:run</code> in your console to launch your PWA Provider instance. This should go well if you have followed the procedure on setting up Keycloak.</p>
</div>
</div>
<div class="sect4">
<h5 id="configure-pwa-app-pwa-shell-with-keycloak"><a class="anchor" href="#configure-pwa-app-pwa-shell-with-keycloak"></a>CONFIGURE PWA APP (PWA-SHELL) WITH KEYCLOAK</h5>
<div class="paragraph">
<p>We need to tell the app that we are now using Keycloak authentication for user management and security. Go now to <em>pwa-shell</em> folder and open <strong><em>.env.local</em></strong> to make changes on the environmental variables:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>REACT_APP_AUTH_TYPE=keycloak
...
REACT_APP_KEYCLOAK_REALM=entando-development
REACT_APP_KEYCLOAK_CLIENT_ID=entando-pwa</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong><em>REACT_APP_AUTH_TYPE</em></strong> is now "<em>keycloak</em>" and we add two variables named <strong><em>REACT_APP_KEYCLOAK_REALM</em></strong> with your realm name "<em>entando-development</em>" and <strong><em>REACT_APP_KEYCLOAK_CLIENT_ID</em></strong> with "<em>entando-pwa</em>" for this is the 2nd client we created back at Keycloak setup.</p>
</div>
<div class="paragraph">
<p>Don&#8217;t forget to save it. Then run command <code>npm start</code> to test it out.</p>
</div>
<div class="paragraph">
<p>This concludes your setup guide your Keycloak-powered Entando PWA!</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="styling-rebranding"><a class="anchor" href="#styling-rebranding"></a>1.6.4. STYLING / REBRANDING</h4>
<div class="paragraph">
<p>This section will help you style your Entando PWA <em>(pwa-shell)</em> app in no time. We should start with the name of your app.</p>
</div>
<div class="sect4">
<h5 id="app-naming"><a class="anchor" href="#app-naming"></a>APP NAMING</h5>
<div class="paragraph">
<p>There are 2 files we need to modify:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong><em>public/manifest.json</em></strong> - This is the <a href="https://developers.google.com/web/fundamentals/web-app-manifest/">Web App Manifest</a> file of your app. All you need to do is change the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><strong>"short_name"</strong> - that will be used on the user&#8217;s home screen, launcher, or limited-space areas</p>
</li>
<li>
<p>and <strong>"name"</strong> - that will be used on <em>App Install Prompt</em>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><em>src/HomePageHead.js</em></strong> - look for the lines:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>const name = 'Entando PWA';
const shortName = 'Entando';</code></pre>
</div>
</div>
<div class="paragraph">
<p>Modify them with same <em>name</em> and <em>short_name</em> you placed in the web app manifest file.</p>
</div>
</div>
<div class="sect4">
<h5 id="icons-splash-screens"><a class="anchor" href="#icons-splash-screens"></a>ICONS &amp; SPLASH SCREENS</h5>
<div class="paragraph">
<p>Your logo will be needed to represent your app (as an icon and splash screen when user starts your app). They will be needed once your app is being added to user&#8217;s device. These are already specified in your <em>public/manifest.json</em>. All you need to do is replace the icons using your own.</p>
</div>
<div class="paragraph">
<p>For the icons, there are two areas for you to modify:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <strong>"public"</strong> folder - basically there are two specifics in this folder you need to customize:</p>
<div class="ulist">
<ul>
<li>
<p>the Favicon (<strong>favicon.png</strong>) - you can also use .ico for this</p>
</li>
<li>
<p><strong>app-icons</strong> subfolder - inside there are two files, <em>icon-192.png</em> and <em>icon-512.png</em>. Both must be similar and has dimensions of 192x192 pixels and 512x512 pixels, respectively.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>"src/images/apple"</strong> folder - there will be a handful of files for you to customize. They are all going to be used under iOS platforms. Take note of these files mentioned below for you to convert:</p>
<div class="ulist">
<ul>
<li>
<p><strong>icon-&lt;size&gt;.png</strong> - 4 icon sizes you have to provide: 152x152, 167x167, 180x180, and 512x512.</p>
</li>
<li>
<p><strong>launch-&lt;size&gt;.png</strong> - 9 launch screens for various <a href="http://iosres.com/">iOS phones and tablets</a>:</p>
<div class="ulist">
<ul>
<li>
<p>750x1334 - iPhone 6, 6s, 7, 8</p>
</li>
<li>
<p>828x1792 - iPhone XR</p>
</li>
<li>
<p>1125x2436 - iPhone X &amp; Xs</p>
</li>
<li>
<p>1242x2208 - iPhone 8 Plus, 6 Plus, 6s Plus, 7 Plus</p>
</li>
<li>
<p>1242x2688 - iPhone Xs Max</p>
</li>
<li>
<p>1536x2048 - iPad Pro (9.7-inch), all iPad Air&#8217;s, all iPad Mini&#8217;s</p>
</li>
<li>
<p>1668x2224 - iPad Pro (10.5-inch)</p>
</li>
<li>
<p>1668x2388 - iPad Pro (11-inch)</p>
</li>
<li>
<p>2048x2732 - iPad Pro 12.9-inch (2nd generation), iPad Pro (12.9-inch)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="logos-icons-other-image-assets"><a class="anchor" href="#logos-icons-other-image-assets"></a>LOGOS, ICONS &amp; OTHER IMAGE ASSETS</h5>
<div class="paragraph">
<p>This section will give you a quick guide on what are in-app image assets you can modify. Take note that all image assets you can find are inside <strong><em>pwa-shell/src/images</em></strong> folder.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>The Header Logo</strong> - this is a horizontal-type image that is obviously located at the header of your app. Look for the image file <strong><em>Logo_horizontal@2x.jpg</em></strong> under <em>src/images</em> folder.</p>
</li>
<li>
<p><strong><em>Vertical</em> Logo</strong> - this is a square-type logo that is usually found on login page and an empty-state notification page. Refer to the image file <strong><em>Logo_vertical@2x.png</em></strong> and <strong><em>Logo_vertical@1x.png</em></strong>.</p>
</li>
<li>
<p><strong>Other icons</strong> - other icons you can find (like search, notification, menu, etc.) are found under <strong><em>src/images/icons</em></strong> folder. These are SVG files so you can easily change its colors using CSS.</p>
</li>
<li>
<p><strong><em>Footer</em> Background Image</strong> - You can see this background image file when you scroll to the bottommost of the page. You can replace this with the file <strong><em>Vegetato@2x.png</em></strong> under <em>src/images</em> folder.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="color-themes"><a class="anchor" href="#color-themes"></a>COLOR THEMES</h5>
<div class="paragraph">
<p>Your App colors can be modified by changing SCSS variables under <strong><em>src/styles/variables.scss</em></strong> file. At the beginning of the file, you should see these lines:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>$color-primary: #203752;
$color-primary-light: #455b71;
$color-primary-lightest: #cfcfd4;
$color-primary-text: #fff;
$color-secondary: #f6f6f7;
$color-secondary-light: #d1d6db;
$color-secondary-lightest: #fff;
$color-secondary-text: #7b7f82;
$color-accent: #19bcff;

$color-red: #ff7e7d;
$color-dark: #7b7f82;
$color-darkest: #1c2024;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The theme is consist of 5 representations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Primary</strong> - the main color of your app. This is used basically on the header background. It is recommended to use a color that is in visually contrast to the specified secondary color. This has 4 sub entites:</p>
<div class="ulist">
<ul>
<li>
<p><strong>"color-primary"</strong> - the main primary color</p>
</li>
<li>
<p><strong>"color-primary-light"</strong> - a light version of the main primary color</p>
</li>
<li>
<p><strong>"color-primary-lightest"</strong> - a more, lighter version of the main primary color</p>
</li>
<li>
<p><strong>"color-primary-text"</strong> - text color to be used against the primary color (specifically when primary color is used as background).</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Secondary</strong> - the second color of your app. This is used basically on the body background. It is recommended to use a color that is in visually contrast to the specified primary color. This has 4 sub entites:</p>
<div class="ulist">
<ul>
<li>
<p><strong>"color-secondary"</strong> - the main secondary color</p>
</li>
<li>
<p><strong>"color-secondary-light"</strong> - a light version of the main secondary color</p>
</li>
<li>
<p><strong>"color-secondary-lightest"</strong> - a more, lighter version of the main secondary color</p>
</li>
<li>
<p><strong>"color-secondary-text"</strong> - text color to be used against the secondary color (specifically when secondary color is used as background).</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Accent / color-accent</strong> - this is basically used as color for call-to-Action buttons. It is recommended to use a color that stands out against the two color groups mentioned above.</p>
</li>
<li>
<p><strong>The error color / color-red</strong> - the color used for erroneous entities such as alerts.</p>
</li>
<li>
<p><strong>The dark color / color-dark(darkest)</strong> - the color used for some parts of the app that are needed a dark contrast.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="the-pwa-shell-code-structure"><a class="anchor" href="#the-pwa-shell-code-structure"></a>1.6.5. THE PWA SHELL CODE STRUCTURE</h4>
<div class="paragraph">
<p>If you want to take your PWA app into the next level with regards to changing the layout, you can to customize it deeper. In order for you to achieve customization, you need React JS experience, browse to <strong>"pwa-shell"</strong> folder and these guides below.</p>
</div>
<div class="sect4">
<h5 id="layout-components"><a class="anchor" href="#layout-components"></a>LAYOUT COMPONENTS</h5>
<div class="paragraph">
<p>All layout-related components are located in <strong>"src/ui"</strong> folder. It&#8217;s corresponding stylesheets (SCSS) are located in <strong>"src/styles"</strong> folder. Here are some essential files that are commonly known to modify for customisation:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>App.js</strong> - the main shell of your app. The stylesheet file is in <em>"src/styles/app.scss"</em>.</p>
</li>
<li>
<p><strong>HomePageHead.js</strong> - contains head metadata of your app including the name, icon locations, etc.</p>
</li>
<li>
<p><strong>content-list</strong> folder - consist of components that are used around the main page or your content list. The stylesheet file is in <em>"src/styles/content-list.scss"</em>. You can modify the layout with the following files:</p>
<div class="ulist">
<ul>
<li>
<p><strong>ContentListTopBar.js</strong> - the top bar of your content list page. Stylesheet file is in <em>"src/styles/topbar.scss"</em>.</p>
</li>
<li>
<p><strong>ContentList.js</strong> - the body (excluding top bar) of your content list page. This includes the selected categories (<code>&lt;SelectedCategoryList /&gt;</code>) and content list items (<code>&lt;ContentListItem /&gt;</code>)</p>
</li>
<li>
<p><strong>SelectedCategoryList.js</strong> - selected categories block related to the current content list. Stylesheet file is in <em>"src/styles/selected-category-list.scss"</em>.</p>
</li>
<li>
<p><strong>ContentListItem.js</strong> - the shell of the content item (or content model) used to the list. You can refer to both <em>"src/styles/content-list-item.scss"</em> for the shell style and <em>"src/styles/content-model.css"</em> for the content model stylesheet.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>content-detail</strong> folder - contains components that are used in the content detail view.</p>
<div class="ulist">
<ul>
<li>
<p><strong>ContentDetailTopBar.js</strong> - the top bar of your content view page.</p>
</li>
<li>
<p><strong>ContentDetail.js</strong> - the body layout of content view page. The stylesheet file is in <em>"src/styles/content-detail.scss"</em>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>menu</strong> folder - areas used around the app working as essential controls (such as menu, search, etc.)</p>
<div class="ulist">
<ul>
<li>
<p><strong>Drawer.js</strong> - the app drawer. Stylesheet is in <em>"src/styles/drawer.scss"</em>.</p>
</li>
<li>
<p><strong>CategoryFilter.js</strong> - the category filtering control found in the app drawer. Stylesheet is in <em>"src/styles/category-filter.scss"</em>.</p>
</li>
<li>
<p><strong>Logout.js</strong> - Simply contains the logged user information and logout button control. Stylesheet is in <em>"src/styles/drawer.scss"</em>.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="api-methods"><a class="anchor" href="#api-methods"></a>API METHODS</h5>
<div class="paragraph">
<p>API methods in this app are used with <a href="https://github.com/entando/frontend-libraries/tree/master/packages/entando-apimanager#api-requests">Entando&#8217;s API Manager</a> going to specified PWA Provider instance. All related files are located inside <strong>pwa-shell/src/api</strong> folder. Here are the following files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>content.js</strong> - All content related requests such as content details (protected and public), and content list.</p>
</li>
<li>
<p><strong>category.js</strong> - contains category listing around your PWA app.</p>
</li>
<li>
<p><strong>contentType.js</strong> - contains content type listing including your default content type for your app.</p>
</li>
<li>
<p><strong>notification.js</strong> - notification related requests such as the user&#8217;s notification list.</p>
</li>
<li>
<p><strong>userProfile.js</strong> - profile details of the logged user</p>
</li>
<li>
<p><strong>login.js</strong> - login request for viewing protected contents</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information on section details mentioned above, see <a href="#_content_management_system">CMS (Content Management System)</a> for more details.</p>
</div>
</div>
<div class="sect4">
<h5 id="i18n"><a class="anchor" href="#i18n"></a>I18N</h5>
<div class="paragraph">
<p>Entando PWA features a quick way to generate a language (JSON) file generator for the developer to easily customise. This is powered by react-intl with the efficient tools of <a href="https://github.com/evenchange4/react-intl.macro">react-intl.macro</a> to extract messages around the app and followed by <a href="https://github.com/GertjanReynaert/react-intl-translations-manager">react-intl translations manager</a> to gather all the extracted messages and place them all under one JSON file per language to efficiently let the developer translate the needed messages depending on your specified language.</p>
</div>
<div class="paragraph">
<p>Should you need to create or change the language, here are some steps for you to do:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>open <strong>"pwa-shell/scripts/bundleTranslations.js"</strong> and look for this code:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>bundleTranslations({
  messagesDirectory: '.messages',
  translationsDirectory: 'src/i18n/translations/',
  languages: ['it'],
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can set for the language by modifying <code>languages</code> array. You can have multiple languages if you  want. For this example, we have indicated to use <strong>'it'</strong> as your language.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>After indicating your languages. Save the modified file. Then in <strong>"pwa-shell"</strong> console, run this command:</p>
<div class="literalblock">
<div class="content">
<pre>npm run i18n</pre>
</div>
</div>
</li>
<li>
<p>this will process on creating language JSON structure that is used around the app. You can check the result under the folder <strong>"pwa-shell/src/i18n/translations/it.json"</strong> and modify the necessary messages that fits with the default message.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>{
  "categoryfilter.selectTopic": "Seleziona i tuoi argomenti di interesse",
  "categorylist.topicsViewing": "Argomenti che stai visualizzando",
  "contentdetail.loadingProgress": "Caricamento...",
  "contentlist.loadingProgress": "Caricamento...",
  ...,
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the example above, you have modified the message translations with <strong>'it'</strong> (Italian) language.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In order for you to use the translation you just worked on, you should modify the file <strong>"pwa-shell/src/i18n/locales.js"</strong> and include your newly generated and modified json file from the previous step.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>import it from 'i18n/translations/it.json';

// English is the default message in each of our source files, so no need for a separate en.json file
const en = {};

export default { en, it };</code></pre>
</div>
</div>
<div class="paragraph">
<p>for the example above, <strong>"it"</strong> language has been added to the list of locales.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>open <code>pwa-shell/src/state/appConfig.js</code>, and set <strong>"languageCode"</strong> to <strong>'it'</strong>. Save it then you should be good to go using your new language. Run <code>npm start</code> to check it out.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="entandos-custom-jsp-tags"><a class="anchor" href="#entandos-custom-jsp-tags"></a>1.7. ENTANDO&#8217;S CUSTOM JSP TAGS</h3>
<div class="paragraph">
<p><strong>Tag name:</strong> action<br>
<strong>Function:</strong> Build the URL to call a jsp or a functionality of a servlet defined within the system.<br>
<strong>Available subtags:</strong> Parameter tag for adding URL parameters.<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The relative path of the JSP or servlet to invoke, relative to the context of the web-application.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page-scoped variable where to place the URL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> categories<br>
<strong>Function:</strong> Return the list of the system categories on SelectItem objects<br>
<strong>Available subtags:</strong> None.<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">titleStyle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The style of the single select item. Currently it can be “default” (single title node), “full” (title with all parents), or “prettyFull” (title with all parents in form of ‘..’). The default when none is given is “default”.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fullTitleSeparator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the separator between the titles when 'titleStyle' is 'full' or 'prettyFull'.]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page-scoped variable where to place the list of categories.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">root</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The root of the categories to show. The default is the system root categories.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> checkHeadInfoOuputter - Use only in widgets<br>
<strong>Function:</strong> this subtag verifies the availability of the information to display. Use this subtag ONLY in a page model, in conjunction with ‘outputHeadInfo’.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the type of information to analyze.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> contentNegotiation * DEPRECATED. This function was moved into the executor service since Entando 4.1.</p>
</div>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> cssURL<br>
<strong>Function:</strong> Extension of the resourceURL tag. It returns the URL of the css files.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong> None</p>
</div>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> currentPage<br>
<strong>Function:</strong> Returns the requested information held by the current page bean.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The wanted parameter; can be either “title”, “owner” (group), “code”, “hasChild”, or “childOf (with attribute “targetPage”. The default when none is given is “title”.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">langCode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code of the language to use for the page information being returned.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page context variable where the information is placed. Note that in this case, special characters are not escaped.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">targetPage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Target page when "param" is "childOf".</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decides whether to escape the special characters in the information retrieved. Values admitted are true/false. Default is true.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> currentWidget<br>
<strong>Function:</strong> Returns information about the widget where the tag resides. To retrieve information about a widget placed in a frame other than the current one, use the “frame” attribute.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The requested parameter. It can assume one of the following values:<br>
* "code" returns the code of the associated widget type (empty if none associated)<br>
* "title" returns the name of the associated widget type (empty if none associated)<br>
* "config" returns the value of the configuration parameter declared in the "configParam" attribute<br>
The default is “title”</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">configParam</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the configuration parameter request. This attribute is mandatory when the attribute “param” is set to “config.”</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page context variable where the requested information is pushed. In this case the special characters will not be escaped.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">frame</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Id of the frame hosting the widget with the desired information.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decides whether to escape the special characters in the information retrieved. Values admitted are true/false. Default is true.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> currentShowlet * DEPRICATED - Use currentWidget for Entando versions 4.0.0+<br>
<strong>Function:</strong> Returns informations about the widget where the tag resides. To obtain information about a widget placed in a frame other than the current, use the "frame" attribute.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The requested parameter. It can assume one of the following values:<br>
* "code" returns the code of the associated widget type (empty if none associated)<br>
* "title" returns the name of the associated widget type (empty if none associated)<br>
* "config" returns the value of the configuration parameter declared in the "configParam" attribute<br>
The default is “title”</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">configParam</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the configuration parameter request. This attribute is mandatory when the attribute “param” is set to “config.”</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page context variable where the requested information is pushed. In this case the special characters will not be escaped.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">frame</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Id of the frame hosting the widget with the desired information.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decides whether to escape the special characters in the information retrieved. Values admitted are true/false. Default is true.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> fragment<br>
<strong>Function:</strong> Print a gui fragment by the given code.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">code</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The code of the fragment to return.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page context variable where the requested information is pushed. In this case the special characters will not be escaped.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decides whether to escape the special characters in the information retrieved. Values admitted are true/false. Default is true.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> freemarkerTemplateParameter<br>
<strong>Function:</strong> Add a parameter into the Freemarker&#8217;s TemplateModel Map<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the variable where the requested information is pushed.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">valueName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the variable of the page context where extract the information.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">removeOnEndTag</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to remove the parameter on end of Tag.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> headInfo * SPECIAL SYSTEM TAG - Use only in widgets<br>
<strong>Function:</strong> Declares the information to insert in the header of the HTML page. The information can be passed as an attribute or, in an indirect manner, through a variable of the page context.<br></p>
</div>
<div class="paragraph">
<p>It is mandatory to specify the type of the information.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaration of the information type. Currently only "CSS" is currently supported.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Information to declare. This is an alternative of the "var" attribute.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the variable holding the information to declare.This attribute is the alternative of the "info" one. This variable can be used for those types of information that cannot be held by an attribute.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> i18n<br>
<strong>Function:</strong> Return the string associated to the given key in the specified language.This string is either returned (and rendered) or can be optionally placed in a page context variable.<br></p>
</div>
<div class="paragraph">
<p>This tag can use the ParameterTag sub-tag to add label parameters.<br>
<strong>Available subtags:</strong> ParameterTag<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key of the label to return.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lang</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code of the language requested for the label.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page context variable where the requested information is pushed. In this case the special characters will not be escaped.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decides whether to escape the special characters in the information retrieved. Values admitted are true/false. Default is true.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> ifauthorized<br>
<strong>Function:</strong> Toggles the visibility of the elements contained in its body, depending on user permissions.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">permission</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The code of the permission required.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">groupName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the group membership required.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the (boolean) page context parameter where the result of the authorization check is placed.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> imageURL<br>
<strong>Function:</strong> Extension of the ResourceURL tag. It returns the URL of the images to display as static content outside the cms.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong> None</p>
</div>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> info<br>
<strong>Function:</strong> Returns the information of the desired system parameter.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key of the desired system parameter, admitted values are:<br>
* "startLang" returns the code of start language of web browsing<br>
* "defaultLang" returns the code of default language<br>
* "currentLang" returns the code of current language<br>
* "langs" returns the list of the languages defined in the system<br>
* "systemParam" returns the value of the system param specified in the "paramName" attribute.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the variable where to store the retrieved information (page scope).
In this case the special characters will not be escaped.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">paramName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the wanted system parameter; it is mandatory if the "key" attribute is "systemParam", otherwise it is ignored.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Toggles the escape of special characters in the information retrieved. Values admitted are true/false. Default is true.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> internalServlet * SPECIAL SYSTEM TAG - Use only in widgets<br>
<strong>Function:</strong> Tag for the "Internal Servlet" functionality. Publishes a function served by an internal Servlet; the servlet is invoked from a path specified in the attribute "actionPath" or by the widget parameter sharing the same name. This tag can be used only in a widgets.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">actionPath</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The initial action path.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">staticAction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to execute only the given action path. Possible entries (true/false). Default value: false.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> externalFramework * DEPRECATED*; use "internalServlet" instead.<br>
<strong>Function:</strong> Tag for the "External Framework" widget.</p>
</div>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> outputHeadInfo * SPECIAL SYSTEM TAG - Use only in page models<br>
<strong>Function:</strong> Iterates over various information in HTML header displaying them; this tag works in conjunction with other specific sub-tags. Note that the body can contain <strong>only</strong> a sub-tag, or information, at once. This tag must be used <strong>only</strong> in a page model.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Attribute</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Function</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Required?</strong></p>
<p class="tableblock">type
Specifies the type of information to return, in accordance with the sub-tag to use.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> pageInfo<br>
<strong>Function:</strong> Returns the information of the specified page. This tag can use the sub-tag "ParameterTag" to add url parameters if the info attribute is set to 'url'.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pageCode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The code of the page.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code of required page parameter. Possible entries: "code" (default value) , "title", "owner" (group), "url", "hasChild" or "childOf" (with attribute "targetPage").</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">langCode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code of the language to use for the returned information.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name used to reference the value pushed into the pageContext. In this case, the system <strong>will not</strong> escape the special characters in the value entered in pageContext.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">targetPage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Target page when "param" is "childOf".</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to escape HTML. Possible entries (true/false). Default value: true.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> pager<br>
<strong>Function:</strong> List pager.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum value for each object group.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">listName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the list as found in the request.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">objectName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the object currently iterated. The following methods are exposed: getMax, getPrevItem, getNextItem, getCurrItem, getSize, getBegin, getEnd, getMaxItem, getPagerId.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pagerId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the ID of the pager itself, it has to be used when two or more pagers exist in the same page. This attributes overrides "pagerIdFromFrame".</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pagerIdFromFrame</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the ID of the pager (mandatory when two or more pagers share the same page) based upon the frame where the tag is placed. Admitted values are (true/false), the latter being the default. Note that the "pagerId" attribute takes precedence over this one.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">advanced</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Toggles the pager in advanced mode. Admitted values are (true/false). Use the advanced mode the tag is used when the list to iterate over is excessively large.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">offset</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This attribute is considered only when the pager is in advanced mode. This is the numeric value of the single step increment (or decrement) when iterating over the list.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> parameter<br>
<strong>Function:</strong> This tag can be used to parameterise other tags. The parameter value can be added through the 'value' attribute or the body tag. When you declare the param tag, the value can be defined in either a value attribute or as text between the start and the ending of the tag.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the parameter.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value of the parameter.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> printHeadInfo - Use only with pagemodels<br>
<strong>Function:</strong> Returns the information to display. This sub-tag must be used <strong>only</strong> in a page model, in conjunction with 'outputHeadInfo'.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong> None</p>
</div>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> resourceURL<br>
<strong>Function:</strong> Returns URL of the resources.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">root</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares the resource root. If not otherwise specified, the value of SystemConstants.PAR_RESOURCES_ROOT_URL is used.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">folder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares a specific directory for the desired resources. Unless specified,the value "" (empty string) is used to generate the URL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> show * SPECIAL SYSTEM TAG - Use only in pagemodels<br>
<strong>Function:</strong> Defines the position of inclusion of a widget. This tag can be used <strong>only</strong> in a page model.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">frame</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The positional number of the frame, starting from 0.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> url<br>
<strong>Function:</strong> Generates the complete URL of a portal page. The URL returned is either returned (and rendered) or placed in the given variable. To insert parameters in the query string the sub-tag "ParameterTag" is provided.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">page Code of the destination page. The default is the current page.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lang</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code of the language to use in the destination page.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the page-scoped variable where to place the URL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">paramRepeat</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Repeats in the URL all the parameters of the actual request.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">excludeParameters</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> urlPar * DEPRECATED - use ParameterTag instead<br>
<strong>Function:</strong> This is the sub-tag of the "url" tag. Adds a parameter in the URL query string generated.</p>
</div>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> pageWithWidget<br>
<strong>Function:</strong> Search and return the page (or the list of pages) with the given widget type. When "filterParamName" and "filterParamValue" attributes are present, the returned list will be filtered by a specific widget configuration.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">widgetTypeCode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The code of the widget to search.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">filterParamName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional widget config param name.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">filterParamValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional widget config param value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">listResult</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional, dafault false. When true the result is a list of pages, when false the returned page is the first occurence.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> currentUserProfileAttribute<br>
<strong>Function:</strong> Current User Profile tag. Return an attribute value of the current user profile.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributeName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the attribute from which extract the value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributeRoleName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the attribute role from which extract the value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name used to reference the value pushed into the pageContext.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decides whether to escape the special characters in the information retrieved or not. Value admitted (true/false). The default is true.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<hr>
<div class="paragraph">
<p><strong>Tag name:</strong> userProfileAttribute<br>
<strong>Function:</strong> User profile tag. Returns an attribute value from the profile give a an username.<br>
<strong>Available subtags:</strong> None<br>
<strong>Attributes:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">username</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the username.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributeName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the attribute from which to extract the value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributeRoleName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the name of the attribute role from which extract the value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name used to reference the value pushed into the pageContext.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escapeXml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decides whether to escape the special characters in the information retrieved or not. Value admitted (true/false), the default is true.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="entando-faqs"><a class="anchor" href="#entando-faqs"></a>1.8. ENTANDO FAQs</h3>
<div class="sect3">
<h4 id="error-messages"><a class="anchor" href="#error-messages"></a>1.8.1. ERROR MESSAGES</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Error creating bean with name…​ Unsatisfied dependency</dt>
<dd>
<p>This error can occur if you develop on Jetty but deploy to JBoss and Jetty’s web.xml file does not match the web.xml used for JBoss. You need to manually update the web.xml files (e.g., after adding a bean xml path) in both the JBoss config directory (<em>src/main/config/jboss/web.xml</em>) and the one used by Jetty (<em>src/main/config/web.xml</em>) so that the values match.<br></p>
<div class="paragraph">
<p>Remember that if you use an Entando image for Openshift, JBoss, or Wildfly, these images will also use the web.xml in the JBoss config directory.</p>
</div>
</dd>
</dl>
</div>
<hr>
<div class="dlist">
<dl>
<dt class="hdlist1">java.lang.NoClassDefFoundError: javax/servlet/jsp/jstl/core/ConditionalTagSupport</dt>
<dd>
<p>This error can occur if you are trying to deploy entando 5.0.3 release on the latest version of Tomcat (Actually 8.5.39) and your project is missing the <em>jstl</em> dependency. To solve this issue just add this dependency to your <em>pom.xml</em> file.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">    &lt;dependency&gt;
        &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
        &lt;artifactId&gt;jstl&lt;/artifactId&gt;
        &lt;version&gt;1.2&lt;/version&gt;
    &lt;/dependency&gt;</code></pre>
</div>
</div>
<hr>
</div>
<div class="sect3">
<h4 id="how-tos"><a class="anchor" href="#how-tos"></a>1.8.2. HOW TOs</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Where can I modify the port in a Maven-generated standalone webapp?</dt>
<dd>
<p>You can change the port value by updating the appropriate filter in <em>src/main/filters</em>. Each filter is specific to the environment in which it runs. If you&#8217;re running Jetty (dev env mode) you can also pass the port as a command line option with <code>-Djetty.port=&lt;newPort&gt;</code></p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="widgets"><a class="anchor" href="#widgets"></a>1.8.3. WIDGETS</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">When do I need to include the <em>action</em> tag in my widget and plugin configurations?</dt>
<dd>
<p>You only need to include information in the <em>action</em> tag when using Entando&#8217;s legacy Admin Portal. If you are using the App Builder, you do not need to include any information in the <em>action</em> tag.</p>
</dd>
<dt class="hdlist1">How can I access widget config data from React at runtime?</dt>
<dd>
<p>There are three ways to do this:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Following an example</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click or navigate to <a href="https://github.com/entando/entando-components/blob/master/plugins/entando-plugin-jpkiebpm/src/main/webapp/WEB-INF/plugins/jpkiebpm/aps/jsp/internalservlet/bpm-case-roles.jsp" class="bare">https://github.com/entando/entando-components/blob/master/plugins/entando-plugin-jpkiebpm/src/main/webapp/WEB-INF/plugins/jpkiebpm/aps/jsp/internalservlet/bpm-case-roles.jsp</a></p>
</li>
<li>
<p>Invoke REACT in the JSP where you import and reference your React component. In this example, you push the config elements into the DOM (note they are all hidden) and then pass that DOM to your React components. Following the example at the link above you would import React at the top and do something like:<br>
<code>ReactDOM.render(element, document.getElementById('&lt;%=cId%&gt;'))</code></p>
</li>
<li>
<p>The example above reproduces the same form used at config time but you can use a simpler structure to make the information available.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Using configuration parameters in the dom</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Use the currentWidget parameter jsp tags to reference your configuration parameters and make them available in the dom. For example, you can reference the widget configuration with this tag:<br>
<a href="https://github.com/entando/entando-core/blob/8291b863250ce00b76808a1134b8ef2ab62a041d/engine/src/main/tld/aps-core.tld#L140" class="bare">https://github.com/entando/entando-core/blob/8291b863250ce00b76808a1134b8ef2ab62a041d/engine/src/main/tld/aps-core.tld#L140</a>)</p>
</li>
<li>
<p>For example referencing a configuration parameter height:<br>
<code>&lt;wp:currentWidget param="config" configParam="height" /&gt;</code></p>
</li>
<li>
<p>Or pass them directly to your React component:<br>
<code>&lt;MyReactComponent  height="&lt;wp:currentWidget param="config" configParam="height" /&gt;"  /&gt;</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>Make the existing REST call</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Pass the page code, frame ID, and token to your React component using the JSP tags and then invoke the REST endpoint.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Unresolved directive in entando-5.3.0/index.adoc - include::release-notes/prior.adoc[leveloffset=+1]</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="entando-5-2-0"><a class="anchor" href="#entando-5-2-0"></a>2. ENTANDO 5.2.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="see-5-2-0"><a class="anchor" href="#see-5-2-0"></a>2.1. See 5.2.0</h3>
<div class="ulist">
<ul>
<li>
<p>See Entando 5.3.0 for documentation on using Entando 5.2.0. The concepts and commands are identical.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="entando-5-1-0"><a class="anchor" href="#entando-5-1-0"></a>3. ENTANDO 5.1.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="see-5-2-0-2"><a class="anchor" href="#see-5-2-0-2"></a>3.1. See 5.2.0</h3>
<div class="ulist">
<ul>
<li>
<p>See Entando 5.2.0 for documentation on using Entando 5.1.0. The concepts and commands are identical.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="entando-5-0-0"><a class="anchor" href="#entando-5-0-0"></a>4. ENTANDO 5.0.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="installation-e5"><a class="anchor" href="#installation-e5"></a>4.1. INSTALLING ENTANDO APP BUILDER 5.0</h3>
<div class="sect3">
<h4 id="prerequisites-4"><a class="anchor" href="#prerequisites-4"></a>4.1.1. PREREQUISITES</h4>
<div class="sect4">
<h5 id="space-and-hardware-requirements-2"><a class="anchor" href="#space-and-hardware-requirements-2"></a>SPACE AND HARDWARE REQUIREMENTS</h5>
<div class="paragraph">
<p>Entando is a built to be a very light framework requiring limited runtime resources. When extending Entando in a development setting, sizing for development environments that add to an Entando install is up to individual user requirements.</p>
</div>
</div>
<div class="sect4">
<h5 id="installed-prerequisites-2"><a class="anchor" href="#installed-prerequisites-2"></a>INSTALLED PREREQUISITES:</h5>
<div class="ulist">
<ul>
<li>
<p>Java 1.8+</p>
</li>
<li>
<p>npm 5.6.0+ (for ReactJS front ends)</p>
</li>
<li>
<p>Maven 3.0.5+</p>
</li>
<li>
<p>Ant 1.8.0+</p>
</li>
<li>
<p>Git (only if building from source code)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="running-the-mapp-engine-instance-2"><a class="anchor" href="#running-the-mapp-engine-instance-2"></a>4.1.2. RUNNING THE MAPP ENGINE INSTANCE</h4>
<div class="sect4">
<h5 id="creating-a-new-entando-project-2"><a class="anchor" href="#creating-a-new-entando-project-2"></a>CREATING A NEW ENTANDO PROJECT</h5>
<div class="paragraph">
<p>Set up an Entando application via a Maven archetype. The archetype creates the project and structure needed to develop and add to an application.</p>
</div>
<div class="paragraph">
<p><strong>Steps:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open your command line and navigate to the directory that will house your new project.</p>
</li>
<li>
<p>Run the following command:<br>
<code>mvn archetype:generate -Dfilter=entando-archetype-webapp-generic</code></p>
</li>
<li>
<p>Select Option 1, displayed as follows:<br>
<code>1: remote &gt; org.entando.entando:entando-archetype-webapp-generic (Generic web app Archetype for Entando: an agile, modern and user-centric open source web app like platform.)</code></p>
</li>
<li>
<p>If prompted for a version, select 5.0.0.</p>
</li>
<li>
<p>Enter values for groupId, artifactId, version, and package. These values go into the Maven setup in the new project. See the Maven documentation for more information on these values. <a href="https://maven.apache.org/guides/mini/guide-naming-conventions.html" class="bare">https://maven.apache.org/guides/mini/guide-naming-conventions.html</a></p>
</li>
<li>
<p>Open the directory created by the Maven archetype in Step 2. The directory will have the same name as the value you entered for artifactId in Step 5. This directory contains all of the structure necessary to start the Entando MApp-Engine and execute the application. See Launching the Application section below for instructions on starting the newly created project.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="launching-the-mapp-engine-2"><a class="anchor" href="#launching-the-mapp-engine-2"></a>LAUNCHING THE MAPP ENGINE</h5>
<div class="sect5">
<h6 id="quick-start-using-derby-and-jetty-2"><a class="anchor" href="#quick-start-using-derby-and-jetty-2"></a>QUICK START USING DERBY AND JETTY</h6>
<div class="paragraph">
<p>Once you have created an Entando application, you can launch it using Jetty and an embedded Derby database.</p>
</div>
<div class="paragraph">
<p>To do so, run the following command inside your project:<br>
<code>mvn clean jetty:run</code></p>
</div>
<div class="paragraph">
<p><strong>Once started the logs will print the following messages:</strong><br>
  [INFO] Started SelectChannelConnector@0.0.0.0:8080<br>
  [INFO] Started Jetty Server<br>
  [INFO] Starting scanner at interval of 5 seconds</p>
</div>
<div class="paragraph">
<p>The logs will indicate that your application is running. To launch your application, point your browser to <a href="http://localhost:8080/">your app name</a></p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="launching-the-app-builder-2"><a class="anchor" href="#launching-the-app-builder-2"></a>4.1.3. LAUNCHING THE APP BUILDER</h4>
<div class="paragraph">
<p>This section provides several options for launching the App Builder which is used to manage a separately running Mapp Engine instance.  The App Builder is completely stateless and relies on the Engine to store the application configuration.  If no Mapp engine is specified, the App Builder will default to providing mock data so that the functionality can be demonstrated.</p>
</div>
<div class="paragraph">
<p><strong>Prerequisites:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>git</p>
</li>
<li>
<p>npm</p>
</li>
<li>
<p>node</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="clone-and-setup-2"><a class="anchor" href="#clone-and-setup-2"></a>CLONE AND SETUP</h5>
<div class="paragraph">
<p><strong>Enter the following commands in your command line:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>git clone https://github.com/entando/app-builder.git</code></p>
</li>
<li>
<p><code>cd app-builder</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>It is recommended to checkout the release branch corresponding to the version of the Mapp Engine, e.g.,<br>
<code>git checkout v5.0.0-release</code></p>
</li>
<li>
<p>Available release branches can be listed with: <code>git branch -a</code></p>
</li>
</ol>
</div>
</li>
<li>
<p><code>npm install</code><br></p>
</li>
<li>
<p><code>npm start</code>&#8201;&#8212;&#8201;Starts the application in dev mode (local web server).</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The npm install command installs npm dependencies inside the node_modules folder</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This will give you a running app-builder instance using mock data. The Configuration section below covers connecting your App Builder to a running MApp engine.</p>
</div>
</div>
<div class="sect4">
<h5 id="configuration-2"><a class="anchor" href="#configuration-2"></a>CONFIGURATION</h5>
<div class="paragraph">
<p>There are two methods for using the App Builder, depending on whether the API calls will be to the live Entando Core or if they will use mock data.</p>
</div>
<div class="olist arabic">
<div class="title">Configurable properties</div>
<ol class="arabic">
<li>
<p><strong>USE_MOCKS (boolean):</strong> a Boolean setting that determines if the App Builder uses a live connection to the Entando Core or uses mock data. A value of "true" instructs the App Builder to use mock data. A value of "false" allows the App Builder&#8217;s APIs to make live data calls to the Entando Core.</p>
</li>
<li>
<p><strong>DOMAIN (string):</strong> a string representing the domain name of the Entando Core instance. The protocol is optional and you can specify a subdirectory of the domain. Trailing slashes are invalid and it only validates up to third-level domains.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you set USE_MOCKS to "false," you must run an Entando Core (MApp Engine) instance and
then to connect the App Builder to the MApp Engine using the following steps:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Run the MApp Engine instance. See Running the MApp Engine section for more information.</p>
</li>
<li>
<p>Connect the MApp Engine.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you set USE_MOCKS to "true," you do not need to run the App Builder instance because you are only using mock data.</p>
</div>
<div class="paragraph">
<p><strong>To connect the MApp Engine</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a file at the root of the app-builder called <em>.env.development.local</em>.</p>
</li>
<li>
<p>Add 'USE_MOCKS=false'</p>
</li>
<li>
<p>Add DOMAIN=&lt;url of running MApp Engine&gt;</p>
</li>
<li>
<p>Run <code>npm start</code> in your App Builder.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="additional-commands-2"><a class="anchor" href="#additional-commands-2"></a>ADDITIONAL COMMANDS</h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>npm run lint</code></dt>
<dd>
<p>Runs the linter to check code style. It fails if linting rules are not matched.</p>
</dd>
<dt class="hdlist1"><code>npm run coverage</code></dt>
<dd>
<p>Runs unit tests. It fails if a unit test fails, or if the minimum coverage threshold is not met.</p>
</dd>
<dt class="hdlist1"><code>npm run import-plugins</code></dt>
<dd>
<p>Compiles and imports Entando plugins.</p>
</dd>
<dt class="hdlist1"><code>npm run build</code></dt>
<dd>
<p>Compiles the project and creates the a production build</p>
</dd>
<dt class="hdlist1"><code>npm run build-full</code></dt>
<dd>
<p>Runs npm run lint, npm run coverage, npm run import-plugins and npm run build</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="setting-up-a-database-optional-2"><a class="anchor" href="#setting-up-a-database-optional-2"></a>4.1.4. SETTING UP A DATABASE (OPTIONAL)</h4>
<div class="paragraph">
<p>You can configure a newly created Entando application to connect to a database as its backing store. Derby is the default configuration in archetype-created applications, but you can change the default to a different value. Open the Filter Properties file in src/main/filters and enter the appropriate environment and database configuration.</p>
</div>
<div class="paragraph">
<p>Create two databases in your dbms.</p>
</div>
<div class="paragraph">
<p><strong>To connect the MApp Engine to a database server:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In your database server, create a user for the application.</p>
</li>
<li>
<p>Create two databases. Give the user from Step 1 permission to create, read, and write. For the quickstart, you should name the databases as follows:</p>
<div class="literalblock">
<div class="content">
<pre>&lt;your-project-name&gt;Port
&lt;your-project-name&gt;Serv</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>These are the default names included in the default properties files.
You can adjust the names and then change the connection information in the project&#8217;s configuration filters in src/main/filters.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>You also need to uncomment the maven dependency for the database that your are using from the <em>pom.xml</em> file. For example for MySQL you would uncomment:</p>
<div class="literalblock">
<div class="content">
<pre>&lt;dependency&gt;
        &lt;groupId&gt;mysql&lt;/groupId&gt;
        &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
        &lt;version&gt;5.1.18&lt;/version&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</li>
<li>
<p>Update the appropriate Filter Properties file in src/main/filters to use the configuration for the database properties. For example, on a MacOS, you would update  <em>filter-development-unix.properties</em>.</p>
</li>
<li>
<p>Set the user, database, and password for the values created in Steps 1 and 2.</p>
</li>
<li>
<p>Launch the application with <code>mvn jetty:run</code></p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When launching with the <code>mvn jetty:run command</code>, Jetty will automatically create the table structure required
to run the application if the tables aren&#8217;t already present. This can be used to instantiate an empty database
for future use when the target deployment is an app server such as JBoss or Tomcat.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="configuring-swagger-optional"><a class="anchor" href="#configuring-swagger-optional"></a>4.1.5. CONFIGURING SWAGGER (OPTIONAL)</h4>
<div class="paragraph">
<p>When generating an application, Entando automatically includes an instance of Swagger, a tool that lets you describe the structure of your APIs to make them easier for other machines to read. Configuring Swagger for use only takes a few steps.</p>
</div>
<div class="sect4">
<h5 id="enabling-swagger-in-a-development-environment"><a class="anchor" href="#enabling-swagger-in-a-development-environment"></a>ENABLING SWAGGER IN A DEVELOPMENT ENVIRONMENT</h5>
<div class="paragraph">
<p>To enable swagger in your development environment, you need to run your application with an enabled Swagger profile. There are two options. Run ONE of the following from the  root of your generated project&#8217;s directory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Start the container with a JVM parameter using the following command:<br>
<code>mvn clean jetty:run -Dspring.profiles.active=swagger</code></p>
</li>
<li>
<p>Add an environment variable by using the following commands:<br>
<code>export spring_profiles_active=swagger</code><br>
<code>mvn clean jetty:run</code></p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">To access the Swagger interface:</div>
<ol class="arabic">
<li>
<p>In a browser, navigate to your application’s URL (e.g., <a href="http://localhost:8080/appname" class="bare">http://localhost:8080/appname</a>).</p>
</li>
<li>
<p>Append the URL with api/swagger-ui.html. Again, for example, <a href="http://localhost:8080/appname/api/swagger-ui.html" class="bare">http://localhost:8080/appname/api/swagger-ui.html</a></p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For security purposes, you should only run this with the default credentials in a development environment. If enabling swagger in production for integration purposes be sure to change the clientId and secret.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="authentication-details"><a class="anchor" href="#authentication-details"></a>AUTHENTICATION DETAILS</h5>
<div class="paragraph">
<p><strong>Default login details:</strong><br>
<strong>Username:</strong> admin<br>
<strong>Password:</strong> adminadmin</p>
</div>
<div class="paragraph">
<p><strong>Default Swagger OAuth details:</strong><br>
<strong>Type:</strong> Request Body<br>
<strong>clientId:</strong> swagger<br>
<strong>Secret:</strong> = swaggerswagger</p>
</div>
</div>
<div class="sect4">
<h5 id="how-does-the-integration-work"><a class="anchor" href="#how-does-the-integration-work"></a>HOW DOES THE INTEGRATION WORK?</h5>
<div class="paragraph">
<p>The Swagger integration is based on three components and is activated by a Spring profile. The components are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>SwaggerConfig</strong> - responsible for configuring most of the Swagger UI behavior (or the library Springfox that provides Swagger UI functionality). It configures which paths to scan, where to find the oAuth endpoints, and other essentials</p>
</li>
<li>
<p><strong>SwaggerMvcAdapter</strong> - makes the Swagger UI&#8217;s human-friendly HTML page and its resources available for the application</p>
</li>
<li>
<p><strong>SwaggerInitializer</strong> - assists the Swagger UI with talking to your new application. Swagger UI needs to talk to the application backend, which require oAuth authentication to communicate back to the Swagger UI. The backend uses standard oAuth authentication, requiring an oAuth client_id and secret, and also that any requested redirect matches a specific URL. SwaggerInitializer is also responsible for adding the oAuth consumer details for Swagger in the database. If Swagger is enabled when the application starts, SwaggerInitializer will check for an existing configuration for a Swagger consumer in the database and adds one if necessary</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <em>swagger</em> Spring profile is active, Spring will initialize and wire all three components during application startup. If inactive, Entando ignores the components.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="building-the-mapp-engine-from-source-code-optional"><a class="anchor" href="#building-the-mapp-engine-from-source-code-optional"></a>4.1.6. BUILDING THE MAPP ENGINE FROM SOURCE CODE (OPTIONAL)</h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Building the MApp Engine from the source code is use case for heavily customizing your Entando project. As such, we recommend that all but the most advanced projects use the standard process outlined beginning with the Creating an Entando Project section above.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>To download the latest source code:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open your terminal and create an empty directory for your project:<br>
<code>mkdir ~/my_new_project</code></p>
</li>
<li>
<p>Move to the new directory:<br>
<em>cd ~/my_new_project</em></p>
</li>
<li>
<p>Clone the following repositories IN ORDER: entando-core, entando-components, entando-archetypes, entando-ux-packages projects:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Entando-core:<br>
<code>git clone https://github.com/entando/entando-core</code></p>
</li>
<li>
<p>Entando-components:<br>
<code>git clone https://github.com/entando/entando-components</code></p>
</li>
<li>
<p>Entando-archetypes:<br>
<code>git clone https://github.com/entando/entando-archetypes</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>Install, IN ORDER, the entando-core, entando-components, entando-archetypes projects:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>cd entando-core<br>
<code>mvn clean install -DskipTests</code></p>
</li>
<li>
<p>cd entando-components<br>
<code>mvn clean install -DskipTests</code></p>
</li>
<li>
<p>cd entando-archetypes<br>
<code>mvn clean install -DskipTests</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>Complete the download by following the steps from the Creating a New Entando Project section.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>At this point you have installed all of the dependencies required to build a new MApp Engine instance.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The command to use the artifacts you have installed locally with an additional switch on the archetype command to use local values only is:<br>
<code>mvn archetype:generate -Dfilter=entando-archetype-webapp-generic -DarchetypeCatalog=local</code></p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="deployment-on-docker-and-openshift"><a class="anchor" href="#deployment-on-docker-and-openshift"></a>4.2. DEPLOYMENT ON DOCKER AND OPENSHIFT</h3>
<div class="sect3">
<h4 id="containers"><a class="anchor" href="#containers"></a>4.2.1. Overview</h4>
<div class="paragraph">
<p>Entando currently offers a variety of Docker images that can be used in different container environments, such as
'vanilla' Docker, Openshift or Kubernetes. These images were also developed with different use cases in mind, such as
for simple demos, for getting started with your own app, for more advanced CI/CD, or for production deployments.
Supporting different environments and use cases inevitably comes with some level of complexity. In this chapter,
we will gradually take you from the simpler use cases to the more complex use cases, hopefully easing the learning
curve required for using our Docker images.</p>
</div>
<div class="sect4">
<h5 id="a-word-on-docker-tooling"><a class="anchor" href="#a-word-on-docker-tooling"></a>A word on Docker tooling.</h5>
<div class="paragraph">
<p>While it is theoretically possible to manage this multitude of Entando Docker containers using the 'docker' command, we
strongly recommend using container management tools that allow you to manage multiple containers in concert. Entando
itself is typically deployed on Docker in sets of two to three images. As containerization gains more traction in the
industry, we expect more Entando Docker images to be added to these deployments. We therefor advise even the die-hard
'docker' command line users to familiarize themselves with one or more  container management tool that allows you to easily
deploy, start and stop multiple containers collectively using a single command.</p>
</div>
<div class="paragraph">
<p>Entando supports Docker Compose and Openshift, both of which simplify the management of multiple Docker containers and setting
up connectivity amongst them. Since Entando Apps are still Java projects built with Maven, we have also added support
for the Fabric8 Maven Docker Plugin for multiple Entando Docker images to be built built and tested during the development and
build processes. We have developed quick starts for all three these technologies to make it easier for new users to
get Entando up and running on Docker.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="getting-started"><a class="anchor" href="#getting-started"></a>4.2.2. Getting Started</h4>
<div class="paragraph">
<p>You can get started on Entando using either Docker Compose, the Maven Docker Plugin or Openshift. In order to choose the
option that fits your needs the best, consider the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Docker Compose:</strong> For 'vanilla' Docker installations, the Docker Compose tool allows you to run
several of our images together by using one of the Docker Compose 'YAML' files that we offer. If you have some skill
in Docker, but you have limited interest or skills in development, this would be best way for you to get started.
You can deploy and run a selection of our pre-built, deployment-ready images as configured in our
<a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack">Docker Compose 'YAML' files</a>.
Get started with <a href="#getting-started-with-docker-compose">Docker Compose in a 'vanilla' Docker environment</a></p>
</li>
<li>
<p><strong>Maven with Docker:</strong> If you have some development skills, especially around the use of Maven, but
Docker is not necessarily (yet) your forte, this approach may be the best for you. We have an
<a href="https://github.com/entando/entando-sample-full/tree/v5.0.3-dev">example Maven project</a>
you can use as a template to help you build your project image and run the resulting image in Docker.
<a href="#maven-docker-quickstart">Getting started on Maven and Docker</a></p>
</li>
<li>
<p><strong>Openshift:</strong> If you have an Openshift environment at your disposal and you know how to deploy an
Openshift template, the Openshift approach would be best. Openshift doesn&#8217;t require extensive
knowledge of either the Development world or the Ops world to get started, but it does reward your knowledge of either.
If DevOps is your thing, this approach is ideal for you, and you can choose from our selection of
<a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/templates">Openshift Templates</a> to match
your use case. Get started with an <a href="#openshift-quickstart">Openshift Quick Start</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="getting-started-with-docker-compose"><a class="anchor" href="#getting-started-with-docker-compose"></a>4.2.3. Docker Compose in a 'vanilla' Docker environment</h4>
<div class="olist arabic">
<div class="title">Prerequisites:</div>
<ol class="arabic">
<li>
<p>You have installed Docker locally.</p>
</li>
<li>
<p>You are either running a Linux distribution or MacOS. (Windows still to be tested)</p>
</li>
<li>
<p>The <a href="https://docs.docker.com/compose/install/">docker-compose command line tool</a> has also been installed. Some Docker distributions may require you to install this separately.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Steps:</div>
<ol class="arabic">
<li>
<p>Download the Entando Full Stack docker-compose 'YAML' file from <a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/docker-compose.yml">Github</a> to a directory of your choice.</p>
</li>
<li>
<p>In the same directory, create a file named '.env' such as <a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/docker-compose.yml">this</a>
to define the environment variables to apply to the docker-compose yaml file</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>ENTANDO_IMAGE_VERSION: the version of Entando you are interested in</p>
</li>
<li>
<p>DOCKER_HOST_ADDRESS: the TCP/IP name or address of where the Docker service is hosted. On Linux, localhost would suffice. On Windows or Apple it will be the IP Address of the Docker virtual machine.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Open a terminal window and change the present working directory to the directory that you have downloaded the yaml file to.</p>
</li>
<li>
<p>It is highly recommended that you first pull the required images from Docker Hub running the command <code>docker-compose pull</code></p>
</li>
<li>
<p>Run the command <code>docker-compose up</code> to spin up the required Docker containers</p>
</li>
<li>
<p>Open your browser and point it to <a href="http://${DOCKER_HOST_ADDRESS}:5000" class="bare">http://${DOCKER_HOST_ADDRESS}:5000</a>. This will open the AppBuilder. Replace ${DOCKER_HOST_ADDRESS} with the correct address of your Docker service.</p>
</li>
<li>
<p>Use the credentials admin/adminadmin to log in. Consult our documentation for more details on how to build an Entando App from AppBuilder</p>
</li>
<li>
<p>To open the resulting web app, point your browser to <a href="http://localhost:8080/entando" class="bare">http://localhost:8080/entando</a>.  Replace ${DOCKER_HOST_ADDRESS} with the correct address of your Docker service.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Next steps</div>
<p>Now that you got started on Entando in your Docker platform, you have a couple of different options on how to proceed.
You can have a look at our <a href="#demos-on-docker">Demos on Docker</a> section to see some more demos that you can deploy to Docker. If you are
serious about getting your images deployed to production, we would recommend working through the <a href="#openshift-quickstart">Openshift Quick Start</a>
section, as Openshift is currently our recommended approach.</p>
</div>
</div>
<div class="sect3">
<h4 id="maven-docker-quickstart"><a class="anchor" href="#maven-docker-quickstart"></a>4.2.4. Getting started on Maven and Docker</h4>
<div class="olist arabic">
<div class="title">Prerequisites:</div>
<ol class="arabic">
<li>
<p>You have installed Docker locally.</p>
</li>
<li>
<p>You have installed Java and Maven locally.</p>
</li>
<li>
<p>You are either running a Linux distribution or MacOS. (Windows still to be tested)</p>
</li>
<li>
<p>It is highly recommended that you have pulled the required images into your Docker environment
using the <a href="https://github.com/entando/entando-ops/blob/master/Docker/base-images/pull-quickstart-images.sh">pull-quickstart-images.sh script</a></p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Steps:</div>
<ol class="arabic">
<li>
<p>Open a terminal to the folder you want to place you Maven project in.</p>
</li>
<li>
<p>Clone the sample project to this folder , and change the present working directory into the newly created folder:</p>
<div class="literalblock">
<div class="content">
<pre>git clone git@github.com:entando/entando-sample-full.git
cd  entando-sample-full</pre>
</div>
</div>
</li>
<li>
<p>To view the different versions of the sample project, list all the branches:</p>
<div class="literalblock">
<div class="content">
<pre>git branch -a</pre>
</div>
</div>
</li>
<li>
<p>Select the version you want to use by checking out its corresponding branch, e.g.:</p>
<div class="literalblock">
<div class="content">
<pre>git checkout origin/v5.0.3-dev --track</pre>
</div>
</div>
</li>
<li>
<p>Run a Maven build using the 'docker-eap-derby' profile, and start the Docker containers. Specify the  the TCP/IP name or address of where the Docker service is hosted using the JVM property 'docker.host.adress'. On Linux, localhost would suffice. On Windows or Apple it will be the IP Address of the Docker virtual machine.:</p>
<div class="literalblock">
<div class="content">
<pre>mvn clean package -Pdocker-eap-derby docker:start -Ddocker.host.address=192.168.0.106</pre>
</div>
</div>
</li>
<li>
<p>When the build process finishes, one of the last log entries will list the URL where you can access the AppBuilder. Maven dynamically allocates a port on the Docker host for this URL:</p>
<div class="literalblock">
<div class="content">
<pre>[INFO] DOCKER&gt; [entando/appbuilder:5.0.3-SNAPSHOT]: Waited on url http://192.168.0.106:32769 1895 ms</pre>
</div>
</div>
</li>
<li>
<p>Open this URL and use the credentials admin/adminadmin to log in. Consult our documentation for more details on how to build an Entando App from AppBuilder</p>
</li>
<li>
<p>Similarly, a couple of log entries above this, Maven lists base URL where you can access the resulting web app on the Entando Engine from your browser:</p>
<div class="literalblock">
<div class="content">
<pre>[INFO] DOCKER&gt; [entandosamples/entando-sample-full:5.0.3-SNAPSHOT] "entando-sample-full": Waited on url http://192.168.0.106:32772/entando-sample-full 72063 ms</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Next steps</div>
<p>Now that you got started on Entando using Maven and the Docker platform, you may want to
consider managing the database yourself, or find out how to use a different base image.
For guidance on how to do this, please consult our <a href="#maven-and-docker">Maven and Docker</a> section
on the use of Docker with our Maven archetypes. If you are serious about getting
your images deployed to production, we would recommend working through the <a href="#openshift-quickstart">Openshift Quick Start</a>
section, as Openshift is currently our recommended approach.</p>
</div>
</div>
<div class="sect3">
<h4 id="openshift-quickstart"><a class="anchor" href="#openshift-quickstart"></a>4.2.5. Openshift Quick Start</h4>
<div class="olist arabic">
<div class="title">Prerequistes:</div>
<ol class="arabic">
<li>
<p>You have access to a fully operational Openshift cluster (could also be a local Minishift installation).</p>
</li>
<li>
<p>You have credentials to log into this environment.</p>
</li>
<li>
<p>Your user has access to the project named 'openshift'</p>
</li>
<li>
<p>Where it is feasible at all, it is highly recommended that you or your system admin has pulled all the required images into the Docker environment supporting your Openshift cluster
using the <a href="https://github.com/entando/entando-ops/blob/master/Openshift/installers/pull-quickstart-images.sh">pull-quickstart-images.sh script</a></p>
</li>
<li>
<p>If you require RedHat Process Automation Manager, we recommend deploying the
<a href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.0/html-single/deploying_a_red_hat_process_automation_manager_7.0_authoring_environment_on_red_hat_openshift_container_platform/index">Authoring environment template</a>
 to Openshift and take down the connection details (baseUrl, username and password) of the KIE Server.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>There are two different approaches you can follow to deploy Entando to your Openshift environment:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Using the browser based console. This approach is ideal if you are new to Openshift, if you are not comfortable with the commandline terminal and
if you won&#8217;t be expected to automate deployment and confguration any time soon.</p>
</li>
<li>
<p>Using the <code>oc</code> command line interface. This approach is intended for the more low level technical audience, especially if you will be expected
to automate deployment and configuration.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Steps using the browser based console:</div>
<ol class="arabic">
<li>
<p>Log into the browser based console using your credentials.</p>
</li>
<li>
<p>Navigate to the 'openshift' project</p>
</li>
<li>
<p>Use the 'Add to project'&#8594;'Import YAML/JSON' menu item to import some files to your catalog. The easiest would be to open these files
in your browser and copy and paste their contents into the YAML/JSON text area.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>the Entando EAP Quick Start image stream: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-eap71-quickstart-openshift.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-eap71-quickstart-openshift.json</a></p>
</li>
<li>
<p>the Entando AppBuilder image stream: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json</a></p>
</li>
<li>
<p>the Entando EAP Quick Start template: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/templates/entando-eap71-quickstart.yml" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/templates/entando-eap71-quickstart.yml</a></p>
</li>
</ol>
</div>
</li>
<li>
<p>Go back to the Openshift landing page by clicking the 'OPENSHIFT' text in the top left corner</p>
</li>
<li>
<p>Click on the 'Create Project' button in the top right area and type in the name 'entando-sample' for your new project</p>
</li>
<li>
<p>Click on the link that displays the newly created project&#8217;s name</p>
</li>
<li>
<p>Click on the 'Browse Catalog' button</p>
</li>
<li>
<p>Scroll until you find the template 'Entando in EAP 7.1'. (Sometimes there is a delay before this item shows up. If you cannot find it, delete your project, go drink some coffee, and then recreate your project again.)</p>
</li>
<li>
<p>Click on the 'Entando in EAP 7.1' template, and follow the wizard. When you are prompted for parameter values, type the following parameter values:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Find out from your admins what the default domain suffix is for your Openshift cluster, usually something like
'YOUR.CLUSTER.IP.nip.io'.</p>
</li>
<li>
<p><strong>Custom HTTP Route Hostname for the Entando runtime engine</strong>: type 'entando.YOUR.CLUSTER.IP.nip.io'. Your Entando app will be available at this domain name</p>
</li>
<li>
<p><strong>Context root of the Entando runtime engine web app</strong> should be set to "entando-sample" as this will be the context of the web app on the EAP server</p>
</li>
<li>
<p>If you have installed RedHat Process Automation Manager, you would require valid values for the following parameters:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><strong>KIE Server Base URL:</strong>  the URL of the route that exposes the KIE Server, or any URL that can be used to access the KIE Server web application.</p>
</li>
<li>
<p><strong>KIE Server Username:</strong> The username that you configured for the KIE Server. This would be the value you provided for the 'KIE Server User' parameter
when installing  RedHat Process Automation Manager, or the value of the KIE_SERVER_USER environment variable on the KIE Server
deployment configuration in Openshift.</p>
</li>
<li>
<p><strong>KIE Server Pasword:</strong> The password that you configured for the KIE Server. This would be the value you provided for the 'KIE Server Password' parameter
when installing  RedHat Process Automation Manager, or the value of the KIE_SERVER_PWD environment variable on the KIE Server
deployment configuration in Openshift.</p>
</li>
</ol>
</div>
</li>
<li>
<p>The default values would suffice for all the other parameters</p>
</li>
</ol>
</div>
</li>
<li>
<p>Navigate to the Builds&#8594;Builds menu item, confirm that a build has been triggered, and wait for this build to complete</p>
</li>
<li>
<p>Once completed, navigate to Applications&#8594;Deployments and wait until you have two active deployments</p>
</li>
<li>
<p>Once completed, navigate to Application&#8594;Routes</p>
</li>
<li>
<p>To access the Entando App Builder, click on the URL for AppBuilder Route and log in using the following username/password: admin/adminadmin.</p>
</li>
<li>
<p>To view the resulting Entando web app, click on the URL for Entando 'runtime-http' Route and log in using admin/adminadmin as well.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Steps using the <code>oc</code> command line interface:</div>
<ol class="arabic">
<li>
<p>Log into your openshift cluster using <code>oc login -u USERNAME -p PASSWORD OPENSHIFT_CLUSTER_IP:8443</code> where
<code>OPENSHIFT_CLUSTER_IP</code> is the hostname or ip address of your Openshift cluster</p>
</li>
<li>
<p>Set the current project to 'openshift': <code>oc project openshift</code></p>
</li>
<li>
<p>Install the following YAML and JSON files:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The Entando EAP image stream: <code>oc create -f <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-eap71-quickstart-openshift.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-eap71-quickstart-openshift.json</a></code></p>
</li>
<li>
<p>The Entando AppBuilder image stream: <code>oc create -f <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json</a></code></p>
</li>
<li>
<p>The Quickstart template: <code>oc create -f <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/templates/entando-eap71-quickstart.yml" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/templates/entando-eap71-quickstart.yml</a></code></p>
</li>
</ol>
</div>
</li>
<li>
<p>Create an Openshift project for your Entando App: <code>oc new-project entando-sample</code></p>
</li>
<li>
<p>Deploy the template:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Determine what the default domain suffix is for your Openshift cluster, usually something like 'YOUR.CLUSTER.IP.nip.io'. Decide what domain name you
want your Entando instance to run on by specifying the <strong>ENTANDO_ENGINE_HOSTNAME</strong> parameter, e.g. ENTANDO_ENGINE_HOSTNAME=entando.YOUR.CLUSTER.IP.nip.io</p>
</li>
<li>
<p>The <strong>ENTANDO_ENGINE_WEB_CONTEXT</strong> paramater should be set to "/entando-sample" as this will be the context of the web app on the EAP server</p>
</li>
<li>
<p>If you have installed RedHat Process Automation Manager, you would require valid values for the following parameters:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><strong>KIE_SERVER_BASE_URL</strong>: the URL of the route that exposes the KIE Server. You have installed Red Hat Process Automation Manager on your Openshift cluster and exposed it using the hostname kieserver.YOUR.CLUSTER.IP.nip.io it would be <a href="http://kieserver.YOUR.CLUSTER.IP.nip.io" class="bare">http://kieserver.YOUR.CLUSTER.IP.nip.io</a></p>
</li>
<li>
<p><strong>KIE_SERVER_USERNAME</strong>: the username that you configured for the KIE Server. This would be the value you provided for the 'KIE Server User' parameter
when installling  RedHat Process Automation Manager, or the value of the KIE_SERVER_USER environment variable on the KIE Server
deployment configuration in Openshift.</p>
</li>
<li>
<p><strong>KIE_SERVER_PASSWORD</strong>: the password that you configured for the KIE Server. This would be the value you provided for the 'KIE Server Password' parameter
when installing  RedHat Process Automation Manager, or the value of the KIE_SERVER_PWD environment variable on the KIE Server
deployment configuration in Openshift.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Instantiating the template would then look something like this:</p>
<div class="literalblock">
<div class="content">
<pre>oc process openshift//entando-eap-quickstart -p ENTANDO_ENGINE_HOSTNAME=entando.YOUR.CLUSTER.IP.nip.io
-p ENTANDO_ENGINE_WEB_CONTEXT="/entando-sample" -p KIE_SERVER_BASE_URL=http://kieserver.YOUR.CLUSTER.IP.nip.io -p KIE_SERVER_USERNAME=john_smith -p KIE_SERVER_PASSWORD=mypassword
|oc create -f -</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Confirm that a build has been triggered by runnning: <code>oc get builds</code>. Wait for build to complete.</p>
</li>
<li>
<p>Comfirm that two deployments have been triggered by running: <code>oc get dc`and then `oc get pods</code>. Wait until all pods are
in 'Running' status.</p>
</li>
<li>
<p>List all the routes that were created using the command : <code>oc get routes</code>.</p>
</li>
<li>
<p>To access the Entando App Builder, open its Route&#8217;s URL in your browser and log in using the following username/password: admin/adminadmin.</p>
</li>
<li>
<p>To view the resulting Entando web app, open the 'runtime-http'  Route&#8217;s URL in your browser log in using admin/adminadmin as well.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Next steps</div>
<p>Now that you got started with Entando on Openshift, you may want to delve into the
process of managing the database yourself, or how to leverage Jenkins in Openshift
to setup your own pipeline, or how to promote your changes from one environment to the next.
For guidance on how to do this, please consult our <a href="#entando-on-openshift">Entando on Openshift</a> section on
the use of our Openshift images and templates.</p>
</div>
</div>
<div class="sect3">
<h4 id="common-variables"><a class="anchor" href="#common-variables"></a>4.2.6. Common Variables on Docker</h4>
<div class="paragraph">
<p>Once you have completed one of our <a href="#getting-started">Getting Started</a> tutorials, you should have one or more Docker containers running
either on Docker or on Openshift. Ultimately, that is what this chapter is about - taking a Docker image, configuring
the various variables required to successfully create a container from that image, and the creating and running the container.
Whether we do this from Docker Compose, the Fabric8 Docker Maven Plugin or from Openshift, at some point we have an
image to configure.</p>
</div>
<div class="paragraph">
<p>When configuring a Docker image for container creation, three different types of variables typically need to be provided
by the user:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The environment variables required by the image</p>
</li>
<li>
<p>The ports on the host that will be used to exposed the container&#8217;s ports on</p>
</li>
<li>
<p>The volumes on the host that will be used to map the container&#8217;s hard drive volumes on</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In order to provide the correct values for these variables, the user needs to understand what the function of each
environment variable, image port and image volume is. We have kept these configuration variables
of our Entando Docker images as consistent as possible. The Entando images consistently associate the same functionality
with the same ports, volumes and environment variables. You can use this section as a reference on how to configure
the Entando images.</p>
</div>
<div class="sect4">
<h5 id="environment-variables-for-images-hosting-the-entando-database"><a class="anchor" href="#environment-variables-for-images-hosting-the-entando-database"></a>Environment Variables for images hosting the Entando database</h5>
<div class="ulist">
<div class="title">Applicable Images:</div>
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/base-images/entando-postgresql95-base">Entando PostgreSQL 9.5 Base Image (entando/entando-postgresql95-base:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/s2i-images/entando-postgresql95-openshift">Entando PostgreSQL 9.5 Openshift S2I Image (entando/entando-postgresql95-openshift:latest)</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Environment Variables</div>
<ul>
<li>
<p><strong>PORTDB_DATABASE</strong> - the name of the Entando PORT database that is created and hosted in the image</p>
</li>
<li>
<p><strong>PORTDB_USERNAME</strong> - the username of the user that has read/write access to the Entando PORT database</p>
</li>
<li>
<p><strong>PORTDB_PASSWORD</strong> - the password of the above-mentioned username.</p>
</li>
<li>
<p><strong>SERVDB_DATABASE</strong> - - the name of the Entando SERV database that is created and hosted in the image</p>
</li>
<li>
<p><strong>SERVDB_USERNAME</strong> - the username of the user that has read/write access to the Entando SERV database. For compatibility with mvn jetty:run, please keep this the same as PORTDB_USERNAME</p>
</li>
<li>
<p><strong>SERVDB_PASSWORD</strong> - the password of the above-mentioned username.  For compatibility with mvn jetty:run, please keep this the same as PORTDB_PASSWORD</p>
</li>
<li>
<p><strong>ADMIN_USERNAME</strong> - the username of a user that has admin rights on both the SERV and PORT databases. For compatibility with Postgresql, keep this value to 'postgres'</p>
</li>
<li>
<p><strong>ADMIN_PASSWORD</strong> - the password of the above-mentioned username.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="environment-variables-for-images-hosting-the-entando-engine"><a class="anchor" href="#environment-variables-for-images-hosting-the-entando-engine"></a>Environment Variables for images hosting the Entando Engine</h5>
<div class="ulist">
<div class="title">Applicable Images</div>
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/base-images/entando-eap71-base">Entando EAP 7.1 Base Image (entando/entando-eap71-base:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/base-images/entando-eap71-clustered-base">Entando EAP 7.1 Clustered Base Image (entando/entando-eap71-clustered-base:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/base-images/entando-wildfly12-base">Entando Wildfly 12 Base Image (entando/entando-wildfly12-base:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/s2i-images/entando-eap71-quickstart-openshift">Entando EAP 7.1 Openshift Quickstart Image (entando/entando-eap71-quickstart-openshift:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/s2i-images/entando-wildfly12-quickstart-openshift">Entando Wildfly 12 Openshift Quickstart Image (entando/entando-wildfly12-quickstart-openshift:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/s2i-images/entando-eap71-clustered-openshift">Entando EAP 7.1 Clustered Openshift Image (entando/entando-eap71-clustered-openshift:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/demos/fsi-cc-dispute-customer">Entando FSI Credit Card Dispute Customer Image (entando/fsi-cc-dispute-customer:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/demos/fsi-cc-dispute-admin">Entando FSI Credit Card Dispute Back Office Image (entando/fsi-cc-dispute-admin:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/entando">The Full Entando Engine API (entando/engine-api:latest)</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Environment Variables</div>
<ul>
<li>
<p><strong><a id="portdb_url"></a>PORTDB_URL</strong> - the full JDBC connection string used to connect to the Entando PORT database</p>
</li>
<li>
<p><strong><a id="portdb_jndi"></a>PORTDB_JNDI</strong> - the full JNDI name where the Entando PORT datasource will be made available to the Entando Engine JEE application</p>
</li>
<li>
<p><strong><a id="portdb_driver"></a>PORTDB_DRIVER</strong> - the name of the driver for the Entando PORT database as configured in the JEE application server</p>
</li>
<li>
<p><strong><a id="portdb_username"></a>PORTDB_USERNAME</strong> - the username of the user that has read/write access to the Entando PORT database</p>
</li>
<li>
<p><strong><a id="portdb_password"></a>PORTDB_PASSWORD</strong> - the password of the above-mentioned username.</p>
</li>
<li>
<p><strong><a id="portdb_service_host"></a>PORTDB_SERVICE_HOST</strong> - the  name of the server that hosts the Entando PORT database.</p>
</li>
<li>
<p><strong><a id="portdb_service_port"></a>PORTDB_SERVICE_PORT</strong> - the port on the above-mentioned server that serves the Entando PORT database. Generally we keep to the default port for each RDBMS, e.g. for PostgreSQL it is 5432</p>
</li>
<li>
<p><strong><a id="servdb_url"></a>SERVDB_URL</strong> - the full JDBC connection string used to connect to the Entando SERV database</p>
</li>
<li>
<p><strong><a id="servdb_jndi"></a>SERVDB_JNDI</strong> - the full JNDI name where the Entando SERV datasource will be made available to the Entando Engine JEE application</p>
</li>
<li>
<p><strong><a id="servdb_driver"></a>SERVDB_DRIVER</strong> - the name of the driver for the Entando SERV database as configured in the JEE application server</p>
</li>
<li>
<p><strong><a id="servdb_username"></a>SERVDB_USERNAME</strong> - the username of the user that has read/write access to the Entando SERV database. For compatibility with mvn jetty:run, please keep this the same as PORTDB_USERNAME</p>
</li>
<li>
<p><strong><a id="servdb_password"></a>SERVDB_PASSWORD</strong> - the password of the above-mentioned username.  For compatibility with mvn jetty:run, please keep this the same as PORTDB_PASSWORD</p>
</li>
<li>
<p><strong><a id="servdb_service_host"></a>SERVDB_SERVICE_HOST</strong> - the  name of the server that hosts the Entando SERV database</p>
</li>
<li>
<p><strong><a id="servdb_service_port"></a>SERVDB_SERVICE_PORT</strong> - the port on the above-mentioned server that serves the Entando SERV database. Generally we keep to the default port for each RDBMS, e.g. for PostgreSQL it is 5432</p>
</li>
<li>
<p><strong><a id="kie_server_base_url"></a>KIE_SERVER_BASE_URL</strong> - The base URL where a KIE Server instance is hosted, e.g. <a href="http://entando-kieserver701.apps.serv.run/" class="bare">http://entando-kieserver701.apps.serv.run/</a></p>
</li>
<li>
<p><strong><a id="kie_server_username"></a>KIE_SERVER_USERNAME</strong> - The username of a user that be used to log into the above-mentioned KIE Server</p>
</li>
<li>
<p><strong><a id="kie_server_password"></a>KIE_SERVER_PASSWORD</strong> - The password of the above-mentioned KIE Server user.</p>
</li>
<li>
<p><strong><a id="entando_oidc_active"></a>ENTANDO_OIDC_ACTIVE</strong> set this variable&#8217;s value to "true" to activate Entando&#8217;s Open ID Connect and the related OAuth authentication infrastructure. If set to "false" all the subsequent OIDC  variables will be ignored. Once activated, you may need to log into Entando using the following url: &lt;application_base_url&gt;/&lt;lang_code&gt;/&lt;any_public_page_code&gt;.page?username=&lt;MY_USERNAME&gt;&amp;password=&lt;MY_PASSWORD&gt;</p>
</li>
<li>
<p><strong><a id="entando_oidc_auth_location"></a>ENTANDO_OIDC_AUTH_LOCATION</strong> - the URL of the authentication service, e.g. the 'login page' that Entando needs to redirect the user to in order to  allow the OAuth provider to authenticate the user.</p>
</li>
<li>
<p><strong><a id="entando_oidc_token_location"></a>ENTANDO_OIDC_TOKEN_LOCATION</strong> - the URL of the token service where Entando can retrieve the OAuth token from after authentication</p>
</li>
<li>
<p><strong><a id="entando_oidc_client_id"></a>ENTANDO_OIDC_CLIENT_ID</strong> - the Client ID that uniquely identifies the Entando App in the OAuth provider&#8217;s configuration</p>
</li>
<li>
<p><strong><a id="entando_oidc_redirect_base_url"></a>ENTANDO_OIDC_REDIRECT_BASE_URL</strong> - the optional base URL, typically the protocol, host and port (<a href="https://some.host.com:8080/" class="bare">https://some.host.com:8080/</a>) that will be prepended to the path segment of the URL requested by the user and provided as a redirect URL to the OAuth provider. If empty, the requested URL will be used as is.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="environment-variables-for-images-hosting-the-appbuilder-and-other-javascript-apps"><a class="anchor" href="#environment-variables-for-images-hosting-the-appbuilder-and-other-javascript-apps"></a>Environment Variables for images hosting the AppBuilder (and other JavaScript apps)</h5>
<div class="ulist">
<div class="title">Applicable Images</div>
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/appbuilder">Entando App Builder Image (entando/appbuilder:latest)</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Environment Variables</div>
<ul>
<li>
<p><strong>DOMAIN</strong> - the HTTP URL on which the associated Entando Engine instance will be served</p>
</li>
<li>
<p><strong>CLIENT_SECRET</strong> - the HTTP URL on which the associated Entando Engine instance will be served</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="common-ports"><a class="anchor" href="#common-ports"></a>4.2.7. Common Ports</h4>
<div class="ulist">
<ul>
<li>
<p><strong>5000</strong> - the port for the NodeJS HTTP Service on images that serve JavaScript applications</p>
</li>
<li>
<p><strong>8080</strong> - the port for the HTTP service hosted by JEE Servleit Containers on images that host Java services</p>
</li>
<li>
<p><strong>8443</strong> - the port for  the HTTPS service hosted by JEE Servlet Containers that support HTTPS. (P.S. generally we prefer to configure HTTPS on a router such as the Openshift Router)</p>
</li>
<li>
<p><strong>8778</strong> - the port for the Jolokia service on JBoss. This service is used primarily for monitoring.</p>
</li>
<li>
<p><strong>8888</strong> - the port that a ping service will expose to on support JGroups on images that support JGroups such as the JBoss EAP images</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="common-volumes"><a class="anchor" href="#common-volumes"></a>4.2.8. Common Volumes</h4>
<div class="ulist">
<ul>
<li>
<p><strong>/entando-data</strong> - contains the data that will be used and/or generated by the Entando app running in the container. In order to keep things simple, we generally map the following Maven
filter properties to subdirectories inside this volume:</p>
<div class="ulist">
<ul>
<li>
<p><strong>profile.resources.path=/entando-data/resources</strong> - this is where uploaded files are stored</p>
</li>
<li>
<p><strong>profile.resources.path.protected=/entando-data/protected</strong> - this is where sensitive files are stored such as database backups</p>
</li>
<li>
<p><strong>profile.index.path=/entando-data/indexdir</strong> - this is where Entando builds its indices</p>
</li>
<li>
<p><strong>Embedded Derby Databases: /entando-data/databases</strong> this contains the embedded Derby database for optional use, which can be ignored if you are pointing to a different database.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="demos-on-docker"><a class="anchor" href="#demos-on-docker"></a>4.2.9. Demos on Docker</h4>
<div class="paragraph">
<p>Entando offers a couple of demos, such as the Entando Full Stack demo we had a look at in the <a href="#getting-started">Getting Started</a> section. In this section we will delve a bit deeper into
these demos on Docker and the various options they offer you. All of these demos have been configured for docker-compose using the standard docker-compose yaml file format.
You will notice that these files generally required two environment variables:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>ENTANDO_IMAGE_VERSION: the version of Entando you are interested in</p>
</li>
<li>
<p>DOCKER_HOST_ADDRESS: the TCP/IP name or address of where the Docker service is hosted. On Linux, localhost would suffice. On Windows or Apple it will be the IP Address of the Docker virtual machine.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Depending on the operating system you use, there are various ways that you can make these variables available to docker-compose. We recommend creating a file with the name '.env'
in the same folder as the docker-compose yaml files that you will be downloading. This is the most portable solution as it works consistently across all platforms. An example '.env' file
is available in our <a href="https://github.com/entando/entando-ops/blob/EN-2348/Docker/Production/entando-full-stack/.env">GitHub repository</a></p>
</div>
<div class="sect4">
<h5 id="entando-ful-stack-demo"><a class="anchor" href="#entando-ful-stack-demo"></a>Default Entando Full Stack demo</h5>
<div class="paragraph">
<p>This demo was briefly discussed in the <a href="#getting-started">Getting Started</a> section. The entando Full Stack demo deploys two images. Follow their links to read more about the image in question</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/appbuilder">Entando App Builder Image (entando/appbuilder:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/entando">The Full Entando Engine API (entando/engine-api:latest)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This demo exports the standard ports of 5000 and 8080 to the Docker host. On Linux this would be localhost, but on Windows and Apple it will be the IP address of the virtual machine
that hosts the Docker service.</p>
</div>
<div class="paragraph">
<p>The demo also allocates a local volume for the /entando-data volume. This volume contains the usual uploaded resources, protected and index files as described in the <a href="#common-volumes">Common Volumes</a> section.
This particular configuration of the Entando Full Stack image comes with two pre-built embedded Derby databases that will be copied to the /entando-data/databases directory. Any changes
made to the underlying database will therefore be persisted in this volume and will thus survive container restarts, even when the container itself is removed.</p>
</div>
<div class="paragraph">
<p>To determine the location of the volume, first list the volumes using <code>docker volume ls</code> and then describe the
appropriate volume in more detail using <code>docker inspect entando-full-stack_entando-volume</code>. For Windows and Apple, keep in mind that those volumes are hosted inside the virtual machine
that hosts the Docker service. If you want to clear the volume, stop the Docker containers and run <code>docker volume rm entando-full-stack_entando-volume</code>. This will reset all data
stored in the volume.</p>
</div>
</div>
<div class="sect4">
<h5 id="entando-full-stack-on-postgresql"><a class="anchor" href="#entando-full-stack-on-postgresql"></a>Entando Full Stack on Postgresql</h5>
<div class="paragraph">
<p>Wherease the default confguration of the Entando Full Stack image uses the two embeded Derby  databases, the configuration in
<a href="https://raw.githubusercontent.com/entando/entando-ops/EN-2348/Docker/Production/entando-full-stack/docker-compose-postgresql.yml">docker-compose-postgresql.yml</a>
points Entando to an external database provided by our PostgreSQL. To run this demo, do the following:</p>
</div>
<div class="olist arabic">
<div class="title">Steps:</div>
<ol class="arabic">
<li>
<p>Download the Entando Full Stack docker-compose-postgresql.yml  file from <a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/docker-compose-postgresql.yml">Github</a></p>
</li>
<li>
<p>Open a terminal window and change the present working directory to the directory that you have downloaded the yaml file to.</p>
</li>
<li>
<p>It is highly recommended that you first pull the required images from Docker Hub running the command <code>docker-compose -f docker-compose-postgresql.yml pull</code></p>
</li>
<li>
<p>Run the command <code>docker-compose -f docker-compose-postgresql.yml up</code> to spin up the required Docker containers</p>
</li>
<li>
<p>Open your browser and point it to <a href="http://localhost:5000" class="bare">http://localhost:5000</a>. This will open the AppBuilder. Note that on Apple or Windows you won&#8217;t be using localhost but rather the IP address of the Docker virtual machine.</p>
</li>
<li>
<p>Use the credentials admin/adminadmin to log in. Consult our documentation for more details on how to build an Entando App from AppBuilder</p>
</li>
<li>
<p>To open the resulting web app, point your browser to <a href="http://localhost:8080/entando" class="bare">http://localhost:8080/entando</a>. Note that on Apple or Windows you won&#8217;t be using localhost but rather the IP address of the Docker virtual machine.</p>
</li>
<li>
<p>To access the PostgreSQL databases, point your database client to jdbc:postgresql://localhost:5432 and connect using postgres/adminpwd. (On Apple or Windows use the IP address of the Docker virtual machine.)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The key difference between this demo and the <a href="#entando-ful-stack-demo">Default Entando Full Stack demo</a> is that the database here is hosted in a different container. For this reason, this demo requires
two Docker volumes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>entando-volume.</p>
</li>
<li>
<p>entando-pg-volume.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The first volume contains the usual uploaded resources, protected and index files as described in the <a href="#common-volumes">Common Volumes</a> section, but no database.
The second volume contains the PostgreSQL database. If you want to reset the database, please delete this volume and let the PostgreSQL image recreate the database.</p>
</div>
<div class="paragraph">
<p>For more information on the individual images that this demo is composed of, follow these links:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/appbuilder">Entando App Builder Image (entando/appbuilder:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/entando">The Full Entando Engine API (entando/engine-api:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/postgresql">PostgreSQL Database Image (entando/postgresql:latest</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="fsi-credit-card-dispute-demo"><a class="anchor" href="#fsi-credit-card-dispute-demo"></a>FSI Credit Card Dispute Demo</h5>
<div class="paragraph">
<p>The Entando team, Red Hat and our business partners have collaborated to bring you a demo that illustrates how Entando can be used as the user experience layer for your Red Hat Process Automation Manager processes. The process in question allows customers to initiate a dispute case against a specific transaction. This demo provides two Entando apps - a customer facing app and a back-office app. These apps connect to a shared KIE Server instance.</p>
</div>
<div class="olist arabic">
<div class="title">Steps:</div>
<ol class="arabic">
<li>
<p>Download the Entando FSI Credit Card Dispute Demo docker-compose.yml file from <a href="https://github.com/entando/entando-ops/blob/EN-2348/Docker/demos/docker-compose.yml">Github</a></p>
</li>
<li>
<p>Open a terminal window and change the present working directory to the directory that you have downloaded the yaml file to.</p>
</li>
<li>
<p>It is highly recommended that you first pull the required images from Docker Hub running the command <code>docker-compose pull</code></p>
</li>
<li>
<p>Run the command <code>docker-compose up</code> to spin up the required Docker containers</p>
</li>
<li>
<p>Open your browser and point it to <a href="http://localhost:5001" class="bare">http://localhost:5001</a>. This will open the AppBuilder for the customer facing app.</p>
</li>
<li>
<p>Use the credentials aryaStark/adminadmin to log in. Consult our documentation for more details on how to build an Entando App from AppBuilder</p>
</li>
<li>
<p>Point your browser to <a href="http://localhost:5002" class="bare">http://localhost:5002</a>. This will open the AppBuilder for the back-office app.</p>
</li>
<li>
<p>Use the credentials admin/adminadmin to log in. Consult our documentation for more details on how to build an Entando App from AppBuilder</p>
</li>
<li>
<p>To open the customer facing web app, point your browser to <a href="http://localhost:8081/fsi-credit-card-dispute-customer" class="bare">http://localhost:8081/fsi-credit-card-dispute-customer</a>. Use aryaStark/adminadmin to log in</p>
</li>
<li>
<p>To open the back-office web app, point your browser to <a href="http://localhost:8082/fsi-credit-card-dispute-backoffice" class="bare">http://localhost:8082/fsi-credit-card-dispute-backoffice</a>. Use admin/adminadmin to log in</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Both images in this demo come with their own embedded Derby databases. These databases are stored in the following Docker volumes</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>entando-customer-volume</p>
</li>
<li>
<p>entando-admin-volume</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For more information about the images this demo is composed of, follow these links:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/appbuilder">Entando App Builder Image (entando/appbuilder:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/demos/fsi-cc-dispute-customer">Entando FSI Credit Card Dispute Customer Image (entando/fsi-cc-dispute-customer:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/demos/fsi-cc-dispute-admin">Entando FSI Credit Card Dispute Back Office Image (entando/fsi-cc-dispute-admin:latest)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This demo is configured by default to use Entando&#8217;s public Red Hat PAM environment, where the necessary rules, processes and model objects have been pre-installed.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="designing-your-pipeline-for-entando"><a class="anchor" href="#designing-your-pipeline-for-entando"></a>4.2.10. Designing your pipeline for Entando.</h4>
<div class="paragraph">
<p>Thus far we have only looked at Entando&#8217;s pre-built demos. They illustrate what the end product could look like when deployed in the target environment.
However, none of these demos illustrate how your Entando App should be built, tested and promoted through your pipeline. As we start looking at Entando&#8217;s Docker
support for Maven and Openshift, we will in fact start covering these topics. You will also be made aware of the different options that you have, and with this
you would need to be armed with the necessary knowledge to help you make the appropriate decision for your environment. In this section, we will take you through
a couple of significant issues to consider that will help you make these decisions.</p>
</div>
<div class="sect4">
<h5 id="entando-app-granularity"><a class="anchor" href="#entando-app-granularity"></a>Entando App Granularity</h5>
<div class="paragraph">
<p>The scope and granularity of an Entando app play a significant role in designing the pipeline. By "scope", we need
to look specifically at the organisational scope of the app, that is who it is that needs to work on the app. If several people in your organisation work on an Entando
app, it is likely to be more coarse grained and your selected pipeline would look different compare to the pipeline of an Entando App that only has
one or two developers working on it. This section offers some guidelines to decide what the best pipeline approach would be for your specific use case</p>
</div>
<div class="sect5">
<h6 id="coarse-grained-apps"><a class="anchor" href="#coarse-grained-apps"></a>Coarse Grained Apps</h6>
<div class="paragraph">
<p>A coarse grained Entando App typically involves a fairly complex site with a lot of content and a substantial database. In this case, you will find that
different authors with potentially different skill-sets contribute to the site concurrently. It is also very likely that some of your authors may not have
strong development skills and would not be comfortable addressing conflicts at a source code level. For this reason, you are likely to rely more on
Entando&#8217;s CMS functionality to ensure that concurrent work against the site produces the expected result with minimum conflicts.</p>
</div>
<div class="paragraph">
<p>If this describes your usage of Entando, you would need a shared environment that everyone can work on concurrently. As such, the database backing
this shared environment is an extremely important asset to your organisation, and you need to take care in how you propogate the state of this database
from one environment to the next. We recommend that you leverage as much as possible of your existing database infrastructure and governance. For instance,
rather configure Entando to point to your existing database servers than using one of our database images inside the Openshift cluster. Entando doesn&#8217;t currently
have any specific features that could simplify this for you, and we suggest  using a third party database migration tool such as Liquibase.
It is very important to ensure that the directory that you uploaded your content to is promoted exactly the same time as the database, and the responsibility
for this ultimately lies with your operations team.</p>
</div>
<div class="paragraph">
<p>In future releases of Entando we are hoping to provide more support for this use case. At this point in time, we do offer for a
<a href="https://access.redhat.com/containers/?tab=overview#/registry.connect.redhat.com/entando/entando-eap71-openshift-imagick">JBoss EAP Imagick image</a>. We have
pre-installed Imagick which is required for cropping and server side modification of uploaded images. Other than that, this image inherits the standard EAP
functionality from its <a href="https://access.redhat.com/containers/?tab=overview#/registry.access.redhat.com/jboss-eap-7/eap71-openshift">parent image</a>. You can
use this to build the appropriate configuration for your Entando app.</p>
</div>
<div class="paragraph">
<p>To summarize, this use case would typically involve the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The Entando customer allocates the necessary space for the Entando database on their existing database infrastructure for DEV, STAGE and PROD environments.</p>
</li>
<li>
<p>The Entando customer allocates the necessary space for uploaded files on network storage for DEV, STAGE and PROD environments.</p>
</li>
<li>
<p>The Entando customer allocates the necessary resources for the Entando App on their Openshift cluster for all the environments. This app will be fairly large and needs explicit planning.</p>
</li>
<li>
<p>The customer&#8217;s developers prepare the appropriate selection of plugins for the Entando App in a maven project, and commits it to a  source control management tool such as Git</p>
</li>
<li>
<p>The customer&#8217;s developers may optionally customize Entando with additional plugins.</p>
</li>
<li>
<p>The customer&#8217;s developers and ops team configures a build pipeline for the Entando app on their existing Java and Maven infrastructure,</p>
</li>
<li>
<p>At some point in the pipeline, a Docker image is built using the <a href="https://access.redhat.com/containers/?tab=overview#/registry.connect.redhat.com/entando/entando-eap71-openshift-imagick">JBoss EAP Imagick image</a></p>
</li>
<li>
<p>The source code of this Entando App will remain relatively static when compared to the database changes that will occur.</p>
</li>
<li>
<p>The customer&#8217;s content team does most of its work against one of the chosen shared environments, such as DEV or STAGE, but ideally not directly in PROD.</p>
</li>
<li>
<p>When the necessary QA work is done, business decides to promote the app to the next environment.</p>
</li>
<li>
<p>The customer&#8217;s operations team then co-ordinates efforts to ensure the Database changes, the Docker image and the uploaded resources are deployed to the target environemt at exactly the same time.</p>
</li>
<li>
<p>The customer&#8217;s end users use the Entando App once it is promoted to production.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="fine-grained-apps"><a class="anchor" href="#fine-grained-apps"></a>Fine Grained Apps</h6>
<div class="paragraph">
<p>A fine grained Entando App typically involves a smaller, self-contained site. It would still involve some content and data, but not so much that you
need a fully fledged content management system to eliminate conflicts. If the authors have more advanced development skills, they would be
able to sort out all potential conflicts using the source control management tool of their choice. In this case, the database remains small and simple
enough for you to resolve all conflicts at the source code level, comparing the various SQL files that will populate the database in the target environment.
Most of our Docker and Openshift infrastructure supports this particular use case out of the box. The resources and files that make up the content of your site
would also be small enough that you can commit it to your source control management system without minimal overhead.</p>
</div>
<div class="paragraph">
<p>In this particular scenario, your database is not a very important asset - it can be restored from source code at any point in time. It can be considered to
be a fairly ephemeral piece of the puzzle, an as such, it would be much easier to provision your database in the Openshift cluster using one of our database images.
You wouldn&#8217;t need to concern yourself with the synchronization of your uploaded content and your database, as both can be rebuilt from scratch every time you
deploy your Entando App to a given environment. In this scenario, it is therefore not necessary to tax your database administration and operations teams with the
details of database state propagation, and it would therefore be much lighter from a governance perspective.</p>
</div>
<div class="paragraph">
<p>This use case is significantly simpler to manage than <a href="#coarse-grained-apps">Coarse Grained Apps</a>, but it comes at a cost. You need at least some development skills, and some knowledge
of source control management tools to contribute to such an app. For some scenarios, this may not be a price worth paying. You also need to actively manage the
complexity and scope of your apps, and make sure that a fine grained app never grows to such a size that it starts hogging your build and source control infrastructure.
But if you can nail these skills, the you will reap the benefit from most of the advantages that a typical microservices architecture offers.</p>
</div>
<div class="paragraph">
<p>To summarize, this use case would typically involve the following steps.
. The Entando customer would classify the planned Entando App in terms of size. (CPU consumption, memory, storage and database storage)
. The Entando customer&#8217;s Openshift administration team would ensure that the necessary memory, storage and processing power is available to handle the required number of instances of this app.
. The customer&#8217;s developers would setup a full CI/CD pipeline using whichever infrastructure is already in place for their other microservices.
. The customer&#8217;s developers would implement all requirements using the <code>mvn jetty:run</code> command on a local machine.
. Once completed the developer would generate a database backup from Entando running in Jetty, and then commit the resulting SQL files.
. The developer would now resolve conflicts, and push the changes to the appropriate branch to trigger a build and test run in the appropriate environment, likely using ephemeral containers that were spun up just for these purposes.
. Once the automatic validation succeeds, the resulting Entando Image is tagged and deployed to a shared environment where non-technical people can verify its quality
. Once the QA has completed, the Entando App is tagged and deployed to Production for use by end users.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="your-existing-build-infrastructure"><a class="anchor" href="#your-existing-build-infrastructure"></a>4.2.11. Your existing build infrastructure.</h4>
<div class="paragraph">
<p>In our interactions with our customers, we have come to realize that it is difficult to make a generalization as to where all our customers are in their DevOps journey.
Some customers have already invested a lot of time and effort into establishing a more traditional centralized build server instance with minimal integration with Docker.
Other customers may have embraced Kubernetes and/or Openshift for all of their infrastructure. Some even have their build, staging and production environments all hosted
in a single cluster whereas other have a set of interrelated clusters to do the job.  Still other customers may find themselves somewhere between having a centralized build
server and having a Kubernetes or Openshift cluster that hosts all the build infrastructure. For the purposes of designing your Entando pipeline, we will distinguish between
two different scenarios - a scenario where everything runs on Openshift, and a scenario where multiple divergent technologies are orchestrated to produce a Docker image
that will be deployed to Openshift (or any other Docker hosting environment for that matter).</p>
</div>
<div class="sect4">
<h5 id="pure-openshift-environment"><a class="anchor" href="#pure-openshift-environment"></a>Pure Openshift Environment</h5>
<div class="paragraph">
<p>Opting for a pure Openshift environment for your entire pipeline offers some significant benefits. You can manage and scale your build infrastructure as easily as you
can manage and scale your deployment environments. You can scale out to a cloud provider if needed. You also have a centralized catalog of all pipeline related activity
that is happening and there is definitely a benefit in reusing your Openshift knowledge for your build environment. On the negative side, one has to acknowledge that
certain advanced build techniques that are not yet implemented in Openshift. It is also true that, whilst the Jenkins/Openshift integration already provides a viable
option, there are still some features that are not fully integrated, which results in duplication and/or overlap that can be quite difficult to navigate. All in all though,
this offers an appealing if perhaps slightly cutting edge option.</p>
</div>
<div class="paragraph">
<p>In a pure Openshift environment you are free to use the various build and deployment techniques described in its
<a href="https://docs.openshift.com/container-platform/3.9/dev_guide/application_lifecycle/promoting_applications.html">official documentation</a>. Entando has also implemented
a set of templates that would allow you to repeat and customize your configuration for various environments. If you want to take it one level further, we have a beta
version of our reference pipeline based on the <a href="https://www.oreilly.com/library/view/devops-with-openshift/9781491975954/ch04.html">DevOps with Openshift book</a>.</p>
</div>
<div class="paragraph">
<p>In a pure Openshift environment we would recommend that you leverage the three types of BuildConfigs that Openshift offers to build your Docker images:
Source-to-Image builds, Dockerfile builds and Jenkins pipelines.</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Source-to-Image builds certainly provide the simplest solution, and require almost no knowledge of Docker to get going. This facility simply
builds your Entando war file using Maven and leaves it to the S2I image to contribute it to the correct location in the image&#8217;s file system. Entando does offer
<a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/s2i-images">several S2I images</a> to choose from, along with
<a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/templates">templates</a> that can facilitate the installation of these images.</p>
</li>
<li>
<p>The Dockerfile approach may be more appealing to those with strong Docker skills. Whereas we do use Dockerfile builds in our pipelines, Entando does not provide any
specific support for this approach other than offering several <a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/base-images">base images</a> that you can choose from.</p>
</li>
<li>
<p>The Jenkins Pipeline approach is more powerful, but also comes with significant build overheads and a steep learning curve. The integration between Jenkins and Openshift
can be a bit finicky at times, and there is significant overlap and repetition that need to be addressed at a conceptual level. But once you have a Jenkins pipeline in place,
the increased flexibility and power does help significantly, especially in synchronizing Image deployment and database migration.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>We will explore Entando&#8217;s offering in this space in more detail in the <a href="#entando-on-openshift">Entando on Openshift</a> section</p>
</div>
</div>
<div class="sect4">
<h5 id="hybrid-docker-environment"><a class="anchor" href="#hybrid-docker-environment"></a>Hybrid Docker Environment</h5>
<div class="paragraph">
<p>The hybrid Docker environment is common amongst customers that are growing from a more traditional continuous integration approach to a full DevOps approach.
Such organizations often have mature continuous integration infrastructure from which it already benefits significantly. They may have evaluated Openshift&#8217;s build
infrastructure but may have found it wanting on features that the organization already relies on, such as complex branch build algorithms required for pull requests.
It could also be that the organization simply has skills primarily in Bamboo and that the move to Jenkins doesn&#8217;t seem like a cost effective step to take. Another
motivation here could be that the organization is not using Openshift on Docker in the deployment environment, but some other container orchestration product that
does not necessarily have Openshift&#8217;s out-of-the-box support for builds. The end result though is the same: the organization uses existing continuous integration
infrastructure for all build related activities, and Docker is reserved primarily for the the deployment environment.</p>
</div>
<div class="paragraph">
<p>In hybrid Docker environments, it is best to think of the Docker image as the unit of delivery that is handed off from the build environment to the Docker environment.
It almost serves the same role as tradition JEE war files did in the days of monolithic application servers. Like a JEE war file, the traditional build infrastructure
therefore produces and verifies the Docker image, and the publishes it to a shared artifact repository, in this case a Docker registry. During deployment to
a shared environment, the deployment process then picks up the Docker image and instantiates it with the correct environment variables in the target environment.</p>
</div>
<div class="paragraph">
<p>We would recommend using the Maven Docker plugin for these types of scenarios. It is a powerful build tool that allows you to produce the image immediately after
the Entando war file is built. It does however require Docker capabilities on the Bamboo agent or Jenkins slave, even if it is just connected to a viable
Docker server. This can be a bit tricky when the agent/slave is a Docker container itself, but it is certainly doable. Once the image has been built and verified,
it can be handed off to any Docker based deployment environment. In fact, this makes the Maven Docker plugin very appealing for environments where the organization
does not want to be tied into a specific container orchestration vendor, such as Openshift or Kubernetes. We will look into this option in the <a href="#maven-and-docker">Maven and Docker</a>
section.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="maven-and-docker"><a class="anchor" href="#maven-and-docker"></a>4.2.12. Maven and Docker</h4>
<div class="paragraph">
<p>In the <a href="#maven-docker-quickstart">Getting started on Maven and Docker</a> section, we briefly looked at how to generate an Entando Maven project with the Maven Docker Plugin pre-configured. Once such
a project is in place, all one needs to do is run the following command and you have an Entando instance up and running:</p>
</div>
<div class="paragraph">
<p><code>mvn clean install -Pdocker-eap-derby docker:start -Ddocker.host.address=172.17.0.1</code></p>
</div>
<div class="paragraph">
<p>But happens behind the scenes here?</p>
</div>
<div class="sect4">
<h5 id="the-pom-xml"><a class="anchor" href="#the-pom-xml"></a>The pom.xml</h5>
<div class="paragraph">
<p>Central to building and running a Docker image from your Entando Maven project is the highly parameterized configuration of three 'image' elements in the
Docker Maven Plugin, and a set of Maven profiles that instantiate this configuration in different ways. This section will briefly look at each 'image' element
and the settings that were parameterized, and then look at the different profiles and the value of the abovementioned parameters in each profile. Ultimately,
we would very much like for developers to be armed with the necessary information to chop and change the pom.xml to best suited for their development
approach.</p>
</div>
<div class="sect5">
<h6 id="entando-engine-server-image"><a class="anchor" href="#entando-engine-server-image"></a>Entando Engine server image</h6>
<div class="paragraph">
<p>The most important image configuration is that of the Entando server engine. This image has both a 'build' configuration and a 'run' configuration which allows it
to be build as part of the Maven build process, and then started from Maven too. It looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>                        &lt;image&gt;
                            &lt;name&gt;entandosamples/${project.artifactId}:${project.version}&lt;/name&gt;
                            &lt;alias&gt;${project.artifactId}&lt;/alias&gt;
                            &lt;build&gt;
                                &lt;from&gt;entando/${server.base.image}:${entando.version}&lt;/from&gt;
                                &lt;skip&gt;${skipServerImage}&lt;/skip&gt;
                                &lt;assembly&gt;
                                    &lt;descriptorRef&gt;artifact&lt;/descriptorRef&gt;
                                    &lt;targetDir&gt;${jboss.home.in.image}/standalone/deployments&lt;/targetDir&gt;
                                &lt;/assembly&gt;
                                &lt;runCmds&gt;
                                    &lt;run&gt;${docker.db.init.command}&lt;/run&gt;
                                &lt;/runCmds&gt;
                            &lt;/build&gt;
                            &lt;run&gt;
                                &lt;skip&gt;${skipServerImage}&lt;/skip&gt;
                                &lt;namingStrategy&gt;alias&lt;/namingStrategy&gt;
                                &lt;network&gt;
                                    &lt;mode&gt;custom&lt;/mode&gt;
                                    &lt;name&gt;${project.artifactId}-network&lt;/name&gt;
                                    &lt;alias&gt;${project.artifactId}&lt;/alias&gt;
                                &lt;/network&gt;
                                &lt;volumes&gt;
                                    &lt;bind&gt;
                                        &lt;volume&gt;${project.artifactId}-entando-data:/entando-data&lt;/volume&gt;
                                    &lt;/bind&gt;
                                &lt;/volumes&gt;
                                &lt;env&gt;
                                    &lt;PORTDB_USERNAME&gt;agile&lt;/PORTDB_USERNAME&gt;
                                    &lt;PORTDB_USERNAME&gt;agile&lt;/PORTDB_USERNAME&gt;
                                    &lt;PORTDB_PASSWORD&gt;agile&lt;/PORTDB_PASSWORD&gt;
                                    &lt;SERVDB_USERNAME&gt;agile&lt;/SERVDB_USERNAME&gt;
                                    &lt;SERVDB_PASSWORD&gt;agile&lt;/SERVDB_PASSWORD&gt;
                                    &lt;PORTDB_DATABASE&gt;entandoPort&lt;/PORTDB_DATABASE&gt;
                                    &lt;SERVDB_DATABASE&gt;entandoServ&lt;/SERVDB_DATABASE&gt;
                                    &lt;PORTDB_URL&gt;${port.db.url}&lt;/PORTDB_URL&gt;
                                    &lt;SERVDB_URL&gt;${serv.db.url}&lt;/SERVDB_URL&gt;
                                    &lt;!--Uncomment this if you do not want the derby database to be overwritten with every build --&gt;
                                    &lt;!--&lt;PREPARE_DATA&gt;false&lt;/PREPARE_DATA&gt;--&gt;
                                &lt;/env&gt;
                                &lt;ports&gt;
                                    &lt;port&gt;entando.engine.port:8080&lt;/port&gt;
                                &lt;/ports&gt;
                                &lt;wait&gt;
                                    &lt;http&gt;
                                        &lt;url&gt;http://${docker.host.address}:${entando.engine.port}/${project.artifactId}&lt;/url&gt;
                                    &lt;/http&gt;
                                    &lt;time&gt;90000&lt;/time&gt;
                                &lt;/wait&gt;
                                &lt;log&gt;
                                    &lt;enabled&gt;true&lt;/enabled&gt;
                                    &lt;prefix&gt;server:&lt;/prefix&gt;
                                    &lt;color&gt;blue&lt;/color&gt;
                                &lt;/log&gt;
                            &lt;/run&gt;
                        &lt;/image&gt;</code></pre>
</div>
</div>
<div class="ulist">
<div class="title">Maven Properties</div>
<ul>
<li>
<p><strong>server.base.image</strong> Specifies which base-image to use. Current options are 'entando-wildfly12-base', 'entando-eap71-base' or 'entando-eap71-clustered-base'</p>
</li>
<li>
<p><strong>skipServerImage</strong>  Both the build configuration and run configuration of this image are activated or deactivated based on the <code>skipServerImage</code></p>
</li>
<li>
<p><strong>jboss.home.in.image</strong> The installation root of JBoss/Wildfly. On the EAP images, this would be '/opt/eap', and '/wildfly' on the Wildfly images</p>
</li>
<li>
<p><strong>docker.db.init.command</strong> An optional command that can be executed during the build process. Useful for DB initialization</p>
</li>
<li>
<p><strong>port.db.url</strong> A JDBC URL that points to the Entando 'PORT' Database, either a local Derby URL or a PostgreSQL URL</p>
</li>
<li>
<p><strong>serv.db.url</strong> A JDBC URL that points to the Entando 'SERV' Database, either a local Derby URL or a PostgreSQL URL</p>
</li>
<li>
<p><strong>entando.engine.port</strong> This property gets automatically populated by Maven when it finds a port on the Docker host to expose this service on. Can be used by downstream 'run' configurations</p>
</li>
<li>
<p><strong>docker.host.address</strong> The TCP/IP address or hostname where the Docker service is hosted. 172.17.0.1 is a 'cheat' that can be used in Linux environments as it represents the Docker software network&#8217;s gateway. Alternatively, use the virtual machine that hosts Docker</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="postgresql-image"><a class="anchor" href="#postgresql-image"></a>PostgreSQL Image</h6>
<div class="paragraph">
<p>This image is optional and is only used if you decide to persist your Entando data in a separate image using PostgreSQL. It also has both a build and
a run configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>                        &lt;image&gt;
                            &lt;name&gt;entandosamples/postgresql-${project.artifactId}&lt;/name&gt;
                            &lt;alias&gt;postgresql-${project.artifactId}&lt;/alias&gt;
                            &lt;build&gt;
                                &lt;skip&gt;${skipDatabaseImage}&lt;/skip&gt;
                                &lt;from&gt;entando/entando-postgresql95-base:${entando.version}&lt;/from&gt;
                                &lt;assembly&gt;
                                    &lt;descriptorRef&gt;artifact&lt;/descriptorRef&gt;
                                    &lt;targetDir&gt;/tmp&lt;/targetDir&gt;
                                &lt;/assembly&gt;
                                &lt;env&gt;
                                    &lt;!--
                                    Required by the PostgreSQL image to create the correct databases.
                                    Ensure that the corresponding variables in the Server image have the same values
                                    --&gt;
                                    &lt;PORTDB_USERNAME&gt;agile&lt;/PORTDB_USERNAME&gt;
                                    &lt;PORTDB_PASSWORD&gt;agile&lt;/PORTDB_PASSWORD&gt;
                                    &lt;SERVDB_USERNAME&gt;agile&lt;/SERVDB_USERNAME&gt;
                                    &lt;SERVDB_PASSWORD&gt;agile&lt;/SERVDB_PASSWORD&gt;
                                    &lt;PORTDB_DATABASE&gt;entandoPort&lt;/PORTDB_DATABASE&gt;
                                    &lt;SERVDB_DATABASE&gt;entandoServ&lt;/SERVDB_DATABASE&gt;

                                    &lt;!--Required for the Jetty runner to be able to host the WAR file--&gt;
                                    &lt;SERVDB_JNDI&gt;${profile.datasource.jndiname.servdb}&lt;/SERVDB_JNDI&gt;
                                    &lt;PORTDB_JNDI&gt;${profile.datasource.jndiname.portdb}&lt;/PORTDB_JNDI&gt;
                                &lt;/env&gt;
                                &lt;runCmds&gt;
                                    &lt;run&gt;$STI_SCRIPTS_PATH/init-postgresql-from-war.sh --war-file=/tmp/${project.build.finalName}.war --jetty-version=${jetty.version} &lt;/run&gt;
                                &lt;/runCmds&gt;
                            &lt;/build&gt;
                            &lt;run&gt;
                                &lt;skip&gt;${skipDatabaseImage}&lt;/skip&gt;
                                &lt;namingStrategy&gt;alias&lt;/namingStrategy&gt;
                                &lt;network&gt;
                                    &lt;mode&gt;custom&lt;/mode&gt;
                                    &lt;name&gt;${project.artifactId}-network&lt;/name&gt;
                                    &lt;alias&gt;postgresql-${project.artifactId}&lt;/alias&gt;
                                &lt;/network&gt;
                                &lt;ports&gt;
                                    &lt;!-- Uncomment the next line if you want to connect to PogreSQL locally from another client --&gt;
                                    &lt;!--&lt;port&gt;5432:5432&lt;/port&gt;--&gt;
                                &lt;/ports&gt;
                                &lt;volumes&gt;
                                    &lt;bind&gt;
                                        &lt;volume&gt;entando-docker-entando-pg-data:/var/lib/pgsql/data&lt;/volume&gt;
                                    &lt;/bind&gt;
                                &lt;/volumes&gt;
                                &lt;wait&gt;
                                    &lt;log&gt;Future log output will appear in directory&lt;/log&gt;
                                &lt;/wait&gt;
                                &lt;log&gt;
                                    &lt;enabled&gt;true&lt;/enabled&gt;
                                    &lt;prefix&gt;postgres:&lt;/prefix&gt;
                                    &lt;color&gt;cyan&lt;/color&gt;
                                &lt;/log&gt;
                            &lt;/run&gt;
                        &lt;/image&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>skipDatabaseImage</strong>  Both the build configuration and run configuration of this image are activated or deactivated based on the <code>skipDatabaseImage</code></p>
</li>
<li>
<p><strong>profile.datasource.jndiname.servdb</strong> Set this to the JDNI location that has been 'compiled' into the war file. It will typically be a java:jboss/* location. This is just needed for Jetty to emulate an environment similar to JBoss</p>
</li>
<li>
<p><strong>profile.datasource.jndiname.portdb</strong> See above. Needed for Jetty to emulate an environment similar to JBoss</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="appbuilder-image"><a class="anchor" href="#appbuilder-image"></a>AppBuilder Image</h6>
<div class="paragraph">
<p>You would use this image if you want to configure you Entando app after being deployed in Docker. For the <a href="#fine-grained-apps">Fine Grained Apps</a> use case, this will probably
not happen often, as you would be configuring your Entando app locally after starting it using the mvn jetty:run command. This image is run as is and does
not get built during the Maven build process.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>                        &lt;image&gt;
                            &lt;name&gt;entando/appbuilder:${entando.version}&lt;/name&gt;
                            &lt;run&gt;
                                &lt;skip&gt;${skipAppBuilderImage}&lt;/skip&gt;
                                &lt;network&gt;
                                    &lt;mode&gt;custom&lt;/mode&gt;
                                    &lt;name&gt;${project.artifactId}-network&lt;/name&gt;
                                    &lt;alias&gt;appbuilder&lt;/alias&gt;
                                &lt;/network&gt;
                                &lt;ports&gt;
                                    &lt;port&gt;${docker.host.address}:appbuilder.port:5000&lt;/port&gt;
                                &lt;/ports&gt;
                                &lt;dependsOn&gt;
                                    &lt;container&gt;${project.artifactId}&lt;/container&gt;
                                &lt;/dependsOn&gt;                                &lt;env&gt;
                                    &lt;DOMAIN&gt;http://${docker.host.address}:${entando.engine.port}/${project.artifactId}&lt;/DOMAIN&gt;
                                &lt;/env&gt;
                                &lt;wait&gt;
                                    &lt;http&gt;
                                        &lt;url&gt;http://${docker.host.address}:${appbuilder.port}&lt;/url&gt;
                                    &lt;/http&gt;
                                    &lt;time&gt;90000&lt;/time&gt;
                                &lt;/wait&gt;
                                &lt;log&gt;
                                    &lt;enabled&gt;true&lt;/enabled&gt;
                                    &lt;prefix&gt;appbuilder:&lt;/prefix&gt;
                                    &lt;color&gt;red&lt;/color&gt;
                                &lt;/log&gt;
                            &lt;/run&gt;
                        &lt;/image&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>skipAppBuilderImage</strong> Deactivates the AppBuilder image when set to 'false'</p>
</li>
<li>
<p><strong>docker.host.address</strong> TCIP/IP address or hastname of the Docker service</p>
</li>
<li>
<p><strong>entando.engine.port</strong> A dynamically populated property that holds the random port number that the Entando engine is hosted on.</p>
</li>
<li>
<p><strong>appbuilder.port</strong>A dynamically populated property that holds the random port number that the AppBuilder service is hosted on.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="the-docker-eap-derby-profile"><a class="anchor" href="#the-docker-eap-derby-profile"></a>The 'docker-eap-derby' Profile</h6>
<div class="paragraph">
<p>This profile is not intended for production environments as it does not support caching and assumes a local Derby database. Notice how
the <code>docker.db.init.command</code> command initializes the local Derby databases from the resulting '.war' file. Also double check that
the <code>env.db.environment</code> corresponds to the value that was active when the database backup was made. For the default profile,
when running mvn jetty:run this wil be 'develop'</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>        &lt;profile&gt;
            &lt;id&gt;docker-eap-derby&lt;/id&gt;
            &lt;properties&gt;
                &lt;jboss&gt;jboss&lt;/jboss&gt;
                &lt;env&gt;docker&lt;/env&gt;
                &lt;skipDocker&gt;false&lt;/skipDocker&gt;
                &lt;!--Ensure that this value corresponds to the database backup made for Docker deployments--&gt;
                &lt;env.db.environment&gt;develop&lt;/env.db.environment&gt;
                &lt;!-- Filter properties --&gt;
                &lt;profile.datasource.jndiname.servdb&gt;java:jboss/datasources/entandoServDataSource&lt;/profile.datasource.jndiname.servdb&gt;
                &lt;profile.datasource.jndiname.portdb&gt;java:jboss/datasources/entandoPortDataSource&lt;/profile.datasource.jndiname.portdb&gt;
                &lt;profile.database.driverClassName&gt;org.apache.derby.jdbc.EmbeddedDriver&lt;/profile.database.driverClassName&gt;

                &lt;server.base.image&gt;entando-eap71-base&lt;/server.base.image&gt;
                &lt;jboss.home.in.image&gt;/opt/eap&lt;/jboss.home.in.image&gt;
                &lt;docker.db.init.command&gt;$STI_SCRIPTS_PATH/init-derby-from-war.sh --war-file=${jboss.home.in.image}/standalone/deployments/${project.build.finalName}.war --jetty-version=${jetty.version}&lt;/docker.db.init.command&gt;
                &lt;port.db.url&gt;jdbc:derby:/entando-data/databases/entandoPort;create=true&lt;/port.db.url&gt;
                &lt;serv.db.url&gt;jdbc:derby:/entando-data/databases/entandoServ;create=true&lt;/serv.db.url&gt;

                &lt;!--Image activation--&gt;
                &lt;skipServerImage&gt;false&lt;/skipServerImage&gt;
                &lt;skipDatabaseImage&gt;true&lt;/skipDatabaseImage&gt;
                &lt;skipAppBuilderImage&gt;false&lt;/skipAppBuilderImage&gt;
            &lt;/properties&gt;
        &lt;/profile&gt;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="the-docker-wildfly-derby-profile"><a class="anchor" href="#the-docker-wildfly-derby-profile"></a>The 'docker-wildfly-derby' Profile</h6>
<div class="paragraph">
<p>This profile is also not intended for production environments as it does not support caching and assumes a local Derby database. Again,
the <code>docker.db.init.command</code> command initializes the local Derby databases. The <code>env.db.environment</code> property is set to 'develop'</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>        &lt;profile&gt;
            &lt;id&gt;docker-wildfly-derby&lt;/id&gt;
            &lt;properties&gt;
                &lt;jboss&gt;jboss&lt;/jboss&gt;
                &lt;env&gt;docker&lt;/env&gt;
                &lt;skipDocker&gt;false&lt;/skipDocker&gt;
                &lt;!--Ensure that this value corresponds to the database backup made for Docker deployments--&gt;
                &lt;env.db.environment&gt;develop&lt;/env.db.environment&gt;
                &lt;!-- Filter properties --&gt;
                &lt;profile.datasource.jndiname.servdb&gt;java:jboss/datasources/entandoServDataSource&lt;/profile.datasource.jndiname.servdb&gt;
                &lt;profile.datasource.jndiname.portdb&gt;java:jboss/datasources/entandoPortDataSource&lt;/profile.datasource.jndiname.portdb&gt;
                &lt;profile.database.driverClassName&gt;org.apache.derby.jdbc.EmbeddedDriver&lt;/profile.database.driverClassName&gt;

                &lt;server.base.image&gt;entando-wildfly12-base&lt;/server.base.image&gt;
                &lt;jboss.home.in.image&gt;/wildfly&lt;/jboss.home.in.image&gt;
                &lt;docker.db.init.command&gt;$STI_SCRIPTS_PATH/init-derby-from-war.sh --war-file=${jboss.home.in.image}/standalone/deployments/${project.build.finalName}.war --jetty-version=${jetty.version}&lt;/docker.db.init.command&gt;
                &lt;port.db.url&gt;jdbc:derby:/entando-data/databases/entandoPort;create=true&lt;/port.db.url&gt;
                &lt;serv.db.url&gt;jdbc:derby:/entando-data/databases/entandoServ;create=true&lt;/serv.db.url&gt;

                &lt;!--Image activation--&gt;
                &lt;skipServerImage&gt;false&lt;/skipServerImage&gt;
                &lt;skipDatabaseImage&gt;true&lt;/skipDatabaseImage&gt;
                &lt;skipAppBuilderImage&gt;false&lt;/skipAppBuilderImage&gt;
            &lt;/properties&gt;
        &lt;/profile&gt;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="the-docker-eap-clustered-profile"><a class="anchor" href="#the-docker-eap-clustered-profile"></a>The 'docker-eap-clustered' Profile</h6>
<div class="paragraph">
<p>This is the typical profile to use for production environments. Please ensure that your organization has the necessary subscription and support
to allow for JBoss EAP in a production environment. In this case, the <code>port.db.url</code> and <code>serv.db.url</code> properties point to the local PostgreSQL image,
which is now activated with <code>skipDatabaseImage=false</code>. Keep in mind that these JDBC URL&#8217;s can be overridden by providing alternative values to these
URL&#8217;s in your different deployment environments. In this profile, all that the <code>docker.db.init.command</code> does is to generate
a file named 'build_id' with the current date/time as content. This is to ensure that scripts that restore the resources and protected
resources during image instantiation can check whether the resources in the '.war' file are newer than the previously extracted resources.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>        &lt;profile&gt;
            &lt;id&gt;docker-eap-clustered&lt;/id&gt;
            &lt;properties&gt;
                &lt;jboss&gt;jboss&lt;/jboss&gt;
                &lt;env&gt;docker&lt;/env&gt;
                &lt;skipDocker&gt;false&lt;/skipDocker&gt;
                &lt;!--Ensure that this value corresponds to the database backup made for Docker deployments--&gt;
                &lt;env.db.environment&gt;develop&lt;/env.db.environment&gt;
                &lt;!-- Filter properties --&gt;
                &lt;profile.datasource.jndiname.servdb&gt;java:jboss/datasources/entandoServDataSource&lt;/profile.datasource.jndiname.servdb&gt;
                &lt;profile.datasource.jndiname.portdb&gt;java:jboss/datasources/entandoPortDataSource&lt;/profile.datasource.jndiname.portdb&gt;
                &lt;profile.database.driverClassName&gt;org.postgresql.Driver&lt;/profile.database.driverClassName&gt;

                &lt;server.base.image&gt;entando-eap71-clustered-base&lt;/server.base.image&gt;
                &lt;jboss.home.in.image&gt;/opt/eap&lt;/jboss.home.in.image&gt;
                &lt;docker.db.init.command&gt;echo $(date +%s) &gt; /entando-data-templates/build_id&lt;/docker.db.init.command&gt;
                &lt;port.db.url&gt;jdbc:postgresql://postgresql-${project.artifactId}:5432/entandoPort&lt;/port.db.url&gt;
                &lt;serv.db.url&gt;jdbc:postgresql://postgresql-${project.artifactId}:5432/entandoServ&lt;/serv.db.url&gt;

                &lt;!--Image activation--&gt;
                &lt;skipServerImage&gt;false&lt;/skipServerImage&gt;
                &lt;skipDatabaseImage&gt;false&lt;/skipDatabaseImage&gt;
                &lt;skipAppBuilderImage&gt;false&lt;/skipAppBuilderImage&gt;
            &lt;/properties&gt;
        &lt;/profile&gt;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="the-docker-wildfly-postgresql-profile"><a class="anchor" href="#the-docker-wildfly-postgresql-profile"></a>The 'docker-wildfly-postgresql' Profile</h6>
<div class="paragraph">
<p>Another configuration to illustrate a combination of Wildfly and PostgreSQL</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>        &lt;profile&gt;
            &lt;id&gt;docker-wildfly-postgresql&lt;/id&gt;
            &lt;properties&gt;
                &lt;jboss&gt;jboss&lt;/jboss&gt;
                &lt;env&gt;docker&lt;/env&gt;
                &lt;skipDocker&gt;false&lt;/skipDocker&gt;
                &lt;!--Ensure that this value corresponds to the database backup made for Docker deployments--&gt;
                &lt;env.db.environment&gt;develop&lt;/env.db.environment&gt;
                &lt;!-- Filter properties --&gt;
                &lt;profile.datasource.jndiname.servdb&gt;java:jboss/datasources/entandoServDataSource&lt;/profile.datasource.jndiname.servdb&gt;
                &lt;profile.datasource.jndiname.portdb&gt;java:jboss/datasources/entandoPortDataSource&lt;/profile.datasource.jndiname.portdb&gt;
                &lt;profile.database.driverClassName&gt;org.postgresql.Driver&lt;/profile.database.driverClassName&gt;

                &lt;server.base.image&gt;entando-wildfly12-base&lt;/server.base.image&gt;
                &lt;jboss.home.in.image&gt;/wildfly&lt;/jboss.home.in.image&gt;
                &lt;docker.db.init.command&gt;echo $(date +%s) &gt; /entando-data-templates/build_id&lt;/docker.db.init.command&gt;
                &lt;port.db.url&gt;jdbc:postgresql://postgresql-${project.artifactId}:5432/entandoPort&lt;/port.db.url&gt;
                &lt;serv.db.url&gt;jdbc:postgresql://postgresql-${project.artifactId}:5432/entandoServ&lt;/serv.db.url&gt;

                &lt;!--Image activation--&gt;
                &lt;skipServerImage&gt;false&lt;/skipServerImage&gt;
                &lt;skipDatabaseImage&gt;false&lt;/skipDatabaseImage&gt;
                &lt;skipAppBuilderImage&gt;false&lt;/skipAppBuilderImage&gt;
            &lt;/properties&gt;
        &lt;/profile&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="using-mvn-jettyrun-locally-with-appbuilder-and-postgresql-images"><a class="anchor" href="#using-mvn-jettyrun-locally-with-appbuilder-and-postgresql-images"></a>4.2.13. Using mvn jetty:run locally with AppBuilder and PostgreSQL images</h4>
<div class="paragraph">
<p>Whereas it is entirely possible to use Maven to build and run the Entando Docker image in your day to day development flow,
this flow of events still takes significantly longer than simply running <code>mvn clean package jetty:run</code>. It also doesn&#8217;t
support the 'live' source update that the Jetty-based approach enables. If you are looking for quick feedback to see what
your Entando app looks like, we therefore recommend that you still use the Maven Jetty plugin to do this. Once you have
achieved the required results, it is then recommended that the developer verifies the resulting Entando App at least
once from the targeted Docker image. This will give the developer the confidence that the Image build will complete successfully on
the server and that all the integration points behave as expected.</p>
</div>
<div class="paragraph">
<p>Whereas the <code>mvn jetty:run</code> approach definitely provides the quickest feedback for developers compared to using the Entando engine image, using
the other Docker images can still contribute to productivity. By pointing the AppBuilder image to the Jetty service running at localhost:8080 offers
the developer access to AppBuilder without the need to install NodeJS and other JavaScript infrastructure and build AppBuilder from source. By
pointing the Jetty datasources to the PostgreSQL container already available in Docker, the developer also gets access to o his/her own,
isolated PostgreSQL instance. To achieve this, simply follow these steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deactivate your currently selected database property section by 'commenting it out' in the appropriate filter properties file
(filter-development-unix.properties  or filter-development-windows.properties depending on your operating system) eg:</p>
<div class="literalblock">
<div class="content">
<pre># --------------------- Database Configuration: DERBY ---------------------
#profile.database.hostname=localhost
#profile.database.port=1527
#profile.database.username=agile
#profile.database.password=agile
#
##usually no need to change the following group of 3 properties:
#profile.database.driverClassName=org.apache.derby.jdbc.EmbeddedDriver
#profile.database.url.portdb=jdbc:derby:${project.build.directory}/derby/production/${profile.application.name}Port;create=true
#profile.database.url.servdb=jdbc:derby:${project.build.directory}/derby/production/${profile.application.name}Serv;create=true</pre>
</div>
</div>
</li>
<li>
<p>Uncomment the section marked as <code>Database Configuration: PostgreSQL running in Docker</code> in the appropriate filter properties file:</p>
<div class="literalblock">
<div class="content">
<pre># --------------------- Database Configuration: PostgreSQL running in Docker ---------------------
profile.database.hostname=localhost
profile.database.port=5432
profile.database.username=agile
profile.database.password=agile</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>#usually no need to change the following group of 3 properties:
profile.database.driverClassName=org.postgresql.Driver
profile.database.url.portdb=jdbc:postgresql://${profile.database.hostname}:${profile.database.port}/entandoPort
profile.database.url.servdb=jdbc:postgresql://${profile.database.hostname}:${profile.database.port}/entandoServ</pre>
</div>
</div>
</li>
<li>
<p>If you are running on Windows or Apple, remember to use the TCP/IP address of the Docker virtual matching as database hostname (<code>profile.database.hostname</code>)</p>
</li>
<li>
<p>Expose the PostgreSQL port from the container to the Docker host by uncommenting this line in the pom.xml file:</p>
<div class="literalblock">
<div class="content">
<pre>&lt;!-- Uncomment the next line if you want to connect to PogreSQL locally from Jetty --&gt;
&lt;port&gt;5432:5432&lt;/port&gt;</pre>
</div>
</div>
</li>
<li>
<p>Build the PostgreSQL image and run it along with the AppBuilder image using the docker-with-local-jetty profile:</p>
<div class="literalblock">
<div class="content">
<pre>mvn clean package -Pdocker-with-local-jetty docker:start</pre>
</div>
</div>
</li>
<li>
<p>Start Jetty:</p>
<div class="literalblock">
<div class="content">
<pre>mvn clean package jetty:run</pre>
</div>
</div>
</li>
<li>
<p>Make your modifications and verify them, and terminate the Jetty process once you are done.</p>
</li>
<li>
<p>Now you can actually build and run the Entando Engine image of your choice, pointing to the same database:</p>
<div class="literalblock">
<div class="content">
<pre>mvn clean package -Pdocker-eap-clustered -DskipDatabaseImage=true -DskipAppBuilderImage=true docker:start -Dentando.engine.port=8080 -Ddocker.host.address=localhost</pre>
</div>
</div>
</li>
<li>
<p>Verify that it is behaving as expected at <a href="http://localhost:8080/entando-sample-full" class="bare">http://localhost:8080/entando-sample-full</a>.</p>
</li>
<li>
<p>Before checking in your changes, remember to backup the database to your Maven project</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="volumes"><a class="anchor" href="#volumes"></a>4.2.14. Volumes</h4>
<div class="paragraph">
<p>In the pom.xml file, two Docker volumes have been configured:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>                    &lt;volumes&gt;
                        &lt;volume&gt;
                            &lt;!--Volume for JBoss and Derby data--&gt;
                            &lt;name&gt;${project.artifactId}-entando-data&lt;/name&gt;
                            &lt;driver&gt;local&lt;/driver&gt;
                        &lt;/volume&gt;
                        &lt;volume&gt;
                            &lt;!--Volume for PostgreSQL data--&gt;
                            &lt;name&gt;${project.artifactId}-entando-pg-data&lt;/name&gt;
                            &lt;driver&gt;local&lt;/driver&gt;
                        &lt;/volume&gt;
                    &lt;/volumes&gt;
You can look at the actual volumes in Docker by using the following command:</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>    docker volume ls
    DRIVER              VOLUME NAME
    local               entando-sample-full-entando-pg-data
    local               entando-sample-full-entando-data</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>entando-docker-entando-data</code> volume is the standard entando-data volume that is mounted at /entando-data in the container once it has started. In this scenario, this
volume contains the indices that are generated. In the scenario where the default embedded Derby databases are used, those will also be stored here. if you need to
reset this data, run the following command to delete this volume:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>docker volume rm entando-sample-full-entando-data</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>entando-sample-full-entando-pg-data</code> volume is where the PostgreSQL database is stored. If you are using the PostgreSQL image, you can reset the database by running
the following command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>docker volume rm entando-sample-full-entando-pg-data</pre>
</div>
</div>
<div class="paragraph">
<p>This will delete the existing database and allow the PostgreSQL image to restore the last database that was baked up before the '.war' file was built.</p>
</div>
<div class="paragraph">
<p>NB! If you switch from one of the JBoss EAP images to the Wildfly image, you would have to delete the <code>entando-docker-entando-data</code> volume entirely. This
is needed because these two images run under different user id&#8217;s.</p>
</div>
</div>
<div class="sect3">
<h4 id="docker-host-ip-complexities"><a class="anchor" href="#docker-host-ip-complexities"></a>4.2.15. Docker Host IP Complexities</h4>
<div class="paragraph">
<p>When integrating the Maven Docker Plugin into your existing build infrastructure, it may sometimes be challenging to figure out how to connect to the Docker server
that can perform the image build. The Maven Docker Plugin connects to the Docker host from a client process (Maven), and therefore may need to be told explicitly
where the Docker server is running. The <code>DOCKER_HOST</code> environment variable will allow you to specify the Docker server explicitly. There are a couple tips and tricks
to keep in mind in specifying the DOCKER_HOST variable:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>On most Docker distributions for Linux, it will be <code>localhost</code>. Your Linux configuration may also use a local unix socket /var/run/docker.sock</p>
</li>
<li>
<p>If you are using the Docker service in Minishift or Minikube, the DOCKER_HOST should be the IP address of the Minishit/Minikube virtual machine.</p>
</li>
<li>
<p>If you are using Docker on Windows or Apple, the DOCKER_HOST should be the IP address of the virtual machine that host the Docker server.</p>
</li>
<li>
<p>If you are running your Maven build inside a Docker container, the gateway IP address 172.17.0.1 is almost always a safe bet for the DOCKER_HOST.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>One more think to take note of is that, if you do have a <code>&lt;wait&gt;</code> element with an HTTP request url specified on your image run configuration, you need to use a correct Docker host as the
hostname segment of your URL. In fact, the same goes for any URL you use to access the exposed Docker port.</p>
</div>
</div>
<div class="sect3">
<h4 id="verifying-and-pushing-your-images"><a class="anchor" href="#verifying-and-pushing-your-images"></a>4.2.16. Verifying and Pushing your images</h4>
<div class="paragraph">
<p>With the Docker image build and run now forming part of the Entando App&#8217;s build process, it is fairly easy to do some automated testing against the resulting image.
You could use the Maven Failsafe plugin to initiate some integration tests after the container has started up successfully. This would allow you to performa some
verification before pushing the Image to the shared Docker registry.</p>
</div>
<div class="paragraph">
<p>The Maven Docker plugin also allows you to push the image to a shared Docker registry. It is highly recommended to use a secure registry for these purposes. You are
most likely to be pushing the image from a build server, in which case the recommended approach would be to define a <code>&lt;server&gt;</code> in the $HOME/.m2/settings.xml file. In
order for Maven to pick up the correct credentials, the <code>&lt;id&gt;</code> of the server element needs to be the same as the <code>hostname</code> segment in your Docker Image name. For example
if you have a Docker registry called <code>my.registry.com</code>, you need to specify your image as:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;image&gt;my.registry.com/somenamespace/myimage:1.0.4&lt;/image&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>and your server configuration in the settings.xml file as</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;servers&gt;
  &lt;server&gt;
    &lt;id&gt;my.registry.com&lt;/id&gt;
    &lt;username&gt;myusername&lt;/username&gt;
    &lt;password&gt;s!cr!t&lt;/password&gt;
  &lt;/server&gt;
  ....
&lt;/servers&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Once all of this is in place, you can push all images in the Maven project using a single command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn -Pdocker-eap-clustered docker:push</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="entando-on-openshift"><a class="anchor" href="#entando-on-openshift"></a>4.2.17. Entando on Openshift</h4>
<div class="paragraph">
<p>Thus far in this chapter on containers, we have demonstrated how Entando&#8217;s images can be used in a 'vanilla'
Docker deployment. We have also looked at how the Entando Docker base images can be used and extended using the
Fabric8 Maven Docker Plugin. However, none of these tools and techniques offer a viable solution for running your
Docker containers in deployment just yet. For that, you would ultimately need a more mature container orchestration and
clustering product, such as Kubernetes, Openshift or Docker Swarm. At Entando we have focused our initial efforts
primarily on supporting Openshift.</p>
</div>
<div class="paragraph">
<p>In this section, we will first get familiar with some of the core concepts in Openshift at the hand have a couple of
Entando&#8217;s pre-built images. Then we&#8217;ll explore how to build your own images from the images and templates Entando offers.
This section will conclude with a look at how to setup Jenkins pipelines for Entando in Openshift.</p>
</div>
<div class="paragraph">
<p>Before continuing with this section, it is perhaps worth noting how the two typical use cases of Entando,
<a href="#fine-grained-apps">Fine Grained Apps</a> and <a href="#coarse-grained-apps">Coarse Grained Apps</a>, feature in Entando&#8217;s Openshift offering. Openshift is
positioned primarily as a Platform As A Service offering for finer grained services. As such, it is very well
suited for the architectural approached commonly known as 'Microservices'. Although it certainly doesn&#8217;t prevent one
from deploying more coarse grained services, or even monolithic applications, it would be fair to say that this
is not its sweet spot. For this reason, Entando&#8217;s initial efforts in this space focused more on the <a href="#fine-grained-apps">Fine Grained Apps</a>
use case for Entando, as discussed earlier. We have some basic support for the <a href="#coarse-grained-apps">Coarse Grained Apps</a> use case,
and we will introduce more functionality in future to support this use case. Our initial focus was
just on the <a href="#fine-grained-app">[fine-grained-app]</a> use case as this is where Openshift&#8217;s value really comes to the fore.</p>
</div>
<div class="sect4">
<h5 id="from-docker-compose-to-openshift"><a class="anchor" href="#from-docker-compose-to-openshift"></a>From Docker Compose to Openshift</h5>
<div class="paragraph">
<p>In the section <a href="#demos-on-docker">Demos on Docker</a>, we used Docker Compose to install Entando&#8217;s two pre-built demos. The pre-built
images were configured using the standard 'docker-compose.yml' files. Openshift Templates fulfill a very similar
role to docker-compose.yml files, and in fact can also be developed in the YAML format. Openshift Templates are
used to configure the following objects that are used to build and deploy Docker images</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>At the heart of a typical Openshift Template would be one or more <strong>DeploymentConfig</strong> objects. We use these objects
to configure how containers are created from images, and what Openshift should do with the containers environment
variables, ports and volumes. A DeploymentConfig can be configured to create multiple containers based on a single
image, thus supporting clustering.</p>
</li>
<li>
<p>One typically configures a <strong>Service</strong> object For each signficant port exposed by the containers produced by
a DeploymentConfig. Services are essential in the Kubernetes clustering and networking model. Each Service
has a cluster IP address that can be used to access the port that the Service is mapped to, but the load balancer
decides which container will serve each request.</p>
</li>
<li>
<p><strong>Routes</strong> are used to assign externally accessible, user-friendly domain names and paths to specific services. Routes
are also used to configure HTTPS on Services that expose the HTTP protocol. One can therefore attached the necessary
certificates and keys to an HTTPS Route.</p>
</li>
<li>
<p>The <strong>BuildConfig</strong> complete the picture for those that want to host their entire pipeline in Openshift, as they allow you
to checkout source code and then perform some build operations on it with the goal of producing a new image.</p>
</li>
<li>
<p>The <strong>ImageStream</strong> is one last concept that is worth noting. It provides a level of indiretction between
DeploymentConfigs or BuildConfigs and the Docker Images that they use. It also allows Openshift to triger builds and
deployments when an ImageStream is updated. Similar to Docker Images, ImageStreams also contain tags called
ImageStreamTags that typically pin a build or deployment to a specific version of a Docker Image.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Openshift Templates can be instantiated either from the commandline, or from the web-based Openshift Console. In the
section on the <a href="#openshift-quickstart">Openshift Quick Start</a>, we did in fact instantiate such a template, and we gave instructions on
how to do so either from the commandline or from the web console. Please feel free to work through that example
again, perhaps also exploring the
<a href="https://github.com/entando/entando-ops/blob/EN-2348/Openshift/templates/entando-eap71-quickstart.yml">Template definition file</a>.
Have a look at how the different objects we discussed above feature in this template.</p>
</div>
</div>
<div class="sect4">
<h5 id="entando-standard-openshift-template-parameters"><a class="anchor" href="#entando-standard-openshift-template-parameters"></a>Entando Standard Openshift Template Parameters</h5>
<div class="paragraph">
<p>When instantiating an Openshift Template, you also need to provide valid values for the Parameters in a Template.
These parameter values are often passed on directly to one of the DeploymentConfigs as environment variables to the
containers it manages. You will therefore often encounter one of Entando&#8217;s standard image environment variable in the
form of an Openshift Template Parameter. There are also many Parameters in our templates that have exactly the same
function in each of the Templates they occur in. This is in line with our container design philosophy that we like
to keep things simple and consistent.</p>
</div>
<div class="ulist">
<div class="title">Parameters that map directly to Environment Variables</div>
<ul>
<li>
<p><strong>KIE_SERVER_BASE_URL</strong> - The base URL where a KIE Server instance is hosted, e.g. <a href="http://entando-kieserver701.apps.serv.run/" class="bare">http://entando-kieserver701.apps.serv.run/</a></p>
</li>
<li>
<p><strong>KIE_SERVER_USERNAME</strong> - The username of a user that be used to log into the above-mentioned KIE Server</p>
</li>
<li>
<p><strong>KIE_SERVER_PASSWORD</strong>- The password of the above-mentioned KIE Server user.</p>
</li>
<li>
<p><strong>ENTANDO_OIDC_AUTH_LOCATION</strong> - the URL of the authentication service, e.g. the 'login page' that Entando needs to redirect the user to in order to  allow the OAuth provider to authenticate the user.</p>
</li>
<li>
<p><strong>ENTANDO_OIDC_TOKEN_LOCATION</strong> - the URL of the token service where Entando can retrieve the OAuth token from after authentication</p>
</li>
<li>
<p><strong>ENTANDO_OIDC_CLIENT_ID</strong> - the Client ID that uniquely identifies the Entando App in the OAuth provider&#8217;s configuration</p>
</li>
<li>
<p><strong>ENTANDO_OIDC_REDIRECT_BASE_URL</strong> - the optional base URL, typically the protocol, host and port (<a href="https://some.host.com:8080/" class="bare">https://some.host.com:8080/</a>) that will be prepended to the path segment of the URL requested by the user and provided as a redirect URL to the OAuth provider. If empty, the requested URL will be used as is.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Standard Parameters in Entando Openshift Templates</div>
<ul>
<li>
<p><strong><a id="application_name"></a>APPLICATION_NAME</strong> - an Openshift compliant name that can be used as a prefix to automatically  generate names for related objects in the Template</p>
</li>
<li>
<p><strong><a id="image_stream_namespace"></a>IMAGE_STREAM_NAMESPACE</strong> - the name of the Openshift project that contains all the  ImageStreams required for the Template  in question. If the ImageStreams were created in the default 'openshift' project,  Openshift will automatically add it to  its application catalog. It is however possible to store them in any   project, including the project that the current Template is being instantiated in.</p>
</li>
<li>
<p><strong><a id="image_stream_tag"></a>ENTANDO_IMAGE_VERSION</strong> - the version number of the Entando images that will be used. In Docker, this will be the 'tag' segment of the Image repository reference. In Openshift, this will be the name of a Tag in the ImageStreams that will be used to bind all  S2I BuildConfigs and  DeploymentConfigs to. This generally corresponds with the version of Entando being used.</p>
</li>
<li>
<p><strong><a id="entando_engine_hostname"></a>ENTANDO_ENGINE_HOSTNAME</strong> - the fully qualified domain name of the Route that will be  created to expose the Entando Runtime Service using HTTP without SSL. This variable  is often used to connect to from the App Builder. You therefore need to make sure that it is accessible from outside the Openshift cluster.</p>
</li>
<li>
<p><strong><a id="entando_engine_secure_hostname"></a>ENTANDO_ENGINE_SECURE_HOSTNAME</strong> - the fully qualified domain name of the Route that will be  created to expose the Entando Runtime Service using SSL/HTTPS. This variable  is often used to connect to from the App Builder. You therefore need to make sure that it is accessible from outside the Openshift cluster.</p>
</li>
<li>
<p><strong><a id="domain_suffix"></a>DOMAIN_SUFFIX</strong> - the domain suffix will be appended to the various service names to form a full domain name for the Route of the  mapped to the service. This parameter is required to ensure that the AppBuider points to the externally accessible URL that serves Entando App.</p>
</li>
<li>
<p><strong><a id="entando_app_builder_hostname"></a>ENTANDO_APP_BUILDER_HOSTNAME</strong> - the fully qualified domain name of the Route that will be  created to expose the Entando App Builder JavaScript App  using HTTP without SSL.</p>
</li>
<li>
<p><strong><a id="entando_app_builder_secure_hostname"></a>ENTANDO_APP_BUILDER_SECURE_HOSTNAME</strong> - the fully qualified domain name of the Route that will be  created to expose the Entando App Builder JavaScript App using SSL/HTTPS.</p>
</li>
<li>
<p><strong><a id="entando_web_context"></a>ENTANDO_ENGINE_WEB_CONTEXT</strong> - the context root  of the Entando Web Application. This is the context  on the JEE server that will be used to dispatch requests to the Entando Web Application. Generally this would be the same as the APPLICATION_NAME. In typical JEE deployments this would be the name of the war file, excluding the '.war' extension and prefixed with a slash (/). In typical Maven projects, this would be the value of the &lt;finalName&gt; element in the pom.xml</p>
</li>
<li>
<p><strong><a id="source_repository_url"></a>SOURCE_REPOSITORY_URL</strong> - the full URL of the source repository where the source code of the image that needs to be built can be found</p>
</li>
<li>
<p><strong><a id="source_repository_ref"></a>SOURCE_REPOSITORY_REF</strong> - the branch or tag that will be checked out from the source repository specified at the SOURCE_REPOSITORY_URL</p>
</li>
<li>
<p><strong><a id="source_secret"></a>SOURCE_SECRET</strong> - the Openshift Secret containing the Username and Password for the source repository specified at the SOURCE_REPOSITORY_URL</p>
</li>
<li>
<p><strong><a id="context_dir"></a>CONTEXT_DIR</strong> - the relative directory inside the source repository from which the build should be  executed.</p>
</li>
<li>
<p><strong><a id="volume_capacity"></a>VOLUME_CAPACITY</strong> - the amount of storage space to be allocated to the Entando App. This needs to be large enough for documents and images that are uploaded, database backups that need to be made,  and the indices that Entando generates. Depending  on the exact template, this may aslo include the space required for the embedded Derby database.</p>
</li>
<li>
<p><strong><a id="memory_limit"></a>MEMORY_LIMIT</strong> - the maximum amount of memory to be allocated to the Entando JEE App.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="deploying-the-entando-pre-built-images"><a class="anchor" href="#deploying-the-entando-pre-built-images"></a>Deploying the Entando pre-built images</h5>
<div class="paragraph">
<p>Entando&#8217;s two pre-built demos can be deployed to Openshift using a Templates built for these purposes. Refer
back to the <a href="#openshift-quickstart">Openshift Quick Start</a> on more detailed instructions on how to instantiate a Template. In this section
we will focus primarily on the Parameters of the Template in question, and how the images are configured inside the
Template' DeploymentConfigs. Remember to install the prerequisite ImageStreams in the Openshift project you have chosen
for these purposes.</p>
</div>
<div class="sect5">
<h6 id="full-stack-template"><a class="anchor" href="#full-stack-template"></a>Full Stack Template</h6>
<div class="paragraph">
<p>The Entando Full Stack Template installs an Entando App that contains all of the standard Entando plugins. You can
download the template from Github.</p>
</div>
<div class="ulist">
<div class="title">Template Location</div>
<ul>
<li>
<p><a href="https://raw.githubusercontent.com/entando/entando-ops/EN-2348/Openshift/templates/entando-full-stack.yml" class="bare">https://raw.githubusercontent.com/entando/entando-ops/EN-2348/Openshift/templates/entando-full-stack.yml</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Images used</div>
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/appbuilder">Entando App Builder Image (entando/appbuilder:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/entando">The Full Entando Engine API (entando/engine-api:latest)</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisite Image Streams</div>
<ul>
<li>
<p>Entando AppBuilder Image stream: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json</a></p>
</li>
<li>
<p>The Entando Full Stack Image stream: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-sample-full.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-sample-full.json</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Parameters</div>
<ul>
<li>
<p><strong><a href="#entando_app_builder_hostname">ENTANDO_APP_BUILDER_HOSTNAME</a></strong> - the fully qualified domain name of the Route that will be  created to expose the Entando App Builder JavaScript App  using HTTP without SSL.</p>
</li>
<li>
<p><strong><a href="#entando_engine_hostname">ENTANDO_ENGINE_HOSTNAME</a></strong> - the fully qualified domain name of the Route that will be  created to expose the Entando Runtime Service using HTTP without SSL. This variable  is often used to connect to from the App Builder. You therefore need to make sure that it is accessible from outside the Openshift cluster.</p>
</li>
<li>
<p><strong><a href="#image_stream_tag">ENTANDO_IMAGE_VERSION</a></strong> - the version number of the Entando images that will be used. In Docker, this will be the 'tag' segment of the Image repository reference. In Openshift, this will be the name of a Tag in the ImageStreams that will be used to bind all  S2I BuildConfigs and  DeploymentConfigs to. This generally corresponds with the version of Entando being used.</p>
</li>
<li>
<p><strong><a href="#image_stream_namespace">IMAGE_STREAM_NAMESPACE</a></strong> - the name of the Openshift project that contains all the  ImageStreams required for the Template  in question. If the ImageStreams were created in the default 'openshift' project,  Openshift will automatically add it to  its application catalog. It is however possible to store them in any   project, including the project that the current Template is being instantiated in.</p>
</li>
<li>
<p><strong><a href="#kie_server_baseurl">KIE_SERVER_BASE_URL</a></strong> - The base URL where a KIE Server instance is hosted, e.g. <a href="http://entando-kieserver701.apps.serv.run/" class="bare">http://entando-kieserver701.apps.serv.run/</a></p>
</li>
<li>
<p><strong><a href="#kie_server_username">KIE_SERVER_USERNAME</a></strong> - The username of a user that be used to log into the above-mentioned KIE Server</p>
</li>
<li>
<p><strong><a href="#kie_server_password">KIE_SERVER_PASSWORD</a></strong> - The password of the above-mentioned KIE Server user.</p>
</li>
<li>
<p><strong><a href="#volume_capacity">VOLUME_CAPACITY</a></strong> - the amount of storage space to be allocated to the Entando App. This needs to be large enough for documents and images that are uploaded, database backups that need to be made,  and the indices that Entando generates. Depending  on the exact template, this may aslo include the space required for the embedded Derby database.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Example Installation Script</div>
<p><a href="https://github.com/entando/entando-ops/blob/EN-2348/Openshift/installers/install-entando-full-stack.sh" class="bare">https://github.com/entando/entando-ops/blob/EN-2348/Openshift/installers/install-entando-full-stack.sh</a></p>
</div>
<div class="paragraph">
<div class="title">Resulting Routes.</div>
<p>You can navigate to the most significant URL&#8217;s from you browser by clicking on the URL&#8217;s of the following Routes.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Full Stack Entando app: click on the  <code>entando-full-stack-engine-http</code> Route</p>
</li>
<li>
<p>AppBuilder: click on the <code>entando-full-stack-appbuilder</code> Route</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Persistent Volume Claims</div>
<ul>
<li>
<p><strong>entando-full-stack-claim</strong> - Contains the two embedded Derby databases by default. Will also contain any uploaded
files, database backups and indices generated by Entando</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="fsi-template"><a class="anchor" href="#fsi-template"></a>FSI Template</h6>
<div class="paragraph">
<p>The Entando team, Red Hat and our business partners have collaborated to bring you a demo that illustrates how Entando can be used as the user experience layer for your Red Hat Process Automation Manager processes. The process in question allows customers to initiate a dispute case against a specific transaction. This demo provides two Entando apps - a customer facing app and a back-office app. These apps connect to a shared KIE Server instance.  The FSI Credit Card Dispute Template installs all the pre-built images required
for you to explore the FSI Credit Card Dispute Demo.</p>
</div>
<div class="ulist">
<div class="title">Template Location</div>
<ul>
<li>
<p><a href="https://raw.githubusercontent.com/entando/entando-ops/EN-2348/Openshift/templates/fsi-ccd-demo.yml" class="bare">https://raw.githubusercontent.com/entando/entando-ops/EN-2348/Openshift/templates/fsi-ccd-demo.yml</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Images used</div>
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/appbuilder">Entando App Builder Image (entando/appbuilder:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/demos/fsi-cc-dispute-customer">Entando FSI Credit Card Dispute Customer Image (entando/fsi-cc-dispute-customer:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/demos/fsi-cc-dispute-admin">Entando FSI Credit Card Dispute Back Office Image (entando/fsi-cc-dispute-admin:latest)</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisite Image Streams</div>
<ul>
<li>
<p>Entando AppBuilder Image stream: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json</a></p>
</li>
<li>
<p>The Entando FSI Credit Card Dispute Image Streams: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-fsi-ccd-demo.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-fsi-ccd-demo.json</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Parameters</div>
<ul>
<li>
<p><strong>ADMIN_APP_BUILDER_HOSTNAME</strong> - for the Backoffice app, the fully qualified domain name of the Route that will be  created to expose the Entando App Builder JavaScript App  using HTTP without SSL.</p>
</li>
<li>
<p><strong>ADMIN_ENTANDO_ENGINE_HOSTNAME</strong> - for the Backoffice app, the fully qualified domain name of the Route that will be  created to expose the Entando Runtime Service using HTTP without SSL. This variable  is often used to connect to from the App Builder. You therefore need to make sure that it is accessible from outside the Openshift cluster.</p>
</li>
<li>
<p><strong>CUSTOMER_APP_BUILDER_HOSTNAME</strong> - for the Customer app, the fully qualified domain name of the Route that will be  created to expose the Entando App Builder JavaScript App  using HTTP without SSL.</p>
</li>
<li>
<p><strong>CUSTOMER_ENTANDO_ENGINE_HOSTNAME</strong> - for the Customer app, the fully qualified domain name of the Route that will be  created to expose the Entando Runtime Service using HTTP without SSL. This variable  is often used to connect to from the App Builder. You therefore need to make sure that it is accessible from outside the Openshift cluster.</p>
</li>
<li>
<p><strong><a href="#image_stream_tag">ENTANDO_IMAGE_VERSION</a></strong> - the version number of the Entando images that will be used. In Docker, this will be the 'tag' segment of the Image repository reference. In Openshift, this will be the name of a Tag in the ImageStreams that will be used to bind all  S2I BuildConfigs and  DeploymentConfigs to. This generally corresponds with the version of Entando being used.</p>
</li>
<li>
<p><strong><a href="#image_stream_namespace">IMAGE_STREAM_NAMESPACE</a></strong> - the name of the Openshift project that contains all the  ImageStreams required for the Template  in question. If the ImageStreams were created in the default 'openshift' project,  Openshift will automatically add it to  its application catalog. It is however possible to store them in any   project, including the project that the current Template is being instantiated in.</p>
</li>
<li>
<p><strong><a href="#kie_server_baseurl">KIE_SERVER_BASE_URL</a></strong> - The base URL where a KIE Server instance is hosted, e.g. <a href="http://entando-kieserver701.apps.serv.run/" class="bare">http://entando-kieserver701.apps.serv.run/</a></p>
</li>
<li>
<p><strong><a href="#kie_server_username">KIE_SERVER_USERNAME</a></strong> - The username of a user that be used to log into the above-mentioned KIE Server</p>
</li>
<li>
<p><strong><a href="#kie_server_password">KIE_SERVER_PASSWORD</a></strong> -The password of the above-mentioned KIE Server user.</p>
</li>
<li>
<p><strong><a href="#volume_capacity">VOLUME_CAPACITY</a></strong> - the amount of storage space to be allocated to the Entando App. This needs to be large enough for documents and images that are uploaded, database backups that need to be made,  and the indices that Entando generates. Depending  on the exact template, this may aslo include the space required for the embedded Derby database.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Example Installation Script</div>
<p><a href="https://github.com/entando/entando-ops/blob/EN-2348/Openshift/installers/install-fsi-ccd-demo.sh" class="bare">https://github.com/entando/entando-ops/blob/EN-2348/Openshift/installers/install-fsi-ccd-demo.sh</a></p>
</div>
<div class="paragraph">
<p>You can navigate to the most significant URL&#8217;s from you browser by clicking on the URL&#8217;s of the following Routes.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Entando Customer App: click on the  <code>entando-fsi-ccd-demo-ccd-customer-engine-http</code> Route</p>
</li>
<li>
<p>AppBuilder for the Customer App: click on the  <code>entando-fsi-ccd-demo-ccd-customer-appbuilder</code> Route</p>
</li>
<li>
<p>The Entando Back Office App: click on the  <code>entando-fsi-ccd-demo-ccd-admin-engine-http</code> Route</p>
</li>
<li>
<p>AppBuilder for the Back Office App: click on the  <code>entando-fsi-ccd-demo-ccd-admin-appbuilder</code> Route</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Persistent Volume Claims</div>
<ul>
<li>
<p><strong>entando-fsi-ccd-demo-ccd-customer-claim</strong> Contains the two embedded Derby databases for the Customer App</p>
</li>
<li>
<p><strong>entando-fsi-ccd-demo-ccd-admin-claim</strong> Contains the two embedded Derby databases for the Back Office App</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="building-your-own-entando-images"><a class="anchor" href="#building-your-own-entando-images"></a>Building your own Entando images</h5>
<div class="paragraph">
<p>The first couple of Openshift examples illustrate how the end product of an Entando App can be deployed on Openshift in
the form of pre-built images. However, Openshift also allows for the images to be built on the Openshift platform itself.
In this section we will have a closer look at some of the Templates and S2I builder images that can be used to package
and deploy your Entand App Image</p>
</div>
<div class="sect5">
<h6 id="quickstart-template"><a class="anchor" href="#quickstart-template"></a>Quickstart Template</h6>
<div class="paragraph">
<p>We looked briefly at the Entando <a href="#openshift-quickstart">Openshift Quick Start</a> Template in an earlier section in this chapter. You can
download the template from Gitub. This section will explore the Quickstart template in a bit more detail.</p>
</div>
<div class="paragraph">
<p>Please note that this template is not intended for use in a production environment. The embedded Derby database is
not cluster safe. The <a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/s2i-images/entando-eap71-quickstart-openshift">Entando EAP 7.1 Openshift Quickstart Image (entando/entando-eap71-quickstart-openshift:latest)</a> used in this template also does not have
JGroups configured on EAP and therefore cannot support our Infinispan plugin for a cluster safe cache.</p>
</div>
<div class="paragraph">
<p>Please note that this configuration uses a child image of the official JBoss EAP commercial Docker Image. This would mean that  in order to deploy this in a production environment, you would need to purchase the necessary subscription from Red Hat first.</p>
</div>
<div class="ulist">
<div class="title">Template Location</div>
<ul>
<li>
<p><a href="https://raw.githubusercontent.com/entando/entando-ops/EN-2348/Openshift/templates/entando-eap71-quickstart.yml" class="bare">https://raw.githubusercontent.com/entando/entando-ops/EN-2348/Openshift/templates/entando-eap71-quickstart.yml</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Images used</div>
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/appbuilder">Entando App Builder Image (entando/appbuilder:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/s2i-images/entando-eap71-quickstart-openshift">Entando EAP 7.1 Openshift Quickstart Image (entando/entando-eap71-quickstart-openshift:latest)</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisite Image Streams</div>
<ul>
<li>
<p>Entando AppBuilder Image stream: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json</a></p>
</li>
<li>
<p>Entando EAP 7.1 Quickstart Openshift Image Stream: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-eap71-quickstart-openshift.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-eap71-quickstart-openshift.json</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Parameters</div>
<ul>
<li>
<p><strong>APPLICATION_NAME</strong> - an Openshift compliant name that can be used as a prefix to automatically  generate names for related objects in the Template</p>
</li>
<li>
<p><strong>ENTANDO_IMAGE_VERSION</strong> - the version number of the Entando images that will be used. In Docker, this will be the 'tag' segment of the Image repository reference. In Openshift, this will be the name of a Tag in the ImageStreams that will be used to bind all  S2I BuildConfigs and  DeploymentConfigs to. This generally corresponds with the version of Entando being used.</p>
</li>
<li>
<p><strong>ENTANDO_APP_BUILDER_HOSTNAME</strong> - the fully qualified domain name of the Route that will be  created to expose the Entando App Builder JavaScript App  using HTTP without SSL.</p>
</li>
<li>
<p><strong>ENTANDO_ENGINE_HOSTNAME</strong> - the fully qualified domain name of the Route that will be  created to expose the Entando Runtime Service using HTTP without SSL. This variable  is often used to connect to from the App Builder. You therefore need to make sure that it is accessible from outside the Openshift cluster.</p>
</li>
<li>
<p><strong>ENTANDO_ENGINE_WEB_CONTEXT</strong> - the context root  of the Entando Web Application. This is the context  on the JEE server that will be used to dispatch requests to the Entando Web Application. Generally this would be the same as the APPLICATION_NAME. In typical JEE deployments this would be the name of the war file, excluding the '.war' extension and prefixed with a slash (/). In typical Maven projects, this would be the value of the &lt;finalName&gt; element in the pom.xml</p>
</li>
<li>
<p><strong>KIE_SERVER_BASE_URL</strong> - The base URL where a KIE Server instance is hosted, e.g. <a href="http://entando-kieserver701.apps.serv.run/" class="bare">http://entando-kieserver701.apps.serv.run/</a></p>
</li>
<li>
<p><strong>KIE_SERVER_USERNAME</strong> - The username of a user that be used to log into the above-mentioned KIE Server</p>
</li>
<li>
<p><strong>KIE_SERVER_PASSWORD</strong> - The password of the above-mentioned KIE Server user.</p>
</li>
<li>
<p><strong>SOURCE_REPOSITORY_URL</strong> - the full URL of the source repository where the source code of the image that needs to be built can be found</p>
</li>
<li>
<p><strong>SOURCE_REPOSITORY_REF</strong> - the branch or tag that will be checked out from the source repository specified at the SOURCE_REPOSITORY_URL</p>
</li>
<li>
<p><strong>SOURCE_SECRET</strong> - the Openshift Secret containing the Username and Password for the source repository specified at the SOURCE_REPOSITORY_URL</p>
</li>
<li>
<p><strong>CONTEXT_DIR</strong> - the relative directory inside the source repository from which the build should be  executed.</p>
</li>
<li>
<p><strong>VOLUME_CAPACITY</strong> the amount of storage space to be allocated to the Entando App. This needs to be large enough for documents and images that are uploaded, database backups that need to be made,  and the indices that Entando generates. Depending  on the exact template, this may aslo include the space required for the embedded Derby database.</p>
</li>
<li>
<p><strong>GITHUB_WEBHOOK_SECRET</strong> - Github webhook secret that can be used from Github to trigger builds on this BuildConfig in the Openshift cluster</p>
</li>
<li>
<p><strong>GENERIC_WEBHOOK_SECRET</strong> - Generic webhook secret that can be used from any generic SCM tool to trigger builds on this BuildConfig in the Openshift cluster</p>
</li>
<li>
<p><strong>IMAGE_STREAM_NAMESPACE</strong> - the name of the Openshift project that contains all the  ImageStreams required for the Template  in question. If the ImageStreams were created in the default 'openshift' project,  Openshift will automatically add it to  its application catalog. It is however possible to store them in any   project, including the project that the current Template is being instantiated in.</p>
</li>
<li>
<p><strong>MAVEN_MIRROR_URL</strong> - Maven mirror to use for S2I builds. Specifying a Maven mirror such as Nexus, running in the same cluster can significantly speed up build execution.</p>
</li>
<li>
<p><strong>MAVEN_ARGS_APPEND</strong> - additional Maven arguments that will be appended to the standard Maven command used in the S2I build</p>
</li>
<li>
<p><strong>ARTIFACT_DIR</strong> - List of directories from which archives will be copied into the deployment folder. If unspecified, all archives in /target will be copied.</p>
</li>
<li>
<p><strong>MEMORY_LIMIT</strong> - the maximum amount of memory to be allocated to the Entando JEE App.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Example Installation Script</div>
<p><a href="https://github.com/entando/entando-ops/blob/EN-2348/Openshift/installers/install-entando-eap71-quickstart.sh" class="bare">https://github.com/entando/entando-ops/blob/EN-2348/Openshift/installers/install-entando-eap71-quickstart.sh</a></p>
</div>
<div class="paragraph">
<div class="title">Important URLS</div>
<p>The URLs you can access after the template was installed depends on the value of the relevant parameters you have provided
Use the standard admin username/password combination admin/adminadmin to log into both URLs.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Entando App: 'http://<a href="#entando_runtime_hostname_http">$ENTANDO_ENGINE_HOSTNAME</a>/<a href="#entando_web_context">$ENTANDO_ENGINE_WEB_CONTEXT</a>'</p>
</li>
<li>
<p>AppBuilder: 'http://<a href="#entando_app_builder_hostname_http">$ENTANDO_APP_BUILDER_HOSTNAME</a>/'</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Persistent Volume Claims</div>
<ul>
<li>
<p><strong>$APPLICATION_NAME-entando-claim</strong> - contains the two embedded Derby databases for the Entando App, along wth files that
will be uploaded, database backups and indices. (Replace $APPPLICATION_NAME with the value you provided for
the APPLICATION_NAME parameter)</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Usage Notes</div>
<p>After installing the Entando EAP Quickstart Template, you will find two BuildConfigurations with following generated names:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>$APPLICATION_NAME-s2i-dbrebuild</p>
</li>
<li>
<p>$APPLICATION_NAME-s2i-fast</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The primary difference is that 'DB Rebuild' BuildConfig, as it name implies, rebuilds the database from scratch, and
restores the database backup (if any) that was stored in the Maven project. If the database backup was created from Entando
running locally using <code>mvn jetty:run</code>, the database backup will be stored in the relative directory <code>src/main/webapp/protected</code>.
If this 'DB Rebuild' build detects a backup in that directory, it restores the database to that backup&#8217;s state.
Unfortunately this database rebuild adds significantly to the build execution time. If you have not modified anying
in your database state, you can perform the "Fast" build, which only builds the war file.</p>
</div>
<div class="paragraph">
<p>It is quite important to keep track of what will be happening to the Persistent Volumne when a container is started from
an Image that has been built using the 'DB Rebuild' process. On startup, the container it first checks if the database
that it contains inside the Image is newer than the database in the Persistent Volume. If so, it deletes the existing
databases from the Persistent Volume and copies the new ones across from the Image. After this, you are free to
add content to the database, but keep in mind that a 'DB Rebuild' could potentially destroy that content. It
is therefore still advisable to rather add content from an Entando instance that
was started using <code>mvn jetty:run</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="entando-jboss-eap-and-postgresql-template"><a class="anchor" href="#entando-jboss-eap-and-postgresql-template"></a>Entando JBoss EAP and PostgreSQL Template</h6>
<div class="paragraph">
<p>For production environments that do not require a shared CMS environment, in other words, the <a href="#fine-grained-apps">Fine Grained Apps</a>
use case, we recommend the entando-eap71-postgresql95-persistent template. This Template introduces a configuration for
JBoss EAP that has the clustered caches configured for Entando&#8217;s Infinispan plugin. It also introduces a PostgreSQL 9.5
DeploymentConfig with pre-configured connectivity from the JBoss EAP DeploymentConfig to the resulting PostgreSQL
service. In addition, it also introduces a S2I BuildConfig for the PostgreSQL image that will rebuild the PostgreSQL
database based on the state of the Maven project. You can download the template from Github.</p>
</div>
<div class="paragraph">
<p>Please note that this configuration uses a child image of the official JBoss EAP commercial Docker Image. This would mean that  in order to deploy this in a production environment, you would need to purchase the necessary subscription from Red Hat first.</p>
</div>
<div class="ulist">
<div class="title">Template Location</div>
<ul>
<li>
<p><a href="https://raw.githubusercontent.com/entando/entando-ops/EN-2348/Openshift/templates/entando-eap71-with-postgresql95.yml" class="bare">https://raw.githubusercontent.com/entando/entando-ops/EN-2348/Openshift/templates/entando-eap71-with-postgresql95.yml</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Images used</div>
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Docker/Production/entando-full-stack/appbuilder">Entando App Builder Image (entando/appbuilder:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/s2i-images/entando-eap71-clustered-openshift">Entando EAP 7.1 Clustered Openshift Image (entando/entando-eap71-clustered-openshift:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/s2i-images/entando-postgresql95-openshift">Entando PostgreSQL 9.5 Openshift S2I Image (entando/entando-postgresql95-openshift:latest)</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisite Image Streams</div>
<ul>
<li>
<p>Entando AppBuilder Image stream: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/appbuilder.json</a></p>
</li>
<li>
<p>Entando EAP 7.1 Clustered Openshift Image Stream: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-eap71-clustered-openshift.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-eap71-clustered-openshift.json</a></p>
</li>
<li>
<p>Entando PostgreSQL 9.5 Openshift Image Stream: <a href="https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-postgresql95-openshift.json" class="bare">https://raw.githubusercontent.com/entando/entando-ops/master/Openshift/image-streams/entando-postgresql95-openshift.json</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Parameters</div>
<ul>
<li>
<p><strong>APPLICATION_NAME</strong> - an Openshift compliant name that can be used as a prefix to automatically  generate names for related objects in the Template</p>
</li>
<li>
<p><strong>ENTANDO_IMAGE_VERSION</strong> - the version number of the Entando images that will be used. In Docker, this will be the 'tag' segment of the Image repository reference. In Openshift, this will be the name of a Tag in the ImageStreams that will be used to bind all  S2I BuildConfigs and  DeploymentConfigs to. This generally corresponds with the version of Entando being used.</p>
</li>
<li>
<p><strong>ENTANDO_APP_BUILDER_HOSTNAME</strong> - the fully qualified domain name of the Route that will be  created to expose the Entando App Builder JavaScript App  using HTTP without SSL.</p>
</li>
<li>
<p><strong>ENTANDO_ENGINE_HOSTNAME</strong> - the fully qualified domain name of the Route that will be  created to expose the Entando Runtime Service using HTTP without SSL. This variable  is often used to connect to from the App Builder. You therefore need to make sure that it is accessible from outside the Openshift cluster.</p>
</li>
<li>
<p><strong>ENTANDO_ENGINE_BASEURL</strong> - The full URL that AppBuilder must use to connect to the Entando Runtime. This parameter is required in situations where AppBuilder can connet to the Entando Runtime using either HTTP or HTTPS. AppBuilder does not work well with self-signed certificates so for test environments you may sometimes fall back on the HTTP Route. Also keep in mind that you may need to append the web context that the Entando app is served at by the JEE servlet container.</p>
</li>
<li>
<p><strong>SOURCE_REPOSITORY_URL</strong> - the full URL of the source repository where the source code of the image that needs to be built can be found</p>
</li>
<li>
<p><strong>SOURCE_REPOSITORY_REF</strong> - the branch or tag that will be checked out from the source repository specified at the SOURCE_REPOSITORY_URL</p>
</li>
<li>
<p><strong>SOURCE_SECRET</strong> - the Openshift Secret containing the Username and Password for the source repository specified at the SOURCE_REPOSITORY_URL</p>
</li>
<li>
<p><strong>CONTEXT_DIR</strong> - the relative directory inside the source repository from which the build should be  executed.</p>
</li>
<li>
<p><strong>ENTANDO_PORT_DATABASE</strong> - the name of the Entando PORT database that is created and hosted in the image</p>
</li>
<li>
<p><strong>ENTANDO_SERV_DATABASE</strong> - - the name of the Entando SERV database that is created and hosted in the image</p>
</li>
<li>
<p><strong>DB_SECRET</strong> - the Openshift secret containing the username and password to be used for the Entando user on PostgreSQL</p>
</li>
<li>
<p><strong>ENTANDO_OIDC_ACTIVE</strong> - set this variable&#8217;s value to "true" to activate Entando&#8217;s Open ID Connect and the related OAuth authentication infrastructure. If set to "false" all the subsequent OIDC  variables will be ignored. Once activated, you may need to log into Entando using the following url: &lt;application_base_url&gt;/&lt;lang_code&gt;/&lt;any_public_page_code&gt;.page?username=&lt;MY_USERNAME&gt;&amp;password=&lt;MY_PASSWORD&gt;</p>
</li>
<li>
<p><strong>ENTANDO_OIDC_AUTH_LOCATION</strong> - the URL of the authentication service, e.g. the 'login page' that Entando needs to redirect the user to in order to  allow the OAuth provider to authenticate the user.</p>
</li>
<li>
<p><strong>ENTANDO_OIDC_TOKEN_LOCATION</strong> - the URL of the token service where Entando can retrieve the OAuth token from after authentication</p>
</li>
<li>
<p><strong>ENTANDO_OIDC_CLIENT_ID</strong> - the Client ID that uniquely identifies the Entando App in the OAuth provider&#8217;s configuration</p>
</li>
<li>
<p><strong>ENTANDO_OIDC_REDIRECT_BASE_URL</strong> - the optional base URL, typically the protocol, host and port (<a href="https://some.host.com:8080/" class="bare">https://some.host.com:8080/</a>) that will be prepended to the path segment of the URL requested by the user and provided as a redirect URL to the OAuth provider. If empty, the requested URL will be used as is.</p>
</li>
<li>
<p><strong>KIE_SERVER_SECRET</strong> - the Openshift secret containing the 'username', 'password', 'url' that would provide access to a RedHat Process Automation Manager instance</p>
</li>
<li>
<p><strong>VOLUME_CAPACITY</strong> the amount of storage space to be allocated to the Entando App. This needs to be large enough for documents and images that are uploaded, database backups that need to be made,  and the indices that Entando generates. Depending  on the exact template, this may aslo include the space required for the embedded Derby database.</p>
</li>
<li>
<p><strong>HTTPS_SECRET</strong>  - the name of the secret containing the keystore file</p>
</li>
<li>
<p><strong>HTTPS_KEYSTORE</strong> - the name of the keystore file within the secret</p>
</li>
<li>
<p><strong>HTTPS_KEYSTORE_TYPE</strong> -the type of the keystore file (JKS or JCEKS)</p>
</li>
<li>
<p><strong>HTTPS_NAME</strong> -the name associated with the server certificate</p>
</li>
<li>
<p><strong>HTTPS_PASSWORD</strong> - the password for the keystore and certificate</p>
</li>
<li>
<p><strong>DB_MIN_POOL_SIZE</strong> - sets xa-pool/min-pool-size for the configured datasource.</p>
</li>
<li>
<p><strong>DB_MAX_POOL_SIZE</strong> - sets xa-pool/max-pool-size for the configured datasource.</p>
</li>
<li>
<p><strong>DB_TX_ISOLATION</strong> - sets transaction-isolation for the configured datasource.</p>
</li>
<li>
<p><strong>POSTGRESQL_MAX_CONNECTIONS</strong> - the maximum number of client connections allowed. This also sets the maximum number of prepared transactions.</p>
</li>
<li>
<p><strong>POSTGRESQL_SHARED_BUFFERS</strong> - configures how much memory is dedicated to PostgreSQL for caching data.</p>
</li>
<li>
<p><strong>GITHUB_WEBHOOK_SECRET</strong> - Github webhook secret that can be used from Github to trigger builds on this BuildConfig in the Openshift cluster</p>
</li>
<li>
<p><strong>GENERIC_WEBHOOK_SECRET</strong> - Generic webhook secret that can be used from any generic SCM tool to trigger builds on this BuildConfig in the Openshift cluster</p>
</li>
<li>
<p><strong>IMAGE_STREAM_NAMESPACE</strong> - the name of the Openshift project that contains all the  ImageStreams required for the Template  in question. If the ImageStreams were created in the default 'openshift' project,  Openshift will automatically add it to  its application catalog. It is however possible to store them in any   project, including the project that the current Template is being instantiated in.</p>
</li>
<li>
<p><strong>MAVEN_MIRROR_URL</strong> - Maven mirror to use for S2I builds. Specifying a Maven mirror such as Nexus, running in the same cluster can significantly speed up build execution.</p>
</li>
<li>
<p><strong>MAVEN_ARGS_APPEND</strong> - additional Maven arguments that will be appended to the standard Maven command used in the S2I build</p>
</li>
<li>
<p><strong>JGROUPS_ENCRYPT_SECRET</strong> - - the name of the secret containing the keystore file</p>
</li>
<li>
<p><strong>JGROUPS_ENCRYPT_KEYSTORE</strong> - - the name of the keystore file within the secret</p>
</li>
<li>
<p><strong>JGROUPS_ENCRYPT_NAME</strong> - - the name or alias of the kesytore entry containing the server certificate</p>
</li>
<li>
<p><strong>JGROUPS_ENCRYPT_PASSWORD</strong> - - the password for the keystore and certificate</p>
</li>
<li>
<p><strong>JGROUPS_PING_PROTOCOL</strong> - - JGroups protocol to use for node discovery. Can be either openshift.DNS_PING or openshift.KUBE_PING.</p>
</li>
<li>
<p><strong>JGROUPS_CLUSTER_PASSWORD</strong> --JGroups cluster password</p>
</li>
<li>
<p><strong>ARTIFACT_DIR</strong> - List of directories from which archives will be copied into the deployment folder. If unspecified, all archives in /target will be copied.</p>
</li>
<li>
<p><strong>MEMORY_LIMIT</strong> - the maximum amount of memory to be allocated to the Entando JEE App.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Example Installation Script</div>
<p><a href="https://github.com/entando/entando-ops/blob/EN-2348/Openshift/installers/install-entando-eap71-with-postgresql95.sh" class="bare">https://github.com/entando/entando-ops/blob/EN-2348/Openshift/installers/install-entando-eap71-with-postgresql95.sh</a></p>
</div>
<div class="paragraph">
<div class="title">Important URLS</div>
<p>The URLs you can access after the template was installed depends on the value of the relevant parameters you have provided
Use the standard admin username/password combination admin/adminadmin to log into both URLs.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Entando App: the value of the ENTANDO_ENGINE_BASEURL parameter</p>
</li>
<li>
<p>AppBuilder: the valule of the ENTANDO_APP_BUILDER_HOSTNAME parameter</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Persistent Volume Claims</div>
<ul>
<li>
<p><strong>$APPLICATION_NAME-entando-claim</strong> - the Persistent Volume where files  will be uploaded, database backups will be made and
 indices will be generated. (Replace $APPPLICATION_NAME with the value you provided for
the APPLICATION_NAME parameter)</p>
</li>
<li>
<p><strong>$APPLICATION_NAME-postgresql-claim</strong> - the Persistent Volume where the PostgreSQL server will store all its databases.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Usage Notes</div>
<p>After installing the Entando EAP Quickstart Template, you will find two BuildConfigurations with following generated names:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>$APPLICATION_NAME-s2i</strong> This is the standard EAP 7.1 S2I build that will generate a war file from the Maven project,
and contribute it to the resulting image at the location /opt/eap/standalone/deployments.</p>
</li>
<li>
<p><strong>$APPLICATION_NAME-postgresql-s2i</strong> This BuildConfig recreates a PostgreSQL database from the Maven project. It will
invoke all the necessary Entando plugins to ensure that the database schema reflects the current selection of Entando
plugins. If there is a database backup in the Maven project, it will restore that backup to the newly created database.
It there are any binary, 'tar' format backups, it will restore these backups. If you have been developing locally
on Entando using <code>mvn jetty:run</code>, you would need to run this build config every time you have changed the database which
you subsequently backed up.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Generating all the necessary keystores for this template can be quite a laborious task. Please work through our sample
installation script to see one approach of doing it. It is also perfectly acceptable not to use the HTTPS passthrouhg
Routes created by this Template, but instead create your own HTTPS edge Routes in Openshift.</p>
</div>
<div class="paragraph">
<p>You will notice that the default configuration of our PostgreSQL container does not support clustering (i.e.
its replciation count = 1). You are of course free to change this configuration yourself. However, keep
in mind that this Template only targets the Entando <a href="#fine-grained-apps">Fine Grained Apps</a> use case. Consider the following
before venturing into the complexity of setting up a clustered PostgreSQL server on Openshift for the fine grained
use case:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you map this Template&#8217;s PersistentVolumeClaims to a cluster safe, redundant, network file system such as Gluster,
you have addressed most of your requirements for redundant persistence.</p>
</li>
<li>
<p>Openshift&#8217;s replication controller will automatically restart this Pod if it crashes for some reason.</p>
</li>
<li>
<p>Entando itself is configured here with a clustered cache. For find grained apps, the majority of operations to
the database would be read-only and will therefore benefit signiciantly from the cache. Clustering the database
server would not add significantly to performance in this scenario.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Some shortcomings of the EAP/PostgreSQL template</div>
<ul>
<li>
<p>It doesn&#8217;t enforce a strict sequence of events that would ensure that the database is in the correct state before
the EAP Image is deployed. It is up to the DevOps professionals to ensure the database is in the correct state before
a new version of the EAP image is deployed.</p>
</li>
<li>
<p>This template runs a build on the same infrastructure as the deployment. This is not acceptable for a production
deployment. One would rather promote the images built in the CI/CD environment to production than rebuild them.
It is up to the DevOps professional to promote the correct images at the same time to production.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="entando-imagick-s2i-image"><a class="anchor" href="#entando-imagick-s2i-image"></a>Entando Imagick S2I Image</h5>
<div class="paragraph">
<p>The Entando Imagick S2I Image is the only image that can be used safely for environments where you require a shared
CMS environment, and therefore the Entando <a href="#coarse-grained-apps">Coarse Grained Apps</a> use case. The reason for this is that it
has the Imagick image manipulation package installed on Red Hat Linux.
This package is required for uploaded images when it needs to be cropped or edited in other ways.</p>
</div>
<div class="paragraph">
<p>Please note that this configuration uses a child image of the official JBoss EAP commercial Docker Image. This would mean that  in order to deploy this in a production environment, you would need to purchase the necessary subscription from Red Hat first.</p>
</div>
<div class="paragraph">
<p>Currently you need to install this image manually, as the Template to install this image is still under development. The
image itself is also only a very basic extension of the original JBoss EAP image. Consider using it only if you are
already familiar  with the JBoss EAP image
(<a href="https://access.redhat.com/containers/?tab=overview#/registry.access.redhat.com/jboss-eap-7/eap71-openshift" class="bare">https://access.redhat.com/containers/?tab=overview#/registry.access.redhat.com/jboss-eap-7/eap71-openshift</a>). This image
is also only available on Red Hat&#8217;s container marketplace (registry.connect.redhat.com)</p>
</div>
<div class="olist arabic">
<div class="title">Prerequisites</div>
<ol class="arabic">
<li>
<p>Official Entando EAP 7.1.x Openshift Image downloaded from Red Hat container catalog (<a href="https://access.redhat.com/containers/" class="bare">https://access.redhat.com/containers/</a>)</p>
</li>
<li>
<p>An openshift cluster up and running ≥ 3.6.1</p>
</li>
<li>
<p>Openshift client tools (same version of the Openshift cluster)</p>
</li>
<li>
<p>An entando project ≥ 4.3.2-cloud-native release reachable by the openshift cluster instance (github, bitbucker or your corporate VCS server)</p>
</li>
<li>
<p>JBoss xml configuration file (<a href="https://pastebin.com/irnuyZM6">standalone-openshift.xml</a>). Take note specifically of the environment variables (${env.XYZ}) as we will be using those to configure the data sources.</p>
</li>
<li>
<p>A Postgresql server DB already configured with the entando port and serv databases</p>
</li>
<li>
<p>A good knowledge of Openshift platform and JBoss is required</p>
</li>
<li>
<p>A good knowledge of the configuration settings of the entando framework(where the configuration files are located)</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Installing Entando Imagick S2I image</div>
<ol class="arabic">
<li>
<p>Create a project in Openshift
We have to login to our Openshift instance with a user that has the permission to create a project so from the cli we are going to execute this command:</p>
<div class="literalblock">
<div class="content">
<pre>oc new-project [name of your project]</pre>
</div>
</div>
</li>
<li>
<p>Import the official Entando EAP 7.1.x image
We have to execute this command to import the official entando EAP 7.1.x image from the Red Hat container marketplace. Just remember that we will be able to import the image only if we have a valid user account from Red Hat (a simple developer account will be ok) that we are going to use to create a secret for authenticating us during the download procedure.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>So the first thing to do is to create a secret:</p>
<div class="literalblock">
<div class="content">
<pre>oc create secret docker-registry [name of your secret] --docker-username=[your redhat uid] --docker-password=[your redhat password] --docker-server=registry.connect.redhat.com --docker-email=[your email]</pre>
</div>
</div>
</li>
<li>
<p>The second one is to link the secret with the default serviceaccount for pulling the image:</p>
<div class="literalblock">
<div class="content">
<pre>oc secrets link default [yout secret name] --for=pull</pre>
</div>
</div>
</li>
<li>
<p>Now we can import the builder image on our project:</p>
<div class="literalblock">
<div class="content">
<pre>oc import-image [name of your imported image] --from=registry.connect.redhat.com/entando/entando-eap71-openshift-imagick --confirm</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Set permissions to allow pods to see each other in the cluster.
We have to to give the view permission to the system serviceaccount to let the pods see each other in the cluster:</p>
<div class="literalblock">
<div class="content">
<pre>oc policy add-role-to-user view system:serviceaccount:$(oc project -q):default -n $(oc project -q)</pre>
</div>
</div>
</li>
<li>
<p>Create a new app with the downloaded builder image. To create the entando application we have to execute this command:</p>
<div class="literalblock">
<div class="content">
<pre>oc new-app --name=[name of your application] [name of your imported image]~https://[your vcs server repository containing the entando project] \    -p PG_USERNAME=[agile] \
 -p PG_PASSWORD=[agile] \
 -p PG_ENTANDO_PORT_DB_JNDI_NAME=[JNDI for the port DB] \
 -p PG_ENTANDO_SERV_DB_JNDI_NAME=[JNDI for the serv DB] \
 -p PG_ENTANDO_PORT_DB_CONNECTION_STRING=[host:port/DB] \
 -p PG_ENTANDO_SERV_DB_CONNECTION_STRING=[host:port/DB] \
 -p OPENSHIFT_KUBE_PING_NAMESPACE=[name of the openshift project] \
 -p OPENSHIFT_KUBE_PING_LABELS=[app=[name of the entando application in Openshift]] \
 -p JGROUPS_CLUSTER_PASSWORD[random chars] \
 -p OPENSHIFT_KUBE_PING_PORT_NAME=ping \
 -p MAVEN_MIRROR_URL=[nexus url for entando maven dependencies] \
 -p JAVA_OPTS_APPEND=-Dfile.encoding=UTF-8</pre>
</div>
</div>
</li>
<li>
<p>Patch the deployment configuration.  Now that we have the entando application deployed we need to patch it to have the clustering work correctly:</p>
<div class="literalblock">
<div class="content">
<pre>oc patch dc/[your app name] -p '[{"op": "replace", "path": "/spec/template/spec/containers/0/ports/3", "value": {"name":"ping","containerPort":8888,"protocol":"TCP"}}]' --type=json</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="jenkins-pipelines"><a class="anchor" href="#jenkins-pipelines"></a>4.2.18. Jenkins Pipelines</h4>
<div class="paragraph">
<p>Up to this point, the templates we have looked at all used Openshift&#8217;s "Source-to-image" BuildConfigs. In these
templates deployments are automatically triggered when such a BuildConfig produces a new version of an image.
This process works fairly well for most use cases, but sometimes business requires more control over exactly how
the promotion of the various deployment elements (e.g. the database state, the Docker images and the uploaded files)
is co-ordinated. For these slightly more complex use cases, Openshift offers another type of
BuildConfig: Jenkins pipelines.</p>
</div>
<div class="paragraph">
<p>Whereas S2I BuildConfigs are typically focused on producing a single image, Jenkins pipelines are typically used for more
coarse grained builds involving one or more images and the promotion of other build elements such as databases,
configuration data and other supporting data. Jenkins has an elegant Groovy based syntax to declare pipelines. It instantiates
images automatically for the build process based on the label that the pipeline specifies. Here is an example of
a simple pipeline</p>
</div>
<div class="literalblock">
<div class="content">
<pre>def templatePath = 'https://raw.githubusercontent.com/openshift/nodejs-ex/master/openshift/templates/nodejs-mongodb.json'
def templateName = 'nodejs-mongodb-example'
pipeline {
    agent {
      node {
        // spin up a node.js slave pod to run this build on
        label 'nodejs'
      }
    }
    options {
        // set a timeout of 20 minutes for this pipeline
        timeout(time: 20, unit: 'MINUTES')
    }
    stages {
        stage('preamble') {
            steps {
                script {
                    openshift.withCluster() {
                        openshift.withProject() {
                            echo "Using project: ${openshift.project()}"
                        }
                    }
                }
            }
        }
        stage('cleanup') {
            steps {
                script {
                    openshift.withCluster() {
                        openshift.withProject() {
                            // delete everything with this template label
                            openshift.selector("all", [ template : templateName ]).delete()
                            // delete any secrets with this template label
                            if (openshift.selector("secrets", templateName).exists()) {
                                openshift.selector("secrets", templateName).delete()
                            }
                        }
                    }
                } // script
            } // steps
        } // stage
    } // stages
} // pipeline</pre>
</div>
</div>
<div class="paragraph">
<p>In this particular example, the pipeline specifies that it needs a container with the label 'nodejs' to perform the various
build stages on. Once can also specificy a different agent for each stage. Stages are broken down into steps that are all
performed on the same container. In this example, steps are defined using Groovy scripts that use a Groovy based
API to perform operations on the current cluster. One can also define simple shell script steps.</p>
</div>
<div class="paragraph">
<p>Jenkins Pipelines solve a very important problem when releasing Entando Apps that would be very difficult to solve
with simple S2I builds - co-ordinating database migration with the deployment of new versions of the Entando App&#8217;s image.
Entando&#8217;s current automated database migration operations are relatively high risk, bulk database operations. While
a table is being recreated, active instances of the previous version of the Entando App could fail. Their caches
will go out of sync and the server side of the Entando App could end up in an unpredictable, potential invalid state.
For this reason, it is best to shut down all Entando App instances running against a database before migrating the
database. Such a process can be fairly easily orchestrated from a Jenkins Pipelines.</p>
</div>
<div class="paragraph">
<p>Pipelines can span over multiple Openshift clusters too. This make them particularly useful for running a pipeline that
needs to co-ordinate build tasks that span multiple clusters.</p>
</div>
<div class="paragraph">
<p>Another aspect of the Openshift Jenkins Pipeline integration that makes it worth your while is that most of the
integration is done on a Kubernetes level and therefore doesn&#8217;t require Openshift. This would be very
encouraging for those that are interested in 'vanilla' Kubernetes deployment. In future, we hope to provide similar
Jenkins Pipeline solutions for other container orchestration vendors too.</p>
</div>
<div class="paragraph">
<p>Pipelines can also make use of custom Docker images for agents, or Jenkins Slaves as they are commonly called.
We use this technique extensively in our Entando Reference pipeline. We have a Jenkins Slave image that comes
with Entando&#8217;s dependencies pre-cached, and another that can update a remote PostgreSQL server with the database
changes required for a specific Entando App. For more information about these images, have a look at their
documentation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/supporting-images/entando-maven-jenkins-slave-openshift39">Entando Maven Jenkins Slave Image for Openshift 3.9 (entando/entando-maven-jenkins-slave-openshift39:latest)</a></p>
</li>
<li>
<p><a href="https://github.com/entando/entando-ops/tree/EN-2348/Openshift/supporting-images/entando-postgresql-jenkins-slave-openshift39">Entando PostgreSQL Client Jenkins Slave Image for Openshift 3.9 (entando/entando-postgresql-jenkins-slave-openshift39:latest)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is important to note that our current Jenkins Pipelines and the supporting Jenkins Slave Images only cater
for the <a href="#fine-grained-apps">Fine Grained Apps</a> use case of Entando. It therefore assumes that the database needs to be
rebuilt from the Entando project every time a new instance of the app is deployed. Your existing database
will be backed up, but the new database will be based entirely on the state of the last database backup in
the your Entando App&#8217;s Maven project under src/main/webapp/protected.</p>
</div>
<div class="paragraph">
<p>There are plans to support the <a href="#coarse-grained-apps">Coarse Grained Apps</a> use case too. In fact, we started using Pipelines specifically
to find ways to support more complex database migration scenarios, and we believe that the solution for the
<a href="#coarse-grained-apps">Coarse Grained Apps</a> scenarios will be found in this space.</p>
</div>
<div class="sect4">
<h5 id="entando-reference-pipeline"><a class="anchor" href="#entando-reference-pipeline"></a>Entando Reference Pipeline</h5>
<div class="paragraph">
<p>Entando&#8217;s first reference Pipeline for Openshift based environments was based on Chapter 4
of the book <em>DevOps with OpenShift</em> which is available online at
<a href="https://www.oreilly.com/library/view/devops-with-openshift/9781491975954/ch04.html" class="bare">https://www.oreilly.com/library/view/devops-with-openshift/9781491975954/ch04.html</a>. The overall architecture
of this Pipeline is described quite accurately in the following diagram:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/BestPracticesPipeline.png" alt="Best Practice">
</div>
</div>
<div class="paragraph">
<p>In thise 'Best Practices' Pipeline, all the projects run in the same cluster. All the CI/CD elements reside
in a separate project depicted as the rectangle at the top of the diagram. The resulting Images are then
published to ImageStreams in the Development project, depicted as a rectangle on the left. Note that, even
though it does not preclude the use of an external Docker registry, all access to the Docker registry is mediated
by the ImageStreams in the Development project. The remaining rectangles represent the Test and Production
projects that contain similar deployment related objects to the Development project, but without the ImageStreams.</p>
</div>
<div class="paragraph">
<p>We have deviated slightly from this example pipeline. We decided to follow the more common pattern where the
Openshift cluster responsible for CI/CD and testing is separate from the production cluster. We also opted for
an external Docker registry which results in better support for build infrastructure outside of Openshift as well
as better support for multiple clusters. Lastly, we have collapsed the Development and Testing environments into
a single stage environment. We may support more complex deployment environments in future, but since Entando does
most of the high risk work for you behind the scenes, we do not the typical fine grained app to carry such
risk with it that it needs more than a single stage environment.</p>
</div>
<div class="paragraph">
<p>The overall architecture of the pipeline is as follows:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/EntandoReferencePipeline.png" alt="Entando Reference Pipeline">
</div>
</div>
<div class="paragraph">
<p>At the top, we have a project containing all the Jenkins Pipeline BuildConfigs. This project may or may not build
the Docker images, as you will see later, but it definitely contains all the Jenkins Pipeline BuildConfigs. This
is also the project from which the automatically provisioned Jenkins instance will be operating. For this reason,
we also have to install ImageStreams in this project to make each of our Entando Jenkins Slave images available.
Whoever has access to this project would be able to trigger a pipeline to either of the other two environments.
In our pipeline, this project will carry the suffix "-build" to distinguish it from other projects in
our application.</p>
</div>
<div class="paragraph">
<p>In the center of the image, we have an external registry. At Entando we use private Docker repositories running on
Docker&#8217;s cloud infrastructure. You could opt to use other registries in your organization, such as the Nexus 3
Docker registry. It is also entirely possible to use Openshift&#8217;s built-in registry, although from the perspectivce
of our BuildConfigs and DeploymentConfigs, it is still treated as an external Docker registry. This needs to be
a secure registry. Your production evironment would be reading and deploying images from othis registry.
Our deployment configs are setup to access this registry directly, rather than mediating
through ImageStreams. Our pipelines would not benefit much from ImageStreams as we would not want deployments to be
automatically triggered when an ImageStream is updated, and it would just add to the complexity of the deployment.</p>
</div>
<div class="paragraph">
<p>The project hosting the staging environment is depicted in the bottom left corner. This project only contains
the necessary DeploymentConfigs, Services and Routes to expose your application. There are no BuildConfigs in this
project. For our reference Pipeline, we decided to host both the EAP Image and the PostgreSQL image for the backing
database in this project. It wouldn&#8217;t be too difficult to configure the EAP Image to point to an external database
server, especially if you already have a clustered database server uup and running. However, for the purposes
of the <a href="#fine-grained-apps">Fine Grained Apps</a> use case it is unlikely that you would have massive scalability requirements on the
database tier, especially since the vast majority of the data is read only, not updated, and Entando also provides
you with a cluster safe cache in the form of the Infinispan plugin.</p>
</div>
<div class="paragraph">
<p>The project hosting the production environment is depicted in the bottom right corner. It is basically a mirror of the
staging project, but you do have the option of increasing your pod replica count to meet your requirements in production.
Other than that, the idea was to keep the staging and production projects as similar as possible. In fact, the
reference pipeline installation script uses the same templates for both projects.</p>
</div>
<div class="sect5">
<h6 id="preparing-for-the-pipeline-installation"><a class="anchor" href="#preparing-for-the-pipeline-installation"></a>Preparing for the Pipeline Installation</h6>
<div class="paragraph">
<p>Entando offers a BASH script that you can use to install the reference pipeline. The best way to run this script is
to clone or download our <code>entando-ops</code> project in Github:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>git clone git@github.com:entando/entando-ops.git</pre>
</div>
</div>
<div class="paragraph">
<p>This will download the bash script along with the other Openshift object definitions such as ImageStreams and Templates.
Once you have checked out the source code, open up a BASH console and change the present working directory to the
reference pipeline installer&#8217;s directory:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cd Openshift/installers/reference-pipeline</pre>
</div>
</div>
<div class="paragraph">
<p>In this directory, you will find a subdirectory named 'sample-config'. This directory contains a sample configuration for the pipeline.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cd sample-conf/</pre>
</div>
</div>
<div class="paragraph">
<p>The configuration is split up into three files:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ls -l</pre>
</div>
</div>
<div class="paragraph">
<p>Results:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>-rw-r--r-- 1 lulu lulu 406 Dec 13 15:09 build.conf
-rw-r--r-- 1 lulu lulu 750 Dec 13 15:12 prod.conf
-rw-r--r-- 1 lulu lulu 622 Nov  2 09:03 stage.conf</pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>build.conf</strong> file defines values for all the variables required to operate the Pipeline in both STAGE and PROD.
This includes credentials for both the STAGE and PROD cluster. You can provide the credentials for any user that
has the necessary permissions to create a new project.</p>
</div>
<div class="paragraph">
<p>The <strong>stage.conf</strong> file defines values for all the variables required to setup the STAGE environment. If you set
the variable DEPLOY_POSTGRESQL to 'true', the script will install a PostgreSQL Image in the project, and the rest
of the variable names will be used to create the databases to the required state. If you set it to 'false', you need
to make sure that the variable values correspond with your pre-configured PostgreSQL databases.</p>
</div>
<div class="paragraph">
<p>You will notice the following variables in this file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>OIDC_AUTH_LOCATION</strong> - the URL of the authentication service, e.g. the 'login page' that Entando needs to redirect the user to in order to  allow the OAuth provider to authenticate the user.</p>
</li>
<li>
<p><strong>OIDC_TOKEN_LOCATION</strong> - the URL of the token service where Entando can retrieve the OAuth token from after authentication</p>
</li>
<li>
<p><strong>OIDC_CLIENT_ID</strong> - the Client ID that uniquely identifies the Entando App in the OAuth provider&#8217;s configuration</p>
</li>
<li>
<p><strong>OIDC_REDIRECT_BASE_URL</strong> - the optional base URL, typically the protocol, host and port (<a href="https://some.host.com:8080/" class="bare">https://some.host.com:8080/</a>) that will be prepended to the path segment of the URL requested by the user and provided as a redirect URL to the OAuth provider. If empty, the requested URL will be used as is.</p>
</li>
<li>
<p><strong>KIE_SERVER_BASE_URL</strong> - The base URL where a KIE Server instance is hosted, e.g. <a href="http://entando-kieserver701.apps.serv.run/" class="bare">http://entando-kieserver701.apps.serv.run/</a></p>
</li>
<li>
<p><strong>KIE_SERVER_USERNAME</strong> - The username of a user that be used to log into the above-mentioned KIE Server</p>
</li>
<li>
<p><strong>KIE_SERVER_PASSWORD</strong> - The password of the above-mentioned KIE Server user.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <strong>prod.conf</strong> file defines values for all the variables required to setup the PROD environment. These variables
are semantically similar to those defined in the STAGE environment, but with values applicable to the PROD environment.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="installing-the-pipeline"><a class="anchor" href="#installing-the-pipeline"></a>Installing the pipeline</h5>
<div class="paragraph">
<p>The installation script is contained in the file named <code>setup-entando-pipeline.sh</code>. This script takes a single
command as a first parameter, and then any combination of arguments to follow in the format <code>--arg-name=arg-value</code>.</p>
</div>
<div class="ulist">
<div class="title">The following commands are available</div>
<ul>
<li>
<p><strong>create</strong> - creates all three projects and sets up the necessary service account permissions across them. Also starts the Jenkins server instance in the CI/CD project</p>
</li>
<li>
<p><strong>create-stage</strong> - only creates the build project and the stage project. Also starts the Jenkins server instance in the CI/CD project</p>
</li>
<li>
<p><strong>create-prod</strong> - only creates the prod project</p>
</li>
<li>
<p><strong>delete</strong> - deletes all three projects and all of their content.. NB!! Use with care, it could delete your production deployments.</p>
</li>
<li>
<p><strong>delete-prod</strong> - deletes the production project and all of its content. NB!! Use with care, it could delete your production deployments.</p>
</li>
<li>
<p><strong>delete-stage</strong> - deletes the build and stage projects and all of their content.</p>
</li>
<li>
<p><strong>populate-prod</strong> - installs all the image streams for prod and installs the PostgreSQL and EAP templates</p>
</li>
<li>
<p><strong>populate-stage</strong>- installs all the image streams for build and stage, installs the Jenkins Pipeline BuildConfigs in the Build project and installs the PostgreSQL and EAP templates in stage</p>
</li>
<li>
<p><strong>populate</strong> - populates all image streams, templates and BuildConfigs</p>
</li>
<li>
<p><strong>clear</strong> - removes all object installed with the populate command</p>
</li>
<li>
<p><strong>clear-stage</strong>  - removes all object installed with the populate-stage command</p>
</li>
<li>
<p><strong>clear-prod</strong> - removes all object installed with the populate-prod command</p>
</li>
<li>
<p><strong>recreate-external-docker-secret</strong> - deletes the existing external docker secret and recreates it based on the variables in the build.conf file</p>
</li>
<li>
<p><strong>recreate-prod-cluster-secret</strong> - deletes the existing production cluster secret and recreates it based on the variables in the build.conf file</p>
</li>
<li>
<p><strong>recreate-source-secret</strong> - deletes the existing source secret and recreates it based on the variables in the build.conf file</p>
</li>
<li>
<p><strong>log-into-prod</strong> - establishes a session with the prod cluster using the prod credentials in the build.conf file</p>
</li>
<li>
<p><strong>log-into-stage</strong> - establishes a session with the prod cluster using the stage credentials in the build.conf file</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">The following arguments are available</div>
<ul>
<li>
<p><strong>application-name</strong> - a prefix that will be prepended to each project, and will be automatically assigned as a Kubernetes label for all objects created by this script.</p>
</li>
<li>
<p><strong>config-dir</strong> - a directory containing the build.conf, prod.conf and stage.conf files that you want to use for this script.</p>
</li>
<li>
<p><strong>image-stream-namespace</strong> - the name of the Openshift project that contains all the  ImageStreams required for the Template  in question. If the ImageStreams were created in the default 'openshift' project,  Openshift will automatically add it to  its application catalog. It is however possible to store them in any   project, including the project that the current Template is being instantiated in.</p>
</li>
<li>
<p><strong>entando-image-version</strong> - the version number of the Entando images that will be used. In Docker, this will be the 'tag' segment of the Image repository reference. In Openshift, this will be the name of a Tag in the ImageStreams that will be used to bind all  S2I BuildConfigs and  DeploymentConfigs to. This generally corresponds with the version of Entando being used.</p>
</li>
<li>
<p><strong>image-promotion-only</strong> - include this argument if you do not wish to build any images, but only promote them.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This concludes the overview of our generic Jenkins Pipeline infrastructure. At this point, you need to make a call
whether your requirements would be best addressed with a <a href="#hybrid-docker-environment">Hybrid Docker Environment</a>, or whether
a <a href="#pure-openshift-environment">Pure Openshift Environment</a> addresses your need. Our reference Pipeline script supports both.</p>
</div>
</div>
<div class="sect4">
<h5 id="example-openshift-only-pipeline"><a class="anchor" href="#example-openshift-only-pipeline"></a>Example Openshift Only Pipeline</h5>
<div class="paragraph">
<p>If you opt for an Openshift Only environment, your pipeline would look something like this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/OpenshiftOnlyPipeline.png" alt="Openshift Only Pipeline">
</div>
</div>
<div class="paragraph">
<p>As you can see, this Pipeline builds and pushes your Docker images to the external Docker registry. Under the
hoods, it still uses S2I BuildConfig, but the process is controlled entirely from the Jenkins Pipeline. When promoting
the resulting Image to one of the target deployment environments, this Pipeline follows the following process:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>scale the target DeploymentConfig to 0 replicas.</p>
</li>
<li>
<p>migrate the database for the target deployment to the latest</p>
</li>
<li>
<p>scale the target DeploymentConfig back up to 2 recplicas.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To install the entire pipeline, make sure that valid values have been given to all the variables in the configuration files.
Then navigate to the Openshift/installers/reference-pipeline directory.</p>
</div>
<div class="olist arabic">
<div class="title">Perform these steps</div>
<ol class="arabic">
<li>
<p>Create all projects</p>
<div class="literalblock">
<div class="content">
<pre>./setup-entando-pipeline create --application-name=entando-sample --config-dir=./sample-conf</pre>
</div>
</div>
</li>
<li>
<p>Populate all projects</p>
<div class="literalblock">
<div class="content">
<pre>./setup-entando-pipeline populate --application-name=entando-sample  --config-dir=./sample-conf</pre>
</div>
</div>
</li>
<li>
<p>Double check that there were no errors in the installation process.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Once the references Pipelines have been installed, you can now trigger one of the builds. You will notice that there are
the following seven different BuildConfigs.</p>
</div>
<div class="ulist">
<div class="title">Source to Image BuildConfigs</div>
<ul>
<li>
<p><strong>$APPLICATION_NAME-s2i-build</strong> - the BuildConfig at the heart of the EAP Image build. This build should only be triggered
by the Jenkins Pipeline. The Jenkins Pipeline prepares the input directory of this build in a very specific state which
ensures that all the correct files end up in all the correct place. It automatically pushes the resulting Image to
the external Docker registry. Please do not trigger this build manually.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Dockerfile BuildConfigs</div>
<ul>
<li>
<p><strong>$APPLICATION_NAME-tag-as-stage</strong> - this BuildConfig simply rebuilds the specified image but with a new tag - 'stage'. This
is  a tepmorary workaround for challenges we faced utilising the Docker 'tag' command from Jenkins.
 It automatically pushes the resulting tag to the external Docker registry.</p>
</li>
<li>
<p><strong>$APPLICATION_NAME-tag-as-prod</strong>  - this BuildConfig simply rebuilds the specified image but with a new tag - 'stage'. This
is  a tepmorary workaround for challenges we faced utilising the Docker 'tag' command from Jenkins.
It automatically pushes the resulting tag to the external Docker registry.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Jenkins Pipeline BuildConfigs</div>
<ul>
<li>
<p><strong>$APPLICATION_NAME-build-and-promote-to-stage-with-db-migration</strong> - this Jenkins Pipeline builds the EAP Docker image from scratch, then
it migrates the stage database, tags the image as 'stage' and deploys it to the stage environment.</p>
</li>
<li>
<p><strong>$APPLICATION_NAME-build-and-promote-to-stage-without-db-migration</strong>  - this Jenkins Pipeline builds the EAP Docker image from scratch,
tags the image as 'stage' and immediately deploys it to the stage environment.</p>
</li>
<li>
<p><strong>$APPLICATION_NAME-promote-to-production-with-db-migration</strong>  - this Jenkins Pipeline tags the 'stage' Docker image as 'prod',
migrates the production database and then deploys it to the stage environment.</p>
</li>
<li>
<p><strong>$APPLICATION_NAME-promote-to-production-without-db-migration</strong> - this Jenkins Pipeline tags the 'stage' Docker image as 'prod',
and then immediately deploys it to the stage environment.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="example-hybrid-pipeline"><a class="anchor" href="#example-hybrid-pipeline"></a>Example Hybrid Pipeline</h5>
<div class="paragraph">
<p>If you opt for a hybrid environment, your pipeline would look something like this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/HybridPipeline.png" alt="hybrid Pipeline">
</div>
</div>
<div class="paragraph">
<p>As you can see, this Pipeline needs your existing build infrastructure to build and pushe your Docker images to the
external Docker registry. This Pipeline can then co-ordinate the promotion of the resulting Image to one of
the target deployment environments, this Pipeline still follows the following process:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>scale the target DeploymentConfig to 0 replicas.</p>
</li>
<li>
<p>migrate the database for the target deployment to the latest</p>
</li>
<li>
<p>scale the target DeploymentConfig back up to 2 recplicas.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To install the entire pipeline, make sure that valid values have been given to all the variables in the configuration files.
Then navigate to the Openshift/installers/reference-pipeline directory. Please note that each of the commands listed
below includes the argument <code>--promotion-only</code>. This instructs the installation script to bypass the installation
of any BuildConfigs or Pipeline steps that will actually build the Docker image.</p>
</div>
<div class="olist arabic">
<div class="title">Perform these steps</div>
<ol class="arabic">
<li>
<p>Create all projects</p>
<div class="literalblock">
<div class="content">
<pre>./setup-entando-pipeline create --application-name=entando-sample --config-dir=./sample-conf --promotion-only</pre>
</div>
</div>
</li>
<li>
<p>Populate all projects</p>
<div class="literalblock">
<div class="content">
<pre>./setup-entando-pipeline populate --application-name=entando-sample  --config-dir=./sample-conf  --promotion-only</pre>
</div>
</div>
</li>
<li>
<p>Double check that there were no errors in the installation process.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Once the references Pipelines have been installed, you can now trigger one of the builds. You will notice that there are
the following seven different BuildConfigs.</p>
</div>
<div class="ulist">
<div class="title">Dockerfile BuildConfigs</div>
<ul>
<li>
<p><strong>$APPLICATION_NAME-tag-as-stage</strong> - this BuildConfig simply rebuilds the specified image but with a new tag - 'stage'. This
is  a tepmorary workaround for challenges we faced utilising the Docker 'tag' command from Jenkins.
 It automatically pushes the resulting tag to the external Docker registry.</p>
</li>
<li>
<p><strong>$APPLICATION_NAME-tag-as-prod</strong>  - this BuildConfig simply rebuilds the specified image but with a new tag - 'stage'. This
is  a tepmorary workaround for challenges we faced utilising the Docker 'tag' command from Jenkins.
It automatically pushes the resulting tag to the external Docker registry.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Jenkins Pipeline BuildConfigs</div>
<ul>
<li>
<p><strong>$APPLICATION_NAME-promote-to-stage-with-db-migration</strong> - this Jenkins Pipeline migrates the stage database, tags the
'latest' image as 'stage' and deploys it to the stage environment.</p>
</li>
<li>
<p><strong>$APPLICATION_NAME-promote-to-stage-without-db-migration</strong>  - this Jenkins Pipeline tags the 'latest' image as 'stage'
and immediately deploys it to the stage environment.</p>
</li>
<li>
<p><strong>$APPLICATION_NAME-promote-to-production-with-db-migration</strong>  - this Jenkins Pipeline tags the 'stage' Docker image as 'prod',
migrates the production database and then deploys it to the stage environment.</p>
</li>
<li>
<p><strong>$APPLICATION_NAME-promote-to-production-without-db-migration</strong> - this Jenkins Pipeline tags the 'stage' Docker image as 'prod',
and then immediately deploys it to the stage environment.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As you can see, these Pipelines all assume that the specified Docker Image has already been built. If you used our
Maven archetype to generate your Entando App, it would be quite easy to introduce the necessary commands to achieve this.
Please refer back to our <a href="#maven-and-docker">Maven and Docker</a> section for more details. Generally you would do the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configure your build server&#8217;s Maven settings file, $HOME/.m2/settings.xml to have a <code>&lt;server&gt;</code> config for your
external Docker registry:</p>
<div class="literalblock">
<div class="content">
<pre>&lt;server&gt;
  &lt;id&gt;my.registry.com&lt;/id&gt;
  &lt;username&gt;myusername&lt;/username&gt;
  &lt;password&gt;s!cr!t&lt;/password&gt;
&lt;/server&gt;</pre>
</div>
</div>
</li>
<li>
<p>Make sure that your pom.xml references that registry in the name of the Image you want to build, and make sure
it tags the image as 'latest'</p>
<div class="literalblock">
<div class="content">
<pre>&lt;image&gt;
  &lt;name&gt;my.registry.com/myteam/${project.artifactId}:latest&lt;/name&gt;
  ...</pre>
</div>
</div>
</li>
<li>
<p>Build and push your image on you build server using the following command</p>
<div class="literalblock">
<div class="content">
<pre>mvn clean install -Pdocker docker:push</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cloud-deployments-on-aws-azure-and-gce"><a class="anchor" href="#cloud-deployments-on-aws-azure-and-gce"></a>4.3. Cloud deployments on AWS, Azure and GCE</h3>
<div class="sect3">
<h4 id="cloud-deployments"><a class="anchor" href="#cloud-deployments"></a>4.3.1. Overview</h4>
<div class="paragraph">
<p>Entando currently offers a variety of Docker images that can be used in different container environments, such as
'vanilla' Docker, Openshift or Kubernetes. These images were also developed with different use cases in mind, such as
for simple demos, for getting started with your own app, for more advanced CI/CD, or for production deployments.
In this chapter we are mainly interested in showing you how to use those images in a Kubernetes environment hosted somewhere
in some datacenter of your favorite hosting cloud provider.</p>
</div>
</div>
<div class="sect3">
<h4 id="assumptions"><a class="anchor" href="#assumptions"></a>4.3.2. Assumptions</h4>
<div class="paragraph">
<p>We assume that you have already a kubernetes cluster up and running (also a minikube running on your local machine), that
 you know how to write a yaml file for kubernetes and that you already have your docker images
 (<a href="http://developer.entando.com/#_docker_overview" class="bare">http://developer.entando.com/#_docker_overview</a>) published on your docker registry and of course you have kubectl installed
  (<a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/">how to install kubectl</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="getting-started-k8s"><a class="anchor" href="#getting-started-k8s"></a>4.3.3. Getting started</h4>
<div class="sect4">
<h5 id="simplest-example"><a class="anchor" href="#simplest-example"></a>The Simplest example</h5>
<div class="paragraph">
<p>Let&#8217;s start with a very simple all in one docker image that contains everything needed to run an entando project:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>A java container</strong> (jetty)</p>
</li>
<li>
<p><strong>2 DBs</strong> (Derby)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is the Dockerfile that we are going to use for this example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile">FROM entando/centos-base:master
USER entando

ENV PROJECT_HOME /home/entando
ENV PROJECT_NAME k8s-simplest

WORKDIR ${PROJECT_HOME}

RUN mvn archetype:generate -B -Dfilter=entando -DarchetypeGroupId=org.entando.entando -DarchetypeArtifactId=entando-archetype-webapp-generic -DgroupId=org.entando -DartifactId=${PROJECT_NAME} -Dversion=1.0-SNAPSHOT -Dpackage=test.entando

WORKDIR ${PROJECT_HOME}/${PROJECT_NAME}

CMD ["mvn", "jetty:run", "-Dorg.eclipse.jetty.annotations.maxWait=180"]

EXPOSE 8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this in place we are going to build our image and push it on our docker registry. This registry<strong> has to be reachable from our kubernetes</strong>
cluster.</p>
</div>
<div class="paragraph">
<p><code>docker build -t myregistry/k8s-simplest:test .</code></p>
</div>
<div class="paragraph">
<p><code>docker push myregistry/k8s-simplest:test</code></p>
</div>
<div class="paragraph">
<p>The next step is to create a <strong>deployment</strong> configuration file for kubernetes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml"># Deployment configuration definition for k8s-simplest
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: k8s-simplest-deploy
spec:
  selector:
    matchLabels:
      run: k8s-simplest
      app: k8s-simplest-demo
  replicas: 1
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      labels:
        run: k8s-simplest
        app: k8s-simplest-demo
    spec:
      containers:
        - name: k8s-simplest
          image: myregistry/k8s-simplest:test
          resources:
            requests:
              memory: 2048Mi
              cpu: 0.50
            limits:
              memory: 2Gi
          imagePullPolicy: Always
          ports:
            - containerPort: 8080
...
# Service definition for the k8s-simplest app
---
apiVersion: v1
kind: Service
metadata:
  name: k8s-simplest-service
  labels:
    name: k8s-simplest-service
    app:  k8s-simplest-demo
spec:
  type: LoadBalancer
  ports:
    - port: 80
      targetPort: 8080
  selector:
    run: k8s-simplest
    app: k8s-simplest-demo
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Save the content of this yaml file on your path (i.e k8s-simplest.yml) and execute:</p>
</div>
<div class="paragraph">
<p><code>kubectl create -f k8s-simplest.yml</code></p>
</div>
<div class="paragraph">
<p>This file also created a LoadBalancer to expose our entando project on port 80. That&#8217;s it.</p>
</div>
<div class="paragraph">
<p>We have just publish our first container on a kubernetes cluster.</p>
</div>
</div>
<div class="sect4">
<h5 id="n-tier-example"><a class="anchor" href="#n-tier-example"></a>An n-tier example</h5>
<div class="paragraph">
<p>Let&#8217;s continue from our k8s-simplest project. For this demo we are going to use:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Wildfly 15.0.1.Final release</p>
</li>
<li>
<p>Postgresql 9.6 release</p>
</li>
<li>
<p>Entando 5.0.3 release (our k8s-simplest project)</p>
</li>
<li>
<p>Infinispan 9.4.8.Final release</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>Please remember that the following instructions are not meant to be used on production environments but are only samples
on how to deploy entando on a kubernetes cluster.</code></p>
</div>
<div class="sect5">
<h6 id="postgresql-96-k8s"><a class="anchor" href="#postgresql-96-k8s"></a>Postgresql</h6>
<div class="paragraph">
<p>The first image that we need to deploy is the DB server. For the sake of this demonstration
we have already prepared a docker image that contains the two DBs (k8s-simplestPort, k8s-simplestServ) so the only
thing that we need now is the deployment configuration file for kubernetes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">---
apiVersion: v1
kind: Pod
metadata:
  name: postgres96-pod
  labels:
    name: postgres96-pod
    app:  k8s-demo
spec:
  containers:
    - name: postgres96
      image: entando/postgres-96:k8s-simplest
      ports:
        - containerPort: 5432
          protocol: TCP
      resources:
        requests:
          cpu: 0.50
...
# Service
---
apiVersion: v1
kind: Service
metadata:
  name: postgres96
  labels:
    name: postgres96-service
    app: k8s-demo
spec:
  ports:
    - port: 5432
      targetPort: 5432
  selector:
    name: postgres96-pod
    app:  k8s-demo
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>We have exposed the DB server on port 5432 and named it <code>postgres96-service</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="infinispan-cluster-k8s"><a class="anchor" href="#infinispan-cluster-k8s"></a>Infinispan cluster</h6>
<div class="paragraph">
<p>The second docker image that we are going to deploy on our kubernetes cluster is the infinispan&#8217;s one but to be able to
make this image works correctly first we need to set correct permissions to the service account and assign the view role
so that the jgroups subsystem is able to form a cluster.
We are going to execute the following command:</p>
</div>
<div class="paragraph">
<p><strong>Infinispan permissions</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl create rolebinding infinispan \
  --clusterrole=view \
  --user=default \
  --namespace=default \
  --group=system:serviceaccounts</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we can go on and set the deployment configuration file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
  labels:
    application: infinispan-server
  name: infinispan-server
  namespace: default
spec:
  replicas: 3
  selector:
    matchLabels:
      application: infinispan-server
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      creationTimestamp: null
      labels:
        application: infinispan-server
        deploymentConfig: infinispan-server
    spec:
      containers:
        - args:
            - cloud
            - -Djboss.default.jgroups.stack=kubernetes
          env:
            - name: KUBERNETES_LABELS
              value: application=infinispan-server
            - name: KUBERNETES_NAMESPACE
              valueFrom:
                fieldRef:
                  fieldPath: metadata.namespace
            - name: MGMT_USER
              value: "demo"
            - name: MGMT_PASS
              value: "demo"
            - name: APP_USER
              value: "demo"
            - name: APP_PASS
              value: "demo"
          image: entando/infinispan-server:k8s-simplest
          imagePullPolicy: Always
          name: infinispan-server
          ports:
            - containerPort: 8080
              protocol: TCP
            - containerPort: 8181
              protocol: TCP
            - containerPort: 8888
              protocol: TCP
            - containerPort: 9990
              protocol: TCP
            - containerPort: 11211
              protocol: TCP
            - containerPort: 11222
              protocol: TCP
            - containerPort: 11223
              protocol: TCP
          resources:
            requests:
              memory: 2Gi
              cpu: 0.50
            limits:
              memory: 4Gi
          terminationMessagePath: /dev/termination-log
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      securityContext: {}
      terminationGracePeriodSeconds: 30
...
# Internal service configuration
---
apiVersion: v1
kind: Service
metadata:
  annotations:
    description:  Hot Rod's port.
  name: infinispan-service
  labels:
    application: infinispan-server
    app: k8s-demo
spec:
  ports:
    - port: 11222
      targetPort: 11222
      name: hotrod
      protocol: TCP
    - port: 11223
      targetPort: 11223
      name: hotrod-internal
      protocol: TCP
  selector:
    deploymentConfig: infinispan-server
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The configuration file is self explanatory just have a look at the containers args that we are using (we have set the
default jgroups stack as kubernetes).</p>
</div>
<div class="paragraph">
<p>For this deployment the service (infinispan-service) exposes port 11222 and 11223 that we are going to use to populate and
retreive entries for/from the entando&#8217;s caches by the hotrod protocol.</p>
</div>
</div>
<div class="sect5">
<h6 id="wildfly-15-01-final-k8s"><a class="anchor" href="#wildfly-15-01-final-k8s"></a>Wildfly-15.0.1.Final</h6>
<div class="paragraph">
<p>Finally we need the deployment configuration file for our wildfly docker image to deploy our k8s-simplest war. As for the
infinispan docker image we need view permissions to be able to make the jgroups protocol to see other pods and form the cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl create rolebinding default-viewer \
  --clusterrole=view \
  --serviceaccount=default:default \
  --namespace=default</code></pre>
</div>
</div>
<div class="paragraph">
<p>After that we are going to create the deployment configuration file and the service definition that this time will be a
load balancer exposing the port 80 and mapping it to port 8080 of our wildfly pods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml"># Deployment configuration definition for wildfly15-01-ha
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: k8s-demo-deploy
spec:
  selector:
    matchLabels:
      run: wildfly15-01-ha
      app: k8s-demo
  replicas: 2
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      labels:
        run: wildfly15-01-ha
        app: k8s-demo
    spec:
      containers:
        - name: wildfly15-01-ha
          image: entando/wildlfy-15.0.1.final:k8s-simplest
          resources:
            requests:
              memory: 2048Mi
              cpu: 0.50
            limits:
              memory: 4Gi
          imagePullPolicy: Always
          ports:
            - containerPort: 8080
            - containerPort: 7600 #jgroups default
            - containerPort: 8888 #jgroups undertow
          env:
            - name: MY_POD_NAME
              valueFrom:
                fieldRef:
                  fieldPath: metadata.name
            - name: MY_POD_NAMESPACE
              valueFrom:
                fieldRef:
                  fieldPath: metadata.namespace
            - name: MY_POD_IP
              valueFrom:
                fieldRef:
                  fieldPath: status.podIP
            - name: PG_ENTANDO_PORT_DB_JNDI_NAME
              value: "java:jboss/datasources/k8s-simplestPortDataSource"
            - name: PG_ENTANDO_SERV_DB_JNDI_NAME
              value: "java:jboss/datasources/k8s-simplestServDataSource"
            - name: PG_ENTANDO_PORT_DB_CONNECTION_STRING
              value: "postgres96:5432/k8s-simplestPort"
            - name: PG_ENTANDO_SERV_DB_CONNECTION_STRING
              value: "postgres96:5432/k8s-simplestServ"
            - name: PG_USERNAME
              value: "agile"
            - name: PG_PASSWORD
              value: "agile"
            - name: INITIAL_POOL_SIZE
              value: "5"
            - name: MAX_POOL_SIZE
              value: "10"
...
# Service definition for the wildfly15-01-ha
---
apiVersion: v1
kind: Service
metadata:
  name: wildfly15-01-ha-service
  labels:
    name: wildfly15-01-ha-service
    app:  k8s-demo
spec:
  type: LoadBalancer
  ports:
    - port: 80
      targetPort: 8080
  selector:
    run: wildfly15-01-ha
    app: k8s-demo
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>We have passed as ENV vars to this deployment configuration the JNDI name, the DB&#8217;s connection string tha is linked to our
internal service name (postgres96). All the othe options are self explanatory.</p>
</div>
</div>
<div class="sect5">
<h6 id="entando-project-configuration-k8s"><a class="anchor" href="#entando-project-configuration-k8s"></a>Entanto project configuration</h6>
<div class="paragraph">
<p>To be able to use the remote infinispan server cluster we have modified the entando project to use the hotrod protocol for
all the tasks related to caching and to make the overall deployment more scalabale and
container (Java container) indipendent.</p>
</div>
<div class="paragraph">
<p>To see how the entando project has been modified to work with the datagrid implementation take a loook at the code on
github (<a href="https://github.com/entando/k8s-simplest/tree/kubernetes">kubernetes branch</a>)</p>
</div>
<div class="paragraph">
<p>Here is the client hotrod configuration file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ini hljs" data-lang="ini">infinispan.client.hotrod.server_list=infinispan-service:11222
infinispan.client.hotrod.marshaller=org.infinispan.commons.marshall.jboss.GenericJBossMarshaller
infinispan.client.hotrod.async_executor_factory=org.infinispan.client.hotrod.impl.async.DefaultAsyncExecutorFactory
infinispan.client.hotrod.request_balancing_strategy=org.infinispan.client.hotrod.impl.transport.tcp.RoundRobinBalancingStrategy
infinispan.client.hotrod.tcp_no_delay=true
-infinispan.client.hotrod.key_size_estimate=128
infinispan.client.hotrod.value_size_estimate=1024
infinispan.client.hotrod.force_return_values=false
infinispan.client.hotrod.client_intelligence=HASH_DISTRIBUTION_AWARE
infinispan.client.hotrod.batch_Size=10000

# authentication
infinispan.client.hotrod.use_auth=true
infinispan.client.hotrod.sasl_mechanism=DIGEST-MD5
infinispan.client.hotrod.auth_username=demo
infinispan.client.hotrod.auth_password=demo
infinispan.client.hotrod.auth_realm=ApplicationRealm
infinispan.client.hotrod.auth_server_name=infinispan-service

## near cache
infinispan.client.hotrod.near_cache.mode=INVALIDATED
infinispan.client.hotrod.near_cache.max_entries=-1
infinispan.client.hotrod.near_cache.name_pattern=Entando_*

## below is connection pooling config
infinispan.client.hotrod.connection_pool.max_active=-1
infinispan.client.hotrod.connection_pool.exhausted_action=CREATE_NEW
infinispan.client.hotrod.connection_pool.min_evictable_idle_time=1800000
infinispan.client.hotrod.connection_pool.min_idle=1</code></pre>
</div>
</div>
<div class="paragraph">
<p>To deploy the project on kubernetes just follow this order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Deploy the DB server (<strong>kubectl create -f postgres96.yml</strong>)</p>
</li>
<li>
<p>Assign correct permissions to default user for infinispan and wildfly cluster</p>
</li>
<li>
<p>Deploy the infinispan cluster (<strong>kubectl create -f infinispan.yml</strong>)</p>
</li>
<li>
<p>Deploy the wildfly cluster (<strong>kubectl create -f wildfly.yml</strong>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Known Issues</strong></p>
</div>
<div class="paragraph">
<p>At this point this demo will not work correctly due to a missing jar required on wildfly. This will be patched in a new
Entando release.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="developers-guide"><a class="anchor" href="#developers-guide"></a>4.4. DEVELOPERS' GUIDE</h3>
<div class="sect3">
<h4 id="firstdevelopers"><a class="anchor" href="#firstdevelopers"></a>4.4.1. INITIAL SETUP</h4>
<div class="paragraph">
<p>Entando manages projects with Maven; we also use Ant to automate several tasks.</p>
</div>
</div>
<div class="sect3">
<h4 id="configuring-ant"><a class="anchor" href="#configuring-ant"></a>4.4.2. CONFIGURING ANT</h4>
<div class="paragraph">
<p>To configure Ant, open the file <em>buildProperties.xml</em> in the root of the project. The root of an Entando project is the directory where the <em>pom.xml</em> file resides.</p>
</div>
<div class="paragraph">
<p>By default, the <em>buildProperties.xml</em> file includes the properties for PostGresSQL and MySQL. To configure Ant, you must edit the values that pertain to your target DBMS. You can ignore any unused properties.</p>
</div>
<div class="ulist">
<div class="title">Values you must configure:</div>
<ul>
<li>
<p>Database address, username, and password</p>
</li>
<li>
<p>Database executable path</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;property name="postgres.hostname" value="localhost" /&gt;
&lt;property name="postgres.port" value="5432" /&gt;
&lt;property name="postgres.username" value="agile" /&gt;
&lt;property name="postgres.password" value="agile" /&gt;

&lt;property name="mysql.hostname" value="localhost" /&gt;
&lt;property name="mysql.port" value="3306" /&gt;
&lt;property name="mysql.username" value="agile" /&gt;
&lt;property name="mysql.password" value="agile" /&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Once configured, you need to declare the path of the target DBMS executables in either the PostgreSQL or MySQL section. The following properties are grouped by operating system, so be sure to configure properties under the correction OS and then comment out the remaining operating systems.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;!-- Properties definitions for *nix machines START --&gt;
&lt;property name="tomcat.home.path" value="/opt/tomcat6" /&gt;
&lt;property name="postgres.bin.path" location="/Library/PostgreSQL/9.5/bin/" /&gt;
&lt;property name="postgres.bin.dump" value="pg_dump" /&gt;
&lt;property name="postgres.bin.psql" value="psql" /&gt;
&lt;property name="postgres.bin.restore" value="pg_restore" /&gt;
&lt;property name="postgres.bin.drop" value="dropdb" /&gt;
&lt;property name="postgres.bin.create" value="createdb" /&gt;
&lt;property name="mysql.bin.path" location="/usr/bin" /&gt;
&lt;property name="mysql.bin.dump" value="mysqldump" /&gt;
&lt;property name="mysql.bin.restore" value="mysql" /&gt;
&lt;property name="mysql.bin.create" value="mysql" /&gt;
&lt;property name="mysql.bin.drop" value="mysql" /&gt;
&lt;property name="ant-contrib.jar.path" location="/usr/bin/java/ant-contrib.jar" /&gt;
&lt;!-- Properties definitions for *nix machines END --&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>The only properties to adjust are those regarding the path of the executables, e.g., <em>postgres.bin.path</em> or <em>mysql.bin.path</em>.</p>
</div>
<div class="sect4">
<h5 id="additional-settings-for-windows"><a class="anchor" href="#additional-settings-for-windows"></a>ADDITIONAL SETTINGS FOR WINDOWS</h5>
<div class="paragraph">
<p>If you are a Windows user, you must also modify the file <em>buildTasks.xml</em>, otherwise Maven will not start correctly and will throw a “file not found” error.</p>
</div>
</div>
<div class="sect4">
<h5 id="windows-10"><a class="anchor" href="#windows-10"></a>WINDOWS 10</h5>
<div class="paragraph">
<p>Find and edit all seven instances of executable=”mvn” in the <em>buildTasks.xml</em> file. Entando 5 contains seven total instances.</p>
</div>
<div class="paragraph">
<p><strong>Change from:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>executable="mvn"</pre>
</div>
</div>
<div class="paragraph">
<p><strong>to:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>executable="mvn.cmd"</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="other-windows-versions"><a class="anchor" href="#other-windows-versions"></a>OTHER WINDOWS VERSIONS</h5>
<div class="paragraph">
<p>Find and edit all seven instances of executable=”mvn” in the <em>buildTasks.xml</em> file. Entando 5 contains seven total instances.</p>
</div>
<div class="paragraph">
<p><strong>Change from:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>executable="mvn"</pre>
</div>
</div>
<div class="paragraph">
<p>to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>executable="mvn.bat"</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="ant-tasks"><a class="anchor" href="#ant-tasks"></a>ANT TASKS</h5>
<div class="paragraph">
<p>After you have correctly declared the executable paths in <em>buildProperties.xml</em>, you can begin executing Ant tasks to perform management operations.</p>
</div>
<div class="paragraph">
<p>These tasks include the creation of the WAR file and database management.</p>
</div>
<div class="paragraph">
<p>To retrieve the list of available tasks, run the following command from the terminal window or command prompt:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ant -p</pre>
</div>
</div>
<div class="paragraph">
<p>The result shows all running tasks, similar to the following:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/firstdev_runningTasks.png" alt="639" width="439">
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Remember that the tasks aimed at database management will only impact the relevant project’s database. For example, in a project named <em>entandodemo</em>, the task <em>PG-db-drop</em> will only drop the <em>entandodemoPort</em> and <em>entandodemoServ</em> databases. Similarly, creating a dump will involve the same databases.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p><strong>Tasks for PostgreSQL:</strong></p>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Before using the PostgreSQL related tasks, you need to create the following directory in your project ./src/main/db/backup/tar. This directory is only necessary for using a PostGresSQL database.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>PG-db-create:</strong> creates the databases for the current project<br>
This item won’t appear in the list</p>
</li>
<li>
<p><strong>PG-db-drop:</strong> drops the default databases of the project<br>
This item won’t appear in the list</p>
</li>
<li>
<p><strong>PG-db-backup-tar:</strong> dumps and compresses the databases, placing the file in ./src/main/db/backup/tar<br>
Remember that you must create the 'tar' directory beforehand</p>
</li>
<li>
<p><strong>PG-db-full-update-tar:</strong> restores the dump created with the previous command<br>
The process drops databases before the restore takes place</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Tasks for MySQL:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>MySQL-db-backup:</strong> dumps the project databases<br>
NOTE: the dump will be placed in the src/db/mysql</p>
</li>
<li>
<p><strong>MySQL-db-create:</strong> creates the project databases</p>
</li>
<li>
<p><strong>MySQL-db-drop:</strong> drops default project databases</p>
</li>
<li>
<p><strong>MySQL-db-full-update:</strong> runs a database update<br>
NOTE: the dump must be present in src/db/mysql</p>
</li>
<li>
<p><strong>MySQL-db-restore:</strong> drops existing tables, then restores the dump<br>
NOTE: the dump must be present in src/db/mysql</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>General tasks:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>WAR-build:</strong> creates the WAR of the project for Apache Tomcat</p>
</li>
<li>
<p><strong>WAR-build-jboss:</strong> creates the WAR of the project for JBoss / Wildfly</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="troubleshooting"><a class="anchor" href="#troubleshooting"></a>4.4.3. TROUBLESHOOTING</h4>
<div class="paragraph">
<p>Most setup errors result from an improper configuration in either <em>buildProperties.xml</em> or, for Windows users, <em>buildTasks.xml</em>.</p>
</div>
<div class="ulist">
<div class="title">To resolve an issue, ensure that each of the following is correct:</div>
<ul>
<li>
<p>The path of DBMS binaries <em>postgres.bin.path</em> or <em>mysql.bin.path</em></p>
</li>
<li>
<p>Username and password for accessing the database. By default, both the username and password are “agile”</p>
</li>
<li>
<p>The URL of the database. The default is ”localhost”</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="filter-management"><a class="anchor" href="#filter-management"></a>4.4.4. FILTER MANAGEMENT</h4>
<div class="paragraph">
<p>Filters contain key:value pairs that Entando uses in templates to generate essential files such as <em>context.xml</em> and <em>web.xml</em>. Each filter generates slightly different xml depending on the target environment, developer, or production environment.</p>
</div>
<div class="paragraph">
<p>The contents of the filters are very similar with the main difference being the name. Different commands select different filters for use. Development filters are identical; production filters differ by one property. Filter contents are essentially identical in all the other respects.</p>
</div>
<div class="paragraph">
<p>Entando comes with the Jetty plugin and Derby as servlet container and database, respectively. As such, you do not need to edit any filter to run a newly created Entando project. Filters are only modified by developers when developing a project, such as one using a database other than Derby.</p>
</div>
<div class="sect4">
<h5 id="development-filters"><a class="anchor" href="#development-filters"></a>DEVELOPMENT FILTERS</h5>
<div class="paragraph">
<p>Development filters operate during the development phase of the project; each operating system has its own version of the filter.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Unix:</strong> filter-development-unix.properties</p>
</li>
<li>
<p><strong>Windows:</strong> filter-development-windows.properties</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The command <code>mvn clean jetty:run</code> selects the appropriate filter to generate the context or web XML files.</p>
</div>
</div>
<div class="sect4">
<h5 id="production-filters"><a class="anchor" href="#production-filters"></a>PRODUCTION FILTERS</h5>
<div class="paragraph">
<p>DevOps teams usually prepare the production filters and contain the values intended for the target production (staging) environment.</p>
</div>
<div class="paragraph">
<p>Production filters co-exist with development filters with no overlap between them.</p>
</div>
<div class="ulist">
<div class="title">There are two production filters:</div>
<ul>
<li>
<p><strong>Tomcat:</strong> filter-production.properties</p>
</li>
<li>
<p><strong>JBoss or Wildfly:</strong> filter-production-jboss.properties</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The command <code>ant WAR-build</code>, for Tomcat application servers, uses the filter-production.properties filter. Templates that generate the <em>context.xml</em> and <em>web.xml</em> files are in the directory ./src/main/config.</p>
</div>
<div class="paragraph">
<p>The command <code>ant WAR-build-jboss</code> uses the filter-production-jboss.properties filter. The template that generates the <em>web.xml</em> is in the directory ./src/main/config/jboss.</p>
</div>
</div>
<div class="sect4">
<h5 id="filter-setup"><a class="anchor" href="#filter-setup"></a>FILTER SETUP</h5>
<div class="paragraph">
<p>Filters are highly customizable. The following paragraphs list adjustments to the basic properties for getting started. Each of the values in this section are from the <em>filter-development-{operating system}.properties</em> file.</p>
</div>
</div>
<div class="sect4">
<h5 id="network-setup"><a class="anchor" href="#network-setup"></a>NETWORK SETUP</h5>
<div class="paragraph">
<p>Make changes to your network. The properties below come with predefined values for development and production filters. Change them as-needed to fit your target environment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>profile.application.baseurl.hostname
profile.application.baseurl.port
profile.application.baseurl.port.separator</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="servlet-container-setup-tomcat"><a class="anchor" href="#servlet-container-setup-tomcat"></a>SERVLET CONTAINER SETUP - TOMCAT</h5>
<div class="paragraph">
<p>This is valid for the <em>filter-development-unix</em>, <em>filter-development-windows</em> and <em>filter-production</em>.</p>
</div>
<div class="paragraph">
<p>Edit the <em>profile.tomcat.home</em> property to reflect the path of Tomcat’s installation directory.</p>
</div>
</div>
<div class="sect4">
<h5 id="application-server-setup-jbosswildfly"><a class="anchor" href="#application-server-setup-jbosswildfly"></a>APPLICATION SERVER SETUP - JBOSS/WILDFLY</h5>
<div class="paragraph">
<p>Edit the <em>profile.jboss.home</em> property to reflect the path JBoss or Wildfly installation directory.</p>
</div>
</div>
<div class="sect4">
<h5 id="database-setup"><a class="anchor" href="#database-setup"></a>DATABASE SETUP</h5>
<div class="paragraph">
<p>Each filter comes with sets of declarations for common databases. By default, all sets are commented out except for Derby.</p>
</div>
<div class="paragraph">
<p>To enable Entando to connect a different database, you must uncomment the appropriate database set and then comment out the Derby set. In addition, edit the following properties to fit your destination environment:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>profile.database.hostname=localhost
profile.database.port=1527
profile.database.username=agile
profile.database.password=agile</pre>
</div>
</div>
<div class="paragraph">
<p>Entando supports most common RDBMSes out-of-the-box. If your target database does not appear in the list (e.g., Oracle), your developers must create the properties in the filters.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configuring-swagger-optional-2"><a class="anchor" href="#configuring-swagger-optional-2"></a>4.4.5. CONFIGURING SWAGGER (OPTIONAL)</h4>
<div class="paragraph">
<p>When generating an application, Entando automatically includes an instance of Swagger, a tool that lets you describe the structure of your APIs to make them easier for other machines to read. Configuring Swagger for use only takes a few steps.</p>
</div>
<div class="sect4">
<h5 id="enabling-swagger-in-a-development-environment-2"><a class="anchor" href="#enabling-swagger-in-a-development-environment-2"></a>ENABLING SWAGGER IN A DEVELOPMENT ENVIRONMENT</h5>
<div class="paragraph">
<p>To enable swagger in your development environment, you need to run your application with an enabled Swagger profile. There are two options. Run ONE of the following from the  root of your generated project&#8217;s directory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Start the container with a JVM parameter using the following command:<br>
<code>mvn clean jetty:run -Dspring.profiles.active=swagger</code></p>
</li>
<li>
<p>Add an environment variable by using the following commands:<br>
<code>export spring_profiles_active=swagger</code><br>
<code>mvn clean jetty:run</code></p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">To access the Swagger interface:</div>
<ol class="arabic">
<li>
<p>In a browser, navigate to your application’s URL (e.g., <a href="http://localhost:8080/appname" class="bare">http://localhost:8080/appname</a>).</p>
</li>
<li>
<p>Append the URL with api/swagger-ui.html. Again, for example, <a href="http://localhost:8080/appname/api/swagger-ui.html" class="bare">http://localhost:8080/appname/api/swagger-ui.html</a></p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For security purposes, you should only run this with the default credentials in a development environment. If enabling swagger in production for integration purposes be sure to change the clientId and secret.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="authentication-details-2"><a class="anchor" href="#authentication-details-2"></a>AUTHENTICATION DETAILS</h5>
<div class="paragraph">
<p><strong>Default login details:</strong><br>
<strong>Username:</strong> admin<br>
<strong>Password:</strong> adminadmin</p>
</div>
<div class="paragraph">
<p><strong>Default Swagger OAuth details:</strong><br>
<strong>Type:</strong> Request Body<br>
<strong>clientId:</strong> swagger<br>
<strong>Secret:</strong> = swaggerswagger</p>
</div>
</div>
<div class="sect4">
<h5 id="how-does-the-integration-work-2"><a class="anchor" href="#how-does-the-integration-work-2"></a>HOW DOES THE INTEGRATION WORK?</h5>
<div class="paragraph">
<p>The Swagger integration is based on three components and is activated by a Spring profile. The components are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>SwaggerConfig</strong> - responsible for configuring most of the Swagger UI behavior (or the library Springfox that provides Swagger UI functionality). It configures which paths to scan, where to find the oAuth endpoints, and other essentials</p>
</li>
<li>
<p><strong>SwaggerMvcAdapter</strong> - makes the Swagger UI&#8217;s human-friendly HTML page and its resources available for the application</p>
</li>
<li>
<p><strong>SwaggerInitializer</strong> - assists the Swagger UI with talking to your new application. Swagger UI needs to talk to the application backend, which require oAuth authentication to communicate back to the Swagger UI. The backend uses standard oAuth authentication, requiring an oAuth client_id and secret, and also that any requested redirect matches a specific URL. SwaggerInitializer is also responsible for adding the oAuth consumer details for Swagger in the database. If Swagger is enabled when the application starts, SwaggerInitializer will check for an existing configuration for a Swagger consumer in the database and adds one if necessary</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <em>swagger</em> Spring profile is active, Spring will initialize and wire all three components during application startup. If inactive, Entando ignores the components.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="building-a-rest-api"><a class="anchor" href="#building-a-rest-api"></a>4.4.6. BUILDING A REST API</h4>
<div class="paragraph">
<p>To extend the Entando REST API interfaces you can create new REST controllers in your application and utilize the existing Entando configuration for Swagger and security.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create your REST controller(s) in your application in a package of your choice</p>
</li>
<li>
<p>Create a Spring context file that scans the package where your controllers were created</p>
</li>
<li>
<p>Add the spring context file created in step 2 to a location scanned by the web.xml in your app. We recommend creating the context in <code>src/main/resouces/spring/aps/api</code> but any scanned package will work</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Ensure that the base-package path in the context-scan contains your controllers</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>An example context file to scan the package <code>com.my.app</code> for controllers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:context="http://www.springframework.org/schema/context"
xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"&gt;

	&lt;context:component-scan base-package="com.my.app" /&gt;

&lt;/beans&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once configured the endpoints will be enabled by Spring and the endpoint documentation will be available in Swagger if enabled. See <a href="#_configuring_swagger_optional">Configuring Swagger</a></p>
</div>
</div>
<div class="sect3">
<h4 id="oauth-2-0-on-entando"><a class="anchor" href="#oauth-2-0-on-entando"></a>4.4.7. OAUTH 2.0 ON ENTANDO</h4>
<div class="paragraph">
<p>Entando uses the <a href="https://tools.ietf.org/html/rfc6749">OAuth 2.0 authorization framework</a> to determine the methods for granting client applications access tokens to authenticate a request to an API endpoint. Access tokens allow API providers to authenticate their system’s users.</p>
</div>
</div>
<div class="sect3">
<h4 id="creating-an-api-consumer"><a class="anchor" href="#creating-an-api-consumer"></a>4.4.8. CREATING AN API CONSUMER</h4>
<div class="paragraph">
<p>From the Entando dashboard, select Integrations &gt; API Management &gt; Consumers. This opens the Consumers screen with a search utility and a table of existing API Keys.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/oauth_consumers.png" alt="oauth consumers" width="50%">
</div>
</div>
<div class="olist arabic">
<div class="title">To create a new access token:</div>
<ol class="arabic">
<li>
<p>Click <strong>Add</strong>.</p>
</li>
<li>
<p>Provide values for each of the fields. Different grant types require values for different parameters.</p>
<div class="imageblock">
<div class="content">
<img src="./images/oauth_paramters.png" alt="oauth paramters" width="50%">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Key</p>
</li>
<li>
<p>Secret</p>
</li>
<li>
<p>Name</p>
</li>
<li>
<p>Description</p>
</li>
<li>
<p>Callback URL - URL to open after the user successfully authenticates</p>
</li>
<li>
<p>Scope - Defines the level of access that this token grants</p>
</li>
<li>
<p>Expiration date</p>
</li>
</ul>
</div>
</li>
<li>
<p>Toggle all the grant types that your application will accept:</p>
<div class="ulist">
<ul>
<li>
<p>Authentication code: used by web and mobile apps and requires the app to launch a browser to begin the flow. Generally, the flow follows these steps:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The application opens a browser and connects the user with the OAuth server</p>
</li>
<li>
<p>The OAuth server prompts the user with an authorization and the user approves the app’s request</p>
</li>
<li>
<p>The user is returned to the application with an authorization code in the query string where the application exchanges it for an access token.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Password: only involves a single step: the application prompts the user to enter a standard username and password into a login form to collect the user’s credentials. The app then makes a POST request to the server to exchange the password for an access token.</p>
</li>
<li>
<p>Client credentials: suitable for machine-to-machine authentication to obtain an access token outside the context of a user. This is generally for clients that need information about themselves rather than about a user.</p>
</li>
<li>
<p>Refresh token: a token used to generate additional access tokens. This allows your application to deploy short-lived access tokens without having to collect credentials when one expires. The app requests this token along with the access and/or ID tokens as part of the user’s initial authentication.</p>
</li>
<li>
<p>Implicit: represents a way for a single-page JavaScript app to get an access token without an intermediate code exchange step. Implicit grant types are most often used by public clients.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>Save</strong> to create the access token.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="imagemagick-setup"><a class="anchor" href="#imagemagick-setup"></a>4.4.9. IMAGEMAGICK SETUP</h4>
<div class="paragraph">
<p>When you upload an image to Entando through the CMS plugin, it is automatically cropped into different formats to produce thumbnails ready to be used when presenting contents.</p>
</div>
<div class="paragraph">
<p>Entando uses a third party application called ImageMagick which is available for both Linux and Windows.</p>
</div>
<div class="paragraph">
<p>To crop the images properly, Entando requires that the ImageMagick library be present in the system. You can override this setting using steps for the relevant OS below.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Generally, only Windows systems require setup. You only need to set up a Linux system if you need to switch off thumbnail generation.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="linuxmac-setup"><a class="anchor" href="#linuxmac-setup"></a>LINUX/MAC SETUP</h5>
<div class="paragraph">
<p>Open the file systemParams.properties in the directory ./src/main/config of the Entando project.</p>
</div>
<div class="sect5">
<h6 id="toggling-thumbnail-creation-on-and-off"><a class="anchor" href="#toggling-thumbnail-creation-on-and-off"></a>TOGGLING THUMBNAIL CREATION ON AND OFF</h6>
<div class="paragraph">
<p>Adjust the <em>imagemagick.enabled</em> property to either True or False.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># set this parameter to true if imagemagick is installed on the system and you need to use it
imagemagick.enabled=true</pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="windows-setup"><a class="anchor" href="#windows-setup"></a>WINDOWS SETUP</h5>
<div class="paragraph">
<p>Configure the following properties to reflect the installation directory of ImageMagick on Windows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>imagemagick.windows=true
imagemagick.path=C:\\Program Files\\ImageMagick-6.6.3-Q16</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The CMS plugin will throw a 500 error if you upload an image with an improperly configured ImageMagick setup.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="creating-a-plugin-back-end"><a class="anchor" href="#creating-a-plugin-back-end"></a>4.4.10. CREATING A PLUGIN - BACK END</h4>
<div class="sect4">
<h5 id="introduction-2"><a class="anchor" href="#introduction-2"></a>INTRODUCTION</h5>
<div class="paragraph">
<p>This section introduces how to create a plugin for Entando 5.x and how to integrate it with the App Builder. The following paragraphs explain how to create the back end of the plugin. <a href="#plugincyclesample_front-end">Click here</a> for steps on creating the front end of the plugin to integrate with the App Builder.</p>
</div>
</div>
<div class="sect4">
<h5 id="plugincyclesample_back-end"><a class="anchor" href="#plugincyclesample_back-end"></a>INITIALIZE THE ENVIRONMENT</h5>
<div class="paragraph">
<p>The first step is to create a root directory for your application.</p>
</div>
<div class="paragraph">
<p>Once you have a root directory, download and install the necessary projects from the <a href="https://github.com/entando/">Entando github repository</a> into your project’s root folder. There are three required projects: entando-core, entando-components, and entando-archetypes. Complete the following steps three times: once for each of the necessary projects.</p>
</div>
<div class="olist arabic">
<div class="title">Complete the following steps IN ORDER:</div>
<ol class="arabic">
<li>
<p>From your root directory, clone the project through the shell command:<br>
<code>git clone <a href="https://github.com/entando/entando-&lt;PROJECT_SUFFIX&gt;.git" class="bare">https://github.com/entando/entando-&lt;PROJECT_SUFFIX&gt;.git</a></code></p>
</li>
<li>
<p>Navigate to the newly created folder.</p>
</li>
<li>
<p>Open the <em>pom.xml</em> file and note the current project version. You will need this version number later. Example:<br>
<code>&lt;version&gt;5.1.0-SNAPSHOT&lt;/version&gt;</code></p>
</li>
<li>
<p>Run the following command:<br>
<code>mvn clean install -DskipTests</code></p>
</li>
<li>
<p>Return to your root directory and re-run the steps for the next Entando project.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="create-an-entando-project"><a class="anchor" href="#create-an-entando-project"></a>CREATE AN ENTANDO PROJECT</h5>
<div class="paragraph">
<p>The following sections are for creating a new Entando project. If you already have the project set up, skip to the Add the Plugin to the Entando Project section.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the command line from your workspace folder.</p>
</li>
<li>
<p>Run the command:<br>
<code>mvn archetype:generate -Dfilter=entando</code></p>
</li>
<li>
<p>On the project type selection screen, choose the number corresponding to "org.entando.entando:entando-archetype-entando-sample".</p>
</li>
<li>
<p>Select the version that corresponds to the version number you noted in the Initialize the Environment section.</p>
<div class="ulist">
<ul>
<li>
<p>If that option is not available, take the following steps:<br></p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Navigate to your computer’s home directory and open the folder titled <em>.m2</em>.</p>
</li>
<li>
<p>Copy the file named <em>archetype-catalog.xml</em> and paste it into your Entando project folder.</p>
</li>
<li>
<p>Restart the steps in this section.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>For "groupId" enter <code>org.entando</code> (or the groupId of your company) and press <strong>ENTER</strong>.</p>
</li>
<li>
<p>For "artifactId", enter the name of the project and press <strong>ENTER</strong>.</p>
</li>
<li>
<p>For "version" leave the selection blank and press <strong>ENTER</strong>.</p>
</li>
<li>
<p>For "package" leave the selection blank and press <strong>ENTER</strong></p>
</li>
<li>
<p>In the configuration confirmation interface, type <code>Y</code> and press <strong>ENTER</strong>. You have now created your Entando project.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="create-a-custom-component-project"><a class="anchor" href="#create-a-custom-component-project"></a>CREATE A CUSTOM COMPONENT PROJECT</h5>
<div class="paragraph">
<p>Now, create an empty component project that reflects the entando-component structure present on GitHub. The project will serve as a container for the plugin that you are creating here.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clone and rename the project entando-components from <a href="https://github.com/entando/entando-components" class="bare">https://github.com/entando/entando-components</a>. Example of shell command:<br>
<code>git clone <a href="https://github.com/entando/entando-components.git" class="bare">https://github.com/entando/entando-components.git</a> [new-project-name]</code></p>
</li>
<li>
<p>Open the plugins folder and delete all folders except the <em>src</em> folder.</p>
</li>
<li>
<p>Open <em>plugins/pom.xml</em> and delete all module instances within the &lt;modules&gt; element.</p>
<div class="imageblock">
<div class="content">
<img src="./images/pcbe_modules.png" alt="pcbe modules">
</div>
</div>
</li>
<li>
<p>Open the the <em>ui-bundles</em> folder and delete all the subfolders.</p>
<div class="imageblock">
<div class="content">
<img src="./images/pcbe_uibundles.png" alt="pcbe uibundles">
</div>
</div>
</li>
<li>
<p>Open <em>ui-bundles/pom.xml</em> and delete all module instances within the &lt;modules&gt; element.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="create-a-prototype-plugin-called-phonebook"><a class="anchor" href="#create-a-prototype-plugin-called-phonebook"></a>CREATE A PROTOTYPE PLUGIN CALLED "PHONEBOOK"</h5>
<div class="paragraph">
<p>This step creates the basic structure of the plugin, on which all the resources generated by EDO will subsequently be inserted.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the <em>entando-components/plugins</em> folder on your command line.</p>
</li>
<li>
<p>Run the command:<br>
<code>mvn archetype:generate -Dfilter=entando</code></p>
</li>
<li>
<p>In the project type selection screen, choose the number corresponding to "org.entando.entando: entando-archetype-plugin-generic".</p>
</li>
<li>
<p>Select the version number you noted in Initialize the Environment, Step 3.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If that option is not available, take the following steps:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Navigate to your computer’s home directory and open the folder titled <em>.m2</em>.</p>
</li>
<li>
<p>Copy the file named <em>archetype-catalog.xml</em> and paste it into the <em>Repository</em> folder.</p>
</li>
<li>
<p>Restart the steps in this section.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>For "groupId" enter "org.entando.entando.plugins".</p>
</li>
<li>
<p>For "artifactId" enter "entando-plugin-jpphonebook" and press <strong>ENTER</strong>.</p>
</li>
<li>
<p>For "version" leave the selection blank and press <strong>ENTER</strong>.</p>
</li>
<li>
<p>For "package" leave the selection blank and press <strong>ENTER</strong>.</p>
</li>
<li>
<p>For the configuration confirmation interface, type 'N' and press <strong>ENTER</strong>.<br></p>
</li>
</ol>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The ‘N’ response is necessary to enter the part of the workflow that allows you to input new parameters for pluginCode (pre-set to "jpchangeme") and pluginName (pre-set to "Please Change Me")
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="10">
<li>
<p>Repeat steps 5 through 8.</p>
</li>
<li>
<p>For "pluginCode" enter "jpphonebook" and press <strong>ENTER</strong>.</p>
</li>
<li>
<p>For "pluginName" enter "Phone Book Plugin - Full Lifecycle Sample" and press <strong>ENTER</strong>.</p>
</li>
<li>
<p>In the configuration confirmation interface, press <strong>ENTER</strong>. This creates the plugin skeleton in a new folder called <em>entando-components/plugins/entando-plugin-jpphonebook</em>.</p>
<div class="imageblock">
<div class="content">
<img src="./images/pcbe_jpphonebook.png" alt="pcbe jpphonebook">
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="create-plugin-with-edo-component-generator"><a class="anchor" href="#create-plugin-with-edo-component-generator"></a>CREATE PLUGIN WITH EDO (COMPONENT GENERATOR)</h5>
<div class="paragraph">
<p>EDO is the official code generator tool for Entando.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Follow the instructions at <a href="https://github.com/entando/component-generator" class="bare">https://github.com/entando/component-generator</a> to build the necessary EDO jar.</p>
</li>
<li>
<p>Clone the project to the root of your own workspace:<br>
<code>git clone <a href="https://github.com/entando/component-generator.git" class="bare">https://github.com/entando/component-generator.git</a></code></p>
</li>
<li>
<p>Open the new <em>component-generator</em> folder and run the following command from the command line:<br>
<code>ant build</code></p>
</li>
<li>
<p>Open the <em>target</em> folder and copy <em>edo-5.x.x-SNAPSHOT.jar</em> into the <em>entando-components-sample/plugins/entando-plugin-jpphonebook</em> that you created in Step 13 of the Create a Prototype Plugin Called “Phonebook" section.</p>
</li>
<li>
<p>Define the structure of the object that the plugin will manage. For example, the plugin has to manage the "Contact" object consisting of the follow fields:</p>
<div class="ulist">
<ul>
<li>
<p>"firstname" - type "String" - required - max length 50 characters</p>
</li>
<li>
<p>"surname" - type "String" - required - max length 50 characters</p>
</li>
<li>
<p>"birthDate" - type "Date" - not required</p>
</li>
<li>
<p>"description" - type "String" - not required</p>
</li>
<li>
<p>"phoneNumber" - type "String" - required</p>
</li>
<li>
<p>"priority" - type "Integer" - not required</p>
</li>
</ul>
</div>
</li>
<li>
<p>Save the following JSON string as a new file called <em>edo-full_lifecycle_sample.json</em>. This is the first step in creating a JSON file that EDO requires to create the resources.<br></p>
</li>
</ol>
</div>
<div class="literalblock">
<div class="content">
<pre>{
    "packageName" : "org.entando.entando.plugins.jpphonebook",
    "model" : {
    "name" : "Contact",
    "fields" : [ {
      "name" : "firstname",
      "type" : "string",
      "required" : true,
      "length" : 50,
      "primaryKey" : false
    }, {
      "name" : "surname",
      "type" : "string",
      "required" : true,
      "length" : 50,
      "primaryKey" : false
    }, {
      "name" : "bornDate",
      "type" : "date",
      "required" : false,
      "length" : null,
      "primaryKey" : false
    }, {
      "name" : "description",
      "type" : "string",
      "required" : false,
      "length" : null,
      "primaryKey" : false
    }, {
      "name" : "phoneNumber",
      "type" : "string",
      "required" : true,
      "length" : null,
      "primaryKey" : false
    }, {
      "name" : "priority",
      "type" : "int",
      "required" : false,
      "length" : null,
      "primaryKey" : false
    } ]
  },
  "assets" : {
    "rest" : true,
    "cxf" : true,
    "specialWidget" : true,
    "internalServlet" : true,
    "adminConsole" : true,
    "adminConsoleProducer" : null
  }
}</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Open the <em>entando-components-sample/plugins/entando-plugin-jpphonebook</em> folder from the command line and run the following command:<br>
<code>java -jar edo-5.1.0-SNAPSHOT.jar -f edo-full_lifecycle_sample.json</code></p>
</li>
<li>
<p>Address duplicate file warnings from the console by removing the empty files created by the archetype and replacing them with those created by EDO.</p>
<div class="ulist">
<ul>
<li>
<p>component.xml file</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Delete the file <em>src/main/resources/component/plugins/jpphonebook/component.xml</em></p>
</li>
<li>
<p>Rename the file <em>src/main/resources/component/plugins/jpphonebook/change_me-component.xml</em> to <em>src/main/resources/component/plugins/jpphonebook/component.xml</em></p>
</li>
<li>
<p>Open the <em>component.xml</em> file and rename the content of element "description" to <em>Phone Book Plugin - Full Lifecycle Sample</em></p>
</li>
<li>
<p>Fix the default resources (sql script) associated with the component descriptor (component.xml file) of the plugin <em>entando-plugin-jpphonebook</em></p>
</li>
</ol>
</div>
</li>
<li>
<p>Open the folder <em>src/main/resources/sql/plugins/jpphonebook/</em></p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Delete files the following files:</p>
<div class="ulist">
<ul>
<li>
<p><em>port_data_production.sql</em></p>
</li>
<li>
<p><em>serv_data_production.sql</em></p>
</li>
<li>
<p><em>port_uninstallation.sql</em></p>
</li>
<li>
<p><em>serv_uninstallation.sql</em></p>
</li>
</ul>
</div>
</li>
<li>
<p>Rename the following files:</p>
<div class="ulist">
<ul>
<li>
<p><em>change_me-port_data_production.sql</em> to <em>port_data_production.sql</em></p>
</li>
<li>
<p><em>change_me-serv_data_production.sql</em> to <em>serv_data_production.sql</em></p>
</li>
</ul>
</div>
</li>
<li>
<p>Adjust the default test resources (sql script) associated with the component descriptor (component.xml file) of the plugin <em>entando-plugin-jpphonebook</em>.</p>
<div class="ulist">
<ul>
<li>
<p>Open the folder <em>src/test/resources/sql/plugins/jpphonebook</em></p>
</li>
<li>
<p>Delete files <em>port_data_test.sql</em> and <em>serv_data_test.sql</em></p>
</li>
<li>
<p>Rename the following files:</p>
<div class="ulist">
<ul>
<li>
<p><em>change_me-port_data_test.sql</em> to <em>port_data_test.sql</em></p>
</li>
<li>
<p><em>change_me-serv_data_test.sql</em> to <em>serv_data_test.sql</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Adjust the definition of Struts2 actions associated with the component of the plugin <em>entando-plugin-jpphonebook</em>.</p>
<div class="ulist">
<ul>
<li>
<p>Open the folder <em>src/main/resources</em></p>
</li>
<li>
<p>Delete file <em>entando-struts-plugin.xml</em>.</p>
</li>
<li>
<p>Rename <em>change_me-jpphonebook-contact-struts-plugin.xml</em> to <em>entando-struts-plugin.xml</em>
Upon completion, the plugin is ready for you to install and insert into an Entando project.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
For best performance, the plugin version <strong>must</strong> match the version of the Entando project you add it to.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="install-the-new-plugin-component"><a class="anchor" href="#install-the-new-plugin-component"></a>INSTALL THE NEW PLUGIN COMPONENT</h5>
<div class="paragraph">
<p>From the command line, open the <em>entando-components-sample</em> folder and run the following command:<br>
<code>mvn clean install -DskipTests</code></p>
</div>
<div class="paragraph">
<p>At the end of the process you should see the following message, indicating a successful install:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pcbe_successfulinstall.png" alt="pcbe successfulinstall">
</div>
</div>
</div>
<div class="sect4">
<h5 id="add-the-plugin-to-an-entando-project"><a class="anchor" href="#add-the-plugin-to-an-entando-project"></a>ADD THE PLUGIN TO AN ENTANDO PROJECT</h5>
<div class="paragraph">
<p>Open the pom.xml file of your project and insert the following snippet to the end inside the element:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;dependency&gt;
    &lt;groupId&gt;org.entando.entando.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;entando-plugin-jpphonebook&lt;/artifactId&gt;
    &lt;version&gt;${entando.version}&lt;/version&gt;
    &lt;type&gt;war&lt;/type&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="app-builder-component"><a class="anchor" href="#app-builder-component"></a>APP BUILDER COMPONENT</h5>
<div class="paragraph">
<p>The App Builder provides a user interface for managing the admin functions of the plugin. Therefore, the MApp Engine needs to expose services for the functions that plugins require. In the case of the Phonebook plugin, the MApp Engine must expose:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>APIs for CRUD operations on the Contact object. These APIs are available at the following endpoints:</p>
<div class="ulist">
<ul>
<li>
<p>GET List of contacts - URI "&lt;APPLICATION_BASE_URL&gt;/api/jpphonebook/contacts" (GET)</p>
</li>
<li>
<p>get single contact - URI "&lt;APPLICATION_BASE_URL&gt;/api/jpphonebook/contacts/{contactId}" (GET)</p>
</li>
<li>
<p>add single contact - URI "&lt;APPLICATION_BASE_URL&gt;/api/jpphonebook/contacts" (POST)</p>
</li>
<li>
<p>update single contact - URI "&lt;APPLICATION_BASE_URL&gt;/api/jpphonebook/contacts/{contactId}" (PUT)</p>
</li>
<li>
<p>delete single contact - URI "&lt;APPLICATION_BASE_URL&gt;/api/jpphonebook/contacts/{contactId}" (DELETE)</p>
</li>
</ul>
</div>
</li>
<li>
<p>The API for configuring the <em>Publish Contact</em> widget, which is the only EDO-generated widget that needs configuration. EDO provides the APIs that you need to create this UI but you must first custom develop and add a component for the validation. The validator is a bean class that extends the <em>WidgetConfigurationValidator</em> class.</p>
<div class="paragraph">
<p>In the case of the Phonebook plugin, the following is the <em>ContactPublisherWidgetValidator</em> class to include in the <em>org.entando.entando.plugins.jpphonebook.aps.system.services.contact.widgettype.validators package</em>:</p>
</div>
</li>
</ul>
</div>
<div class="literalblock">
<div class="content">
<pre>package
org.entando.entando.plugins.jpphonebook.aps.system.services.contact.widgettype.validators;

import com.agiletec.aps.system.exception.ApsSystemException;
import com.agiletec.aps.system.services.page.IPage;
import java.util.Map;
import org.apache.commons.lang3.StringUtils;
import org.entando.entando.aps.system.exception.RestServerError;
import org.entando.entando.aps.system.services.widgettype.validators.WidgetConfigurationValidator;
import org.entando.entando.plugins.jpphonebook.aps.system.services.contact.IContactManager;
import org.entando.entando.web.page.model.WidgetConfigurationRequest;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.validation.BeanPropertyBindingResult;

public class ContactPublisherWidgetValidator implements WidgetConfigurationValidator {

    private final Logger logger = LoggerFactory.getLogger(this.getClass());

    public static final String WIDGET_CODE = "jpphonebookContact";
    public static final String WIDGET_CONFIG_KEY_CONTACT_ID = "id";

    public static final String ERRCODE_CONTACT_ID_NULL = "1";
    public static final String ERRCODE_CONTACT_ID_INVALID = "2";

    private IContactManager contactManager;

    @Override
    public boolean supports(String widgetCode) {
        return WIDGET_CODE.equals(widgetCode);
    }

    @Override
    public BeanPropertyBindingResult validate(WidgetConfigurationRequest widget, IPage page) {
        BeanPropertyBindingResult bindingResult = new BeanPropertyBindingResult(widget, widget.getClass().getSimpleName());
        Map&lt;String, Object&gt; properties = (Map&lt;String, Object&gt;) widget.getConfig();
        String contactIdString = (null != properties) ? properties.get(WIDGET_CONFIG_KEY_CONTACT_ID).toString() : null;
        try {
            logger.debug("validating widget {} for page {}", widget.getCode(), page.getCode());
            if (StringUtils.isBlank(contactIdString)) {
                bindingResult.reject(ERRCODE_CONTACT_ID_NULL, new String[]{}, "Contact id is required");
                return bindingResult;
            }
            Integer contactId = Integer.parseInt(contactIdString);
            if (null == this.getContactManager().getContact(contactId)) {
                bindingResult.reject(ERRCODE_CONTACT_ID_INVALID, new String[]{"Contact", contactIdString}, "NOT_FOUND");
                return bindingResult;
            }
        } catch (NumberFormatException e) {
            bindingResult.reject(ERRCODE_CONTACT_ID_INVALID, new String[]{}, "Contact id is required");
        } catch (ApsSystemException e) {
            logger.error("error in validate wiget {} in page {}", widget.getCode(), page.getCode());
            throw new RestServerError("error in widget config validation", e);
        }
        return bindingResult;
    }

    protected IContactManager getContactManager() {
        return contactManager;
    }

    public void setContactManager(IContactManager contactManager) {
        this.contactManager = contactManager;
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>Insert the following bean definition into the file <em>full-lifecycle-sample/entando-components-sample/plugins/entando-plugin-jpphonebook/src/main/resources/spring/plugins/jpphonebook/aps/managers/jpphonebookContactManagersConfig.xml</em>
<code>&lt;bean id="jpphonebookContactPublisherWidgetValidator" class="org.entando.entando.plugins.jpphonebook.aps.system.services.contact.widgettype.validators.ContactPublisherWidgetValidator"&gt;
&lt;property name="contactManager" ref="jpphonebookContactManager" /&gt;
&lt;/bean&gt;</code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="plugincyclesample_front-end"><a class="anchor" href="#plugincyclesample_front-end"></a>4.4.11. CREATING A PLUGIN - FRONT END</h4>
<div class="sect4">
<h5 id="prerequisites-5"><a class="anchor" href="#prerequisites-5"></a>PREREQUISITES</h5>
<div class="paragraph">
<p>Prior to beginning this tutorial, you must perform the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Install the <a href="#creating-a-plugin-back-end">Plugin Cycle back end</a></p>
</li>
<li>
<p>Install node<br>
NOTE: Entando recommends using nvm to install and manage your node versions.</p>
</li>
<li>
<p>Install npm<br>
NOTE: you should use the latest LTS when working with Entando.</p>
</li>
<li>
<p>(OPTIONAL) Install <a href="https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd?hl=en">redux-devtools</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="installing-the-app-builder"><a class="anchor" href="#installing-the-app-builder"></a>INSTALLING THE APP BUILDER</h5>
<div class="paragraph">
<p>Clone the App Builder project (<a href="https://github.com/entando/app-builder" class="bare">https://github.com/entando/app-builder</a>) to your local machine. Be sure to install the version that matches the MApp Engine version you have installed.</p>
</div>
<div class="paragraph">
<p>Once you have cloned the project, run <code>npm install</code> to install all your dependencies.</p>
</div>
<div class="sect5">
<h6 id="configuring-your-env-file"><a class="anchor" href="#configuring-your-env-file"></a>CONFIGURING YOUR .ENV FILE</h6>
<div class="paragraph">
<p>With the App Builder installed, navigate to the App Builder’s root directory and create a file called <em>.env.development.local</em>. This file points the App Builder installation to the MApp Engine that you previously created.</p>
</div>
<div class="paragraph">
<p>If you are using the project sample that comes with this repo, the content of your .env file will be the following:<br>
<code>USE_MOCKS=false
DOMAIN=http://localhost:8080/project-sample</code></p>
</div>
<div class="paragraph">
<p>Save the file, then, while still in the root of the App Builder, run <code>npm start</code> to start the application server.</p>
</div>
</div>
<div class="sect5">
<h6 id="checking-your-env-file-configuration"><a class="anchor" href="#checking-your-env-file-configuration"></a>CHECKING YOUR .ENV FILE CONFIGURATION</h6>
<div class="paragraph">
<p>In the browser, you can use the redux devtools to see whether or not the state has  updated with the correct values. In Google Chrome, right-click and inspect or open the redux devtools directly.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/PCFE_rdevtools.png" alt="PCFE rdevtools">
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="adding-the-plugin-to-the-basic-app-builder-integration"><a class="anchor" href="#adding-the-plugin-to-the-basic-app-builder-integration"></a>ADDING THE PLUGIN TO THE BASIC APP BUILDER INTEGRATION</h5>
<div class="paragraph">
<p>To integrate the plugin with the App Builder, you need to add to it the App Builder scaffolding. Create a subdirectory within your plugin directory named <em>app-builder</em>. Clone the ui-component-sample project (<a href="https://github.com/entando/ui-component-sample" class="bare">https://github.com/entando/ui-component-sample</a>) and copy the content into the
<em>plugin directory/app-builder</em> folder.</p>
</div>
<div class="paragraph">
<p>The resulting directory tree will be similar to:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/PCFE_directory.png" alt="PCFE directory">
</div>
</div>
<div class="olist arabic">
<div class="title">Then edit the <em>package.json</em> file:</div>
<ol class="arabic">
<li>
<p>Replace the application name with the plugin name.</p>
</li>
<li>
<p>Rename the directory inside public/plugin-assets to match the name of the plugin.</p>
</li>
<li>
<p>Run <code>npm install</code></p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="add-the-plugin-to-the-app-builder"><a class="anchor" href="#add-the-plugin-to-the-app-builder"></a>ADD THE PLUGIN TO THE APP BUILDER</h5>
<div class="paragraph">
<p>In the App Builder directory, edit the <em>entando-plugins-config/plugins.json</em> file to add the new plugin.</p>
</div>
<div class="ulist">
<div class="title">You can build the array in one of two ways:</div>
<ul>
<li>
<p>It can contain only the name of the plugin provided the path to the App Builder directory matches the default, e.g.:<br>
<em>../entando-components/plugins/${pluginItem}/app-builder</em></p>
</li>
<li>
<p>Or you can specify it in an object, e.g.:<br></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>[
  {
    "name": "entando-plugin-jpphonebook",
    "path": "../entando-plugin-cycle-sample/entando-components-sample/plugins/entando-plugin-jpphonebook/app-builder"
  }
]</pre>
</div>
</div>
<div class="paragraph">
<p>Once finished, run the command <code>npm run import-plugins</code> to add the plugin to the App Builder.</p>
</div>
<div class="paragraph">
<p>You can now launch the App Builder and see the "Sample Plugin" label in the integration menu.</p>
</div>
</div>
<div class="sect4">
<h5 id="customize-the-plugin"><a class="anchor" href="#customize-the-plugin"></a>CUSTOMIZE THE PLUGIN</h5>
<div class="paragraph">
<p>The remainder of this tutorial deals with customizing the pages of the plugin within the App Builder. You can leave the App Builder instance running, but several steps require you to re-run the <code>npm run import-plugins</code> command to propagate new changes.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
All paths in the remainder of this document are relative to the plugin’s App Builder directory.
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="change-the-labels"><a class="anchor" href="#change-the-labels"></a>CHANGE THE LABELS</h6>
<div class="paragraph">
<p>To change the labels applied to the project, open the <em>src/locales/en.js</em> file and apply the correct plugin name to the <em>menu.itemLabel</em>. This defines the name of the plugin in the Integrations menu.</p>
</div>
<div class="paragraph">
<p>You must also make the same changes to the file’s Italian language counterpart, <em>src/locales/it/js</em>.</p>
</div>
</div>
<div class="sect5">
<h6 id="set-up-a-router"><a class="anchor" href="#set-up-a-router"></a>SET UP A ROUTER</h6>
<div class="paragraph">
<p>Set up a router for your new plugin by creating the action and selectors in the main state. The action changes the route, while the selector will be used to get the new route.</p>
</div>
<div class="paragraph">
<p>Once done, follow the existing structure to create the default router inside the new <em>src/ui/phone-book directory</em> and point to it in <em>src/index.js</em> as the uiComponent.</p>
</div>
</div>
<div class="sect5">
<h6 id="install-any-necessary-components"><a class="anchor" href="#install-any-necessary-components"></a>INSTALL ANY NECESSARY COMPONENTS</h6>
<div class="paragraph">
<p>If your plugin requires forms, validators, APIs, or patternfly, you can install them all with the following command:<br>
<code>npm i @entando/utils redux-form patternfly-react @entando/apimanager</code></p>
</div>
<div class="paragraph">
<p>===p BUILD YOUR FORMS TO HANDLE THE PLUGIN’S DATA
.Create the APIs, the state actions, and the forms following the samples in the following directories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>src/state/*</p>
</li>
<li>
<p>src/api/*</p>
</li>
<li>
<p>src/ui/phone-book/*</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="apply-widget-configuration-forms"><a class="anchor" href="#apply-widget-configuration-forms"></a>APPLY WIDGET CONFIGURATION FORMS</h5>
<div class="paragraph">
<p>If any of your widgets require a configuration form, you must return the correct components for each widget in the <em>index.js</em> of the plugin. Each widget code in the widgetForms key must use the value from the React component that renders the form.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">const plugin = {
  id,
  menuItemLabelId: 'menu.itemLabel',
  uiComponent,
  reducer,
  locales: [
    enLocale,
    itLocale,
  ],
  // workaround to use apimanager (the plugins compilation has to be pulled out from webpack)
  apiManagerConfig: config,
  widgetForms: {
    jpphonebookContact: ContactSelectContainer,
  },
};</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>If your form does not need special props or actions</strong>, you can return the form component itself and the App Builder will wrap it in a container.</p>
</div>
<div class="paragraph">
<p><strong>If you do need to retrieve specific data such as in the phone book example</strong>, you need to return a container and make sure that you are cascading down the existing props that the container inside App Builder is passing through.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Your <code>onSubmit</code> function calls the parent <em>onSubmit</em> especially if you need to perform additional mapping before passing the data through.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See the <em>src/ui/widgets/*</em> for fuller context of these concepts.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="working-with-entando-widgets"><a class="anchor" href="#working-with-entando-widgets"></a>4.5. WORKING WITH ENTANDO WIDGETS</h3>
<div id="widgets" class="paragraph">
<p>Widgets are how Entando interacts with users through the front end of a web application. CMS contents, input forms, and sign-in fields are examples of widgets. In short, everything in the front end of the webapp happens through widgets.</p>
</div>
<div class="paragraph">
<p><strong>Widgets have several defining characteristics:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>They do not contain business logic. The only logic present in a widget is relative to the presentation. The data a widget always comes from lower layers, either through a REST API or using a standard, custom tag.</p>
</li>
<li>
<p>They do not communicate. This is an Entando decision against using Portlets to make widgets leaner, more exportable, and easily modifiable. However, technologies are available on both the client and server sides to pass data between widgets, depending on the scenario.</p>
</li>
<li>
<p>They are technology agnostic, which is another Entando choice. We believe that developers must be free to create widgets using the technology they already know or are most proficient with.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="widget-catalog"><a class="anchor" href="#widget-catalog"></a>4.5.1. WIDGET CATALOG</h4>
<div class="paragraph">
<p>Every widget has a single entry in the widgetcatalog table of the <em>*Port</em> database. Beginning with Entando 5, the widget table has the following schema:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Structure of the widgetcatalog table</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Column name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">code</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">character varying(40) NOT NULL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* Primary key<br></p>
<p class="tableblock">* unique ID (code) of the widget<br></p>
<p class="tableblock">* for simpler widgets, this is the name of the widget’s JSP file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">titles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text NOT NULL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XML containing the human readable name of the widget for each language of the admin console</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* For widgets requiring configuration<br>
XML containing the parameters necessary for configuring the widget, and the Struts2 name of custom action to call for persisting the configuration</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">plugincode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">character varying(30)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* For widgets bundled with a plugin<br></p>
<p class="tableblock">* unique code of the plugin belonging to this widget</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">parenttypecode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">character varying(40)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* For widgets that are a specialization of an existing widget<br></p>
<p class="tableblock">* the id of the original widget used as a base for the current entry</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">defaultconfig</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For widgets that are a modification of an existing widget<br></p>
<p class="tableblock">* XML containing the permanent configuration of the current entry</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">locked</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">smallint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Express the ability to delete the widget. A value of 1 means the widget cannot be deleted, even by an administrator. A value of 0 means you can delete the widget.<br></p>
<p class="tableblock">* Possible values [0,1]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maingroup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Group ID of the widget’s owner</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="widget-catalog-examples"><a class="anchor" href="#widget-catalog-examples"></a>4.5.2. WIDGET CATALOG EXAMPLES</h4>
<div class="paragraph">
<p>The table below presents example values for each column, and their related meanings. The example values are unrelated to each other unless otherwise noted.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Example values for the widgetcalaog table</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Column name</th>
<th class="tableblock halign-left valign-top">value / notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">code</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">content_viewer<br>
<em>Note: this is the unique name of the widget. The system looks for:</em><br></p>
<p class="tableblock">* a FreeMarker script associated with this widget in the <em>guiframent.widgettypecode</em> table<br></p>
<p class="tableblock">* if the FreeMarker script is not found, then it looks for <em>webapp/WEB-INF/plugins/aps/jsp/content_viewer.jsp</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">titles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br>
 &lt;properties&gt;</strong><br>
 <strong>&lt;property key="en"&gt;Contents - Publish a List of Contents&lt;/property&gt;</strong><br>
 <strong>&lt;property key="it"&gt;Contenuti - Pubblica una Lista di Contenuti&lt;/property&gt;</strong><br>
<strong>&lt;/properties&gt;</strong><br></p>
<p class="tableblock"><em>Note: this XML contains the human readable names of the widgets available in the languages of the admin console</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br>
&lt;config&gt;<br>
&lt;parameter name="contentId"&gt;Content ID&lt;/parameter&gt;
   &lt;parameter name="modelId"&gt;Content Model ID&lt;/parameter&gt;<br>
   *&lt;action name="viewerConfig" /&gt;<br>
&lt;/config&gt;</strong></p>
<p class="tableblock"><em>Note: when configuring a widget on a page, the system will ask for the values of contentId and modelId; it will use the action viewerConfig to manage the configuration logic</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">plugincode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>jacms</strong></p>
<p class="tableblock"><em>Note: this is the code (unique ID) of the plugin this widget belongs to. This information determines the path of the underlying widget JSP (if any)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">parenttypecode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>entando-widget-navigation_bar</strong></p>
<p class="tableblock"><em>Note: this example shows that the current entry is a specialization of the entando-widget-navigation_bar widget. This widget’s configuration file is found in the following (defaultconfig) column</em></p>
<p class="tableblock">Widgets based on the Struts2 framework use the value <strong>formAction</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">defaultconfig</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br>
  &lt;properties&gt;<br>
   &lt;property key="navSpec"&gt;code(homepage)&lt;/property&gt;<br>
&lt;/properties&gt;</strong></p>
<p class="tableblock"><em>Note: this widget uses the setup above and is not configurable</em></p>
<p class="tableblock">Widgets based on the Struts2 framework have here the declaration of the action called when the widget is rendered in a page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">locked</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>1</strong></p>
<p class="tableblock">A value of 1 indicates that the widget is locked and cannot be deleted. A value of 0 allows administrators to delete the widget.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maingroup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>free</strong></p>
<p class="tableblock"><em>Note: this widget is freely accessible but must be placed on an accessible page to be used</em></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="basic-widgets"><a class="anchor" href="#basic-widgets"></a>4.5.3. BASIC WIDGETS</h4>
<div class="paragraph">
<p>Basic widgets in Entando are composed of two objects: a JSP file and a record in the widgetcatalog table.</p>
</div>
<div class="paragraph">
<p>In basic widgets, JSTL custom tags interact directly with the Entando core to generate dynamic data. Widgets that publish content (e.g., the “Publish a Content” widget (code: content_viewer)) or publish lists of content (e.g., “Publish a List of Contents” widget (code: content_viewer_list)) as well as the <a href="https://github.com/entando/entando-components/blob/v5.0.0/ui-bundles/widgets/entando-widget-language_choose/src/main/webapp/WEB-INF/aps/jsp/widgets/entando-widget-language_choose.jsp">language selector</a> and the <a href="https://github.com/entando/entando-components/blob/v5.0.0/ui-bundles/widgets/entando-widget-login_form/src/main/webapp/WEB-INF/aps/jsp/widgets/entando-widget-login_form.jsp">login widget</a> fall under this category.</p>
</div>
<div class="sect4">
<h5 id="example"><a class="anchor" href="#example"></a>EXAMPLE</h5>
<div class="paragraph">
<p><strong>To create a basic widget:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create the following file in your project:<br>
<em>src/main/webapp/WEB-INF/aps/jsp/widgets/hello_world.jsp</em></p>
</li>
<li>
<p>Copy the following HTML into the file you just created:<br>
<code>&lt;h3&gt;Hello world&lt;/h3&gt;</code></p>
</li>
<li>
<p>Execute the following query in the *Port database:<br>
<code>INSERT INTO widgetcatalog (code, titles, parameters, plugincode, parenttypecode, defaultconfig, locked, maingroup) VALUES ('hello_world', '&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;properties&gt;
&lt;property key="en"&gt;Hello World Widget&lt;/property&gt;
&lt;property key="it"&gt;Widget Ciao Mondo&lt;/property&gt;
&lt;/properties&gt;', NULL, NULL , NULL, NULL, 1, 'free');</code></p>
</li>
<li>
<p>Restart the Entando application. After restarting, the “Hello World" widget appears in the list of the available system widgets.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configuring-widgets"><a class="anchor" href="#configuring-widgets"></a>4.5.4. CONFIGURING WIDGETS</h4>
<div class="paragraph">
<p>Configurable basic widgets contain XML with a list of the parameters that needs to be configured and the action that handles the process of configuration. The action for the configuration varies by widget, but each has an abstraction layer that makes developing such actions easier.</p>
</div>
<div class="paragraph">
<p>The <em>widgetcatalog.parameters</em> column in the *Port database lists all basic widgets with configurable fields and what those fields are.</p>
</div>
<div class="paragraph">
<p>You can also retrieve configured parameters using the tag:<br>
<code>&lt;wp:currentWidget param=”config” configParan=”NAME_OF_THE_PARAMETER” /&gt;</code></p>
</div>
</div>
<div class="sect3">
<h4 id="struts2-based-widgets"><a class="anchor" href="#struts2-based-widgets"></a>4.5.5. STRUTS2-BASED WIDGETS</h4>
<div class="paragraph">
<p>Entando leverages the Struts2 framework to implement actions within certain widgets. These actions transfer data and help determine which result to render in the view. For more information about Struts2 widgets, see the Entando Developer Primer.</p>
</div>
<div class="paragraph">
<p>Struts2-based widgets require additional set up, so Entando recommends having the Entando Component Generator (formerly known as EDO) generate all the files. You can access the Component Generator here:
<a href="https://github.com/entando/component-generator/tree/v5.0.0-release" class="bare">https://github.com/entando/component-generator/tree/v5.0.0-release</a></p>
</div>
<div class="paragraph">
<p><strong>When working with Struts2-based widgets, Entando applications follow two steps:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The system detects that a Struts2-based widget needs to be rendered so it executes
the action specified in the record of the widget in the <em>widgetcatalog</em> table.</p>
</li>
<li>
<p>The application executes the action and renders a JSP as a result.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>One important difference between Basic and Struts2-based widgets is that Struts2 widgets are generally composed of multiple JSP files.</p>
</div>
<div class="paragraph">
<p>The exact details of how to build an action for a widget are in the Entando Developer Primer, but the key points are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Action paths are declared in the file:<br>
<em>./src/main/resources/entando-struts-plugin</em></p>
</li>
<li>
<p>The java class(es) implementing the action, the XML declaring the action itself, and the optional XML used for validation are found in the following path:<br>
<em>./src/main/java/&lt;reverse_domain_package&gt;/aps/internalservlet/</em></p>
</li>
<li>
<p>The XML declaring the actions references the JSP files in:<br>
<em>src/main/webapp/WEB-INF/aps/jsp/internalservlet/</em></p>
</li>
<li>
<p>The Spring bean underlying the action Java class is declared in:<br>
<em>src/main/resources/spring/apsadmin</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Struts2 makes available all properties and public methods declared in the Java class that implements the action. Mixing JSTL and Struts2 tags is also possible. Entando uses OGNL expression language to get and set properties of Java objects.</p>
</div>
<div class="sect4">
<h5 id="example-of-database-definition"><a class="anchor" href="#example-of-database-definition"></a>EXAMPLE OF DATABASE DEFINITION</h5>
<div class="paragraph">
<p><strong>Struts2-based widgets use the following configuration:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">column</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">parenttypecode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">formAction</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">defaultconfig</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br>
&lt;properties&gt;<br>
   &lt;property key="actionPath"&gt;/ExtStr2/do/FrontEnd/jpzoo/Animal/list.action&lt;/property&gt;<br>
&lt;/properties&gt;</strong></p>
<p class="tableblock"><em>Note: the action path always starts with /ExtStr2/, but /ExtStr2/ is not used in the action declaration</em></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="widget-configuration"><a class="anchor" href="#widget-configuration"></a>WIDGET CONFIGURATION</h5>
<div class="paragraph">
<p>Configuration for a Struts2-based widget configuration is different from that of basic widgets. <em>In this case the XML containing the configuration parameters does not work as expected.</em></p>
</div>
<div class="paragraph">
<p><strong>You can overcome this by doing the following:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creating a basic widget with a standard configuration</p>
</li>
<li>
<p>Using a Struts2 tag to trigger a standard action, e.g.,<br>
<code>&lt;wp:internalServlet actionPath=”/ExtStr2/do/ACTION_NAMESPACE/MY_ACTION” /&gt;</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using this method, the JSP created for the basic widget is a trigger for the next action that renders the proper JSP.</p>
</div>
<div class="paragraph">
<p>In this scenario, you can retrieve the configuration parameters inside the action class.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="list-of-entando-widgets"><a class="anchor" href="#list-of-entando-widgets"></a>4.6. LIST OF ENTANDO WIDGETS</h3>
<div class="sect3">
<h4 id="widgetlist"><a class="anchor" href="#widgetlist"></a>4.6.1. CREATING A LOGIN PAGE</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From the App Builder, go to UX Patterns &gt; Widgets.</p>
</li>
<li>
<p>Scroll down to the Stock section and select the Login Form widget.</p>
</li>
<li>
<p>Customize the redirect logic for the form in the Custom UI template to redirect to your desired landing page by page code. See the bold text in the example code below.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This redirect depends on your landing page having a unique widget to identify the correct landing page.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Set up your landing page to have an Owner and Join Group that are not protected.</p>
</li>
<li>
<p>Create your new page and add the Login Form widget. You can use the pre-defined Login page for this.</p>
</li>
<li>
<p>Set your Home Page to the login page.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="example-login-form"><a class="anchor" href="#example-login-form"></a>Example login form</h5>
<div class="paragraph">
<p>This example setup displays a login to all users. Configuring a generic landing page with some pages requiring authentication will follow roughly the same pattern with different permissions.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;#assign wp=JspTaglibs["/aps-core"]&gt;
&lt;h1&gt;&lt;@wp.i18n key="RESERVED_AREA" /&gt;&lt;/h1&gt;
&lt;#if (Session.currentUser.username != "guest") &gt;
	&lt;p&gt;&lt;@wp.i18n key="WELCOME" /&gt;, &lt;em&gt;${Session.currentUser}&lt;/em&gt;!&lt;/p&gt;
	&lt;#if (Session.currentUser.entandoUser) &gt;
	&lt;table class="table table-condensed"&gt;
		&lt;tr&gt;
			&lt;th&gt;&lt;@wp.i18n key="USER_DATE_CREATION" /&gt;&lt;/th&gt;
			&lt;th&gt;&lt;@wp.i18n key="USER_DATE_ACCESS_LAST" /&gt;&lt;/th&gt;
			&lt;th&gt;&lt;@wp.i18n key="USER_DATE_PASSWORD_CHANGE_LAST" /&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td&gt;${Session.currentUser.creationDate?default("-")}&lt;/td&gt;
			&lt;td&gt;${Session.currentUser.lastAccess?default("-")}&lt;/td&gt;
			&lt;td&gt;${Session.currentUser.lastPasswordChange?default("-")}&lt;/td&gt;

&lt;script&gt;
localStorage.setItem("accessToken", "${Session.currentUser.accessToken}");
console.log("${Session.currentUser.accessToken}");
&lt;/script&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
		&lt;#if (!Session.currentUser.credentialsNotExpired) &gt;
		&lt;div class="alert alert-block"&gt;
			&lt;p&gt;&lt;@wp.i18n key="USER_STATUS_EXPIRED_PASSWORD" /&gt;: &lt;a href="&lt;@wp.info key="systemParam" paramName="applicationBaseURL" /&gt;do/editPassword.action"&gt;&lt;@wp.i18n key="USER_STATUS_EXPIRED_PASSWORD_CHANGE" /&gt;&lt;/a&gt;&lt;/p&gt;
		&lt;/div&gt;
		&lt;/#if&gt;
	&lt;/#if&gt;
	&lt;@wp.ifauthorized permission="enterBackend"&gt;
	&lt;div class="btn-group"&gt;
		&lt;a href="&lt;@wp.info key="systemParam" paramName="applicationBaseURL" /&gt;do/main.action?request_locale=&lt;@wp.info key="currentLang" /&gt;" class="btn"&gt;&lt;@wp.i18n key="ADMINISTRATION" /&gt;&lt;/a&gt;
	&lt;/div&gt;
	&lt;/@wp.ifauthorized&gt;
	&lt;p class="pull-right"&gt;&lt;a href="&lt;@wp.info key="systemParam" paramName="applicationBaseURL" /&gt;do/logout.action" class="btn"&gt;&lt;@wp.i18n key="LOGOUT" /&gt;&lt;/a&gt;&lt;/p&gt;
	&lt;@wp.pageWithWidget widgetTypeCode="userprofile_editCurrentUser" var="userprofileEditingPageVar" listResult=false /&gt;
	&lt;#if (userprofileEditingPageVar??) &gt;
	&lt;p&gt;&lt;a href="&lt;@wp.url page="${userprofileEditingPageVar.code}" /&gt;" &gt;&lt;@wp.i18n key="userprofile_CONFIGURATION" /&gt;&lt;/a&gt;&lt;/p&gt;
	&lt;/#if&gt;
&lt;#else&gt;
	&lt;#if (accountExpired?? &amp;&amp; accountExpired == true) &gt;
	&lt;div class="alert alert-block alert-error"&gt;
		&lt;p&gt;&lt;@wp.i18n key="USER_STATUS_EXPIRED" /&gt;&lt;/p&gt;
	&lt;/div&gt;
	&lt;/#if&gt;
	&lt;#if (wrongAccountCredential?? &amp;&amp; wrongAccountCredential == true) &gt;
	&lt;div class="alert alert-block alert-error"&gt;
		&lt;p&gt;&lt;@wp.i18n key="USER_STATUS_CREDENTIALS_INVALID" /&gt;&lt;/p&gt;
	&lt;/div&gt;
	&lt;/#if&gt;
	&lt;form action="&lt;@wp.url/&gt;" method="post" class="form-horizontal margin-medium-top"&gt;
		&lt;#if (RequestParameters.returnUrl??) &gt;
		&lt;input type="hidden" name="returnUrl" value="${RequestParameters.returnUrl}" /&gt;

                 <strong>&lt;#else&gt;
                   &lt;@wp.pageWithWidget widgetTypeCode="home_page_cards" var="homePageCards" listResult=false /&gt;
                &lt;#if (homePageCards??) &gt;
		&lt;input type="hidden" name="returnUrl" value="&lt;@wp.url page="${homePageCards.code}" /&gt;" /&gt;
                &lt;/#if&gt;</strong>
		&lt;/#if&gt;



		&lt;div class="control-group"&gt;
			&lt;label for="username" class="control-label"&gt;&lt;@wp.i18n key="USERNAME" /&gt;&lt;/label&gt;
			&lt;div class="controls"&gt;
				&lt;input id="username" type="text" name="username" class="input-xlarge" /&gt;
			&lt;/div&gt;
		&lt;/div&gt;
		&lt;div class="control-group"&gt;
			&lt;label for="password" class="control-label"&gt;&lt;@wp.i18n key="PASSWORD" /&gt;&lt;/label&gt;
			&lt;div class="controls"&gt;
				&lt;input id="password" type="password" name="password" class="input-xlarge" /&gt;
			&lt;/div&gt;
		&lt;/div&gt;
		&lt;div class="form-actions"&gt;
			&lt;input type="submit" value="&lt;@wp.i18n key="SIGNIN" /&gt;" class="btn btn-primary" /&gt;
		&lt;/div&gt;
	&lt;/form&gt;
&lt;/#if&gt;</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="digital-exchange-2"><a class="anchor" href="#digital-exchange-2"></a>4.7. DIGITAL EXCHANGE</h3>
<div class="paragraph">
<p>Entando Digital Exchange is a marketplace from which users can install different Widgets, Components, Fragments, Page Models, Content Models and Content Types.</p>
</div>
<div class="paragraph">
<p>A Digital Exchange (DE) is a special Entando instance able to provide components that can be installed in other Entando instances via the App Builder.</p>
</div>
<div class="sect3">
<h4 id="using-a-digital-exchange"><a class="anchor" href="#using-a-digital-exchange"></a>4.7.1. USING A DIGITAL EXCHANGE</h4>
<div class="paragraph">
<p>In order to use a DE it is necessary to add the DE plugin to your Entando application adding the following dependency in the pom.xml file:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;dependency&gt;
    &lt;groupId&gt;org.entando.entando.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;entando-plugin-jpdigital-exchange&lt;/artifactId&gt;
    &lt;version&gt;${entando.version}&lt;/version&gt;
    &lt;type&gt;war&lt;/type&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Then in the App Builder edit the .env file for enabling the DE</p>
</div>
<div class="literalblock">
<div class="content">
<pre>DIGITAL_EXCHANGE_UI_ENABLED=true</pre>
</div>
</div>
<div class="paragraph">
<p>Start you Entando instance and from the App Builder go to the Digital Exchange page (from top menu) and open the configuration panel (gear icon).</p>
</div>
<div class="paragraph">
<p>Click on "Add Digital Exchange" and configure the DE you want to use. You can also use multiple DE instances. Key and secret fields are used to connecting to the DE using OAuth2.
The DE administrator has to provide you this credentials.</p>
</div>
<div class="paragraph">
<p>You should now be able to see components provided by the DE and install them.</p>
</div>
<div class="sect4">
<h5 id="loggingauditing-information"><a class="anchor" href="#loggingauditing-information"></a>LOGGING/AUDITING INFORMATION</h5>
<div class="paragraph">
<p>When an user starts an installation/uninstallation, the process is handled by an asynchronous job. Job information, including also start/end time, status and the user who triggered the job, is stored into the <code>digital_exchange_jobs</code> table (serv database).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="setup-your-digital-exchange"><a class="anchor" href="#setup-your-digital-exchange"></a>4.7.2. SETUP YOUR DIGITAL EXCHANGE</h4>
<div class="paragraph">
<p>Clone or download the DE project: <a href="https://github.com/entando/digital-exchange" class="bare">https://github.com/entando/digital-exchange</a> and start it in the same way of other Entando instances.</p>
</div>
<div class="sect4">
<h5 id="create-credentials-for-digital-exchange-clients"><a class="anchor" href="#create-credentials-for-digital-exchange-clients"></a>CREATE CREDENTIALS FOR DIGITAL EXCHANGE CLIENTS</h5>
<div class="paragraph">
<p>From the Admin Console go to Integrations &gt; API Management &gt; <strong>Consumers</strong></p>
</div>
<div class="paragraph">
<p>Add a new Consumer:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>fill the required fields</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Callback URL is blank</p>
</li>
<li>
<p>scope is "read,write,trust"</p>
</li>
</ol>
</div>
</li>
<li>
<p>in "Authorized Grant Types" section, set to ON the <code>client_credentials</code> toggle button.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This credentials have to be put by DE clients inside their DE configuration (see above).</p>
</div>
</div>
<div class="sect4">
<h5 id="create-a-component"><a class="anchor" href="#create-a-component"></a>CREATE A COMPONENT</h5>
<div class="paragraph">
<p>A component consists in a folder containing a set of files that are used to insert new data into an Entando instance.
Component providers need to create these files carefully respecting the constraints listed below. To generate the structure of simple components like a page model we suggest using the dedicated command of the command line tool (see section "custom local components").</p>
</div>
<div class="paragraph">
<p>A component has a name, a version and an id. The id must be unique between all the exchanges, so it can be a composition of a DE unique identifier, the component name and the component version.</p>
</div>
<div class="paragraph">
<p>Inside the component folder it is mandatory to have a file named <strong>component.xml</strong> (the component descriptor), describing the component installation/uninstallation needs.
The component descriptor can reference other files using a relative path, so all the paths must be prefixed by the component id (e.g. <code>&lt;component_id&gt;/relative/path</code>).</p>
</div>
<div class="paragraph">
<p>Other files must be put in the following sub-directories:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>data</strong>: used for files needed only during the installation/uninstallation process;</p>
</li>
<li>
<p><strong>resources</strong>: used for public resources (like images, CSS and JavaScript files).</p>
</li>
</ol>
</div>
<div class="sect5">
<h6 id="define-installationuninstallation-operations"><a class="anchor" href="#define-installationuninstallation-operations"></a>DEFINE INSTALLATION/UNINSTALLATION OPERATIONS</h6>
<div class="paragraph">
<p>The component descriptor can contain a sequence of operations defined using Spring SpEL: this allows the execution of bean methods.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;component&gt;
    &lt;!-- ... --&gt;
    &lt;installation&gt;
        &lt;execution&gt;
            &lt;op&gt;@myBean.myMethod()&lt;/op&gt;
            &lt;op&gt;...&lt;/op&gt;
        &lt;/execution&gt;
    &lt;/installation&gt;
&lt;/component&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>The most common use case is to call a controller method, which usually needs a model passed as parameter. The model can be parsed from a JSON or XML file.
It is possible to use a simple bean called <code>ModelParser</code> to do this inside a SpEL expression, e.g.:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>@modelParser.parse('&lt;component_id&gt;/data/my_model.json', T(org.entando.entando.web.MyModelClass))</pre>
</div>
</div>
<div class="paragraph">
<p>The system provides also some <strong>utility functions</strong> in order to simplify the writing of the most common operations:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>the <code>#bindingResult()</code> custom SpEL function provides an instance of a <code>BindingResult</code> class, used in a lot of controllers for handling validation error messages;</p>
</li>
<li>
<p>the <code>#call()</code> custom SpEL function can be used for the most common operations, like creating a label or a contentModel. It accepts an operation name as the first parameter and the path of a file containing the model for that operation as the second parameter. So, for example, for creating a label it is possible to use the following expression: <code>#call('createLabel', '&lt;component_id&gt;/data/label.json')</code></p>
<div class="ulist">
<ul>
<li>
<p>Supported operations are:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>createPageModel</code>/<code>deletePageModel</code></p>
</li>
<li>
<p><code>createWidget</code>/<code>deleteWidget</code></p>
</li>
<li>
<p><code>createGroup</code>/<code>deleteGroup</code></p>
</li>
<li>
<p><code>createRole</code>/<code>deleteRole</code></p>
</li>
<li>
<p><code>createLabel</code>/<code>deleteLabel</code></p>
</li>
<li>
<p><code>createContentType</code>/<code>deleteContentType</code> (CMS plugin must be installed)</p>
</li>
<li>
<p><code>createContentModel</code>/<code>deleteContentModel</code> (CMS plugin must be installed)</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="use-static-resources-in-a-page-model"><a class="anchor" href="#use-static-resources-in-a-page-model"></a>USE STATIC RESOURCES IN A PAGE MODEL</h6>
<div class="paragraph">
<p>If you put a static resource in the resources folder, after the installation it will be available at the following URL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;resources_url&gt;/components/&lt;component_id&gt;/&lt;resource_name&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>So you can reference it from a FreeMarker template using the dedicated tag:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;#assign wp=JspTaglibs["/aps-core"]&gt;
    &lt;!-- ... -&gt;
    &lt;@wp.resourceURL /&gt;components/my_component_id/style.css" /&gt;</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="sql-execution"><a class="anchor" href="#sql-execution"></a>SQL EXECUTION</h6>
<div class="paragraph">
<p>Even if it is discouraged (because it ignores validation logic), it is possible to execute SQL statements during the installation/uninstallation process.</p>
</div>
<div class="paragraph">
<p>Put your SQL file into the data directory and reference it in the component.xml, specifying if its target is the port or the serv database, as in the following example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;component&gt;
    &lt;!-- ... --&gt;
    &lt;installation&gt;
        &lt;environment code="production"&gt;
            &lt;defaultSqlResources&gt;
                &lt;datasource name="portDataSource"&gt;
                    my_component_id/data/scriptPort.sql
                &lt;/datasource&gt;
                &lt;datasource name="servDataSource"&gt;
                    my_component_id/data/scriptServ.sql
                &lt;/datasource&gt;
            &lt;/defaultSqlResources&gt;
        &lt;/environment&gt;
    &lt;/installation&gt;
&lt;/component&gt;</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="examples"><a class="anchor" href="#examples"></a>EXAMPLES</h6>
<div class="paragraph">
<p>Some complete examples can be found here: <a href="https://github.com/entando/de-cli/tree/master/demo_components/data" class="bare">https://github.com/entando/de-cli/tree/master/demo_components/data</a></p>
</div>
<div class="paragraph">
<p>You can upload these demo components on your DE using the DE command line tool (see section below).</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="configure-the-de-to-provide-a-component"><a class="anchor" href="#configure-the-de-to-provide-a-component"></a>CONFIGURE THE DE TO PROVIDE A COMPONENT</h5>
<div class="paragraph">
<p>Put your component folder on a git repository and then configure the DE to retrieve component data from that repository. A graphical interface for doing this has not been implemented yet, but we have implemented a command line tool that calls directly the DE API.</p>
</div>
<div class="paragraph">
<p>You can get the tool at this repository: <a href="https://github.com/entando/de-cli" class="bare">https://github.com/entando/de-cli</a></p>
</div>
<div class="paragraph">
<p>Follow the instructions provided in the README for installing the tool (npm and node are required).</p>
</div>
<div class="paragraph">
<p>Type <code>./de-cli.js --help</code> to see the list of the supported components.</p>
</div>
<div class="sect5">
<h6 id="setup-the-keypair"><a class="anchor" href="#setup-the-keypair"></a>SETUP THE KEYPAIR</h6>
<div class="paragraph">
<p>Each component package is signed after its creation using asymmetric cryptography, in order to prevent clients to install tampered packages.</p>
</div>
<div class="paragraph">
<p>So, before adding any component metadata, it is necessary to create a keypair. This can be done using the following command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js create-keypair</pre>
</div>
</div>
<div class="paragraph">
<p>The private key is stored on disk and it is encrypted using the password set in the .env file (see <code>DE_COMPONENT_PASSWORD</code> property).</p>
</div>
<div class="paragraph">
<p>If you want to verify the keypair existence you can obtain the public key using the following command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js print-public-key</pre>
</div>
</div>
<div class="paragraph">
<p>If you need to delete the keypair you can use the following command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js delete-keypair</pre>
</div>
</div>
<div class="paragraph">
<p>When a keypair is deleted all the component package signatures are set to null (so it is not possible to install the components). Signatures are generated again when a new keypair is created. <strong>WARNING</strong>: If you generate a new keypair you have to notify all your clients that the keypair is changed. A DE client retrieves the public key from the DE when its configuration is added, so clients need to delete their DE configuration and add it again in order to retrieve the updated public key.</p>
</div>
</div>
<div class="sect5">
<h6 id="add-repository-information"><a class="anchor" href="#add-repository-information"></a>ADD REPOSITORY INFORMATION</h6>
<div class="paragraph">
<p>DE components are retrieved from one or more git repositories. Add the repository configuration using the <code>add-repository</code> command and typing the asked information:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js add-repository
Repository name: demo_repo
Repository URL: https://github.com/entando/de-cli.git</pre>
</div>
</div>
<div class="paragraph">
<p>An unique identifier is generated for each repository and it is used for referencing the repository in other commands. Currently only public repositories are supported.</p>
</div>
<div class="paragraph">
<p>To obtain the list of all configured repositories you can use:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js list-repositories</pre>
</div>
</div>
<div class="paragraph">
<p>To delete a repository you can use:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js delete-repository &lt;repo-id&gt;</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="add-component-metadata"><a class="anchor" href="#add-component-metadata"></a>ADD COMPONENT METADATA</h6>
<div class="paragraph">
<p>After you have added a repository you can add component metadata in order to create a package.</p>
</div>
<div class="paragraph">
<p>There are 2 ways to add component metadata: interactively and from a JSON file.</p>
</div>
<div class="paragraph">
<p>The interactive mode asks you the component metadata (a list of available repository identifiers is provided):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js add-component
Component name: hello_widget
Component version: 5.2.0-V1
Component id (hello_widget_5.2.0-V1): hello_widget_v1
Component description: Hello Widget Description
Component type: widget
Repository id
[Available 503 (demo_repo)]: 503
Repository directory: demo_components/data/hello_widget
Commit id (empty for last commit):
Component hello_widget_v1 added</pre>
</div>
</div>
<div class="paragraph">
<p>The metadata can contain also a commit id (useful for supporting multiple versions of the same component) and a repository subdirectory (useful for providing multiple components using a single repository).</p>
</div>
<div class="paragraph">
<p>Alternatively you can create a JSON file containing this information and pass it to the command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
    "id": "hello_widget_v1",
    "name": "hello_widget",
    "description": "Hello Widget Description",
    "type": "widget",
    "version": "5.2.0-V1",
    "repoId": 503,
    "repoDirectory": "demo_components/data/hello_widget"
}

./de-cli.js add-component hello_widget.json</pre>
</div>
</div>
<div class="paragraph">
<p>The insertion of a component metadata triggers the retrieval of the component data from the configured git repository. The data is packed as a zip file and the signature of this package is generated. This process happens asynchronously, so it could take some time before the signature is initialized. You can use the command <code>list-components</code> to check the existence of the signature (a component without a signature can&#8217;t be installed):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js list-components
┌─────────┬───────────────────┬──────────┬───────────┐
│ (index) │        id         │   type   │ signature │
├─────────┼───────────────────┼──────────┼───────────┤
│    0    │ 'hello_widget_v1' │ 'widget' │   'YES'   │
└─────────┴───────────────────┴──────────┴───────────┘</pre>
</div>
</div>
<div class="paragraph">
<p>To delete a component use:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js delete-component &lt;component_id&gt;</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="upload-component-image"><a class="anchor" href="#upload-component-image"></a>UPLOAD COMPONENT IMAGE</h6>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js add-component-image &lt;component_id&gt; &lt;file&gt;</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="demo-components"><a class="anchor" href="#demo-components"></a>DEMO COMPONENTS</h6>
<div class="paragraph">
<p>The DE command line tool repository provides also a folder containing a set of demo components.
To add all these components and their icons use:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js add-demo-components</pre>
</div>
</div>
<div class="paragraph">
<p>Keypair and demo repository are automatically added if they are missing.</p>
</div>
<div class="paragraph">
<p>To delete the demo components and the demo repository use:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js cleanup-demo-components</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="custom-local-components"><a class="anchor" href="#custom-local-components"></a>CUSTOM LOCAL COMPONENTS</h6>
<div class="paragraph">
<p>If you want to create your first custom components and test them locally you can use the dedicated command that guides you in the creation using some templates.
The command line tools will generate a folder for the component inside the directory specified in the .env file using the property <code>LOCAL_REPO_URL</code>. This folder must be outside the de-cli repository because it is versioned using git too.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js create-local-component
Select component type:
1. contentModel
2. contentType
3. pageModel
4. widget
Component type: 1
Component name: my_content_model
Component version: 1.0
Component id (my_content_model_1.0):
Component description: My description</pre>
</div>
</div>
<div class="paragraph">
<p>This will generate a basic component in your local repository directory. Changes are automatically committed to the git repository after the component generation. If you want to customize the generated component remember to commit your additional changes.</p>
</div>
<div class="paragraph">
<p>You can add the generated component to the DE using the <code>add-component</code> command, but for the local components we provide also a simplified version that needs only the component id:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js add-local-component &lt;component-id&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>If you want to delete a component both from the DE and the local repository you can use the following command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./de-cli.js delete-local-component &lt;component-id&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>We suggest using this command instead of a manual removal because it automatically commits the removed directory and cleanups the component metadata on the DE.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="customize-component-rating"><a class="anchor" href="#customize-component-rating"></a>CUSTOMIZE COMPONENT RATING</h5>
<div class="paragraph">
<p>Component rating functionality can be customized editing the file src/main/resources/digital-exchange.properties:</p>
</div>
<div class="paragraph">
<p>To completely disable the rating service use:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>enable-rating=false</pre>
</div>
</div>
<div class="paragraph">
<p>If you need to change the range of the stored rating values you can update the limits using the following properties:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>rate-min=0
rate-max=10</pre>
</div>
</div>
<div class="paragraph">
<p>This can be useful in order to provide compatibility with other rating system. Notice that the range is adapted only inside the database, while the API will always work using the 1-5 range to adopt a standardized range between all the DE instances. This corresponds to the stars on the UI.</p>
</div>
<div class="paragraph">
<p>So, using the range provided in the example the conversion will be:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 50%;">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">API value</th>
<th class="tableblock halign-left valign-top">DB value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="troubleshooting-2"><a class="anchor" href="#troubleshooting-2"></a>4.7.3. TROUBLESHOOTING</h4>
<div class="sect4">
<h5 id="client-issues"><a class="anchor" href="#client-issues"></a>Client issues</h5>
<div class="sect5">
<h6 id="invalid-signature"><a class="anchor" href="#invalid-signature"></a>Invalid signature</h6>
<div class="paragraph">
<p>As a security measure all the component packages are signed. If, installing a component, the installation job fails with the error "<em>SignatureMatchingException: Component signature not matching public key</em>", it means that signature verification has failed. This can have 2 different causes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>the package has been tampered, so the system avoided you to install a broken/malicious package;</p>
</li>
<li>
<p>the DE administrator regenerated the keypair used in the signature.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>So, ask to the DE administrator if he/she has just regenerated the keypair and in that case delete the DE configuration and add it again. This will trigger the retrieval of the new public key from the DE.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="jboss-eap-deployment"><a class="anchor" href="#jboss-eap-deployment"></a>4.8. JBOSS EAP DEPLOYMENT</h3>
<div class="sect3">
<h4 id="jboss_eap_deployment"><a class="anchor" href="#jboss_eap_deployment"></a>4.8.1. PREREQUISITES</h4>
<div class="ulist">
<ul>
<li>
<p>JDK 1.8 (Oracle version)</p>
</li>
<li>
<p>Maven (for packaging the application WAR file)</p>
</li>
<li>
<p>Ant (for database schema generation)</p>
</li>
<li>
<p>JBoss EAP instance installed</p>
</li>
<li>
<p>Access to an external database (Postgres or MySQL). If you need to create the databases, install the following tools:</p>
<div class="ulist">
<ul>
<li>
<p>Postgres: <a href="https://www.postgresql.org/docs/9.6/static/app-psql.html" class="bare">https://www.postgresql.org/docs/9.6/static/app-psql.html</a></p>
</li>
<li>
<p>MySQL: <a href="https://dev.mysql.com/doc/refman/8.0/en/programs-client.html" class="bare">https://dev.mysql.com/doc/refman/8.0/en/programs-client.html</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="introduction-3"><a class="anchor" href="#introduction-3"></a>4.8.2. INTRODUCTION</h4>
<div class="paragraph">
<p>This tutorial walks you through how to package and deploy an Entando application to JBoss Enterprise Application Platform (EAP). It assumes you will use an external database.</p>
</div>
<div class="paragraph">
<p>You can create a new Entando application by taking ONE of the following actions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download a <a href="https://central.entando.com/en/downloads.page">started application</a> and modify as needed OR</p>
</li>
<li>
<p>Create a new empty project using a Maven archetype</p>
<div class="ulist">
<ul>
<li>
<p>See the <a href="https://central.entando.com/en/documentation.page#_creating_a_new_entando_project">getting started guide</a> for more details</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The common structure of the project is as follows:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/RHJED_common_structure.png" alt="346" width="435">
</div>
</div>
</div>
<div class="sect3">
<h4 id="procedure"><a class="anchor" href="#procedure"></a>4.8.3. PROCEDURE</h4>
<div class="sect4">
<h5 id="prepare-the-database"><a class="anchor" href="#prepare-the-database"></a>PREPARE THE DATABASE</h5>
<div class="paragraph">
<p>The information in Entando is stored in a pair of database schemas: one named “port” in the code base and properties, and the other named “serv.”</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Port schema stores dynamic content of the site (e.g., pages, UI fragments)</p>
</li>
<li>
<p>The Serv schema stores administrative content (e.g., authorization, API configuration, user actions)</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>There is no table name collision between the two schemas, but you should keep them separate so that the content remains separate from the administrative data.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For any external database, you must first generate the table structure (schema) and then preload the initial data which includes basic content and an admin user to log in with and begin customization. Entando supports Postgres and MySQL databases and can support many other database vendors. Contact your Entando representative for assistance.</p>
</div>
<div class="paragraph">
<p>The sections below outline using Ant tasks to generate the schemas with initial datasets. Additional Ant tasks are available to assist with backup and migration. See the buildTasks.xml file in the root of an Entando project directory for more details.</p>
</div>
<div class="sect5">
<h6 id="if-using-a-postgres-database"><a class="anchor" href="#if-using-a-postgres-database"></a>IF USING A POSTGRES DATABASE</h6>
<div class="paragraph">
<p>From the root of your project directory, open the <em>buildProperties.xml</em> file. If necessary, adjust the <em>value</em> arguments in the following section of the file to match your database values:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;property name="postgres.hostname" value="localhost" /&gt;
&lt;property name="postgres.port" value="5432" /&gt;
&lt;property name="postgres.username" value="agile" /&gt;
&lt;property name="postgres.password" value="agile" /&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Then specify the path of the PostgreSQL binaries, e.g.,:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;property name=postgres.bin.path" location="C:\Program Files\PostgreSQL\8.3\bin" /&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>From your terminal in the root of your project directory, run the following Ant task:</p>
</div>
<div class="paragraph">
<p><code>ant PG-db-create</code></p>
</div>
</div>
<div class="sect5">
<h6 id="if-using-a-mysql-database"><a class="anchor" href="#if-using-a-mysql-database"></a>IF USING A MYSQL DATABASE</h6>
<div class="paragraph">
<p>From the root of your project directory, open the <em>buildProperties.xml</em> file. If necessary, make changes to the value arguments in the following section of the file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;property name="mysql.hostname" value="localhost" /&gt;
&lt;property name="mysql.port" value="3306" /&gt;
&lt;property name="mysql.username" value="agile" /&gt;
&lt;property name="mysql.password" value="agile" /&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Then specify the path of the MySQL binaries e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;property name="mysql.bin.path" value="C:\Program Files\MySQL\5\bin" /&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>From your terminal in the root of your project directory, run the following ant task:</p>
</div>
<div class="paragraph">
<p><code>ant MySQL-db-create</code></p>
</div>
<div class="paragraph">
<p>For more information about first-time Entando project setups, see the First Developers' Guide.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="jboss-configuration"><a class="anchor" href="#jboss-configuration"></a>JBOSS CONFIGURATION</h5>
<div class="paragraph">
<p>The next step is to configure JBoss to provide connectivity to the two database schemas through a Java Naming and Directory Interface (JNDI) lookup address.  This is a typical configuration step for an enterprise Java application and allows Entando to abstract the actual database configuration from the code, allowing it to make a connection to the database by looking it up by a general name.</p>
</div>
<div class="paragraph">
<p>The following steps contain instructions for completing a basic JBoss configuration. Refer to the official JBoss EAP documentation for more information.</p>
</div>
<div class="sect5">
<h6 id="install-the-jdbc-driver-for-the-database-vendor"><a class="anchor" href="#install-the-jdbc-driver-for-the-database-vendor"></a>INSTALL THE JDBC DRIVER FOR THE DATABASE VENDOR</h6>
<div class="paragraph">
<p>Each vendor has a specific JDBC driver used to make the low level connections to their database instances, which get distributed as a JAR file. You need to add this driver to the JBoss module directory before configuring a datasource.  It is important to download the specific vendor and version to match your installed database.</p>
</div>
<div class="paragraph">
<p><strong>For example:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>MySQL: <a href="https://dev.mysql.com/downloads/connector/j/5.1.html">https://dev.mysql.com/downloads/connector/j/5.1.html</a></p>
</li>
<li>
<p>Postgres: <a href="https://jdbc.postgresql.org/">https://jdbc.postgresql.org/</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Install the driver to a JBoss standalone instance using the JBoss command line interface. You may need to adjust the <strong>bolded</strong> items:</p>
</div>
<div class="paragraph">
<p>MySQL</p>
</div>
<div class="literalblock">
<div class="content">
<pre>module add --name=<strong>mysql</strong> --resources=<strong>mysql-connector-java-6.0.6.jar</strong> --dependencies=javax.api,javax.transaction.api</pre>
</div>
</div>
<div class="paragraph">
<p>Postgres</p>
</div>
<div class="literalblock">
<div class="content">
<pre>module add --name=<strong>postgres</strong> --resources=<strong>postgres-9.1.jdbc4.jar</strong> --dependencies=javax.api,javax.transaction.api</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="register-the-driver-in-the-jobss-configuration"><a class="anchor" href="#register-the-driver-in-the-jobss-configuration"></a>REGISTER THE DRIVER IN THE JOBSS CONFIGURATION</h6>
<div class="paragraph">
<p>Next, make JBoss aware of the database driver:</p>
</div>
<div class="paragraph">
<p>MySQL</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/subsystem=datasources/jdbc-driver=<strong>mysql</strong>:add(driver-module-name=<strong>mysql</strong>, driver-name=<strong>mysql</strong>, driver-class-name=<strong>com.mysql.jdbc.Driver</strong>)</pre>
</div>
</div>
<div class="paragraph">
<p>Postgres</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/subsystem=datasources/jdbc-driver=<strong>postgres</strong>:add(driver-module-name=<strong>postgres</strong>, driver-name=<strong>postgres</strong>, driver-class-name=<strong>org.postgresql.Driver</strong>)</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="configure-the-datasources"><a class="anchor" href="#configure-the-datasources"></a>CONFIGURE THE DATASOURCES</h6>
<div class="paragraph">
<p>Lastly, configure and expose data sources with the JNDI name that the application will use to establish a connection. The specific JNDI names are used in the following section to tie everything together (i.e., java:jboss/datasources/EntandoPortDS and java:jboss/datasources/EntandoServPS). Replace <strong>bolded</strong> items with the specifics of each database connection.</p>
</div>
<div class="paragraph">
<p>MySQL</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/subsystem=datasources/data-source=EntandoPortDS:add(jndi-name=java:jboss/datasources/EntandoPortDS, driver-name=mysql, connection-url=jdbc:mysql://<strong>host:3306/dbname</strong>,user-name=<strong>user</strong>,password=<strong>password</strong>)

/subsystem=datasources/data-source=EntandoServDS:add(jndi-name=java:jboss/datasources/EntandoServDS, driver-name=mysql, connection-url=jdbc:mysql://<strong>host:3306/dbname</strong>,user-name=<strong>user</strong>,password=<strong>password</strong>)</pre>
</div>
</div>
<div class="paragraph">
<p>Postgres</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/subsystem=datasources/data-source=EntandoPortDS:add(jndi-name=java:jboss/datasources/EntandoPortDS, driver-name=postgres, connection-url=jdbc:postgresql://<strong>host:5432/dbname</strong>,user-name=<strong>user</strong>,password=<strong>password</strong>)

/subsystem=datasources/data-source=EntandoServDS:add(jndi-name=java:jboss/datasources/EntandoServDS, driver-name=postgres, connection-url=jdbc:postgresql://<strong>host:5432/dbname</strong>,user-name=<strong>user</strong>,password=<strong>password</strong>)</pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="entando-application-configuration"><a class="anchor" href="#entando-application-configuration"></a>ENTANDO APPLICATION CONFIGURATION</h5>
<div class="paragraph">
<p>Update necessary properties files before packaging the Entando application for deployment to JBoss EAP.</p>
</div>
<div class="sect5">
<h6 id="configure-the-jndi-name"><a class="anchor" href="#configure-the-jndi-name"></a>CONFIGURE THE JNDI NAME</h6>
<div class="paragraph">
<p>Open the <em>src/config/jboss/jbossBaseSystemConfig.xml</em> file, and make sure that the lookup names match the values in the JBoss datasource configuration:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans&gt;
    &lt;jee:jndi-lookup id="portDataSource" jndi-name="<strong>java:jboss/datasources/EntandoPortDS</strong>"/&gt;
    &lt;jee:jndi-lookup id="servDataSource" jndi-name="<strong>java:jboss/datasources/EntandoServDS</strong>"/&gt;
&lt;/beans&gt;</pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="filter-configuration"><a class="anchor" href="#filter-configuration"></a>FILTER CONFIGURATION</h5>
<div class="paragraph">
<p>The filter file is what Entando uses to generate the war file to be deployed on JBoss. Navigate to /src/main/filters. The file to configure is <em>filter-production-jboss.properties</em>.</p>
</div>
<div class="paragraph">
<p>From the image below, adapt any values after the "=" so that they conform to your end environment. The two most essential values are in <em>profile.application.baseurl.hostname=www.mydomain.com</em> and <em>profile.jboss.home=/opt/jboss</em>. These values declare the fully qualified domain of the web application and specify the path of the JBOSS_HOME variable in the file system, respectively.</p>
</div>
<div class="paragraph">
<p>To make the web server serve static resources, adapt <em>profile.resources.path</em> as well. The <em>resource.path</em> serves static resources (e.g., an http server) while the <em>resource.path.protected</em> points to a path that is outside a publicly accessible resource like a webserver because it is the path for the protected resources. Finally the <em>index.path</em> variable stores the cache files and therefore should point to an internal system path.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/RHJED_filter_config.png" alt="RHJED filter config">
</div>
</div>
<div class="sect5">
<h6 id="jboss-configuration-2"><a class="anchor" href="#jboss-configuration-2"></a>JBOSS CONFIGURATION</h6>
<div class="paragraph">
<p>Adjust the JBoss configuration file by inserting a new handler dedicated to the welcome-content directory. This ensures that the static resources path works correctly, assuming that you are using Undertow instead of an external web server. The handler points to the path acting as an external volume that will contain all of your static resources.</p>
</div>
<div class="paragraph">
<p>In the example below, the handler cmscontent points to <em>/entando-resources/welcome-content/cmsresources</em>. Doing so separates the CMS resources from the application’s internal static resources and serves them directly with Undertow.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/RHJED_JBoss_config.png" alt="RHJED JBoss config">
</div>
</div>
<div class="paragraph">
<p>In the JBoss filter, update the value of the <em>profile.resources.path</em> to point to your mounted external volume: <em>/entando-resources/welcome-content/cmsresources</em>.</p>
</div>
</div>
<div class="sect5">
<h6 id="entando-configuration"><a class="anchor" href="#entando-configuration"></a>ENTANDO CONFIGURATION</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create the file resourceTypesDef.xml if it does not already exist in src/main/resources/spring/[application-context]/aps. This file lets you overwrite the behavior of the StorageManager.</p>
<div class="paragraph">
<p>Populate <em>resourceTypesDef.xml</em> with the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:jee="http://www.springframework.org/schema/jee"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.0.xsd
			http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd
			http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-4.0.xsd"&gt;
&lt;bean id="[your app context in camel case]StorageManager" class="org.entando.entando.aps.system.services.storage.LocalStorageManager"
          init-method="init" &gt;
        &lt;property name="baseURL" &gt;
            &lt;jee:jndi-lookup jndi-name="java:comp/env/cmsResourceRootURL" /&gt;
        &lt;/property&gt;
        &lt;property name="baseDiskRoot" &gt;
            &lt;jee:jndi-lookup jndi-name="java:comp/env/resourceDiskRootFolder" /&gt;
        &lt;/property&gt;
        &lt;property name="protectedBaseDiskRoot" &gt;
            &lt;jee:jndi-lookup jndi-name="java:comp/env/protectedResourceDiskRootFolder" /&gt;
        &lt;/property&gt;
        &lt;property name="protectedBaseURL" &gt;
            &lt;jee:jndi-lookup jndi-name="java:comp/env/protectedResourceRootURL" /&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
    &lt;bean id="[your app context in camel case]JacmsAbstractResource" abstract="true"
          class="com.agiletec.plugins.jacms.aps.system.services.resource.model.AbstractResource" &gt;
        &lt;property name="storageManager" ref="[your app context in camel case]Manager" /&gt;
        &lt;property name="protectedBaseURL" &gt;
            &lt;jee:jndi-lookup jndi-name="java:comp/env/protectedResourceRootURL" /&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
    &lt;bean id="jacmsAttachResource" class="com.agiletec.plugins.jacms.aps.system.services.resource.model.AttachResource" parent="[your app context in camel case]JacmsAbstractResource" &gt;
        &lt;property name="type" value="Attach" /&gt;
        &lt;property name="folder" value="cms/documents" /&gt;
        &lt;property name="allowedExtensions"&gt;
            &lt;value&gt;${jacms.attachResource.allowedExtensions}&lt;/value&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
    &lt;bean id="jacmsImageResource" class="com.agiletec.plugins.jacms.aps.system.services.resource.model.ImageResource" parent="[your app context in camel case]JacmsAbstractResource" &gt;
        &lt;property name="type" value="Image" /&gt;
        &lt;property name="folder" value="cms/images" /&gt;
        &lt;property name="allowedExtensions"&gt;
            &lt;value&gt;${jacms.imageResource.allowedExtensions}&lt;/value&gt;
        &lt;/property&gt;
        &lt;property name="imageDimensionReader" ref="jacmsImageDimensionReader" /&gt;
        &lt;property name="imageResizerClasses"&gt;
            &lt;map&gt;
                &lt;entry key="DEFAULT_RESIZER"&gt;
                    &lt;value&gt;com.agiletec.plugins.jacms.aps.system.services.resource.model.imageresizer.DefaultImageResizer&lt;/value&gt;
                &lt;/entry&gt;
                &lt;entry key="png"&gt;
                    &lt;value&gt;com.agiletec.plugins.jacms.aps.system.services.resource.model.imageresizer.PNGImageResizer&lt;/value&gt;
                &lt;/entry&gt;
            &lt;/map&gt;
        &lt;/property&gt;
        &lt;property name="imageMagickEnabled"&gt;
            &lt;value&gt;${imagemagick.enabled}&lt;/value&gt;
        &lt;/property&gt;
        &lt;property name="imageMagickWindows"&gt;
            &lt;value&gt;${imagemagick.windows}&lt;/value&gt;
        &lt;/property&gt;
        &lt;property name="imageMagickPath"&gt;
            &lt;value&gt;${imagemagick.path}&lt;/value&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Add the classpath definition for the <em>resourceTypeDef.xml</em> file defined below to the following two files:</p>
<div class="ulist">
<ul>
<li>
<p><em>src/main/config/jboss/web.xml</em></p>
</li>
<li>
<p><em>src/main/config/web.xml</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Classpath definition:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;param-value&gt;
            classpath:spring/propertyPlaceholder.xml
            classpath:spring/restServerConfig.xml
            classpath:spring/baseSystemConfig.xml
            classpath:spring/jbossBaseSystemConfig.xml
            classpath*:spring/aps/**/**.xml
            classpath*:spring/apsadmin/**/**.xml
            classpath*:spring/plugins/**/aps/**/**.xml
            classpath*:spring/plugins/**/apsadmin/**/**.xml
            classpath*:spring/[your app context]/aps/**/**.xml
        &lt;/param-value&gt;</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Add the environment variable declaration to the <em>src/main/config/context.xml</em> file:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;Environment name="applicationBaseURL" value="${profile.application.baseurl.protocol}://${profile.application.baseurl.hostname}${profile.application.baseurl.port.separator}${profile.application.baseurl.port}/${profile.application.name}/" type="java.lang.String" override="false" /&gt;
    &lt;Environment name="resourceRootURL" value="/resources/" type="java.lang.String" override="false" /&gt;
    &lt;Environment name="cmsResourceRootURL" value="/cmsresources/" type="java.lang.String" override="false" /&gt;
    &lt;Environment name="protectedResourceRootURL" value="/${profile.application.name}/protected/" type="java.lang.String" override="false" /&gt;</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="building-the-war-file"><a class="anchor" href="#building-the-war-file"></a>BUILDING THE WAR FILE</h5>
<div class="paragraph">
<p><strong>To build the WAR file:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configure the platform-specific filter (<em>filter-development-unix</em> or <em>filter-development-windows</em>) and add your the database connection parameters.</p>
</li>
<li>
<p>Run <code>mvn clean jetty:run</code> to start the Entando application.</p>
</li>
<li>
<p>Verify in the Entando logs that your database schemas have been created and populated correctly.</p>
</li>
<li>
<p>Run <code>ant WAR-build-jboss</code> and deploy the generated artifact on JBoss.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="migrating-entando-applictions"><a class="anchor" href="#migrating-entando-applictions"></a>4.9. MIGRATING ENTANDO APPLICTIONS</h3>
<div class="sect3">
<h4 id="porting-from-entando-5-0-0-to-5-0-1"><a class="anchor" href="#porting-from-entando-5-0-0-to-5-0-1"></a>4.9.1. PORTING FROM ENTANDO 5.0.0 TO 5.0.1</h4>
<div class="paragraph">
<p>Upgrading to Entando 5.0.1 requires you to complete two sets of steps.</p>
</div>
<div class="sect4">
<h5 id="upgrade-your-database"><a class="anchor" href="#upgrade-your-database"></a>UPGRADE YOUR DATABASE</h5>
<div class="sect5">
<h6 id="upgrade-to-spring-security-and-remove-oltu"><a class="anchor" href="#upgrade-to-spring-security-and-remove-oltu"></a>UPGRADE TO SPRING SECURITY AND REMOVE OLTU</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Execute the following query:<br>
<code><mark># DB *Serv </mark>#</code></p>
</li>
<li>
<p>Copy and past the following into your database client:<br></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>INSERT INTO api_oauth_consumers (consumerkey, consumersecret, name, description, callbackurl, scope, authorizedgranttypes, expirationdate, issueddate) VALUES ('appbuilder', '{bcrypt}$2a$10$axXuJXKHzgdmwQzBR3wvh.oSiiJp6On1pHxJgaBmwkRXnXqYqjhkK', 'Entando AppBuiler', 'Default Entando AppBuiler Consumer', NULL, 'read,write,trust', 'password,authorization_code,refresh_token,implicit', '2028-10-10 00:00:00', '2008-01-01 00:00:00');</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="upgrade-the-database-for-bpmpam-plugin"><a class="anchor" href="#upgrade-the-database-for-bpmpam-plugin"></a>UPGRADE THE DATABASE FOR BPM/PAM PLUGIN</h6>
<div class="paragraph">
<p>If you are using the <em>entando-plugin-jpkiebpm</em>, you must add three columns to the <em>jpkiebpm_kieformoverride</em> table (in db *serv), to accommodate version changes.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the Integrations &gt; Components &gt; Red Hat PAM Config, click <strong>Overrides List</strong> to open the Entando Error Page.</p>
</li>
<li>
<p>Delete the old rows in the table or fill in appropriate values for the following columns:<br></p>
<div class="ulist">
<ul>
<li>
<p>ALTER TABLE jpkiebpm_kieformoverride ADD COLUMN sourceid text;<br></p>
</li>
<li>
<p>ALTER TABLE jpkiebpm_kieformoverride ADD COLUMN widgetinfoid integer;<br></p>
</li>
<li>
<p>ALTER TABLE jpkiebpm_kieformoverride ADD COLUMN active boolean;</p>
<div class="ulist">
<ul>
<li>
<p>widgetinfoid must be an ID of the table <em>jpkiebpm_widgetinfo</em></p>
</li>
<li>
<p>sourceid must be an ID of a configured BPM instance, defined inside the <em>sysconfig</em> table</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="upgrade-project-configuration"><a class="anchor" href="#upgrade-project-configuration"></a>UPGRADE PROJECT CONFIGURATION</h5>
<div class="sect5">
<h6 id="upgrade-to-struts-2-5-17"><a class="anchor" href="#upgrade-to-struts-2-5-17"></a>UPGRADE TO STRUTS 2.5.17</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the <em>src/main/conf</em> and <em>src/main/conf/jboss</em> directories. From each directory, open the <em>web.xml</em> file and remove the listener class:<br>
<em>org.entando.entando.apsadmin.system.resource.EntandoPluginLabelListener</em></p>
</li>
<li>
<p>Open <em>pom.xml</em> and update the version of Struts2 in the Properties section from "2.5.10.1" to "2.5.17"</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="upgrade-to-spring-security-and-remove-oltu-2"><a class="anchor" href="#upgrade-to-spring-security-and-remove-oltu-2"></a>UPGRADE TO SPRING SECURITY AND REMOVE OLTU</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the <em>src/main/conf</em> and <em>src/main/conf/jboss</em> directories. From each directory, open the <em>web.xml</em> file and remove the following:</p>
<div class="ulist">
<ul>
<li>
<p>definition of "cors" filter and its filter-mapping</p>
</li>
<li>
<p>definition of "AuthorizationServlet" and its servlet-mapping</p>
</li>
<li>
<p>definition of "AccessTokenServlet" and its servlet-mapping</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="porting-from-entando-5-0-0-to-5-1-0"><a class="anchor" href="#porting-from-entando-5-0-0-to-5-1-0"></a>4.9.2. PORTING FROM ENTANDO 5.0.0 TO 5.1.0</h4>
<div class="paragraph">
<p>Upgrading to Entando 5.1 requires you to complete two sets of steps.</p>
</div>
<div class="sect4">
<h5 id="upgrade-your-database-2"><a class="anchor" href="#upgrade-your-database-2"></a>UPGRADE YOUR DATABASE</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To allow porting to 5.1.0 version from versions 4.3.3, 4.3.4, and 5.0.0, you need to run several update scripts (see below). These scripts create new columns and delete old ones, and also copy the values from the <em>groupcode</em> column of the Pages table to the <em>groupcode</em> column in the pages_metadata_online and pages_metadata_draft tables.</p>
</li>
<li>
<p>Execute the following queries:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>** -- ### DB *Port ###

-- copy/paste
ALTER TABLE pages_metadata_draft ADD COLUMN groupcode character varying(30);
ALTER TABLE pages_metadata_online ADD COLUMN groupcode character varying(30);
UPDATE pages_metadata_online SET groupcode = (SELECT pages.groupcode FROM pages WHERE pages_metadata_online.code = pages.code);
UPDATE pages_metadata_draft SET groupcode = (SELECT pages.groupcode FROM pages WHERE pages_metadata_draft.code = pages.code);
ALTER TABLE pages DROP groupcode;


INSERT INTO sysconfig (version, item, descr, config) VALUES ('production', 'jacms_resourceMetadataMapping', 'Mapping between resource Metadata and resource attribute fields', '&lt;mapping&gt;
    &lt;field key="alt"&gt;&lt;/field&gt;
    &lt;field key="description"&gt;&lt;/field&gt;
    &lt;field key="legend"&gt;&lt;/field&gt;
    &lt;field key="title"&gt;&lt;/field&gt;
&lt;/mapping&gt;');

-- ### DB *Serv ###


INSERT INTO _api_oauth_consumers_ (consumerkey, consumersecret, name, description, callbackurl, scope, authorizedgranttypes, expirationdate, issueddate) VALUES ('appbuilder', '{bcrypt}$2a$10$axXuJXKHzgdmwQzBR3wvh.oSiiJp6On1pHxJgaBmwkRXnXqYqjhkK', 'Entando AppBuiler', 'Default Entando AppBuiler Consumer', NULL, 'read,write,trust', 'password,authorization_code,refresh_token,implicit', '2028-10-10 00:00:00', '2008-01-01 00:00:00');</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="upgrade-your-project-configuration"><a class="anchor" href="#upgrade-your-project-configuration"></a>UPGRADE YOUR PROJECT CONFIGURATION</h5>
<div class="sect5">
<h6 id="upgrade-to-struts-2-5-17-2"><a class="anchor" href="#upgrade-to-struts-2-5-17-2"></a>UPGRADE TO STRUTS 2.5.17</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the <em>src/main/conf</em> and <em>src/main/conf/jboss</em> directories. From each directory, open the <em>web.xml</em> files and remove the listener class:  <em>org.entando.entando.apsadmin.system.resource.EntandoPluginLabelListener</em></p>
</li>
<li>
<p>Open the <em>pom.xml</em> and update the version of Struts2 into the properties section; from "2.5.10.1" to "2.5.17"</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="upgrade-to-spring-security-and-remove-oltu-3"><a class="anchor" href="#upgrade-to-spring-security-and-remove-oltu-3"></a>UPGRADE TO SPRING SECURITY AND REMOVE OLTU</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the <em>web.xml</em> file from both the <em>src/main/config</em> and <em>src/main/config/jboss</em> directories.</p>
</li>
<li>
<p>Remove the following from each <em>web.xml</em> file:</p>
<div class="ulist">
<ul>
<li>
<p>definition of "cors" filter and its filter-mapping</p>
</li>
<li>
<p>definition of "AuthorizationServlet" and its servlet-mapping</p>
</li>
<li>
<p>definition of "AccessTokenServlet" and its servlet-mapping</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-07-03 08:05:14 -0400
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>