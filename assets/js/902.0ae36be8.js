(window.webpackJsonp=window.webpackJsonp||[]).push([[902],{2269:function(e,t,a){"use strict";a.r(t);var s=a(36),r=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"microservice-configuration-profiles"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#microservice-configuration-profiles"}},[e._v("#")]),e._v(" Microservice Configuration Profiles")]),e._v(" "),a("p",[e._v("This tutorial describes three methods to utilize configuration profiles to specify resource allocation for Entando microservices. These provide a simple way to customize microservice deployment parameters for improved efficiency.")]),e._v(" "),a("h2",{attrs:{id:"prerequisites"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[e._v("#")]),e._v(" Prerequisites")]),e._v(" "),a("ul",[a("li",[a("RouterLink",{attrs:{to:"/v7.3/docs/getting-started/"}},[e._v("A working instance of Entando")])],1),e._v(" "),a("li",[e._v("Verify dependencies with the "),a("RouterLink",{attrs:{to:"/v7.3/docs/getting-started/entando-cli.html#check-the-environment"}},[e._v("Entando CLI")]),e._v(": "),a("code",[e._v("ent check-env develop")])],1),e._v(" "),a("li",[a("RouterLink",{attrs:{to:"/v7.3/tutorials/consume/entando-operator.html"}},[e._v("Add an Entando Operator ConfigMap")]),e._v(" if needed, then\n"),a("ul",[a("li",[e._v("Enable this property under the "),a("code",[e._v("data")]),e._v(" section so the Entando Operator can manage the resource settings:")])]),e._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[e._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("entando.k8s.operator.impose.limits")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"true"')]),e._v("\n")])])])],1)]),e._v(" "),a("h2",{attrs:{id:"profile-options"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#profile-options"}},[e._v("#")]),e._v(" Profile Options")]),e._v(" "),a("p",[e._v("A profile is a set of configurations encoded as YAML embedded in the "),a("code",[e._v("OperatorConfigMap")]),e._v(" as a string, since ConfigMaps cannot be multilevel.")]),e._v(" "),a("p",[e._v("The three methods to insert configuration profiles are:")]),e._v(" "),a("ol",[a("li",[a("a",{attrs:{href:"#method-1-inline-profile"}},[e._v("Inline Profile")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#method-2-mapped-profile"}},[e._v("Mapped Profile")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#method-3-default-profile"}},[e._v("Default Profile")])])]),e._v(" "),a("h2",{attrs:{id:"configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configuration"}},[e._v("#")]),e._v(" Configuration")]),e._v(" "),a("p",[e._v("Currently, the resources for memory and CPU can be specified. When you specify a "),a("code",[e._v("limit")]),e._v(" on a resource, it is the upper limit allowed for the container. The units for the resources are listed below but should not be included in the specification. Resource settings help Kubernetes determine in which node a pod should be created.")]),e._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("resources.limits.cpu")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("       integer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" millicpus\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("resources.limits.memory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("    integer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" mebibytes\n")])])]),a("p",[e._v("The examples below use "),a("code",[e._v("YOUR-PLUGIN")]),e._v(", "),a("code",[e._v("YOUR-PLUGIN-CODE")]),e._v(", "),a("code",[e._v("YOUR-ORG")]),e._v(", "),a("code",[e._v("YOUR-BUNDLE")]),e._v(" and "),a("code",[e._v("YOUR-PROFILE-NAME")]),e._v(" as placeholders. Also note the use of "),a("code",[e._v("|-")]),e._v(" to designate a new line in the code.")]),e._v(" "),a("h3",{attrs:{id:"retrieve-the-plugin-code"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#retrieve-the-plugin-code"}},[e._v("#")]),e._v(" Retrieve the Plugin Code")]),e._v(" "),a("p",[e._v("You will need to "),a("RouterLink",{attrs:{to:"/v7.3/docs/getting-started/entando-cli.html"}},[e._v("retrieve the plugin code")]),e._v(", which is calculated during installation and written to the EntandoPlugin custom resource as part of the deployment of the microservice.")],1),e._v(" "),a("p",[e._v("Use the following command from the root bundle project directory, where "),a("code",[e._v("YOUR-ORG")]),e._v(" is your Docker organization and "),a("code",[e._v("YOUR-BUNDLE")]),e._v(" contains the microservice:")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[e._v("ent ecr get-plugin-code YOUR-ORG/YOUR-PLUGIN-NAME --repo"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("docker://registry.hub.docker.com/YOUR-ORG/YOUR-BUNDLE\n")])])]),a("h3",{attrs:{id:"method-1-inline-profile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#method-1-inline-profile"}},[e._v("#")]),e._v(" Method 1: Inline Profile")]),e._v(" "),a("p",[e._v("Add the resource parameters to the "),a("code",[e._v("OperatorConfigMap")]),e._v(" as an inline profile at "),a("code",[e._v("data/entando.profile.plugins.YOUR-PLUGIN-CODE")]),e._v(":")]),e._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("entando.profile.plugins.YOUR-PLUGIN-CODE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("resources.limits.cpu")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"1000"')]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("resources.limits.memory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"2000"')]),e._v("\n")])])]),a("h3",{attrs:{id:"method-2-mapped-profile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#method-2-mapped-profile"}},[e._v("#")]),e._v(" Method 2: Mapped Profile")]),e._v(" "),a("ol",[a("li",[e._v("Create the resource parameter profile in the "),a("code",[e._v("OperatorConfigMap")]),e._v(" of the data profile at "),a("code",[e._v("data/entando.profile.YOUR-PROFILE-NAME")]),e._v(":")])]),e._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("entando.profile.YOUR-PROFILE-NAME")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("resources.limits.cpu")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"1000"')]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("resources.limits.memory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"2000"')]),e._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[e._v("Add a reference in the "),a("code",[e._v("profileMapping")]),e._v(" file at "),a("code",[e._v("data/entando.plugins.profileMapping")]),e._v(":")])]),e._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("entando.plugins.profileMapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("YOUR-PLUGIN-CODE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" YOUR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("PROFILE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("NAME\n")])])]),a("h3",{attrs:{id:"method-3-default-profile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#method-3-default-profile"}},[e._v("#")]),e._v(" Method 3: Default Profile")]),e._v(" "),a("ol",[a("li",[e._v("Add the resource parameter profile to the "),a("code",[e._v("OperatorConfigMap")]),e._v(" in the data section at "),a("code",[e._v("data/entando.profile.YOUR-PROFILE-NAME")]),e._v(":")])]),e._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("entando.profile.YOUR-PROFILE-NAME")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("resources.limits.cpu")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"1000"')]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("resources.limits.memory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"2000"')]),e._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[e._v("Add a reference to the profile at "),a("code",[e._v("data/entando.plugins.defaultProfile")]),e._v(":")])]),e._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("entando.plugins.defaultProfile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" YOUR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("PROFILE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("NAME\n")])])]),a("blockquote",[a("p",[e._v("Note: If a resourceRequirement was specified in the plugin custom resource, that will override a profile.")])]),e._v(" "),a("h2",{attrs:{id:"references"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#references"}},[e._v("#")]),e._v(" References")]),e._v(" "),a("p",[e._v("Please refer to the "),a("a",{attrs:{href:"https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Kubernetes documentation on Resources"),a("OutboundLink")],1),e._v(" for more details.")])])}),[],!1,null,null,null);t.default=r.exports}}]);