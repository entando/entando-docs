(window.webpackJsonp=window.webpackJsonp||[]).push([[659],{1918:function(e,t,a){"use strict";a.r(t);var s=a(36),n=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"build-and-publish-a-simple-bundle"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-and-publish-a-simple-bundle"}},[e._v("#")]),e._v(" Build and Publish a Simple Bundle")]),e._v(" "),a("h2",{attrs:{id:"overview"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[e._v("#")]),e._v(" Overview")]),e._v(" "),a("p",[e._v("This tutorial describes how to create a simple Entando Bundle and deploy it into the "),a("RouterLink",{attrs:{to:"/v7.0/docs/getting-started/concepts-overview.html#entando-component-repository"}},[e._v("Entando Component Repository")]),e._v(" (ECR). This process consists of 4 essential steps:")],1),e._v(" "),a("ol",[a("li",[e._v("Define the bundle component(s)")]),e._v(" "),a("li",[e._v("Check the bundle artifacts into a Git repository")]),e._v(" "),a("li",[e._v("Apply the bundle custom resource to Kubernetes")]),e._v(" "),a("li",[e._v("Install the bundle into an application")])]),e._v(" "),a("h2",{attrs:{id:"prerequisites"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[e._v("#")]),e._v(" Prerequisites")]),e._v(" "),a("ul",[a("li",[e._v("Verify dependencies with the "),a("RouterLink",{attrs:{to:"/v7.0/docs/reference/entando-cli.html#check-the-environment"}},[e._v("Entando CLI")]),e._v(": "),a("code",[e._v("ent check-env develop")])],1),e._v(" "),a("li",[e._v("Authenticated Git credentials")]),e._v(" "),a("li",[e._v("An empty Git repository")]),e._v(" "),a("li",[e._v("A running Entando instance")])]),e._v(" "),a("p",[e._v("Publishing a bundle can be simplified by using the "),a("code",[e._v("ent prj")]),e._v(" command and its publication system (pbs) convenience methods. Both the CLI and manual commands are provided.")]),e._v(" "),a("h2",{attrs:{id:"create-the-project-structure"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-the-project-structure"}},[e._v("#")]),e._v(" Create the Project Structure")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("Create a parent project directory (e.g. "),a("code",[e._v("example-bundle")]),e._v(") and a child "),a("code",[e._v("bundle")]),e._v(" directory:")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("mkdir")]),e._v(" -p example-bundle/bundle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" example-bundle/bundle\n")])])]),a("p",[e._v("In a project generated by the "),a("RouterLink",{attrs:{to:"/v7.0/docs/create/component-gen-overview.html"}},[e._v("Entando Component Generator")]),e._v(" (ECG), the microservice and micro frontend source files are stored in the parent directory.")],1)])]),e._v(" "),a("h2",{attrs:{id:"add-a-simple-widget"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#add-a-simple-widget"}},[e._v("#")]),e._v(" Add a Simple Widget")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("Create a widget directory:")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("mkdir")]),e._v(" widgets\n")])])])]),e._v(" "),a("li",[a("p",[e._v("Create a widget descriptor file within that directory:")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("touch")]),e._v(" widgets/example-widget.yaml\n")])])])]),e._v(" "),a("li",[a("p",[e._v("Populate the widget descriptor file "),a("code",[e._v("example-widget.yaml")]),e._v(" with a simple definition. Retain the correct YAML indentation of 2 or 4 spaces.")]),e._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("code")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" example"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("widget\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("titles")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n   "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("en")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" Example Widget\n   "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("it")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" Widget d'esempio\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("group")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" free\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("customUi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" <h2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")]),e._v("Hi from Example Widget</h2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")]),e._v("\n")])])])])]),e._v(" "),a("h2",{attrs:{id:"create-the-bundle-descriptor"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-the-bundle-descriptor"}},[e._v("#")]),e._v(" Create the Bundle Descriptor")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("In the child bundle directory, create a bundle descriptor file named "),a("code",[e._v("descriptor.yaml")]),e._v(":")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("touch")]),e._v(" descriptor.yaml\n")])])]),a("p",[e._v("All of a bundle's components are defined within "),a("code",[e._v("descriptor.yaml")]),e._v(", which is the main file processed by the ECR.")])]),e._v(" "),a("li",[a("p",[e._v("Add the following definition to "),a("code",[e._v("descriptor.yaml")]),e._v(":")]),e._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("code")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" example"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("bundle\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("description")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" This is an example of an Entando Bundle\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("components")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("widgets")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" widgets/example"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("widget.yaml\n")])])]),a("p",[e._v("Component descriptor file names and locations (e.g. "),a("code",[e._v("widgets/example-widget.yaml")]),e._v(") are arbitrary because the bundle descriptor explicitly points to those files. Convention is to group components by type with all widgets in one directory, all page templates in another, etc.")])])]),e._v(" "),a("h2",{attrs:{id:"publish-the-bundle"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#publish-the-bundle"}},[e._v("#")]),e._v(" Publish the Bundle")]),e._v(" "),a("p",[e._v("The steps to publish a bundle can be performed manually or automated with the CLI.")]),e._v(" "),a("h3",{attrs:{id:"cli-steps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cli-steps"}},[e._v("#")]),e._v(" CLI Steps")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("From the project directory, initialize an Entando project with default settings:")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[e._v("ent prj init\n")])])])]),e._v(" "),a("li",[a("p",[e._v("Initialize the publication system. This requires the URL of an empty Git repository (ending in .git) and your Git credentials.")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[e._v("ent prj pbs-init\n")])])])]),e._v(" "),a("li",[a("p",[e._v("Publish the bundle to Git. By convention, the first version is assigned the tag "),a("code",[e._v("v0.0.1")]),e._v(', but the prefix "v" is optional.')]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[e._v("ent prj pbs-publish\n")])])]),a("p",[e._v("To quickly push subsequent iterations of the bundle to Git, execute the "),a("code",[e._v("ent prj pbs-publish")]),e._v(" command. Each push will prompt you to input the corresponding bundle version. You must be consistent with versioning format and alphanumeric precedence to ensure that iterations are listed in the correct order.")])]),e._v(" "),a("li",[a("p",[e._v("Deploy the bundle into the ECR:")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[e._v("ent prj deploy\n")])])]),a("p",[e._v("The "),a("code",[e._v("prj deploy")]),e._v(" command uses the Git repository URL and project name (e.g. "),a("code",[e._v("example-bundle")]),e._v(") to create the custom resource.")])])]),e._v(" "),a("h3",{attrs:{id:"manual-steps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#manual-steps"}},[e._v("#")]),e._v(" Manual Steps")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("From the bundle directory, run the following commands to initialize Git and commit the files:")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" init\n"),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("add")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(".")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" commit -m "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Init Git repository"')]),e._v("\n")])])])]),e._v(" "),a("li",[a("p",[e._v("Add your remote repository as origin and push the bundle:")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" remote "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("add")]),e._v(" origin https://your/remote/repository.git\n"),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" push -u origin master\n")])])])]),e._v(" "),a("li",[a("p",[e._v("Publish a Git tag:")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" tag -a "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"v0.0.1"')]),e._v(" -m "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"My first tag"')]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" push --tags\n")])])])]),e._v(" "),a("li",[a("p",[e._v("Create the Kubernetes custom resource for your bundle:")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[e._v("ent bundler from-git --name"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("example-bundle --namespace"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("entando --repository"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("https://YOUR-REMOTE-REPOSITORY.git --dry-run "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" example-bundle.yaml\n")])])]),a("p",[e._v('A bundle must be published to Git before you can create a custom resource for it. Provide the URL of the bundle\'s remote Git repository (ends with ".git"). To include a thumbnail for your bundle, use the option  '),a("code",[e._v("--thumbnail-file")]),e._v(" or "),a("code",[e._v("--thumbnail-url")]),e._v(".")])]),e._v(" "),a("li",[a("p",[e._v("Transfer the file to your VM, e.g:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("multipass transfer example-bundle.yaml entando:\n")])])])]),e._v(" "),a("li",[a("p",[e._v("Apply the bundle definition to Kubernetes:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("kubectl -n entando apply -f example-bundle.yaml\n")])])])]),e._v(" "),a("li",[a("p",[e._v("Confirm the presence of your custom resource:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("kubectl get EntandoDeBundle -n entando\n")])])])])]),e._v(" "),a("h2",{attrs:{id:"install-the-bundle-into-an-application"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#install-the-bundle-into-an-application"}},[e._v("#")]),e._v(" Install the Bundle into an Application")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("In your Entando instance, go to "),a("code",[e._v("App Builder")]),e._v(" → "),a("code",[e._v("Component Repository")])])]),e._v(" "),a("li",[a("p",[e._v("Click "),a("code",[e._v("Install")]),e._v(". A bundle with multiple iterations allows version selection.")])]),e._v(" "),a("li",[a("p",[e._v("Verify the "),a("code",[e._v("Install")]),e._v(" button changes to "),a("code",[e._v("Uninstall")]),e._v(" to indicate that the installation completed successfully")])]),e._v(" "),a("li",[a("p",[e._v("Go to "),a("code",[e._v("App Builder")]),e._v(" → "),a("code",[e._v("Components")]),e._v(" → "),a("code",[e._v("Micro Frontends & Widgets")]),e._v(' to confirm that your bundle appears in the "User" section')])])])])}),[],!1,null,null,null);t.default=n.exports}}]);