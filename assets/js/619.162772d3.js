(window.webpackJsonp=window.webpackJsonp||[]).push([[619],{1849:function(t,e,a){"use strict";a.r(e);var s=a(36),n=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"build-and-publish-a-simple-bundle"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-and-publish-a-simple-bundle"}},[t._v("#")]),t._v(" Build and Publish a Simple Bundle")]),t._v(" "),a("h2",{attrs:{id:"overview"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[t._v("#")]),t._v(" Overview")]),t._v(" "),a("p",[t._v("This tutorial shows you how to create a simple Entando bundle and deploy it into the Entando Component Repository. This involves manually defining a bundle with a single widget, checking your bundle artifacts into git, apply the Entando bundle custom resource to Kubernetes, and then installing the bundle into your application.")]),t._v(" "),a("h2",{attrs:{id:"prerequisites"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[t._v("#")]),t._v(" Prerequisites")]),t._v(" "),a("ul",[a("li",[t._v("Use the "),a("RouterLink",{attrs:{to:"/v6.3/docs/reference/entando-cli.html#check-environment"}},[t._v("Entando CLI")]),t._v(" to verify you have the prerequisites in place for this tutorial (e.g. Java, npm, git).")],1)]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("ent check-env develop \n")])])]),a("ul",[a("li",[t._v("You will also need your git credentials, an available git repository, and an Entando instance.")])]),t._v(" "),a("p",[t._v("Some of the following steps can be simplified by using the "),a("code",[t._v("ent prj")]),t._v(" command and its publication system (pbs) convenience methods. The manual steps are also provided in those cases.")]),t._v(" "),a("h2",{attrs:{id:"create-the-project-structure"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-the-project-structure"}},[t._v("#")]),t._v(" Create the project structure")]),t._v(" "),a("p",[t._v("First create a parent project directory along with a child bundle directory. In a project generated by the Entando Component Generator the microservice and micro frontend source files also live under the parent directory.")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" -p example-bundle/bundle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" example-bundle/bundle \n")])])]),a("h2",{attrs:{id:"add-a-simple-widget"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#add-a-simple-widget"}},[t._v("#")]),t._v(" Add a simple widget")]),t._v(" "),a("p",[t._v("Create a widget directory and descriptor file:")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" widgets\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("touch")]),t._v(" widgets/example-widget.yaml\n")])])]),a("p",[t._v("Populate the "),a("code",[t._v("example-widget.yaml")]),t._v(" with a simple definition. Make sure to retain the correct YAML indentation.")]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("code")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" example"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("widget\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("titles")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("en")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Example Widget\n   "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("it")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Widget d'esempio\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("group")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" free\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("customUi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" <h2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("Hi from Example Widget</h2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("\n")])])]),a("h2",{attrs:{id:"create-the-bundle-descriptor"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-the-bundle-descriptor"}},[t._v("#")]),t._v(" Create the bundle descriptor")]),t._v(" "),a("p",[t._v("The "),a("code",[t._v("descriptor.yaml")]),t._v(" is the main file processed by the Entando Component Repository and describes all of the components in the bundle. The name of the bundle descriptor must be "),a("code",[t._v("descriptor.yaml")]),t._v(".")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("touch")]),t._v(" descriptor.yaml\n")])])]),a("p",[t._v("Populate the descriptor with the following YAML definition:")]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("code")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" example"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("bundle\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("description")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" This is an example of an Entando bundle\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("components")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("widgets")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" widgets/example"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("widget.yaml\n")])])]),a("p",[t._v("The component descriptor file name and location (e.g. "),a("code",[t._v("widgets/example-widget.yaml")]),t._v(") are arbitrary since the bundle descriptor explicitly points to the file. The typical convention is to group components by type, for example with all widgets in one directory, all page templates in another, etc.")]),t._v(" "),a("h2",{attrs:{id:"publish-the-bundle"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#publish-the-bundle"}},[t._v("#")]),t._v(" Publish the bundle")]),t._v(" "),a("p",[t._v("You can publish a bundle using the CLI or you can perform the steps by hand.")]),t._v(" "),a("h3",{attrs:{id:"cli-steps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cli-steps"}},[t._v("#")]),t._v(" CLI steps")]),t._v(" "),a("ol",[a("li",[t._v("Change to the project directory, if needed")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" example-bundle\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("Initialize the Entando project and accept the defaults.")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("ent prj init\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[t._v("Initialize the publication system. You'll need the git repository URL and your credentials here.")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("ent prj pbs-init\n")])])]),a("ol",{attrs:{start:"4"}},[a("li",[t._v("Publish the bundle to git. By convention your first version will be "),a("code",[t._v("v0.0.1")]),t._v(" but this is up to you.")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("ent prj pbs-publish\n")])])]),a("p",[t._v("On subsequent iterations you can run just this command again to quickly push a new version of your bundle to git.")]),t._v(" "),a("ol",{attrs:{start:"5"}},[a("li",[t._v("You can now create the custom resource for your bundle and apply it to Kubernetes in one step. You should modify the target namespace parameter ("),a("code",[t._v("-n")]),t._v(") if you changed it from the default.")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("ent prj generate-cr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ent kubectl apply -n entando -f -\n")])])]),a("p",[t._v("The "),a("code",[t._v("generate-cr")]),t._v(" command uses the git repository URL and project name from earlier steps to create the custom resource.")]),t._v(" "),a("ol",{attrs:{start:"6"}},[a("li",[t._v("Jump to the section below to finish installing your bundle: "),a("a",{attrs:{href:"#install-the-bundle-into-an-application"}},[t._v("Install the bundle into an application")])])]),t._v(" "),a("h3",{attrs:{id:"manual-steps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#manual-steps"}},[t._v("#")]),t._v(" Manual steps")]),t._v(" "),a("ol",[a("li",[t._v("Change to the bundle directory, if needed")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" example-bundle/bundle\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("Run the following commands to initialize git and commit the files.")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" init\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" commit -m "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Init Git repository"')]),t._v("\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[t._v("Add your remote repository as origin and push the bundle.")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" remote "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" origin https://your/remote/repository.git\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" push -u origin master\n")])])]),a("ol",{attrs:{start:"4"}},[a("li",[t._v("Publish a git tag using the following commands.")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" tag -a "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"v0.0.1"')]),t._v(" -m "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"My first tag"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" push --tags\n")])])]),a("ol",{attrs:{start:"5"}},[a("li",[t._v("Now that you've published your bundle to git you can create the Kubernetes custom resource for it.")])]),t._v(" "),a("p",[t._v("Install the bundler if you haven't previously done so.")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -g  @entando/entando-bundler@6.3.0\n")])])]),a("p",[t._v("Next generate the custom resource for your bundle. Run the "),a("code",[t._v("entando-bundler from-git")]),t._v(" command and provide your remote git repository URL via the "),a("code",[t._v("--repository")]),t._v(" option and the correct namespace via "),a("code",[t._v("--namespace")]),t._v(". You can also provide a thumbnail for your bundle with "),a("code",[t._v("--thumbnail-file")]),t._v(" or "),a("code",[t._v("--thumbnail-url")]),t._v(".")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("entando-bundler from-git --name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("example-bundle --namespace"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("entando --repository"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https://your/remote/repository.git --dry-run "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" example-bundle.yaml\n")])])]),a("p",[t._v("Next you can apply this definition to Kubernetes. You may need to first transfer the file to your VM, e.g using "),a("code",[t._v("multipass transfer")]),t._v(".")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("kubectl -n entando apply -f example-bundle.yaml\n")])])]),a("p",[t._v("You can confirm the presence of your custom resource via "),a("code",[t._v("kubectl get EntandoDeBundle -n entando")])]),t._v(" "),a("h2",{attrs:{id:"install-the-bundle-into-an-application"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#install-the-bundle-into-an-application"}},[t._v("#")]),t._v(" Install the bundle into an application")]),t._v(" "),a("p",[t._v("Now you can go to the "),a("code",[t._v("App Builder")]),t._v(" → "),a("code",[t._v("Component Repository")]),t._v(" and install your bundle. You should see your bundle in the list and when you click "),a("code",[t._v("Install")]),t._v(" you can select your preferred version if the bundle contains more than one.")]),t._v(" "),a("p",[t._v("At this point the Entando platform will download and install the components contained in the bundle. Once complete you should see the "),a("code",[t._v("Install")]),t._v(" button change to give you an option to "),a("code",[t._v("Uninstall")]),t._v(" that specific version. You can also navigate to "),a("code",[t._v("Components")]),t._v(" → "),a("code",[t._v("Micro Frontends & Widgets")]),t._v(" and find your custom widget under the "),a("code",[t._v("User")]),t._v(" section.")])])}),[],!1,null,null,null);e.default=n.exports}}]);