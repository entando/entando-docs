(window.webpackJsonp=window.webpackJsonp||[]).push([[732],{2024:function(t,e,a){"use strict";a.r(e);var s=a(36),n=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"create-a-spring-boot-microservice"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-a-spring-boot-microservice"}},[t._v("#")]),t._v(" Create a Spring Boot Microservice")]),t._v(" "),a("p",[t._v("This tutorial uses the Spring Initializr to create a simple microservice to quickly generate an Entando bundle project.")]),t._v(" "),a("h2",{attrs:{id:"prerequisites"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[t._v("#")]),t._v(" Prerequisites")]),t._v(" "),a("ul",[a("li",[a("RouterLink",{attrs:{to:"/v7.1/docs/getting-started/"}},[t._v("A working instance of Entando")])],1),t._v(" "),a("li",[t._v("Verify dependencies with the "),a("RouterLink",{attrs:{to:"/v7.1/docs/getting-started/entando-cli.html#check-the-environment"}},[t._v("Entando CLI")]),t._v(": "),a("code",[t._v("ent check-env develop")])],1)]),t._v(" "),a("h2",{attrs:{id:"step-1-initialize-the-bundle-with-a-microservice"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-1-initialize-the-bundle-with-a-microservice"}},[t._v("#")]),t._v(" Step 1: Initialize the Bundle with a Microservice")]),t._v(" "),a("ol",[a("li",[t._v("Initialize a new bundle:")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("ent bundle init e71-spring-project\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("From the bundle project root directory, create a new microservice:")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cd e71-spring-project\nent bundle ms add spring-ms\n")])])]),a("h2",{attrs:{id:"step-2-create-the-microservice"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-2-create-the-microservice"}},[t._v("#")]),t._v(" Step 2: Create the Microservice")]),t._v(" "),a("ol",[a("li",[t._v("At the Spring Initialyzr page, "),a("a",{attrs:{href:"http://start.spring.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("start.spring.io"),a("OutboundLink")],1),t._v(", create a project with the following configuration:")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("\tProject=Maven\n\tLanguage=Java\n\tSpring Boot version=2.7.6\n\tGroup=com.entando.example\n\tArtifact=spring-ms \n\tName=spring-ms \n\tDescription=Demo project for Spring Boot\n\tPackage name=com.entando.example.spring-ms\n\tPackaging=Jar\n\tJava=11\n\tDependencies:\n\t             #under WEB: Spring Web \n\t             #under OPS: Spring Boot Actuator\n")])])]),a("p",[t._v("Click generate.")]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[a("p",[t._v("Unzip the package and move the unzipped files and "),a("code",[t._v("src")]),t._v(" directory to the "),a("code",[t._v("microservices/spring-ms/")]),t._v(" directory.")])]),t._v(" "),a("li",[a("p",[t._v("Create a new directory for the controller:")])])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("mkdir microservices/spring-ms/src/main/java/com/entando/example/springms/controller\n")])])]),a("ol",{attrs:{start:"4"}},[a("li",[t._v("In the controller directory, create "),a("code",[t._v("TemplateController.java")]),t._v(" with the following code:")])]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("entando"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("example"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("controller")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("web"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bind"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("annotation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RestController")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TemplateController")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@CrossOrigin")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@GetMapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/api/example"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n         "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyResponse")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getExample")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test Data"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n         "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" payload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" payload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("payload "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" payload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPayload")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" payload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n         "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ol",{attrs:{start:"5"}},[a("li",[t._v("To make the microservice compatible with Entando, add the following snippet to the "),a("code",[t._v("microservices/spring-ms/src/main/resources/application.properties")]),t._v(" file:")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("server.port=8081\nmanagement.endpoints.web.base-path=/api\n")])])]),a("ol",{attrs:{start:"6"}},[a("li",[t._v("Run the microservice from the bundle project root directory to test that it works:")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("ent bundle run spring-ms\n")])])]),a("ul",[a("li",[t._v("In your browser, access "),a("a",{attrs:{href:"http://localhost:8081/api/example",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:8081/api/example"),a("OutboundLink")],1),t._v(" to see "),a("code",[t._v('{"payload":"test Data"}')]),t._v(".")]),t._v(" "),a("li",[t._v("Then, access "),a("a",{attrs:{href:"http://localhost:8081/api/health",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:8081/api/health"),a("OutboundLink")],1),t._v(" to see "),a("code",[t._v('{"status":"UP"}')]),t._v(".\nIn local development, the run command can be used to modify the ports to run multiple microservices, but in production, microservices must run on port 8081.")])]),t._v(" "),a("ol",{attrs:{start:"7"}},[a("li",[t._v("Create "),a("code",[t._v("microservices/spring-ms/Dockerfile")]),t._v(" so ent knows how to assemble the Docker image for the service:")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('FROM openjdk:11\nWORKDIR /app\nCOPY target/*.jar /app/app.jar\nCMD ["java", "-jar", "app.jar"]\nEXPOSE 8081\n')])])]),a("h2",{attrs:{id:"step-3-build-and-install-the-bundle"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-3-build-and-install-the-bundle"}},[t._v("#")]),t._v(" Step 3: Build and Install the Bundle")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("Optionally, add an image file in PNG or JPG format named "),a("code",[t._v("thumbnail")]),t._v(" for the project.")])]),t._v(" "),a("li",[a("p",[t._v("To install your bundle, execute the following commands:")])])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("ent bundle pack\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("ent bundle publish\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("ent bundle deploy\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("ent bundle install \n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[t._v("To test the installed microservice, fetch your host name and microservice path with this command:")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("ent kubectl describe ingress \n")])])]),a("ul",[a("li",[a("p",[t._v("The URL where your microservice can be accessed follows this pattern:"),a("br"),t._v(" "),a("code",[t._v("YOUR-HOST-NAME/YOUR-BUNDLE-NAME/YOUR-MS-NAME/")])]),t._v(" "),a("p",[t._v("In a quickstart environment, the URL for this tutorial will look something like this:"),a("br"),t._v(" "),a("code",[t._v("quickstart.192.168.64.34.nip.io/e71-spring-project-f5bb760b/spring-ms/")])])]),t._v(" "),a("li",[a("p",[t._v("Using this URL in your browser, go to"),a("br"),t._v(" "),a("a",{attrs:{href:"http://quickstart.192.168.64.34.nip.io/e71-spring-project-f5bb760b/spring-ms/api/example/",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://quickstart.192.168.64.34.nip.io/e71-spring-project-f5bb760b/spring-ms/api/example/"),a("OutboundLink")],1),t._v(". It should return "),a("code",[t._v('{"payload":"test Data"}')]),t._v(".")])])]),t._v(" "),a("p",[a("strong",[t._v("Next Steps")])]),t._v(" "),a("ul",[a("li",[t._v("Learn to connect micro frontends to microservices by "),a("RouterLink",{attrs:{to:"/v7.1/tutorials/create/ms/add-api-claim.html"}},[t._v("adding an API Claim")]),t._v(".")],1),t._v(" "),a("li",[t._v("Add a "),a("RouterLink",{attrs:{to:"/v7.1/tutorials/create/mfe/widget-configuration.html"}},[t._v("configuration micro frontend")]),t._v(" to your bundle project.")],1)])])}),[],!1,null,null,null);e.default=n.exports}}]);