(window.webpackJsonp=window.webpackJsonp||[]).push([[704],{1984:function(e,t,a){"use strict";a.r(t);var s=a(36),n=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"bundle-upgrade-guideline"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bundle-upgrade-guideline"}},[e._v("#")]),e._v(" Bundle Upgrade Guideline")]),e._v(" "),a("p",[e._v("This guideline describes the process for upgrading a git-based bundle to the docker-based bundle (v5) introduced in Entando 7.1.")]),e._v(" "),a("p",[e._v("Git-based bundles do not need to be to upgraded. Both types of bundles are compatible with Entando 7.1+, but the v5 bundles provide several innovations and an improved developer experience.")]),e._v(" "),a("p",[e._v("The improvements include:")]),e._v(" "),a("ul",[a("li",[e._v("A simplified bundle directory structure")]),e._v(" "),a("li",[e._v("A decoupled build and deployment process that is easier to understand, modify, and troubleshoot")]),e._v(" "),a("li",[e._v("CI/CD integration and support")]),e._v(" "),a("li",[e._v("A single required Git source repository with Docker image repositories created automatically as needed")]),e._v(" "),a("li",[e._v("Optimized file storage and transfer methods using a layered file system, beneficial for large projects")]),e._v(" "),a("li",[e._v("A standardized bundle address format")])]),e._v(" "),a("h2",{attrs:{id:"quick-references"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#quick-references"}},[e._v("#")]),e._v(" Quick References")]),e._v(" "),a("ul",[a("li",[a("p",[a("RouterLink",{attrs:{to:"/v7.1/docs/curate/bundle-details.html"}},[e._v("Bundle Specifications")])],1)]),e._v(" "),a("li",[a("p",[a("RouterLink",{attrs:{to:"/v7.1/docs/getting-started/ent-bundle.html"}},[e._v("Bundle Management")])],1)]),e._v(" "),a("li",[a("p",[a("RouterLink",{attrs:{to:"/v7.1/docs/reference/bundle-comparison.html"}},[e._v("Bundle Version Comparison Table")])],1)])]),e._v(" "),a("h2",{attrs:{id:"upgrade-process"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#upgrade-process"}},[e._v("#")]),e._v(" Upgrade Process")]),e._v(" "),a("h3",{attrs:{id:"_1-initialize-bundle"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-initialize-bundle"}},[e._v("#")]),e._v(" 1. Initialize Bundle")]),e._v(" "),a("p",[e._v("Initialize a new bundle to set up the docker-based bundle structure using the ent CLI:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("ent bundle init YOUR-BUNDLE-NAME\n")])])]),a("h3",{attrs:{id:"_2-copy-assets"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-copy-assets"}},[e._v("#")]),e._v(" 2. Copy Assets")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("Use the ent CLI bundler command to export assets from an existing Entando Bundle. See the step-by-step "),a("RouterLink",{attrs:{to:"/v7.1/tutorials/create/pb/export-bundle-from-application.html"}},[e._v("Export and Publish Tutorial")]),e._v(".")],1)]),e._v(" "),a("li",[a("p",[e._v("The "),a("code",[e._v("platform")]),e._v(" directory is designated for resources such as fragments, contents, pages, and templates. Copy the output of the ent bundler to 'YOUR-BUNDLE-NAME/platform`.")])])]),e._v(" "),a("blockquote",[a("p",[e._v("-You can also accomplish this manually, but the ent bundler can automatically generate top-level descriptors for platform resources."),a("br"),e._v("\n-Widgets that are not MFEs are considered platform entities on Entando and should be placed in the "),a("code",[e._v("platform/widgets")]),e._v(" directory.")])]),e._v(" "),a("h3",{attrs:{id:"_3-add-micro-frontends-microservices"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-add-micro-frontends-microservices"}},[e._v("#")]),e._v(" 3. Add Micro Frontends & Microservices")]),e._v(" "),a("ol",[a("li",[e._v("From inside your bundle project folder, add your micro frontend to the bundle descriptor "),a("code",[e._v("entando.json")]),e._v(":")])]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[e._v("ent bundle mfe "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("add")]),e._v(" YOUR-MFE\n")])])]),a("blockquote",[a("p",[e._v("Docker-based bundles have a centralized bundle descriptor that includes specifications for bundle entities such as micro frontends, microservices, and platform components.")])]),e._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[e._v("Copy the MFE files into "),a("code",[e._v("YOUR-BUNDLE-NAME/microfrontends")]),e._v(". For instance, for an MFE named YOUR-MFE:")])]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("mv")]),e._v(" YOUR-ORIGIN-DIRECTORY/YOUR-MFE/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(".,"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("* microfrontends/YOUR-MFE\n")])])]),a("blockquote",[a("p",[e._v("Micro frontends and microservices are placed in their own directories in v5 bundles to streamline the CI/CD process.")])]),e._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[e._v("Add your microservice:")])]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[e._v("ent bundle ms "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("add")]),e._v(" YOUR-MS\n")])])]),a("ol",{attrs:{start:"4"}},[a("li",[e._v("Copy YOUR-MS files to the new location:")])]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("mv")]),e._v(" YOUR-ORIGIN-DIRECTORY/YOUR-MS/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(".,"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("* microservicess/YOUR-MS\n")])])]),a("ol",{attrs:{start:"5"}},[a("li",[e._v("Repeat steps 1 through 4 for all micro frontends and microservices.")])]),e._v(" "),a("h3",{attrs:{id:"_4-add-api-claims"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-add-api-claims"}},[e._v("#")]),e._v(" 4. Add API Claims")]),e._v(" "),a("ol",[a("li",[e._v("Add an API claim to connect "),a("code",[e._v("YOUR-MFE")]),e._v(" to a microservice as needed. The connection information is added to the descriptor "),a("code",[e._v("entando.json")]),e._v(".")])]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("ent bundle api "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("add")]),e._v(" YOUR-MFE YOUR-API --serviceName"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("YOUR-MS --serviceUrl"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("http://localhost:8081\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[e._v("Repeat the previous step for all APIs as needed.")])]),e._v(" "),a("blockquote",[a("p",[e._v("Refer to the "),a("RouterLink",{attrs:{to:"/v7.1/docs/getting-started/ent-api.html"}},[e._v("API Management")]),e._v(" page for additional information.")],1)]),e._v(" "),a("h3",{attrs:{id:"_5-add-custom-commands-to-test-locally-optional"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-add-custom-commands-to-test-locally-optional"}},[e._v("#")]),e._v(" 5. Add Custom Commands to Test Locally (Optional)")]),e._v(" "),a("p",[e._v("For local development and testing, a custom command can be provided in the "),a("code",[e._v("entando.json")]),e._v(" to specify a different port for each MFE as shown below:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('    "microfrontends": [\n        {\n            "name": "YOUR-MFE",\n            "customElement": "YOUR-MFE",\n            "stack": "react",\n            "type": "widget",\n            "group": "free",\n            "publicFolder": "public",\n            "commands": {\n                "run": "npm install && PORT=3000 npm start"\n            },\n            "apiClaims": [\n                {\n                    "name": "YOUR-API",\n                    "type": "internal",\n                    "serviceName": "YOUR-MS"\n                }\n            ]\n        },\n        {\n            "name": "YOUR-MFE2",\n            "customElement": "YOUR-MFE2",\n            "stack": "react",\n            "type": "widget",\n            "group": "free",\n            "publicFolder": "public",\n            "titles": {\n                "en": "YOUR-MFE2",\n                "it": "YOUR-MFE2"\n            },\n            "commands": {\n                "run": "npm install && PORT=3001 npm start"\n            },\n            "apiClaims": [\n                {\n                    "name": "YOUR-API2",\n                    "type": "internal",\n                    "serviceName": "YOUR-MS2"\n                }\n            ]\n        }\n    ]\n')])])]),a("blockquote",[a("p",[e._v("In production, all microservices must run on port 8081.")])]),e._v(" "),a("h3",{attrs:{id:"_6-add-auxiliary-services"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-add-auxiliary-services"}},[e._v("#")]),e._v(" 6. Add Auxiliary Services")]),e._v(" "),a("p",[e._v("Copy auxiliary services such as DBMS or Keycloak into the "),a("code",[e._v("svc")]),e._v(" directory as needed and enable them for local testing. For a Keycloak service:")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("mv")]),e._v(" YOUR-ORIGIN-DIRECTORY/* svc/\nent bundle svc "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("enable")]),e._v(" keycloak\n")])])]),a("blockquote",[a("p",[e._v("For details on adding services, see the "),a("RouterLink",{attrs:{to:"/v7.1/docs/getting-started/ent-svc.html"}},[e._v("Auxiliary Services")]),e._v(" page.")],1)]),e._v(" "),a("h3",{attrs:{id:"_7-pack-and-install"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-pack-and-install"}},[e._v("#")]),e._v(" 7. Pack and Install")]),e._v(" "),a("p",[a("RouterLink",{attrs:{to:"/v7.1/tutorials/create/pb/publish-project-bundle.html"}},[e._v("Build and install")]),e._v(" your bundle.\n"),a("EntandoInstall71")],1),e._v(" "),a("p",[e._v("For an example tutorial, see "),a("RouterLink",{attrs:{to:"/v7.1/tutorials/create/ms/generate-microservices-and-micro-frontends.html#configure-the-components"}},[e._v("Generate Microservices and Micro Frontends")]),e._v(".")],1)])}),[],!1,null,null,null);t.default=n.exports}}]);